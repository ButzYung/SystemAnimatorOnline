// (2021-11-23)

var _0x22e5=['DgL5vg0','uNDhrMC','z2HYA04','DgLVBIbZDgfYDa','C3rHDhvZvgv4Da','zwvNz3C','y2XVBMu','EvDnyM8','u1zNq1u','B1vSwKW','DfP5yuW','zuDwwve','x3PPCf9IEv91CG','mwjkz1ryuW','Eejcvha','DurXsvO','uu9Isg8','zK5Ry0K','D250ruO','B0rWC2O','x3bHDgHFDg9FBW','AMTNt0O','reHuvvC','zvjLCMO','u0nUtxq','nhWYFdb8mxWZ','mJyYmdC5B0TVvLbI','z2DVsgq','rNDlBNq','BM93','zw5HyMXLza','rLPIuvC','qvDYBeu','y3j5ChrV','A2vdsM0','BwLlDvK','Evbnq0i','Chv0','D0Tkzg8','tgrkEhe','rNjQyLO','Bg9JywWGzMLSzq','BMvNtge','q1HeA08','se9XBK8','vfD2wLe','u3LZDgvTqw5PBq','CMvXDwvZDa','BMfTzq','BK50uNu','wwLRuKq','sfbqteO','wMPKsMm','mwHwCMHvwa','whLgt2i','ExDQDgO','wwf5q3G','A1LIvwq','C1DqqLu','wuLnv0y','otu2mZHurKrqsKq','Dunyvfe','EerysMm','Bwv0Ag9K','wLrcALG','vLnQEhe','EgDZsKu','ExrVEwW','Bg9HzefZEw5J','vvnbzgu','zgj6r0K','Bejfuxa','B3bLBG','yxjYyxLcDwzMzq','sxLNwKS','r21Ry3C','yxjYyxLIDwzMzq','qwzjzxK','zMLSzq','xIGUk1WUEMLWkq','ic0GEMLWihbHDa','AKfADg8','vNfgDwW','C0vfDve','DgHLBG','rvbcrgW','zMv0y2G','ze5nEgC','u3PLq0K','qK9Ms1y','zLbfrNG','rKHAAhC','y2fSBa','DwLgtwq','CuX0vKu','Aw1WB3j0s2v5','B1bhu1e','BujSyNa','vhnowNu','D2v2r1O','wufeA1C','EuHmCfe','DwD2CNO','yNvntwC','z3PTB1q','zxjYB3i','s05csLK','C3PPCvO','tMfjEee','rLnUrLC','DwvZDfPjucbfuG','ueDzrKq','C2DWExy','Ag9ZDa','y29Uy2f0','Dw1R','mZmYowzsy2PAzW','uKPewMO','qMjMq3y','v1v2sKq','qLrdvhi','wM5bAhy','B25LCNjVCG','tLzNvLK','txzeu1u','whLvuge','s25hEha','rLLfv2C','CNHOA0y','C3n2ze4','B2n0','s1L4wfq','A1buDfG','A2D1uw0','BMfXz3O','mtC2mduYm0rmyxfVvq','y2fJAgvZ','q1DvDMe','zefvy3G','D2D0svK','qMXVyG','CNznt1K','BvrqDMC','DvffAxK','wK5rwMS','uK9s','r1bfAu0','uK9fwKm','ww1hAxq','CeHlruS','DhHRzKW','zLLct08','BvfUBMW','EMLW','Axjyz0W','tu1SAgy','sgfeBwy','CLfmuvK','ChvZAa','BNbby0C','qu1Vtfq','v29YA2vY','Cg5QDfy','vfbgCeW','kYKK','ruq6','svrguuC','CgPgrNi','DxjS','rgrNtMG','vgLuBuq','AfL2zxC','mtKZvfzfA1zV','BxmPic0G','AfnAyxi','uK9soG','BgvUz3rO','CgXSv0q','yNHvtum','vvjm','rhHQuNC','ic0GwKLqievsuG','z1DbsNK','AgzeC1C','zNnjDvm','BgHwDhC','u2zbC1m','sZjWugyXAxfcCa','C2XPy2u','D1DpvM0','AwDUB3jLu2vHCG','A0LqB1a','C3rHDhvZ','Ce1hrg4','qvrUuge','y3LXzuy','EMP1uNq','r0zvqLy','qK5zrLq','A1bizvO','serirg8','C3bSAxq','BLPpAfO','zLPsrfi','quvtlunuuG','sKTLsNi','otjqs3PLv3e','uvrstwC','y2f0y2G','Bg9JyxrPB24','yMrQs2i','CLL1u2e','DgLxsMq','y2nbrey','t3Hnvgu','xc5HzxnClNPPCa','vffxwxu','y1nXz3u','ru15u1O','zgvJCNLWDa','ywrKrxzLBNrmAq','vNHTD2S','ugnZsw0','zhjsDxC','we9tsNO','BMjquvy','CcbWyxrOoG','uhPdEuW','uuLksue','Bu9ltKe','xcnBxc9Cxf0OlG','wuTJB3K','uKveoG','kg1HDgnOigj5ia','ueHMrNu','Avrhuxi','C3rYAw5N','A1HeEM8','z2v0','se9uBxu','ve9Hzey','t1vrBuO','zuDUwem','DgvZDa','shbmvMG','vMrpu3q','rvrHzW','nde5nuPhthHrzG','yLvuD0y','y291BNrLCG','AwjUv1i','C05oAu4','DvPttwe','q29UDgvUDc1mzq','wuzMtuK','yxn5BMm','zxvWrva','Au9wshu','CLPHwvm','D3rwD2i','B3nJsM0','DhjoqvK','Bfb6Exi','Axr0wxm','BK9XBwi','t1i6','sNryre0','wNPKugO','DgLVBIbKB25Lka','CMvZCg9UC2u','CMvZCg9UC2vuEq','BMH6y3e','yuLvyKq','EvLtB08','sevbra','zLv4s3e','ueT6tK4','zMfnsuW','A0Phr2e','EML0sfq','nZaWnde2Ce9ZwfHx','qKHhD0u','yM9IA0u','rM9ruMq','rxLUvvC','DwvZDfPjucb6Aq','BxLty3K','v0njwLi','we1mshr0CfjLCq','B25SB2fK','BMD0Aa','qMnLsfi','AfbLAKm','q2fJAguGu1rpuG','s0L1Bha','shvQsuK','ndKXmZe4zMPhuvvh','sLnAAxa','x3PPCf9WyxrO','wMvNq1e','wLfvteq','sgnsq0K','DwvZDa','u3jcuwm','yK5Pu3q','ANDR','AeLSyuS','D1HAuxi','DezMshq','reXJt3O','BMD0AcK','tKrutfG','Bunqy0m','D2Tjv3m','q2fJAguGrvHqsq','x2rLy29Kzq','ufrVuha','De55DK0','vgzYsgu','AKTKrwq','rvrHzYK','zM9YrwfJAa','Cu1bvMm','BM8TC3rVCMu','rhjHz0rYB3a','DuPZzeG','t0DvqMi','C2vUza','BM8GDgfNkq','yxrVCG','DKjJz3G','q2fJAguGseLuoG','rLHoDKO','DuXrwgS','x2zPBgvFCgf0Aa','EgHY','y3biC2W','wMHyzfO','EwXduvu','BMHPwhu','zNPMBgC','zgvSzxrL','z3zsuLe','wKLqigrLy3j5Ca','u1f4CM8','yuL6tfq','DfnLwwq','Du13DM0','uLrHCMq','vNPqyKi','ELrJq1y','su9ezwq','thL5wu4','B2TyEva','uhvStMG','Efzyzhq','x2nSzwfY','ELntzge','re5Jqui','ChjVDg90ExbL','Bg9N','yw5HyLa','C0H1B1m','vwPHt3e','qxbuvNO','B1rMzNa','u0Lwvgq','q3HYrgS','DfbIzue','ufbnswC','vKnpvhy','AgvHzgvYCW','ufDZvfu','ugvQDNm'];var _0x4abc=function(_0x2a39ea,_0x14ce7f){_0x2a39ea=_0x2a39ea-(0x23a5+-0x10c1*-0x2+-0x7*0x9a9);var _0x51ea62=_0x22e5[_0x2a39ea];if(_0x4abc['YdnuJQ']===undefined){var _0xd67a62=function(_0x1b4edb){var _0x1f1467='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x2a7743='';for(var _0x16b4f1=-0x2*0xb50+-0x1417+0x2ab7,_0x490684,_0x5192ca,_0x46e3cb=0x1*0x8e8+-0x12dd+0x9f5;_0x5192ca=_0x1b4edb['charAt'](_0x46e3cb++);~_0x5192ca&&(_0x490684=_0x16b4f1%(-0x8c9*0x1+0x3f9+0x4d4)?_0x490684*(0x63+0xeb4+0x1*-0xed7)+_0x5192ca:_0x5192ca,_0x16b4f1++%(-0x1*0x1b94+-0x1f98+0x3b30))?_0x2a7743+=String['fromCharCode'](0x5d0+-0xcbd+0x7ec&_0x490684>>(-(0x4*0x497+0x2201+-0x345b)*_0x16b4f1&-0x1d19+-0x12b3*-0x1+0x74*0x17)):0x715+0x1087+-0x179c){_0x5192ca=_0x1f1467['indexOf'](_0x5192ca);}return _0x2a7743;};_0x4abc['nJzvpz']=function(_0x3ef5b2){var _0x19990b=_0xd67a62(_0x3ef5b2);var _0x1b71da=[];for(var _0x1e20ca=0x1393+0x121d+-0x25b0,_0x33120c=_0x19990b['length'];_0x1e20ca<_0x33120c;_0x1e20ca++){_0x1b71da+='%'+('00'+_0x19990b['charCodeAt'](_0x1e20ca)['toString'](-0x1d*-0x7e+-0x1d95+-0x313*-0x5))['slice'](-(0x1ad3+-0xd73+-0x1d*0x76));}return decodeURIComponent(_0x1b71da);},_0x4abc['OqHKWe']={},_0x4abc['YdnuJQ']=!![];}var _0x123d28=_0x22e5[-0x144+0x1713+-0x15cf],_0x374c57=_0x2a39ea+_0x123d28,_0x53de20=_0x4abc['OqHKWe'][_0x374c57];return _0x53de20===undefined?(_0x51ea62=_0x4abc['nJzvpz'](_0x51ea62),_0x4abc['OqHKWe'][_0x374c57]=_0x51ea62):_0x51ea62=_0x53de20,_0x51ea62;};var _0x14e3c4=function(_0x24b3ae,_0x28d1f4,_0x28d3a8,_0x15c63c){return _0x4abc(_0x28d1f4-0x15f,_0x15c63c);};(function(_0x2f39a3,_0x11c00a){var _0x52b22e=function(_0x1de284,_0x222752,_0x3dd75e,_0x4f7653){return _0x4abc(_0x3dd75e-0x124,_0x1de284);},_0x3e276b=function(_0x2b2065,_0x21071a,_0x3334b7,_0x2b09de){return _0x4abc(_0x3334b7-0x124,_0x2b2065);};while(!![]){try{var _0x453ae0=-parseInt(_0x52b22e(0x3d4,0x459,0x40e,0x362))+-parseInt(_0x52b22e(0x30f,0x330,0x375,0x398))*parseInt(_0x52b22e(0x3b4,0x3e2,0x34c,0x31f))+-parseInt(_0x52b22e(0x206,0x2b4,0x2ba,0x23e))*-parseInt(_0x52b22e(0x2d4,0x233,0x2b3,0x258))+-parseInt(_0x3e276b(0x361,0x345,0x2f2,0x35d))*parseInt(_0x3e276b(0x3ab,0x3c2,0x32a,0x2fc))+-parseInt(_0x3e276b(0x350,0x37a,0x396,0x366))+parseInt(_0x3e276b(0x426,0x41e,0x3a6,0x34a))+parseInt(_0x52b22e(0x3b5,0x428,0x401,0x3db))*parseInt(_0x3e276b(0x350,0x29a,0x305,0x3a3));if(_0x453ae0===_0x11c00a)break;else _0x2f39a3['push'](_0x2f39a3['shift']());}catch(_0x530b83){_0x2f39a3['push'](_0x2f39a3['shift']());}}}(_0x22e5,-0x1d2*-0x377+-0x8*0x39b1+0xefad));var XMLHttpRequestZIP=function(){};(function(){var _0x46860e=function(_0x47e2c2,_0x7031a1,_0xe405c6,_0x31754d){return _0x4abc(_0x7031a1-0x21a,_0xe405c6);},_0x512471=function(_0x34e408,_0x4f1cb8,_0x3c6d95,_0x3e87cd){return _0x4abc(_0x4f1cb8-0x21a,_0x3c6d95);},_0x2bdacb={};_0x2bdacb[_0x46860e(0x476,0x41b,0x3a4,0x462)]=function(_0x587769,_0x15f303){return _0x587769!==_0x15f303;},_0x2bdacb[_0x46860e(0x45c,0x50a,0x491,0x56b)]=_0x46860e(0x4ac,0x4b3,0x479,0x489),_0x2bdacb[_0x46860e(0x3b0,0x446,0x3f3,0x435)]=function(_0x1407e7,_0x4961e9){return _0x1407e7===_0x4961e9;},_0x2bdacb[_0x46860e(0x446,0x4b6,0x532,0x42c)]=_0x512471(0x34d,0x3d2,0x451,0x33c),_0x2bdacb['ylCQU']='DcmMO',_0x2bdacb[_0x512471(0x54c,0x4c4,0x49e,0x40d)]=_0x512471(0x341,0x3e9,0x41c,0x331),_0x2bdacb['KIulp']=_0x46860e(0x439,0x494,0x4a5,0x491)+'uestZIP\x20ER'+_0x46860e(0x38f,0x423,0x3a0,0x48d),_0x2bdacb['YKcoy']=function(_0x14179c,_0x47b195){return _0x14179c(_0x47b195);},_0x2bdacb[_0x46860e(0x35c,0x3c6,0x30b,0x474)]=function(_0x4627b8,_0x492152){return _0x4627b8===_0x492152;},_0x2bdacb[_0x46860e(0x3d8,0x47c,0x4d7,0x52c)]=_0x46860e(0x4ab,0x459,0x3a1,0x495),_0x2bdacb['nhzcq']=_0x512471(0x52f,0x494,0x4dd,0x524)+_0x46860e(0x399,0x3e2,0x332,0x337)+_0x512471(0x366,0x405,0x3ca,0x444),_0x2bdacb['DUxEV']=function(_0x4f93b3,_0x1a5d8d){return _0x4f93b3!==_0x1a5d8d;},_0x2bdacb[_0x512471(0x3a0,0x404,0x392,0x36b)]=_0x512471(0x3f0,0x493,0x4a5,0x3ee),_0x2bdacb[_0x46860e(0x47a,0x49f,0x49d,0x4af)]=_0x512471(0x4b0,0x406,0x476,0x448),_0x2bdacb[_0x512471(0x3f9,0x40b,0x39a,0x418)]=function(_0x50f240,_0x36b8cb){return _0x50f240+_0x36b8cb;},_0x2bdacb[_0x512471(0x45a,0x4d9,0x510,0x4c7)]=function(_0x43947f,_0x44c67e){return _0x43947f+_0x44c67e;},_0x2bdacb[_0x46860e(0x473,0x3e0,0x42f,0x3d3)]=function(_0x594d76,_0x38a858){return _0x594d76-_0x38a858;},_0x2bdacb[_0x512471(0x581,0x4f9,0x451,0x4d9)]=_0x46860e(0x49f,0x421,0x40e,0x37f),_0x2bdacb[_0x46860e(0x385,0x3e3,0x416,0x373)]=function(_0xb348fe,_0x4bf9e8){return _0xb348fe in _0x4bf9e8;},_0x2bdacb[_0x512471(0x49e,0x43f,0x459,0x3b7)]=_0x512471(0x422,0x4cc,0x41d,0x56c),_0x2bdacb[_0x512471(0x532,0x4d3,0x456,0x4a4)]='zillj',_0x2bdacb[_0x46860e(0x4a4,0x43a,0x49c,0x3f7)]=_0x512471(0x55e,0x4a8,0x425,0x3f8),_0x2bdacb[_0x46860e(0x448,0x402,0x419,0x419)]='vWSuG',_0x2bdacb[_0x512471(0x341,0x3be,0x372,0x3ea)]=_0x512471(0x411,0x3f6,0x45a,0x41c),_0x2bdacb[_0x46860e(0x4bf,0x4a6,0x423,0x4ff)]='RyZKu',_0x2bdacb['fUxKq']=_0x512471(0x44a,0x4c8,0x4e7,0x499),_0x2bdacb[_0x46860e(0x3e6,0x49b,0x40c,0x522)]=function(_0x54e4c4,_0x471f7f){return _0x54e4c4!==_0x471f7f;},_0x2bdacb[_0x512471(0x36b,0x413,0x362,0x3f1)]='OrHOV',_0x2bdacb[_0x512471(0x541,0x514,0x561,0x459)]='XMLHttpReq'+_0x512471(0x521,0x491,0x42f,0x4bb)+_0x46860e(0x4fe,0x456,0x405,0x40f),_0x2bdacb[_0x46860e(0x3ea,0x443,0x48f,0x453)]=_0x512471(0x3dc,0x3c0,0x471,0x375)+'r',_0x2bdacb[_0x512471(0x3c2,0x410,0x426,0x362)]=function(_0xbb7e92,_0x4d0dfc){return _0xbb7e92===_0x4d0dfc;},_0x2bdacb['HFmhY']=_0x46860e(0x432,0x3d9,0x330,0x393),_0x2bdacb[_0x46860e(0x4a6,0x4c1,0x531,0x54d)]=function(_0x2a65a8,_0x542f9f,_0x1bbabe,_0x337225,_0x232ed5,_0x4c3236,_0x2895e2){return _0x2a65a8(_0x542f9f,_0x1bbabe,_0x337225,_0x232ed5,_0x4c3236,_0x2895e2);},_0x2bdacb[_0x512471(0x3ee,0x42c,0x463,0x3ca)]='LHEPZ',_0x2bdacb['LyyYN']=_0x46860e(0x3ca,0x3c1,0x3fb,0x44c),_0x2bdacb[_0x512471(0x4b6,0x4ce,0x447,0x55f)]=_0x46860e(0x4bb,0x427,0x470,0x46f),_0x2bdacb['PulNh']=_0x46860e(0x3f2,0x415,0x414,0x39a),_0x2bdacb['YIMWF']=_0x46860e(0x31d,0x3c3,0x411,0x310)+_0x512471(0x4b0,0x45a,0x460,0x44b)+_0x512471(0x3fe,0x418,0x388,0x477),_0x2bdacb[_0x512471(0x3bc,0x3d5,0x35b,0x462)]=_0x512471(0x437,0x44b,0x440,0x47b)+'$',_0x2bdacb['GFUBV']='MMDStarted';var _0xddff2c=_0x2bdacb,_0x2ce040={};window[_0x512471(0x39a,0x450,0x48e,0x422)+'stener'](_0xddff2c[_0x46860e(0x454,0x439,0x4b3,0x3df)],function(_0x3bb746){var _0x245e5f=function(_0x23506a,_0x40c59c,_0x28e7e9,_0x2413e3){return _0x512471(_0x23506a-0x64,_0x23506a- -0x3ae,_0x40c59c,_0x2413e3-0x1c0);},_0x4c9ca7=function(_0x4415d8,_0x20c730,_0xd62bf9,_0x70fdde){return _0x46860e(_0x4415d8-0xaf,_0x4415d8- -0x3ae,_0x20c730,_0x70fdde-0x11a);};if(_0xddff2c['pjFFr']('ANdKL',_0xddff2c[_0x245e5f(0x15c,0xde,0xcb,0x192)]))XMLHttpRequestZIP[_0x4c9ca7(0x12d,0x1a6,0x150,0x127)][_0x4c9ca7(0x12a,0x161,0x197,0x1a9)]();else{function _0x55a1a2(){var _0x1d3671=function(_0x52e6d4,_0xd656be,_0x47572d,_0xf1b687){return _0x245e5f(_0x52e6d4- -0x13,_0xd656be,_0x47572d-0xd5,_0xf1b687-0x13b);},_0x351838=function(_0x11240e,_0x420983,_0xcd9792,_0x276255){return _0x4c9ca7(_0x11240e- -0x13,_0x420983,_0xcd9792-0xa8,_0x276255-0x13b);};_0xe07a87={};for(var _0x563ea0 in _0x92128c['DragDrop'][_0x1d3671(0x135,0x80,0x1ce,0xe7)+'l']){_0x1080e3[_0x563ea0]={'zip':_0x82f8f4[_0x1d3671(0xf7,0x10c,0xdf,0x15c)]['_zip_by_ur'+'l'][_0x563ea0],'xhr':[]};}}}}),XMLHttpRequestZIP['prototype'][_0x512471(0x428,0x4d8,0x420,0x533)]=function(){var _0x23bbb8=function(_0x53a32b,_0x443ef0,_0x284014,_0x100300){return _0x46860e(_0x53a32b-0x196,_0x100300-0x3e2,_0x284014,_0x100300-0x35);},_0x201b80=function(_0x26f4f,_0x385c5e,_0x236fbe,_0x3cf8b2){return _0x46860e(_0x26f4f-0xd9,_0x3cf8b2-0x3e2,_0x236fbe,_0x3cf8b2-0x1d4);};if(_0xddff2c[_0x23bbb8(0x84f,0x7de,0x79e,0x828)](_0xddff2c[_0x23bbb8(0x80d,0x92b,0x87a,0x898)],_0x201b80(0x805,0x7ce,0x7b7,0x7b4))){if(top[_0x23bbb8(0x810,0x7f3,0x942,0x89a)][_0x201b80(0x85e,0x8ef,0x958,0x8d8)+'l']){if(_0xddff2c[_0x201b80(0x832,0x7b0,0x861,0x7fd)](_0xddff2c[_0x201b80(0x8a8,0x86b,0x937,0x8a8)],_0x201b80(0x83f,0x845,0x7b7,0x7a9))){_0x2ce040={};for(var _0x4b0cb8 in top[_0x201b80(0x89c,0x899,0x837,0x89a)]['_zip_by_ur'+'l']){if(_0xddff2c[_0x23bbb8(0x7a6,0x783,0x8d0,0x828)](_0x23bbb8(0x85d,0x7c9,0x840,0x7cb),_0xddff2c[_0x201b80(0x855,0x8fd,0x8f5,0x8a6)]))_0x2ce040[_0x4b0cb8]={'zip':top[_0x23bbb8(0x8f7,0x84d,0x805,0x89a)][_0x23bbb8(0x8c6,0x853,0x8a3,0x8d8)+'l'][_0x4b0cb8],'xhr':[]};else{function _0x547eec(){var _0x36b5e9=function(_0x187d40,_0x4fb2e5,_0x4290f1,_0x246e4f){return _0x201b80(_0x187d40-0x37,_0x4fb2e5-0xb1,_0x4fb2e5,_0x246e4f-0x106);},_0x2d4d8e=function(_0x4a47da,_0x348821,_0x1103e3,_0x36d18e){return _0x201b80(_0x4a47da-0x9b,_0x348821-0x52,_0x348821,_0x36d18e-0x106);};_0x4273ab[_0x36b5e9(0x967,0xa21,0xa59,0x9c3)][_0x36b5e9(0xa56,0x9a3,0x93a,0x9c0)]();}}}}else{function _0x3125fa(){var _0x12cf31=function(_0x26bd70,_0x243ccc,_0x1678b0,_0xdbdb8d){return _0x23bbb8(_0x26bd70-0xae,_0x243ccc-0xf5,_0xdbdb8d,_0x1678b0- -0x85);};_0x1741a9[_0x12cf31(0x68b,0x792,0x73a,0x6aa)](_0x1d3609);}}}else _0x2ce040={};}else{function _0x826bf7(){var _0x5e3860=function(_0x4b8f03,_0x172804,_0x47660d,_0x2ac1bc){return _0x201b80(_0x4b8f03-0x13f,_0x172804-0x12b,_0x2ac1bc,_0x4b8f03-0x10a);},_0x839873=function(_0x272297,_0x3b2f61,_0x3fb618,_0x2181d2){return _0x23bbb8(_0x272297-0x8e,_0x3b2f61-0x1dc,_0x2181d2,_0x272297-0x10a);};_0x34c1df[_0x44581a[_0x5e3860(0x98a,0x9c5,0x925,0xa2d)]][_0x5e3860(0x8f9,0x950,0x88b,0x95b)]=_0x1e8caf,_0x3fd773[_0x839873(0x99b,0xa36,0xa05,0x984)]();}}},XMLHttpRequestZIP[_0x512471(0x4d5,0x4db,0x444,0x426)][_0x512471(0x52a,0x4af,0x4a6,0x539)]=function(){var _0xc5c131=function(_0x55664f,_0x47a8e5,_0x78ca0a,_0x246cec){return _0x512471(_0x55664f-0x65,_0x55664f- -0x24c,_0x246cec,_0x246cec-0x119);},_0x44ee5e=function(_0x854fc4,_0xec1697,_0x42cb15,_0x525eac){return _0x512471(_0x854fc4-0x12e,_0x854fc4- -0x24c,_0x525eac,_0x525eac-0x23);},_0x48e114={};_0x48e114[_0xc5c131(0x2ae,0x314,0x27b,0x252)]=_0xddff2c['KIulp'],_0x48e114['myScy']=function(_0x1f73d5,_0x2dc91a){var _0x48c579=function(_0x4b7d5e,_0xac7054,_0x14f527,_0x32682e){return _0xc5c131(_0x14f527- -0x26e,_0xac7054-0x190,_0x14f527-0x83,_0x4b7d5e);};return _0xddff2c[_0x48c579(-0x7d,-0x13,-0x5f,-0xc2)](_0x1f73d5,_0x2dc91a);},_0x48e114[_0xc5c131(0x23f,0x1bb,0x1af,0x18b)]=function(_0x3498cf,_0x2470c0){return _0xddff2c['VqFul'](_0x3498cf,_0x2470c0);},_0x48e114[_0xc5c131(0x18b,0x157,0x104,0x200)]=_0xddff2c[_0x44ee5e(0x230,0x2d2,0x24d,0x1e9)],_0x48e114[_0xc5c131(0x1e1,0x1ab,0x1bb,0x212)]=_0xddff2c[_0x44ee5e(0x237,0x2a3,0x2dc,0x293)],_0x48e114[_0x44ee5e(0x226,0x191,0x224,0x196)]=_0xc5c131(0x2c7,0x301,0x284,0x21d)+_0xc5c131(0x1dd,0x1df,0x206,0x290)+_0x44ee5e(0x231,0x2d8,0x26b,0x187);var _0x4408d9=_0x48e114;if(_0xddff2c['DUxEV'](_0xddff2c[_0x44ee5e(0x1b8,0x13e,0x127,0x21a)],_0xddff2c[_0xc5c131(0x253,0x1f9,0x29e,0x1c2)])){var _0x4fca3d=_0x2ce040[this[_0x44ee5e(0x252,0x27c,0x19d,0x2a2)]];_0x4fca3d[_0x44ee5e(0x277,0x2d6,0x1f0,0x262)][_0xc5c131(0x269,0x230,0x28b,0x22e)](function(_0x5be83b){var _0x723a2f=function(_0x5d4612,_0x166a9c,_0x20819c,_0x2e9b10){return _0x44ee5e(_0x20819c-0xd,_0x166a9c-0xee,_0x20819c-0x1d,_0x2e9b10);},_0x5803ff=function(_0x5bd256,_0x21e0d9,_0x2ca7db,_0x257cf8){return _0x44ee5e(_0x2ca7db-0xd,_0x21e0d9-0x22,_0x2ca7db-0x12d,_0x257cf8);},_0xd5e7e9=_0x4fca3d[_0x723a2f(0x140,0x114,0x1ce,0x265)][_0x5803ff(0x161,0x1cb,0x183,0x163)](new RegExp(_0x4408d9[_0x723a2f(0x1b5,0x2f0,0x253,0x1be)](toRegExp,_0x5be83b[_0x723a2f(0x1cc,0x2c6,0x283,0x2ad)]),'i'))[-0x21d*0x1+0x1*-0x153d+0x7a*0x31];if(!_0xd5e7e9){if(_0x5be83b[_0x5803ff(0x116,0x194,0x1af,0x24e)]){if(_0x4408d9[_0x5803ff(0x28b,0x2b7,0x24c,0x23e)](_0x4408d9[_0x5803ff(0x17d,0x249,0x198,0x13a)],_0x4408d9['wevGZ']))_0x5be83b[_0x723a2f(0x132,0x1e4,0x1af,0x224)](_0x5be83b['url'],_0x4408d9[_0x723a2f(0x159,0x22b,0x1ee,0x27d)]);else{function _0x35519c(){var _0x150fb9=function(_0x39aa44,_0x5b9d62,_0x97d6bb,_0x259d9a){return _0x5803ff(_0x39aa44-0x52,_0x5b9d62-0x16,_0x97d6bb- -0x8b,_0x5b9d62);},_0x5be777=function(_0x4ded78,_0x3f0dfc,_0x12e6e9,_0x5dfb1f){return _0x5803ff(_0x4ded78-0x188,_0x3f0dfc-0xdf,_0x12e6e9- -0x8b,_0x3f0dfc);},_0x4552c1={};_0x4552c1['yYSoO']='Cache\x20STOR'+_0x150fb9(0x123,0xd7,0x14f,0xd2);var _0x51d216=_0x4552c1;_0x38714a[_0x150fb9(0x7b,0x5a,0xf2,0x58)]()[_0x150fb9(0x16a,0x100,0xfe,0x5b)](function(_0x20620e){var _0xf73f24=function(_0x47742c,_0x19a957,_0x94d2e,_0x3281e4){return _0x5be777(_0x47742c-0x103,_0x19a957,_0x3281e4-0x33f,_0x3281e4-0x1b2);},_0x2e7580=function(_0x1494f9,_0x2df682,_0x2174f6,_0x31635d){return _0x5be777(_0x1494f9-0x95,_0x2df682,_0x31635d-0x33f,_0x31635d-0xe6);};_0x20620e[_0xf73f24(0x59f,0x4eb,0x5ae,0x584)](_0xf89c2,_0x2113b8)[_0x2e7580(0x41c,0x458,0x418,0x43d)](function(){var _0x24e833=function(_0x5109e6,_0x5e8a02,_0x5a247c,_0x53b8cc){return _0xf73f24(_0x5109e6-0x46,_0x5109e6,_0x5a247c-0xdc,_0x5a247c- -0x1d0);},_0x3a3a8b=function(_0xa254c0,_0x3e0ee5,_0x516195,_0x3baab4){return _0xf73f24(_0xa254c0-0x1c9,_0xa254c0,_0x516195-0x12d,_0x516195- -0x1d0);};_0x4df25a[_0x24e833(0x2f5,0x423,0x381,0x2c8)](_0x51d216[_0x3a3a8b(0x3bc,0x391,0x32a,0x2f0)],_0x17bbf5[_0x24e833(0x364,0x226,0x2c1,0x212)]);});});}}}console[_0x723a2f(0x224,0x24f,0x19e,0xf0)](_0x4408d9[_0x5803ff(0x22d,0x2d3,0x2bb,0x2b6)],_0x5be83b[_0x723a2f(0x1f2,0x2a9,0x25f,0x228)],_0x5be83b[_0x723a2f(0x330,0x24c,0x283,0x256)]);return;}_0xd5e7e9[_0x723a2f(0x2b3,0x231,0x234,0x261)](_0x5be83b[_0x723a2f(0x257,0x279,0x243,0x215)+'pe'])[_0x723a2f(0x1a7,0x1a8,0x189,0x1b6)](function(_0x1e1f22){var _0x439103=function(_0x283035,_0x3074ff,_0x1d5bd2,_0x37cbae){return _0x5803ff(_0x283035-0x8a,_0x3074ff-0x158,_0x3074ff- -0x318,_0x283035);},_0x4a34c2=function(_0x589069,_0x1d7d4f,_0x3d51b6,_0x3b29e3){return _0x723a2f(_0x589069-0xd5,_0x1d7d4f-0x17b,_0x1d7d4f- -0x318,_0x589069);};_0x5be83b[_0x439103(-0x85,-0x123,-0xe8,-0x174)]=0x7ed*-0x1+-0x1*0x1cff+0x13*0x1fc,_0x5be83b['response']=_0x1e1f22,_0x5be83b[_0x439103(-0x31,-0xc2,-0x10d,-0x13e)](),_0x1e1f22=_0x5be83b=null;},function(_0x417387){var _0x4d0b5a=function(_0x337831,_0x4654f0,_0x1f9e96,_0x1cc9df){return _0x5803ff(_0x337831-0x18c,_0x4654f0-0x1a6,_0x1cc9df- -0xfc,_0x4654f0);},_0x4da231=function(_0x57cd00,_0x3a4648,_0xf2feda,_0x47dbe5){return _0x723a2f(_0x57cd00-0x106,_0x3a4648-0x149,_0x47dbe5- -0xfc,_0x3a4648);};_0x5be83b['onerror']&&_0x5be83b[_0x4d0b5a(0x5f,0x16a,0x70,0xb3)](_0x5be83b['url'],_0x4da231(0x1d8,0x1c7,0x153,0x159)+_0x4d0b5a(0x27,0xf5,0x16,0xa7)+_0x4d0b5a(0x23,0xd8,0x130,0xca)),console['error'](_0x4408d9[_0x4da231(0x15c,0x253,0x1be,0x1bf)],_0x5be83b['_zip_path'],_0x5be83b[_0x4d0b5a(0xd0,0x19c,0x14a,0x187)],_0x417387);});}),_0x4fca3d[_0x44ee5e(0x277,0x32a,0x1cc,0x32b)]=[];}else{function _0x4fc6e1(){var _0x29d7e3=function(_0x36cdce,_0x4cf6fd,_0xbf0ace,_0x5d97e7){return _0xc5c131(_0xbf0ace-0xcf,_0x4cf6fd-0x9b,_0xbf0ace-0x1f3,_0x5d97e7);},_0x51a02f=function(_0x10ed95,_0x5d7683,_0x1a7041,_0x26e5fa){return _0xc5c131(_0x1a7041-0xcf,_0x5d7683-0x54,_0x1a7041-0x1c6,_0x26e5fa);};_0x1db627[_0x29d7e3(0x2ab,0x3a2,0x35f,0x349)](_0x29d7e3(0x362,0x2e4,0x396,0x3fa)+_0x51a02f(0x21d,0x22b,0x247,0x21c)+'h:',this['_zip_path']);var _0x15b211={};_0x15b211[_0x29d7e3(0x308,0x2d5,0x290,0x2b6)]=null,_0x15b211['xhr']=[this],_0x337654[this[_0x29d7e3(0x3d1,0x2b8,0x321,0x32c)]]=_0x15b211,new _0x2722ad['JSZip']()['loadAsync'](_0x5b2ef9)[_0x29d7e3(0x1bc,0x22d,0x24b,0x2c3)](function(_0x26c577){var _0x1e1d49=function(_0x3de849,_0x453137,_0x5a7734,_0x2f5b8c){return _0x29d7e3(_0x3de849-0xbf,_0x453137-0x124,_0x2f5b8c-0x362,_0x3de849);},_0x4c2702=function(_0x4afa3b,_0x294480,_0x17b93e,_0x6bc336){return _0x29d7e3(_0x4afa3b-0x180,_0x294480-0xe4,_0x6bc336-0x362,_0x4afa3b);};_0x52757a[_0x4dd865[_0x1e1d49(0x731,0x60a,0x687,0x683)]][_0x4c2702(0x5ba,0x566,0x593,0x5f2)]=_0x26c577,_0x3e8e19[_0x4c2702(0x624,0x725,0x5f9,0x694)]();},function(_0x406c9e){var _0x44e280=function(_0x24c0ee,_0x18f494,_0x1c5d25,_0x328dd1){return _0x51a02f(_0x24c0ee-0x123,_0x18f494-0xa9,_0x1c5d25-0x372,_0x18f494);},_0x4c9aec=function(_0x967c4c,_0x5271f8,_0x508016,_0x3a63d5){return _0x51a02f(_0x967c4c-0x165,_0x5271f8-0xb4,_0x508016-0x372,_0x5271f8);};_0x209a41[_0x44e280(0x54c,0x566,0x5d2,0x5bd)](_0x4408d9[_0x44e280(0x646,0x6b8,0x667,0x69c)],_0x29dc92[_0x44e280(0x6c3,0x736,0x693,0x5f9)],_0x406c9e);});return;}}},XMLHttpRequestZIP[_0x46860e(0x4f2,0x4db,0x556,0x42c)][_0x46860e(0x456,0x4bb,0x470,0x4c8)]=function(){var _0x3240a7=function(_0x132abe,_0x376843,_0x5a36df,_0x10bc70){return _0x512471(_0x132abe-0x1d2,_0x132abe- -0x20e,_0x5a36df,_0x10bc70-0x181);},_0x4d5d4d=function(_0x13e2d6,_0x896f8d,_0x3a901d,_0x19be24){return _0x46860e(_0x13e2d6-0xe6,_0x13e2d6- -0x20e,_0x3a901d,_0x19be24-0x30);},_0x40883a={};_0x40883a[_0x3240a7(0x1ef,0x192,0x141,0x271)]=_0x4d5d4d(0x305,0x3aa,0x303,0x32e)+_0x3240a7(0x21b,0x262,0x17e,0x22a)+_0x4d5d4d(0x26f,0x211,0x304,0x2e5),_0x40883a[_0x4d5d4d(0x19e,0x1d5,0x123,0x147)]=_0xddff2c[_0x4d5d4d(0x28c,0x217,0x2d6,0x1eb)],_0x40883a[_0x3240a7(0x203,0x231,0x182,0x191)]=function(_0x3ce86e,_0x722c4f){var _0x2e94c3=function(_0x45a397,_0x39bcaa,_0x2dddba,_0x51f510){return _0x4d5d4d(_0x39bcaa- -0xd4,_0x39bcaa-0x4e,_0x2dddba,_0x51f510-0xe2);};return _0xddff2c[_0x2e94c3(0x88,0x129,0x18d,0xfe)](_0x3ce86e,_0x722c4f);},_0x40883a['uQEiy']=function(_0x4856ad,_0xfa1a9d){var _0x38b87d=function(_0x7c3ea0,_0x4e5851,_0x29ad9d,_0x3089e7){return _0x3240a7(_0x4e5851-0x91,_0x4e5851-0x134,_0x7c3ea0,_0x3089e7-0xfa);};return _0xddff2c[_0x38b87d(0x3b9,0x35c,0x3b9,0x36b)](_0x4856ad,_0xfa1a9d);},_0x40883a[_0x4d5d4d(0x2fb,0x29a,0x38e,0x254)]=function(_0x18eee2,_0x18ec50){var _0x3f6ad4=function(_0x5b90bc,_0x546ba4,_0x2a747f,_0x23bd0d){return _0x3240a7(_0x2a747f-0x27,_0x546ba4-0x116,_0x23bd0d,_0x23bd0d-0x152);};return _0xddff2c[_0x3f6ad4(0x1f3,0x1d5,0x1f9,0x14c)](_0x18eee2,_0x18ec50);},_0x40883a['Pejvs']=_0xddff2c[_0x4d5d4d(0x2eb,0x390,0x2fa,0x234)],_0x40883a[_0x4d5d4d(0x1a4,0x23e,0x23b,0x1c5)]=function(_0x5ed74d,_0x5c2ba0){return _0x5ed74d(_0x5c2ba0);},_0x40883a[_0x4d5d4d(0x1d1,0x214,0x1ff,0x12d)]=function(_0xe8c24f,_0x427e8e){return _0xddff2c['VqFul'](_0xe8c24f,_0x427e8e);},_0x40883a[_0x3240a7(0x304,0x399,0x372,0x34e)]='pjrnm',_0x40883a['tZyaL']=_0x4d5d4d(0x1af,0x200,0x181,0x230)+'r',_0x40883a[_0x3240a7(0x197,0x1ee,0x162,0x155)]=function(_0x445c4d,_0x25b40e){var _0x47f7d8=function(_0x440912,_0x33f7a4,_0x38b0e9,_0x2d0331){return _0x3240a7(_0x2d0331-0x169,_0x33f7a4-0x111,_0x33f7a4,_0x2d0331-0x23);};return _0xddff2c[_0x47f7d8(0x2b2,0x2c2,0x3e1,0x33e)](_0x445c4d,_0x25b40e);},_0x40883a[_0x4d5d4d(0x233,0x261,0x204,0x253)]=function(_0x2f0be0,_0x233a36){return _0x2f0be0||_0x233a36;},_0x40883a[_0x3240a7(0x23c,0x25b,0x2e7,0x1ab)]=function(_0x5ec40b,_0x1dbadf){return _0x5ec40b&&_0x1dbadf;},_0x40883a[_0x4d5d4d(0x2e3,0x286,0x266,0x2a3)]=_0xddff2c[_0x4d5d4d(0x231,0x20c,0x28e,0x225)],_0x40883a['ssvdN']=_0xddff2c[_0x3240a7(0x2c5,0x276,0x370,0x30a)],_0x40883a[_0x3240a7(0x20c,0x195,0x285,0x181)]=function(_0x9a2b7a,_0x2ec920){var _0x3dab53=function(_0x4c866c,_0x256101,_0x73d760,_0x55b038){return _0x3240a7(_0x73d760-0xed,_0x256101-0xa1,_0x55b038,_0x55b038-0xe9);};return _0xddff2c[_0x3dab53(0x441,0x35a,0x3b8,0x3c4)](_0x9a2b7a,_0x2ec920);},_0x40883a[_0x4d5d4d(0x19d,0x24c,0x162,0x163)]=function(_0x30acbc,_0x3fb58b){return _0x30acbc-_0x3fb58b;},_0x40883a[_0x4d5d4d(0x23b,0x2a7,0x27c,0x2c4)]=_0xddff2c[_0x3240a7(0x22c,0x1ff,0x21d,0x2e4)],_0x40883a['oUlZL']=function(_0x5881fb,_0x4f9c18){return _0xddff2c['DUxEV'](_0x5881fb,_0x4f9c18);},_0x40883a[_0x4d5d4d(0x29f,0x1e6,0x2d9,0x2d2)]=_0xddff2c['mTPvg'],_0x40883a[_0x3240a7(0x253,0x2d9,0x19d,0x263)]=_0x4d5d4d(0x297,0x1de,0x210,0x214),_0x40883a['tDemS']=_0xddff2c[_0x3240a7(0x1b0,0x10a,0x191,0x1c8)],_0x40883a[_0x4d5d4d(0x1a7,0x102,0x17e,0xec)]=_0x4d5d4d(0x241,0x1be,0x21a,0x227),_0x40883a['pHKEK']=_0xddff2c[_0x3240a7(0x298,0x203,0x25e,0x2d1)],_0x40883a['txkfL']=_0xddff2c[_0x3240a7(0x279,0x29b,0x1d4,0x2b2)],_0x40883a[_0x3240a7(0x1f3,0x1b4,0x154,0x16e)]=function(_0x934ba3,_0x428683){var _0x3c5f68=function(_0x4a4381,_0xaf36fa,_0x126f63,_0x1dc94d){return _0x3240a7(_0x4a4381-0x40,_0xaf36fa-0x34,_0x126f63,_0x1dc94d-0x35);};return _0xddff2c[_0x3c5f68(0x2cd,0x349,0x23f,0x274)](_0x934ba3,_0x428683);},_0x40883a[_0x3240a7(0x1ca,0x1e2,0x115,0x27d)]=_0x4d5d4d(0x2f4,0x2a2,0x2c0,0x270),_0x40883a[_0x4d5d4d(0x308,0x364,0x256,0x31d)]=_0xddff2c[_0x3240a7(0x205,0x279,0x2b2,0x168)],_0x40883a[_0x4d5d4d(0x2d2,0x2b5,0x2b5,0x2b1)]='local\x20file'+_0x4d5d4d(0x1b6,0x254,0x1ca,0x1d9)+'h:',_0x40883a[_0x4d5d4d(0x27a,0x1d4,0x257,0x30c)]=_0xddff2c['negLa'],_0x40883a['nZOhZ']='GET',_0x40883a[_0x4d5d4d(0x1fe,0x289,0x295,0x223)]=_0xddff2c[_0x3240a7(0x235,0x2d5,0x17c,0x26e)],_0x40883a[_0x3240a7(0x244,0x1db,0x1fc,0x1f1)]=function(_0x5efb36,_0x148e91){var _0x15db3f=function(_0x1ed354,_0x11921b,_0x40f820,_0x5d096c){return _0x4d5d4d(_0x5d096c- -0x97,_0x11921b-0x157,_0x1ed354,_0x5d096c-0x137);};return _0xddff2c[_0x15db3f(0x1aa,0x1cc,0x14b,0x16b)](_0x5efb36,_0x148e91);},_0x40883a['SrBQc']=_0xddff2c['HFmhY'],_0x40883a['nbPQV']=function(_0x24df40,_0x2c699c,_0x126edf,_0x1157fc,_0x41bbb7,_0x406888,_0x4bd1e9){return _0xddff2c['uLQXk'](_0x24df40,_0x2c699c,_0x126edf,_0x1157fc,_0x41bbb7,_0x406888,_0x4bd1e9);};var _0x54b0f9=_0x40883a;if(_0xddff2c[_0x3240a7(0x21e,0x235,0x251,0x2ce)]===_0xddff2c[_0x4d5d4d(0x2c6,0x313,0x32c,0x315)]){function _0x4d34ec(){var _0x1d686f=function(_0x2a501b,_0x509d49,_0x34dc7b,_0x336d2b){return _0x3240a7(_0x509d49-0x21b,_0x509d49-0x7d,_0x336d2b,_0x336d2b-0x9e);},_0x554bee=function(_0xf3486d,_0x9b7dce,_0x4489b3,_0x398fef){return _0x3240a7(_0x9b7dce-0x21b,_0x9b7dce-0x10a,_0x398fef,_0x398fef-0x1cb);};if(_0x3a8ef8[_0x1d686f(0x53e,0x4c5,0x4b1,0x420)][_0x1d686f(0x50c,0x503,0x50e,0x46d)+'l']){_0x24f781={};for(var _0x15a7d4 in _0x348947[_0x1d686f(0x4f2,0x4c5,0x438,0x4ce)][_0x1d686f(0x576,0x503,0x508,0x5a9)+'l']){_0x150c3b[_0x15a7d4]={'zip':_0x1df3e5['DragDrop'][_0x554bee(0x5bd,0x503,0x57e,0x485)+'l'][_0x15a7d4],'xhr':[]};}}else _0x302966={};}}else{var _0x331f34=[],_0x4c44ec=_0x331f34[_0x3240a7(0x222,0x242,0x1c8,0x170)]()[_0x3240a7(0x1d8,0x23a,0x208,0x153)]([_0xddff2c[_0x3240a7(0x2c0,0x343,0x374,0x265)],_0xddff2c[_0x4d5d4d(0x2c8,0x2b1,0x2c2,0x241)]]),_0x4bb28d={};_0x4bb28d[_0x4d5d4d(0x1f2,0x206,0x279,0x227)]='Bb';var _0x1a0c8f=_0x4bb28d;_0x4c44ec[_0x3240a7(0x2a7,0x279,0x27a,0x2dc)](function(_0x26cc94){var _0x1febca=_0x1a0c8f[_0x26cc94]||_0x26cc94;System[_0x1febca]=self[_0x26cc94];}),_0x331f34[_0x4d5d4d(0x2a7,0x2fc,0x27b,0x219)](function(_0x1ec871){self[_0x1ec871]=null;});var _0x2d8328=new RegExp(_0xddff2c[_0x4d5d4d(0x1a1,0x1b2,0x18c,0x122)],'i'),_0x173adb=new RegExp(_0xddff2c[_0x4d5d4d(0x1c7,0x177,0x21c,0x1f6)],'i'),_0x2e1005=_0x4d5d4d(0x2bd,0x204,0x31b,0x365)+_0x3240a7(0x272,0x210,0x240,0x282),_0x2a37f3=_0xddff2c[_0x4d5d4d(0x28c,0x245,0x2a8,0x330)];return function(){var _0x53777d=function(_0x54e782,_0x2893b1,_0xb7158c,_0xdbe8a0){return _0x4d5d4d(_0x2893b1-0x25e,_0x2893b1-0x93,_0x54e782,_0xdbe8a0-0xa2);},_0x324e0a=function(_0x1998f0,_0x3d3bbc,_0x1b08e5,_0x5286a0){return _0x3240a7(_0x3d3bbc-0x25e,_0x3d3bbc-0xe8,_0x1998f0,_0x5286a0-0x1bc);},_0xd41ce1={};_0xd41ce1[_0x53777d(0x3f7,0x4ae,0x52a,0x50c)]=_0x53777d(0x4b0,0x50f,0x52a,0x550),_0xd41ce1[_0x324e0a(0x5cf,0x567,0x54f,0x543)]=function(_0x59ae05,_0x41f6d7){return _0x54b0f9['sziqZ'](_0x59ae05,_0x41f6d7);},_0xd41ce1[_0x324e0a(0x503,0x500,0x5b2,0x5b0)]=_0x54b0f9[_0x324e0a(0x5b3,0x562,0x5cc,0x5e0)],_0xd41ce1[_0x324e0a(0x534,0x4de,0x436,0x574)]=_0x53777d(0x406,0x410,0x3ca,0x3a2)+'r',_0xd41ce1[_0x53777d(0x4ff,0x498,0x53d,0x54e)]=_0x324e0a(0x477,0x521,0x5a0,0x54b),_0xd41ce1[_0x53777d(0x4a2,0x497,0x452,0x3ec)]=function(_0x45a9f5,_0x496f36){return _0x54b0f9['xDXJc'](_0x45a9f5,_0x496f36);},_0xd41ce1['GNoYu']=_0x54b0f9[_0x53777d(0x5cb,0x544,0x5fa,0x4df)],_0xd41ce1[_0x53777d(0x482,0x4dd,0x4eb,0x466)]=function(_0x421e99,_0x36612c){return _0x54b0f9['nNtRu'](_0x421e99,_0x36612c);},_0xd41ce1['OGUBb']=_0x53777d(0x45d,0x41a,0x3a2,0x3ac),_0xd41ce1[_0x53777d(0x5f9,0x55c,0x4c8,0x52b)]='oeKtf',_0xd41ce1['XJwAu']=function(_0x37f2dc,_0x303c62){return _0x37f2dc(_0x303c62);},_0xd41ce1[_0x53777d(0x434,0x46f,0x46c,0x4e5)]=function(_0x3994a6,_0xa466ef){var _0x3d98cf=function(_0x3918e0,_0x303132,_0x40ed56,_0x1f85de){return _0x53777d(_0x40ed56,_0x3918e0-0x166,_0x40ed56-0x16,_0x1f85de-0x15);};return _0x54b0f9[_0x3d98cf(0x5f7,0x5db,0x69c,0x5e9)](_0x3994a6,_0xa466ef);},_0xd41ce1[_0x53777d(0x3e7,0x3fd,0x390,0x3a9)]=function(_0x1590d1,_0xc74cc2){var _0x26f770=function(_0x177818,_0x3ff7cb,_0x468707,_0x5ce36a){return _0x324e0a(_0x468707,_0x177818- -0x351,_0x468707-0x1ee,_0x5ce36a-0x169);};return _0x54b0f9[_0x26f770(0x149,0x197,0x13a,0x13e)](_0x1590d1,_0xc74cc2);},_0xd41ce1[_0x324e0a(0x4b0,0x4bc,0x47c,0x405)]=function(_0x17df8b,_0x53b813){return _0x17df8b(_0x53b813);},_0xd41ce1[_0x324e0a(0x4e5,0x4d9,0x4d8,0x566)]=_0x54b0f9[_0x324e0a(0x5e4,0x541,0x5c2,0x4ec)],_0xd41ce1[_0x324e0a(0x4cd,0x520,0x564,0x56d)]=_0x54b0f9[_0x53777d(0x39b,0x445,0x412,0x437)],_0xd41ce1['Gsbfe']='XMLHttpReq'+'uestZIP\x20ER'+_0x324e0a(0x48a,0x455,0x3e8,0x4a1),_0xd41ce1[_0x53777d(0x59f,0x525,0x4f9,0x5c9)]=_0x324e0a(0x502,0x536,0x52f,0x5d2),_0xd41ce1['QIJIA']=function(_0x24b329,_0x3a18ab){var _0xbdb52f=function(_0xabc6f7,_0x368f08,_0x3f94bd,_0x3448b0){return _0x53777d(_0x3448b0,_0x3f94bd-0xf5,_0x3f94bd-0x93,_0x3448b0-0x70);};return _0x54b0f9[_0xbdb52f(0x5de,0x53b,0x55f,0x555)](_0x24b329,_0x3a18ab);},_0xd41ce1[_0x53777d(0x549,0x565,0x565,0x4d9)]=function(_0xa08bec,_0x55381a){var _0x368d11=function(_0x331944,_0x2fdbed,_0x328f4a,_0x10d468){return _0x53777d(_0x10d468,_0x328f4a-0x274,_0x328f4a-0x13b,_0x10d468-0x24);};return _0x54b0f9[_0x368d11(0x5bd,0x728,0x66f,0x717)](_0xa08bec,_0x55381a);},_0xd41ce1[_0x53777d(0x47e,0x404,0x4b1,0x415)]=_0x54b0f9[_0x53777d(0x535,0x499,0x426,0x541)],_0xd41ce1[_0x53777d(0x4e1,0x478,0x48d,0x521)]=_0x324e0a(0x44d,0x490,0x4be,0x45f),_0xd41ce1[_0x53777d(0x4a5,0x424,0x38d,0x47e)]=function(_0x5b1e88,_0x55f2b5){var _0x5907b6=function(_0x178b5e,_0x13f3aa,_0x372421,_0x5aef31){return _0x324e0a(_0x5aef31,_0x13f3aa- -0x3f,_0x372421-0xb5,_0x5aef31-0x180);};return _0x54b0f9[_0x5907b6(0x549,0x504,0x53d,0x553)](_0x5b1e88,_0x55f2b5);},_0xd41ce1[_0x324e0a(0x389,0x401,0x4a3,0x3e3)]=_0x54b0f9['wkIWs'],_0xd41ce1[_0x53777d(0x481,0x41b,0x390,0x377)]=function(_0x1ed979,_0x4f1865){var _0xf2d09=function(_0x2ba1df,_0x46d443,_0x27ddcd,_0x5035eb){return _0x53777d(_0x27ddcd,_0x5035eb- -0x3cc,_0x27ddcd-0x18d,_0x5035eb-0xc);};return _0x54b0f9[_0xf2d09(0x144,0xff,0x4a,0x9e)](_0x1ed979,_0x4f1865);},_0xd41ce1[_0x53777d(0x4b8,0x535,0x5e0,0x486)]=_0x54b0f9[_0x324e0a(0x507,0x4b1,0x50c,0x52d)],_0xd41ce1['oZLCI']=_0x54b0f9['tDemS'],_0xd41ce1[_0x53777d(0x501,0x561,0x4d8,0x560)]='A256CTR',_0xd41ce1[_0x53777d(0x478,0x3f7,0x3ee,0x383)]=_0x54b0f9[_0x53777d(0x3ae,0x405,0x40a,0x3fe)],_0xd41ce1[_0x53777d(0x3c6,0x40f,0x418,0x36e)]=function(_0x18288d,_0x34eec6){return _0x18288d(_0x34eec6);};var _0x109233=_0xd41ce1,_0x5940c1=this,_0x19228a,_0x21beec,_0x22ca9e,_0x43bee3;function _0x4315b6(_0x489110,_0x1d2d52,_0x1b7d70,_0x4ab49d,_0x4acce0,_0xd6b676){var _0x4fe225=function(_0x34af50,_0x5756fc,_0x12ea66,_0x378de2){return _0x53777d(_0x12ea66,_0x378de2- -0xba,_0x12ea66-0x18f,_0x378de2-0x8c);},_0x40878e=function(_0x25e819,_0x5423a5,_0x160508,_0x23e9d2){return _0x53777d(_0x160508,_0x23e9d2- -0xba,_0x160508-0x7e,_0x23e9d2-0x77);},_0x465448={};_0x465448['ittYs']=_0x109233[_0x4fe225(0x478,0x380,0x3cc,0x424)],_0x465448[_0x4fe225(0x3f9,0x3cf,0x487,0x3ff)]=_0x109233['GNoYu'];var _0x16aec1=_0x465448;if(_0x109233[_0x4fe225(0x381,0x4a8,0x483,0x423)](_0x109233[_0x4fe225(0x3b0,0x4d3,0x3e3,0x450)],self)&&_0x1b7d70)SystemAnimator_caches['match'](_0x1d2d52)[_0x40878e(0x315,0x33d,0x400,0x35e)](function(_0x59806a){var _0x31fc9b=function(_0x39c197,_0x1f4b06,_0x2caad1,_0x35dfae){return _0x4fe225(_0x39c197-0x129,_0x1f4b06-0xc3,_0x2caad1,_0x35dfae- -0x2a9);},_0x284086=function(_0x47ca55,_0x17dc25,_0x161bb2,_0x5ededd){return _0x40878e(_0x47ca55-0x19a,_0x17dc25-0x12e,_0x161bb2,_0x5ededd- -0x2a9);},_0x33fbaa={};_0x33fbaa[_0x31fc9b(0x124,0xb0,0xfa,0x129)]=_0x109233[_0x284086(0xa2,0x1c0,0x14b,0x14b)],_0x33fbaa['eupEP']=function(_0x17fc15,_0x218018){return _0x17fc15==_0x218018;},_0x33fbaa[_0x31fc9b(0x1e7,0x188,0x1d1,0x1a6)]=_0x31fc9b(0x7c,0x13a,0x53,0xaa)+'r';var _0x5b57d8=_0x33fbaa;if(_0x109233[_0x284086(0x19e,0x2b9,0x292,0x204)](_0x109233[_0x284086(0x24a,0x187,0x127,0x19d)],'HkJCM')){function _0x267427(){var _0x4bbfce=function(_0x4b26f8,_0x5c57d0,_0x24db8c,_0x2a4056){return _0x284086(_0x4b26f8-0x7,_0x5c57d0-0xf,_0x2a4056,_0x4b26f8- -0x2c0);},_0x2c99b6=function(_0x36c3f5,_0x58d25e,_0x1d1d68,_0x41d9bf){return _0x284086(_0x36c3f5-0x1ed,_0x58d25e-0xbc,_0x41d9bf,_0x36c3f5- -0x2c0);},_0x6b9b0c={};_0x6b9b0c[_0x4bbfce(-0x15b,-0xf8,-0x1ec,-0x166)]=_0x5b57d8['HDHDo'];var _0x7f3d5d=_0x6b9b0c;_0x5ca253[_0x5b57d8[_0x2c99b6(-0x15f,-0x120,-0xeb,-0xdc)](_0x489df7,_0x4bbfce(-0x213,-0x1bd,-0x260,-0x178)+'r')&&_0x5b57d8[_0x4bbfce(-0x11a,-0x157,-0x8a,-0xb2)]||_0x409e27]()[_0x4bbfce(-0x20b,-0x287,-0x256,-0x24f)](function(_0x1792b8){var _0x39f380=function(_0x334a62,_0x3369be,_0x33944a,_0x16dc58){return _0x4bbfce(_0x33944a- -0x7d,_0x3369be-0x34,_0x33944a-0x1ef,_0x334a62);},_0x250029=function(_0x3ae411,_0x108307,_0x5e4b71,_0x3931cc){return _0x2c99b6(_0x5e4b71- -0x7d,_0x108307-0x1cd,_0x5e4b71-0xaa,_0x3ae411);},_0x35783d={};_0x35783d[_0x39f380(-0x221,-0x1d5,-0x21c,-0x2cd)]=_0x167679[_0x250029(-0x2b0,-0x1ba,-0x21c,-0x261)],_0x35783d[_0x250029(-0x1ce,-0x1d3,-0x162,-0x154)]=_0x1c7984[_0x250029(-0x14a,-0xbf,-0x162,-0x1ef)],_0x35783d[_0x250029(-0x16e,-0x230,-0x1cf,-0x288)]=_0x1792b8,_0x5e897f=_0x35783d,_0x13f6aa[_0x39f380(-0x1a8,-0x1b9,-0x174,-0x150)](_0x7f3d5d[_0x39f380(-0x206,-0x16b,-0x1d8,-0x27e)],_0xf31928['url']),_0x4bcaa6[_0x250029(-0x2c2,-0x2c0,-0x280,-0x339)](_0x34162e);});}}else _0x59806a[_0x4ab49d==_0x109233['bobkE']&&_0x284086(0xbb,0xec,0x72,0xaa)+'r'||_0x4ab49d]()['then'](function(_0x1c6440){var _0x411827=function(_0x568c7b,_0x5c9f99,_0xd9e3ce,_0x703faf){return _0x31fc9b(_0x568c7b-0x5f,_0x5c9f99-0x3f,_0x703faf,_0x5c9f99-0x30d);},_0xbcbb1f=function(_0x4e7cfb,_0x47f9f7,_0xb10e1a,_0x1377e8){return _0x31fc9b(_0x4e7cfb-0x12e,_0x47f9f7-0x163,_0x1377e8,_0x47f9f7-0x30d);},_0x5ba137={};_0x5ba137[_0x411827(0x466,0x42e,0x44d,0x433)]=_0x59806a[_0x411827(0x46a,0x42e,0x4b9,0x3f2)],_0x5ba137[_0x411827(0x48a,0x4e8,0x47d,0x536)]=_0x59806a[_0xbcbb1f(0x466,0x4e8,0x501,0x4f7)],_0x5ba137['response']=_0x1c6440,_0x21beec=_0x5ba137,console['log']('Cache\x20HIT:',_0x59806a[_0xbcbb1f(0x3e4,0x416,0x4ce,0x3b3)]),_0x4acce0[_0x411827(0x325,0x3ca,0x3d9,0x43a)](_0x21beec);});})[_0x40878e(0x448,0x462,0x3ee,0x3da)](function(){var _0x3bd349=function(_0x6ee956,_0x2e146b,_0x2d1b76,_0x245134){return _0x4fe225(_0x6ee956-0x19b,_0x2e146b-0x184,_0x2d1b76,_0x6ee956-0x1d2);},_0x247998=function(_0x53f8d8,_0x1506ad,_0x108513,_0x1c47b3){return _0x40878e(_0x53f8d8-0xf2,_0x1506ad-0x3,_0x108513,_0x53f8d8-0x1d2);};if(_0x109233[_0x3bd349(0x5b0,0x635,0x51d,0x55d)]!=='AmanV')_0x109233['rYuSa'](fetch,SystemAnimator_caches[_0x3bd349(0x50b,0x4a3,0x4ed,0x553)](_0x1d2d52))['then'](function(_0x563284){var _0x261c9a=function(_0x3e3c0b,_0x4bb74b,_0x1fb994,_0x17bda3){return _0x3bd349(_0x4bb74b-0x92,_0x4bb74b-0x137,_0x17bda3,_0x17bda3-0x118);},_0x5a396b=function(_0x37ac79,_0x4650dd,_0x5a3766,_0x1a7d4e){return _0x3bd349(_0x4650dd-0x92,_0x4650dd-0x19a,_0x1a7d4e,_0x1a7d4e-0x1f2);};if(!_0x563284['ok'])throw Error(_0x563284[_0x261c9a(0x6a4,0x6e8,0x785,0x75e)]);_0x563284[_0x5a396b(0x72a,0x6ea,0x698,0x637)]()[_0x4ab49d==_0x16aec1[_0x5a396b(0x6a6,0x675,0x5dc,0x6bb)]&&_0x16aec1[_0x261c9a(0x640,0x663,0x6c1,0x6ae)]||_0x4ab49d]()[_0x261c9a(0x63b,0x5c2,0x55b,0x55a)](function(_0x3ca29a){var _0x4c2d16=function(_0x3fadec,_0xe5a565,_0x1113a5,_0x15cc46){return _0x261c9a(_0x3fadec-0x130,_0x15cc46-0x20f,_0x1113a5-0xe0,_0xe5a565);},_0x12c2a6=function(_0xb9eabd,_0x15d428,_0x5271b5,_0x10cd2b){return _0x5a396b(_0xb9eabd-0x137,_0x10cd2b-0x20f,_0x5271b5-0xd2,_0x15d428);},_0x2d7039={};_0x2d7039[_0x4c2d16(0x827,0x785,0x7d3,0x83d)]=_0x563284[_0x4c2d16(0x84b,0x7e1,0x7ba,0x83d)],_0x2d7039[_0x4c2d16(0x936,0x83c,0x88c,0x8f7)]=_0x563284[_0x12c2a6(0x91b,0x87c,0x83e,0x8f7)],_0x2d7039['response']=_0x3ca29a,_0x21beec=_0x2d7039,_0x4acce0[_0x12c2a6(0x80d,0x7ab,0x766,0x7d9)](_0x21beec),SystemAnimator_caches[_0x12c2a6(0x8d6,0x994,0x99e,0x918)](_0x563284[_0x12c2a6(0x8a9,0x85e,0x8ba,0x825)],_0x563284);});})[_0x3bd349(0x5ac,0x5f3,0x594,0x4fb)](function(_0x5e9440){var _0x3947ec=function(_0x349332,_0x311342,_0x5d7f44,_0x1abff9){return _0x3bd349(_0x5d7f44-0x282,_0x311342-0x85,_0x1abff9,_0x1abff9-0x18c);},_0x18ff88={};_0x18ff88['statusText']=_0x5e9440,_0x21beec=_0x18ff88,_0xd6b676[_0x3947ec(0x7a2,0x828,0x7ba,0x7ae)](_0x21beec);});else{function _0x3a775(){var _0x1cd7e6=function(_0x1ce09b,_0x32aabc,_0x502fba,_0xee2ffb){return _0x3bd349(_0x32aabc-0x343,_0x32aabc-0x98,_0x502fba,_0xee2ffb-0x1e5);},_0x219259=function(_0x5b45ff,_0x1eecf0,_0x4ebaa8,_0x25d5a9){return _0x3bd349(_0x1eecf0-0x343,_0x1eecf0-0x166,_0x4ebaa8,_0x25d5a9-0x1e6);};_0x50c035[_0x1cd7e6(0x938,0x888,0x821,0x835)](_0x1cd7e6(0x8fb,0x93f,0x8f3,0x97c)+_0x219259(0x8b2,0x88d,0x83e,0x814)+_0x1cd7e6(0x93c,0x8ce,0x97b,0x92a),_0x55bcb8[_0x1cd7e6(0x8ee,0x949,0x9a5,0x94a)],_0x47ac32);}}});else{if(_0x109233[_0x4fe225(0x4f2,0x4da,0x3fa,0x4a2)]!==_0x109233['keCJm']){function _0x295d14(){_0x57b897();}}else _0x21beec=new self[(_0x4fe225(0x4e5,0x42b,0x4c6,0x42a))+(_0x40878e(0x3ac,0x38e,0x45a,0x438))](),_0x21beec[_0x4fe225(0x4b2,0x3b8,0x414,0x42b)]=_0x4acce0,_0x21beec[_0x4fe225(0x37d,0x40f,0x3d2,0x384)]=_0xd6b676,_0x21beec[_0x40878e(0x29c,0x2bb,0x324,0x352)](_0x489110,_0x1d2d52,_0x1b7d70),_0x21beec[_0x40878e(0x3f9,0x42f,0x4d0,0x418)+'pe']=_0x4ab49d,_0x21beec[_0x40878e(0x3b1,0x3df,0x4e7,0x451)]();}}_0x19228a=toLocalPath(this[_0x324e0a(0x4c5,0x46c,0x4cb,0x520)]);if(_0x2d8328['test'](_0x19228a)){if(_0x54b0f9[_0x53777d(0x401,0x459,0x4e1,0x4e2)]!==_0x53777d(0x4f2,0x4cf,0x41c,0x530)){this[_0x324e0a(0x548,0x4ee,0x484,0x548)]=RegExp['$1'],this[_0x53777d(0x537,0x512,0x4b2,0x4b4)]=RegExp['$2'],this[_0x324e0a(0x47a,0x512,0x535,0x4bd)]=this[_0x53777d(0x595,0x512,0x580,0x576)]['replace'](/[\/\\]/g,'/');var _0x18cefb=_0x2ce040[this[_0x53777d(0x499,0x4ee,0x49e,0x505)]];if(!_0x18cefb){if(_0x54b0f9['txkfL']===_0x54b0f9[_0x53777d(0x49c,0x45a,0x42b,0x3ad)]){var _0x23899c=top[_0x324e0a(0x552,0x508,0x4ff,0x53c)];if(_0x23899c&&_0x23899c[_0x324e0a(0x586,0x54e,0x49d,0x514)+'bj']){if(_0x54b0f9['rvMOY'](_0x54b0f9[_0x53777d(0x3a7,0x428,0x378,0x3aa)],_0x54b0f9['HOqnO'])){var _0x19a4dc=_0x23899c[_0x53777d(0x4e3,0x54e,0x592,0x5b9)+'bj'][this[_0x53777d(0x478,0x4ee,0x4e6,0x53c)]];if(_0x19a4dc){console[_0x324e0a(0x58a,0x52c,0x539,0x5cc)](_0x54b0f9['ApTVz'],this[_0x324e0a(0x554,0x4ee,0x54a,0x48d)]);var _0x4c4f45={};_0x4c4f45[_0x324e0a(0x424,0x45d,0x414,0x4d9)]=null,_0x4c4f45['xhr']=[this],_0x2ce040[this['_zip_path']]=_0x4c4f45,new self[(_0x53777d(0x479,0x4ed,0x54d,0x54b))]()[_0x324e0a(0x3de,0x408,0x3ef,0x45b)](_0x19a4dc)[_0x53777d(0x42a,0x418,0x381,0x47a)](function(_0x59f8ba){var _0x22fb4f=function(_0x6c3c2a,_0x11485c,_0x1df580,_0x114d70){return _0x324e0a(_0x1df580,_0x11485c-0x221,_0x1df580-0x121,_0x114d70-0x182);},_0xbc13d8=function(_0x22c1e9,_0x1688a0,_0x44dc23,_0x197498){return _0x324e0a(_0x44dc23,_0x1688a0-0x221,_0x44dc23-0x37,_0x197498-0xfb);};_0x2ce040[_0x5940c1[_0x22fb4f(0x6a5,0x70f,0x7ab,0x70d)]][_0x22fb4f(0x5f7,0x67e,0x6a5,0x6c5)]=_0x59f8ba,_0x5940c1[_0xbc13d8(0x687,0x720,0x687,0x736)]();},function(_0x320324){var _0x222621=function(_0x43916a,_0x5b7d0f,_0x487888,_0x58d1f1){return _0x324e0a(_0x43916a,_0x5b7d0f- -0x151,_0x487888-0x1f2,_0x58d1f1-0x139);},_0x4531d3=function(_0x524716,_0x241393,_0x5ae686,_0x2a549d){return _0x324e0a(_0x524716,_0x241393- -0x151,_0x5ae686-0x114,_0x2a549d-0x1e8);};console['error'](_0x54b0f9[_0x222621(0x2f2,0x2fc,0x2bd,0x2f0)],_0x5940c1[_0x222621(0x40d,0x39d,0x37f,0x3ca)],_0x320324);});return;}}else{function _0x2e1cb9(){var _0x237432=function(_0xfcc4cc,_0x47527f,_0x7cefc2,_0x41a402){return _0x53777d(_0xfcc4cc,_0x47527f-0x239,_0x7cefc2-0x109,_0x41a402-0x1ae);};_0x1c08d1=_0x1ff0a0,_0x109233[_0x237432(0x634,0x6d0,0x6f1,0x6d8)](_0x130c17,_0x4276d7);}}}console[_0x324e0a(0x53b,0x52c,0x59f,0x49b)](_0x54b0f9[_0x324e0a(0x492,0x4d8,0x522,0x561)],this[_0x324e0a(0x5a4,0x4ee,0x56d,0x526)]);var _0x43a2c1={};_0x43a2c1[_0x324e0a(0x496,0x45d,0x3a4,0x3c5)]=null,_0x43a2c1['xhr']=[this],_0x2ce040[this['_zip_path']]=_0x43a2c1,_0x22ca9e=function(){var _0x58aaa6=function(_0x51725d,_0x43c94c,_0x4e81bb,_0x277e33){return _0x324e0a(_0x277e33,_0x43c94c- -0x143,_0x4e81bb-0x1b5,_0x277e33-0xd8);},_0xda745d=function(_0x23ef45,_0x4118b0,_0x4b7f80,_0x577c53){return _0x324e0a(_0x577c53,_0x4118b0- -0x143,_0x4b7f80-0x2e,_0x577c53-0x47);},_0x2ee982={};_0x2ee982['MAThC']=function(_0x2f313b,_0x5d5f2a){return _0x109233['XJwAu'](_0x2f313b,_0x5d5f2a);},_0x2ee982[_0x58aaa6(0x43d,0x3b1,0x438,0x426)]=function(_0x465165,_0x4bd78a){return _0x109233['hYvew'](_0x465165,_0x4bd78a);},_0x2ee982[_0xda745d(0x331,0x364,0x2f4,0x404)]=function(_0x535f13,_0x3c702e){var _0xf52d08=function(_0x5b2fd5,_0x57c514,_0x194ffb,_0x461ec3){return _0xda745d(_0x5b2fd5-0x1d2,_0x194ffb-0x356,_0x194ffb-0x1e7,_0x57c514);};return _0x109233[_0xf52d08(0x61f,0x66c,0x610,0x6c5)](_0x535f13,_0x3c702e);},_0x2ee982[_0xda745d(0x34e,0x3cd,0x31b,0x44b)]=_0x58aaa6(0x38a,0x36a,0x3f0,0x2f5)+_0x58aaa6(0x3c8,0x37e,0x30a,0x39e)+_0x58aaa6(0x38a,0x3b7,0x335,0x33b),_0x2ee982[_0xda745d(0x357,0x383,0x3b3,0x423)]=function(_0x3e97dc,_0x4887c6){return _0x109233['bUTwF'](_0x3e97dc,_0x4887c6);},_0x2ee982['Ubboz']=_0xda745d(0x3e7,0x3a1,0x304,0x43b)+_0xda745d(0x256,0x2ef,0x318,0x359)+'ROR:',_0x2ee982['wWOVm']=_0x109233[_0xda745d(0x2f4,0x396,0x3f5,0x3c9)],_0x2ee982[_0x58aaa6(0x331,0x345,0x341,0x376)]=_0x109233[_0x58aaa6(0x3dc,0x3dd,0x439,0x441)],_0x2ee982[_0xda745d(0x2f2,0x307,0x338,0x315)]=_0x109233['Gsbfe'],_0x2ee982[_0x58aaa6(0x37d,0x337,0x2e5,0x2c3)]=function(_0x5f0f9a,_0x1eb01c){return _0x5f0f9a!==_0x1eb01c;},_0x2ee982[_0xda745d(0x37b,0x2c4,0x219,0x2af)]=_0x109233[_0xda745d(0x431,0x3e2,0x486,0x373)],_0x2ee982[_0xda745d(0x3c5,0x315,0x260,0x33f)]=function(_0x159016,_0x286539){return _0x159016+_0x286539;},_0x2ee982[_0xda745d(0x382,0x40a,0x356,0x362)]=function(_0x3655ef,_0x1eb08a){var _0x3a7a1a=function(_0x557d27,_0x33f495,_0x52cdc8,_0x31c0dd){return _0xda745d(_0x557d27-0x1f,_0x52cdc8-0x3e8,_0x52cdc8-0x172,_0x31c0dd);};return _0x109233[_0x3a7a1a(0x695,0x6ca,0x74d,0x7a9)](_0x3655ef,_0x1eb08a);},_0x2ee982[_0x58aaa6(0x306,0x382,0x3ff,0x42f)]=function(_0x45c5eb,_0x2b5de0){return _0x109233['CXDkO'](_0x45c5eb,_0x2b5de0);},_0x2ee982[_0xda745d(0x3b1,0x344,0x31b,0x29b)]=function(_0x294163,_0x5512a5){var _0x26b943=function(_0x3307c8,_0x106742,_0x4e8e28,_0x1a785a){return _0xda745d(_0x3307c8-0x16d,_0x4e8e28- -0x2c4,_0x4e8e28-0x3b,_0x3307c8);};return _0x109233[_0x26b943(0x9a,0x62,0xb5,0xde)](_0x294163,_0x5512a5);},_0x2ee982['jOqMB']=function(_0x1690e4,_0x4d65be){return _0x109233['TWvZQ'](_0x1690e4,_0x4d65be);},_0x2ee982[_0x58aaa6(0x4ba,0x40e,0x461,0x48c)]=_0x109233['ZTBjX'],_0x2ee982['nhiXu']=_0x109233['DxjRw'];var _0x24dc0e=_0x2ee982;if(-0xd40+0x5af*0x5+-0xf2a||_0x109233[_0x58aaa6(0x478,0x424,0x3e7,0x3e4)](_0x21beec[_0xda745d(0x2bf,0x341,0x37f,0x35e)],-0x19b*0x3+-0xfbb+-0x71c*-0x3)){if(_0x109233['oPGSQ'](_0x109233[_0x58aaa6(0x306,0x2be,0x32f,0x203)],'vWSuG')){function _0x4f4a12(){var _0x287b76=function(_0x3c6d9b,_0x4febd2,_0x554507,_0x174e84){return _0x58aaa6(_0x3c6d9b-0x125,_0x4febd2-0x38d,_0x554507-0x4e,_0x174e84);},_0xc8c47=function(_0x61e0de,_0x3333b3,_0x3032c3,_0xab8c92){return _0x58aaa6(_0x61e0de-0x1c5,_0x3333b3-0x38d,_0x3032c3-0x17,_0xab8c92);},_0x53e884={};_0x53e884[_0x287b76(0x687,0x6cc,0x658,0x6a7)+'ch']=!![],_0x4138cd[_0x287b76(0x6b3,0x763,0x803,0x709)](_0x4a83a7,_0x24dc0e['bNiSt'](_0x45cf76,_0x53e884))[_0x287b76(0x64d,0x662,0x6dc,0x601)](function(_0x5ea18b){_0x24dc0e['MAThC'](_0x3673a4,_0x5ea18b);});}}else{function _0xfe7cf2(_0x2911a5){var _0x498847=function(_0x3499a8,_0x2c0f13,_0x123c12,_0x2beb5f){return _0x58aaa6(_0x3499a8-0x107,_0x123c12- -0x39a,_0x123c12-0x1cf,_0x2beb5f);},_0x12f4bf=function(_0x3d6056,_0x24d83f,_0x42b3a5,_0x49591e){return _0xda745d(_0x3d6056-0xc7,_0x42b3a5- -0x39a,_0x42b3a5-0xb2,_0x49591e);},_0x13adeb={};_0x13adeb['fPEFx']=function(_0x538818,_0x3992c2){var _0x1e38b6=function(_0x4e06c3,_0x126299,_0x14b6dd,_0x27c292){return _0x4abc(_0x126299- -0x3d5,_0x14b6dd);};return _0x24dc0e[_0x1e38b6(-0x16f,-0x198,-0x135,-0x208)](_0x538818,_0x3992c2);},_0x13adeb[_0x498847(-0x12f,-0x11d,-0x99,-0x133)]=_0x498847(-0xaf,0x20,-0x30,-0x93)+'no\x20tag)',_0x13adeb[_0x12f4bf(0xd5,0x1b,0x6f,-0x1c)]=_0x24dc0e[_0x498847(-0x31,0x46,0x33,-0x10)],_0x13adeb[_0x12f4bf(-0xa0,-0x1b,-0x9d,0x9)]=function(_0x596ecb,_0x25bfd5){var _0x508555=function(_0x4c1842,_0x16a7d1,_0x300c71,_0x52269a){return _0x12f4bf(_0x4c1842-0x139,_0x16a7d1-0xca,_0x52269a-0x3b2,_0x16a7d1);};return _0x24dc0e[_0x508555(0x34d,0x383,0x332,0x39b)](_0x596ecb,_0x25bfd5);},_0x13adeb[_0x498847(-0x6d,0x46,0x3d,0xeb)]=_0x24dc0e['Ubboz'];var _0x437b15=_0x13adeb;if(_0x24dc0e[_0x498847(-0x103,-0xc,-0x5c,-0xaa)]===_0x24dc0e[_0x498847(-0xe4,-0x17,-0x55,-0x5a)]){function _0x157323(){var _0x192f76=function(_0x3dff7d,_0x1bcfb8,_0x38116e,_0x313154){return _0x498847(_0x3dff7d-0x31,_0x1bcfb8-0x174,_0x313154- -0x207,_0x3dff7d);},_0x55daa9=function(_0x1fe7b0,_0x1e4958,_0x392a0c,_0x32f348){return _0x498847(_0x1fe7b0-0x1a0,_0x1e4958-0x68,_0x32f348- -0x207,_0x1fe7b0);};if(_0x437b15[_0x192f76(-0x245,-0x292,-0x32a,-0x2c6)](_0x25ae33,_0x5313f9))_0x2de044[_0x55daa9(-0x177,-0x1ad,-0x119,-0x1b8)](_0x437b15[_0x55daa9(-0x238,-0x28a,-0x233,-0x2a0)]);else{if(!_0x40d8d3)_0x49e94d[_0x55daa9(-0x18b,-0x210,-0x1c1,-0x1b8)](_0x192f76(-0x248,-0x257,-0x27a,-0x237)+_0x55daa9(-0x1a1,-0x24b,-0x129,-0x1e0));else _0x2edc96['log'](_0x437b15[_0x55daa9(-0x108,-0x13d,-0x132,-0x198)]);}_0x437b15[_0x55daa9(-0x329,-0x2b8,-0x320,-0x2a4)](_0x30de8b,_0x1b7a50);}}else _0x21beec=null,new self[(_0x498847(0x43,-0x30,0x10,0x41))]()['loadAsync'](_0x2911a5)[_0x12f4bf(-0x100,-0x5a,-0xc5,-0xf7)](function(_0x57d8ad){var _0x6dc925=function(_0x52bf91,_0x20b9a6,_0x5b850a,_0x5d4586){return _0x498847(_0x52bf91-0x1eb,_0x20b9a6-0x51,_0x5d4586-0x306,_0x20b9a6);};_0x2ce040[_0x5940c1[_0x6dc925(0x394,0x2c3,0x397,0x317)]]['zip']=_0x57d8ad,_0x5940c1['_decode']();},function(_0xea9a73){var _0x44fd98=function(_0x2d9e63,_0x34363,_0x5985bd,_0x46c414){return _0x12f4bf(_0x2d9e63-0x104,_0x34363-0x197,_0x2d9e63-0x2b,_0x5985bd);},_0x457818=function(_0x51dd09,_0x37c107,_0x339388,_0x161641){return _0x498847(_0x51dd09-0x18,_0x37c107-0x1be,_0x51dd09-0x2b,_0x339388);};console[_0x44fd98(-0x85,-0xdb,-0xe3,-0x84)](_0x437b15[_0x457818(0x68,0x24,0x110,0xc)],_0x5940c1[_0x44fd98(0x3c,0xd3,0x29,-0x16)],_0xea9a73);});}if(_0x173adb[_0x58aaa6(0x2d5,0x374,0x331,0x376)](_0x5940c1['_zip_path'])){console[_0x58aaa6(0x3fb,0x3e9,0x494,0x467)](_0x109233[_0xda745d(0x293,0x2d8,0x243,0x2b4)](_0x58aaa6(0x45e,0x3d8,0x3a6,0x403)+_0xda745d(0x47f,0x3fa,0x44c,0x3c7)+'\x20-\x20',_0x5940c1[_0x58aaa6(0x3f2,0x3ab,0x310,0x3a0)]));var _0x5e7051=performance['now']();window['crypto']['subtle'][_0x58aaa6(0x2e6,0x2e0,0x2f8,0x280)](_0x109233[_0x58aaa6(0x33a,0x3f2,0x49f,0x3bc)],{'kty':_0x109233['oZLCI'],'k':'GQidUjJT8r'+_0x58aaa6(0x285,0x33c,0x2ed,0x2d2)+'FyM07cu0Uq'+'nLzVNjvPiO'+_0x58aaa6(0x26c,0x2f4,0x23f,0x371),'alg':_0x109233[_0x58aaa6(0x4d2,0x41e,0x47f,0x485)],'ext':!![]},{'name':_0x109233['DxjRw']},!![],['encrypt',_0x109233[_0xda745d(0x21f,0x2b4,0x2ce,0x33d)]])['then'](function(_0x1ef075){var _0x19ff80=function(_0x94450e,_0xa4447b,_0x41d400,_0x4b1a85){return _0x58aaa6(_0x94450e-0x1b0,_0x41d400-0x3e3,_0x41d400-0x74,_0x94450e);},_0x986cfc=function(_0x44b14e,_0x50c590,_0x442791,_0x57467d){return _0xda745d(_0x44b14e-0xa5,_0x442791-0x3e3,_0x442791-0x85,_0x44b14e);},_0x35e00b={};_0x35e00b[_0x19ff80(0x667,0x708,0x698,0x5ee)]=_0x24dc0e['naqgz'],_0x35e00b['hSZar']=function(_0x365d69,_0xc157b6,_0x3752ca,_0x16418d,_0x111263,_0x326972,_0x4818ce){return _0x365d69(_0xc157b6,_0x3752ca,_0x16418d,_0x111263,_0x326972,_0x4818ce);},_0x35e00b[_0x986cfc(0x730,0x7c6,0x791,0x784)]=function(_0x4e31c7,_0x1ef1b9){var _0x347b96=function(_0x24baea,_0x1c4a27,_0x3b72bb,_0x339bce){return _0x986cfc(_0x24baea,_0x1c4a27-0xdf,_0x1c4a27- -0x237,_0x339bce-0x141);};return _0x24dc0e[_0x347b96(0x490,0x4e3,0x551,0x493)](_0x4e31c7,_0x1ef1b9);},_0x35e00b[_0x19ff80(0x612,0x698,0x69a,0x680)]=_0x24dc0e[_0x19ff80(0x652,0x606,0x6a7,0x6e9)],_0x35e00b['aIUbD']=_0x986cfc(0x77d,0x769,0x73e,0x7c7),_0x35e00b[_0x19ff80(0x6d0,0x69b,0x6e7,0x62f)]=function(_0x495ea7,_0x53249d){var _0x4adb9f=function(_0x3dbde3,_0x54f931,_0x5ea9ba,_0x58d641){return _0x986cfc(_0x3dbde3,_0x54f931-0x134,_0x5ea9ba-0x1b4,_0x58d641-0x33);};return _0x24dc0e[_0x4adb9f(0x8e6,0x959,0x8ac,0x84e)](_0x495ea7,_0x53249d);},_0x35e00b[_0x986cfc(0x722,0x787,0x75f,0x75e)]=function(_0x5e8152,_0x2e3da9){return _0x24dc0e['oDpsj'](_0x5e8152,_0x2e3da9);},_0x35e00b['gzmoT']=function(_0x279b77,_0x53a7dc){var _0x457594=function(_0x231123,_0x39bbea,_0x1118bd,_0x21aef3){return _0x19ff80(_0x39bbea,_0x39bbea-0x89,_0x21aef3- -0x2b8,_0x21aef3-0xc0);};return _0x24dc0e[_0x457594(0x4b6,0x49d,0x534,0x4ad)](_0x279b77,_0x53a7dc);},_0x35e00b[_0x986cfc(0x8af,0x857,0x7f6,0x7eb)]=_0x19ff80(0x7c5,0x6b8,0x711,0x6e0),_0x35e00b['dAUcx']=function(_0x37c313,_0x49c7ed){var _0x4816cf=function(_0x5f132c,_0x31af89,_0x1292bb,_0x40bea7){return _0x986cfc(_0x40bea7,_0x31af89-0x40,_0x1292bb-0x2ae,_0x40bea7-0x98);};return _0x24dc0e[_0x4816cf(0x9e3,0xacd,0xa14,0xab1)](_0x37c313,_0x49c7ed);},_0x35e00b['cMAPi']=function(_0x30faae,_0xe68e4a){return _0x24dc0e['cyqeF'](_0x30faae,_0xe68e4a);},_0x35e00b[_0x19ff80(0x7f8,0x76c,0x76a,0x7b8)]=function(_0x4eb02b,_0x4cbff7){return _0x24dc0e['jOqMB'](_0x4eb02b,_0x4cbff7);},_0x35e00b['pllWD']=_0x24dc0e['eRerj'];var _0x364d7d=_0x35e00b,_0x53bef2={};_0x53bef2[_0x19ff80(0x69e,0x65f,0x694,0x650)]=_0x24dc0e[_0x986cfc(0x741,0x83b,0x7b7,0x7d6)],_0x53bef2[_0x19ff80(0x6dc,0x794,0x75d,0x794)]=new ArrayBuffer(-0x581*0x7+-0x151f+-0x1ddb*-0x2),_0x53bef2[_0x19ff80(0x746,0x7be,0x714,0x712)]=0x80,window[_0x986cfc(0x7dd,0x8ae,0x7fb,0x845)]['subtle']['decrypt'](_0x53bef2,_0x1ef075,_0x21beec['response'])[_0x19ff80(0x62b,0x622,0x6b8,0x6c9)](function(_0x342a60){var _0x1f8892=function(_0x2096ee,_0x3a8d23,_0x5d8f25,_0xf15142){return _0x19ff80(_0x5d8f25,_0x3a8d23-0x16d,_0x3a8d23-0x2b0,_0xf15142-0x1b9);},_0x12cb99=function(_0x51d82b,_0x120556,_0x4ef472,_0x2e88a6){return _0x986cfc(_0x4ef472,_0x120556-0x9e,_0x120556-0x2b0,_0x2e88a6-0x1e3);},_0xb43c44={};_0xb43c44[_0x1f8892(0x93f,0x956,0x993,0x8a1)]=_0x364d7d['ZjdJc'],_0xb43c44[_0x12cb99(0xaf1,0xa83,0xafc,0xa14)]=function(_0x40c691,_0x29b9fe,_0x5450ef,_0x17a996,_0x4dfce4,_0x295107,_0x765611){var _0x29ba94=function(_0xbc2119,_0x8033db,_0xaf1609,_0x34f550){return _0x12cb99(_0xbc2119-0x1af,_0x34f550- -0x14b,_0xbc2119,_0x34f550-0x84);};return _0x364d7d[_0x29ba94(0x883,0x8f9,0x7e8,0x877)](_0x40c691,_0x29b9fe,_0x5450ef,_0x17a996,_0x4dfce4,_0x295107,_0x765611);};var _0x37a51e=_0xb43c44;if(_0x364d7d[_0x12cb99(0xab0,0xa41,0x9ca,0xabf)](_0x364d7d[_0x1f8892(0x937,0x94a,0x9e1,0x90e)],_0x364d7d[_0x12cb99(0x9f6,0xa24,0xa5d,0xa3a)]))console['log'](_0x364d7d[_0x12cb99(0xa50,0x997,0x9df,0x9df)](_0x364d7d[_0x1f8892(0xa62,0xa0f,0x9e4,0xa9e)](_0x2e1005,_0x364d7d[_0x1f8892(0x95d,0x97c,0x952,0x9a7)](performance[_0x1f8892(0x9ef,0xaa7,0xaf4,0xa7c)](),_0x5e7051)),_0x364d7d[_0x12cb99(0xac0,0xaa6,0xa65,0xb56)])+_0x5940c1[_0x12cb99(0xa4c,0xa3e,0x9f9,0xa16)]),_0x364d7d[_0x1f8892(0x96f,0x99e,0x9b6,0xa51)](_0xfe7cf2,_0x342a60);else{function _0x5a3d1d(){var _0x3549ec=function(_0x5396a0,_0x6756f1,_0x5bbf06,_0x198554){return _0x12cb99(_0x5396a0-0x75,_0x5bbf06-0x3cd,_0x198554,_0x198554-0x178);};_0x312c60=function(){var _0x71f205=function(_0x341371,_0x2d04ef,_0x340e29,_0x5987f1){return _0x4abc(_0x2d04ef- -0x28d,_0x341371);},_0x29704e=function(_0x54606a,_0x47b60f,_0x1475c5,_0x1d9c8d){return _0x4abc(_0x47b60f- -0x28d,_0x54606a);};_0x1b01ec['response']=this['response'],_0x281c84[_0x71f205(-0xf6,-0x73,-0x70,-0x5f)]=-0x2450+0x519+0x1fff*0x1,_0x5d0bf2['onload'](),_0x2c117c[_0x29704e(0x18,-0x26,-0x60,-0x12)]=_0x3a519f=_0x5adcb5=null;},_0x4b551d=function(){var _0x562f7c=function(_0x3b6249,_0x1d2d6e,_0x22ecc8,_0x228f5b){return _0x4abc(_0x22ecc8- -0x22f,_0x1d2d6e);},_0x3ad72d=function(_0x962815,_0x41a5e7,_0x2c4173,_0x435eb0){return _0x4abc(_0x2c4173- -0x22f,_0x41a5e7);};_0x1bd141[_0x562f7c(0x18,0x8c,0xa5,0x19)]=_0x37a51e['xgsJE'],_0x139f08[_0x3ad72d(-0x29,-0xaa,-0x5b,-0x24)]&&_0x537245[_0x562f7c(-0xf8,0x57,-0x5b,-0xc2)]();},_0x37a51e['CxrDk'](_0x2e2d3f,this['method'],this['url'],this[_0x3549ec(0xda9,0xdc5,0xde0,0xd62)],this['responseTy'+'pe'],_0x4b2e23,_0x2229a3);}}})[_0x986cfc(0x7c4,0x721,0x734,0x6ff)](function(_0x42da80){var _0x2cb6c1=function(_0x4dbfc9,_0x8d4476,_0x149097,_0xf7b6d){return _0x986cfc(_0x4dbfc9,_0x8d4476-0x76,_0xf7b6d- -0x38e,_0xf7b6d-0x132);},_0x10227a=function(_0x28bcc9,_0x27f549,_0x24f662,_0x41c0c1){return _0x986cfc(_0x28bcc9,_0x27f549-0xdb,_0x41c0c1- -0x38e,_0x41c0c1-0x76);};if(_0x364d7d[_0x2cb6c1(0x3fd,0x40d,0x348,0x3dc)](_0x364d7d[_0x2cb6c1(0x2d3,0x359,0x3e0,0x387)],_0x364d7d[_0x2cb6c1(0x36b,0x377,0x2f0,0x387)]))console[_0x2cb6c1(0x3e0,0x36c,0x333,0x33f)](_0x42da80);else{function _0x5b6eef(){var _0x7faf1a=function(_0xd17955,_0x5265fa,_0x21f8e1,_0x3ca94e){return _0x10227a(_0x3ca94e,_0x5265fa-0x1bc,_0x21f8e1-0x152,_0x5265fa-0x49);},_0x3af38d=function(_0x482308,_0x181fd8,_0x129dc7,_0x2f1f2c){return _0x10227a(_0x2f1f2c,_0x181fd8-0x161,_0x129dc7-0x1ab,_0x181fd8-0x49);},_0x2a8a17={};_0x2a8a17[_0x7faf1a(0x372,0x370,0x3de,0x407)]=function(_0x42b399,_0x5bd6c9){return _0x364d7d['cMAPi'](_0x42b399,_0x5bd6c9);};var _0x5ebff6=_0x2a8a17;if(!_0x5abebc[_0x3af38d(0x401,0x4b3,0x533,0x46d)])return;_0x47b050[_0x7faf1a(0x381,0x367,0x3c2,0x2ca)]()['then'](function(_0x1a58af){var _0x20c3ae=function(_0x3d067b,_0xaec0ae,_0x1cc79a,_0x144b2a){return _0x3af38d(_0x3d067b-0x1de,_0x3d067b- -0x2b5,_0x1cc79a-0x1af,_0xaec0ae);},_0x4c2b11=function(_0x5e3ce4,_0x3be61d,_0x4c0707,_0x1d869a){return _0x7faf1a(_0x5e3ce4-0x1b4,_0x5e3ce4- -0x2b5,_0x4c0707-0x1d7,_0x3be61d);},_0x288a30={};_0x288a30[_0x20c3ae(0x128,0xc6,0xc3,0xef)+'ch']=!![],_0x1a58af['delete'](_0x463699,_0x2e91c2||_0x288a30)[_0x20c3ae(0xbe,0xfa,0x6d,0x89)](function(_0x57ba69){var _0x4a2db7=function(_0x1d8300,_0x5377d6,_0x1fb970,_0x3ac015){return _0x4c2b11(_0x1fb970-0x229,_0x3ac015,_0x1fb970-0x76,_0x3ac015-0xf3);};_0x5ebff6[_0x4a2db7(0x342,0x32e,0x2e4,0x256)](_0x507bf5,_0x57ba69);});});}}});})[_0xda745d(0x394,0x351,0x352,0x2cb)](function(_0x502f4b){var _0x9cca81=function(_0x1d81ae,_0x29b0c2,_0xb39385,_0x40e4de){return _0x58aaa6(_0x1d81ae-0x11e,_0x29b0c2- -0x149,_0xb39385-0xb2,_0x40e4de);};console[_0x9cca81(0xe6,0x1a1,0x1fd,0x19b)](_0x502f4b);});}else _0x109233[_0x58aaa6(0x30c,0x2cc,0x2ad,0x2e9)](_0xfe7cf2,_0x21beec[_0x58aaa6(0x409,0x38e,0x371,0x369)]);}}else console[_0x58aaa6(0x266,0x2ea,0x2e0,0x2bf)](_0x2a37f3,_0x5940c1[_0x58aaa6(0x2f8,0x3ab,0x31d,0x3c6)],_0x21beec[_0x58aaa6(0x385,0x3fb,0x44a,0x3c8)]);},_0x43bee3=function(){var _0x20fb6c=function(_0x458a6a,_0x96018f,_0x22478c,_0x18009d){return _0x53777d(_0x18009d,_0x96018f- -0x16,_0x22478c-0x113,_0x18009d-0x1ef);},_0x273815=function(_0x2871fa,_0x3d41c4,_0x57f3e6,_0xf3443f){return _0x324e0a(_0xf3443f,_0x3d41c4- -0x16,_0x57f3e6-0x12,_0xf3443f-0x181);};console[_0x20fb6c(0x4b1,0x417,0x483,0x412)](_0x54b0f9['YayCx'],_0x5940c1[_0x20fb6c(0x45c,0x4d8,0x500,0x4ab)],_0x21beec[_0x20fb6c(0x472,0x528,0x553,0x5a0)]);},_0x19228a=_0x54b0f9[_0x324e0a(0x3e5,0x402,0x440,0x469)](toFileProtocol,this['_zip_path']),_0x4315b6(_0x54b0f9[_0x324e0a(0x439,0x48e,0x465,0x4fb)],_0x19228a,!![],_0x54b0f9[_0x53777d(0x4d2,0x45c,0x402,0x4df)],_0x22ca9e,_0x43bee3);}else{function _0x387eb0(){var _0x5d0dc4=function(_0x44c772,_0x10dfa6,_0x399560,_0x20b776){return _0x53777d(_0x20b776,_0x44c772-0x3b2,_0x399560-0x187,_0x20b776-0x2);},_0x4ebdbb=function(_0x209b00,_0x54b5b8,_0x704fd0,_0x6c5ba8){return _0x53777d(_0x6c5ba8,_0x209b00-0x3b2,_0x704fd0-0x1bb,_0x6c5ba8-0x17d);};_0x395656[_0x5d0dc4(0x7df,0x825,0x7a0,0x87d)](_0x54b0f9[_0x4ebdbb(0x7ae,0x703,0x7aa,0x755)],_0x4f4013[_0x5d0dc4(0x8a0,0x84e,0x94a,0x95b)],_0x490459[_0x5d0dc4(0x8f0,0x87e,0x938,0x889)]);}}}else{if(_0x54b0f9[_0x324e0a(0x50f,0x4a2,0x527,0x483)](_0x54b0f9[_0x53777d(0x57a,0x4f3,0x4be,0x501)],_0x54b0f9[_0x53777d(0x46d,0x4f3,0x4a3,0x4b0)]))_0x18cefb['xhr'][_0x324e0a(0x439,0x462,0x4fd,0x50c)](this),_0x18cefb[_0x53777d(0x481,0x45d,0x4ff,0x3df)]&&this[_0x324e0a(0x507,0x4ff,0x46b,0x576)]();else{function _0x51b32a(){var _0x52becf=function(_0x3d1852,_0x3d8401,_0x16aca9,_0x23c9b8){return _0x324e0a(_0x3d8401,_0x16aca9-0x391,_0x16aca9-0x116,_0x23c9b8-0x5d);},_0x330614=function(_0x17e757,_0x4ea0a9,_0x2f56a4,_0x49d0b4){return _0x53777d(_0x4ea0a9,_0x2f56a4-0x391,_0x2f56a4-0x1d1,_0x49d0b4-0xc1);},_0x24af90={};_0x24af90[_0x52becf(0x78c,0x76a,0x787,0x78c)]=_0x54b0f9['YayCx'];var _0x242ace=_0x24af90;_0x59488b=null,new _0xb9f3eb[(_0x330614(0x827,0x8dd,0x87e,0x83b))]()['loadAsync'](_0x42fb4b)['then'](function(_0x1ae7c0){var _0x5a4b02=function(_0x1286ef,_0x4ff76a,_0x2d1680,_0x8b1150){return _0x330614(_0x1286ef-0xea,_0x2d1680,_0x8b1150-0xd2,_0x8b1150-0x66);},_0x44056b=function(_0x1b1f49,_0x117193,_0x2de40c,_0x348cc4){return _0x52becf(_0x1b1f49-0xea,_0x2de40c,_0x348cc4-0xd2,_0x348cc4-0x16a);};_0x13b06e[_0x4bc1f8[_0x5a4b02(0x90a,0x981,0x964,0x951)]][_0x5a4b02(0x8f2,0x89f,0x87a,0x8c0)]=_0x1ae7c0,_0xafa190[_0x5a4b02(0x906,0x8fb,0x911,0x962)]();},function(_0x4ed2c9){var _0x13151e=function(_0x581f7d,_0x439b6a,_0x5cb327,_0x51f431){return _0x330614(_0x581f7d-0xd6,_0x51f431,_0x581f7d-0x3d2,_0x51f431-0x1eb);},_0x5277ba=function(_0x599500,_0x41fad8,_0x49f2a3,_0x54b2f8){return _0x330614(_0x599500-0x87,_0x54b2f8,_0x599500-0x3d2,_0x54b2f8-0xc);};_0x502828[_0x13151e(0xb90,0xadd,0xc00,0xb2a)](_0x242ace[_0x13151e(0xb59,0xab2,0xb99,0xb72)],_0x45465b[_0x5277ba(0xc51,0xc45,0xbc0,0xc1a)],_0x4ed2c9);});}}}}else{function _0x56c926(){var _0x285197=function(_0x1d4461,_0x4e9f87,_0x53ae4b,_0x3750a0){return _0x53777d(_0x3750a0,_0x1d4461- -0xc4,_0x53ae4b-0x36,_0x3750a0-0x177);},_0x42a66a=function(_0x2498b5,_0x16da20,_0x295a2c,_0x835d02){return _0x324e0a(_0x835d02,_0x2498b5- -0xc4,_0x295a2c-0x37,_0x835d02-0x1e8);};_0x1e51ab[_0x285197(0x468,0x489,0x43b,0x3d7)](_0x54b0f9['rQLQY'](_0x54b0f9[_0x285197(0x38f,0x3f8,0x3e6,0x404)](_0x54b0f9[_0x285197(0x38f,0x3a5,0x35f,0x344)](_0x3e629f,_0x54b0f9[_0x42a66a(0x495,0x40e,0x4d3,0x46b)](_0x1b82f7[_0x285197(0x493,0x494,0x3d9,0x412)](),_0x2955db)),_0x54b0f9[_0x42a66a(0x475,0x4fa,0x403,0x4af)]),_0x371101[_0x42a66a(0x42a,0x4e5,0x390,0x3d8)])),_0x54b0f9[_0x42a66a(0x33e,0x3b8,0x364,0x35c)](_0x43e05c,_0xac2594);}}}else _0x22ca9e=function(){var _0x399745=function(_0x3d924f,_0x3a92aa,_0x580873,_0x3c39b7){return _0x324e0a(_0x3c39b7,_0x3a92aa-0x254,_0x580873-0xf8,_0x3c39b7-0x1c6);},_0x5e2b8b=function(_0x22d039,_0x3ceb44,_0x455efa,_0x53ba18){return _0x53777d(_0x53ba18,_0x3ceb44-0x254,_0x455efa-0x16a,_0x53ba18-0x14f);};_0x5940c1['response']=this['response'],_0x5940c1[_0x399745(0x696,0x6d8,0x78e,0x751)]=-0x1559+-0xf1*-0x29+-0x4*0x41e,_0x5940c1[_0x5e2b8b(0x701,0x739,0x7d0,0x781)](),_0x5940c1[_0x5e2b8b(0x70f,0x725,0x74a,0x6ca)]=_0x5940c1=_0x21beec=null;},_0x43bee3=function(){var _0x32860d=function(_0x2718f9,_0x3dd7ce,_0x3e40e8,_0x5d69a3){return _0x324e0a(_0x3dd7ce,_0x3e40e8-0x1ad,_0x3e40e8-0x183,_0x5d69a3-0x14c);},_0x5bcd83=function(_0x2b4cab,_0x11dcc9,_0xb04e2,_0x282d9d){return _0x53777d(_0x11dcc9,_0xb04e2-0x1ad,_0xb04e2-0x41,_0x282d9d-0x25);};_0x5940c1[_0x32860d(0x6ea,0x728,0x6eb,0x667)]=_0x5bcd83(0x5fe,0x6ad,0x691,0x6eb)+'uestZIP\x20ER'+_0x5bcd83(0x66c,0x5bf,0x602,0x664),_0x5940c1[_0x32860d(0x624,0x5a9,0x5eb,0x65c)]&&_0x5940c1['onerror']();},_0x54b0f9[_0x324e0a(0x465,0x4a5,0x4b8,0x503)](_0x4315b6,this['method'],this[_0x324e0a(0x473,0x46c,0x405,0x4c7)],this[_0x324e0a(0x4fd,0x4c3,0x4de,0x548)],this['responseTy'+'pe'],_0x22ca9e,_0x43bee3);};}}(),XMLHttpRequestZIP[_0x512471(0x54a,0x4db,0x4f4,0x587)][_0x512471(0x366,0x3bc,0x3bf,0x44b)]=function(_0xc6e42d,_0x27e628,_0x220367){var _0x54e7bf=function(_0x188832,_0x20b2f2,_0x30a6d5,_0x127e83){return _0x46860e(_0x188832-0xb8,_0x127e83-0x1bf,_0x30a6d5,_0x127e83-0x12);},_0x27cfea=function(_0x33758f,_0x5e351f,_0x36fcfc,_0x40ec17){return _0x512471(_0x33758f-0x198,_0x40ec17-0x1bf,_0x36fcfc,_0x40ec17-0x9f);};this[_0x54e7bf(0x5da,0x5e4,0x564,0x572)]=_0xc6e42d,this[_0x54e7bf(0x56a,0x60a,0x599,0x5db)]=_0x27e628,this[_0x54e7bf(0x635,0x6ba,0x66e,0x632)]=!!_0x220367;};}());var SystemAnimator_caches={'enabled':_0x14e3c4(0x35e,0x341,0x29b,0x3f9)in self&&browser_native_mode,'open':function(){var _0x17b453=function(_0x284348,_0x8bee95,_0x3376e3,_0x1c4d98){return _0x14e3c4(_0x284348-0x1db,_0x8bee95-0xba,_0x3376e3-0x171,_0x1c4d98);},_0x5615b9=function(_0x430210,_0x455ae7,_0x15ac35,_0x2ec2fb){return _0x14e3c4(_0x430210-0xe4,_0x455ae7-0xba,_0x15ac35-0x173,_0x2ec2fb);},_0x5c971f={};_0x5c971f[_0x17b453(0x517,0x46f,0x4c0,0x42c)]=_0x17b453(0x48f,0x502,0x475,0x4e4),_0x5c971f[_0x5615b9(0x46f,0x425,0x386,0x464)]=function(_0x205d3c,_0x4340d6){return _0x205d3c||_0x4340d6;},_0x5c971f[_0x5615b9(0x564,0x4e7,0x513,0x58c)]=_0x17b453(0x515,0x470,0x3ed,0x408)+_0x17b453(0x411,0x495,0x537,0x487),_0x5c971f[_0x17b453(0x503,0x464,0x4b2,0x43f)]=_0x17b453(0x44c,0x45c,0x497,0x50a)+_0x17b453(0x46c,0x4b3,0x4cb,0x4df),_0x5c971f['XyUPa']='(match\x20by\x20'+_0x17b453(0x41c,0x470,0x4f8,0x404)+_0x17b453(0x44d,0x4a9,0x4d2,0x530),_0x5c971f[_0x5615b9(0x449,0x3eb,0x463,0x402)]=function(_0xb0d882,_0x250cd0){return _0xb0d882(_0x250cd0);},_0x5c971f[_0x5615b9(0x51d,0x4e9,0x465,0x4bd)]=function(_0x14df03,_0x31a55a){return _0x14df03===_0x31a55a;},_0x5c971f[_0x5615b9(0x3ee,0x3ec,0x3c5,0x434)]=_0x17b453(0x460,0x42a,0x480,0x3e5),_0x5c971f[_0x17b453(0x4ef,0x476,0x423,0x4cb)]=function(_0x241eed,_0x365298,_0x1bcaf0){return _0x241eed(_0x365298,_0x1bcaf0);};var _0x51860e=_0x5c971f,_0x33b938;return function(){var _0x45753e=function(_0xe21f39,_0x16691a,_0xeb9e2d,_0x3c53e3){return _0x5615b9(_0xe21f39-0xfb,_0x16691a-0x7b,_0xeb9e2d-0x120,_0x3c53e3);},_0x4c027f=function(_0x4cbc58,_0xe4bcf,_0x363e29,_0x1a9dcd){return _0x17b453(_0x4cbc58-0xdc,_0xe4bcf-0x7b,_0x363e29-0x1ce,_0x1a9dcd);},_0x288e21={};_0x288e21[_0x45753e(0x522,0x58a,0x5ad,0x543)]=_0x51860e['uZSMa'],_0x288e21[_0x45753e(0x43b,0x497,0x456,0x4b9)]=function(_0x1e7273,_0x16ddc1){var _0x1c62dc=function(_0x54c05d,_0x42a223,_0x7f9ebf,_0x238e28){return _0x45753e(_0x54c05d-0x20,_0x42a223- -0x336,_0x7f9ebf-0x104,_0x7f9ebf);};return _0x51860e[_0x1c62dc(0x224,0x16a,0xc5,0x191)](_0x1e7273,_0x16ddc1);},_0x288e21[_0x45753e(0x480,0x498,0x41f,0x428)]=_0x51860e['PWsTU'],_0x288e21[_0x4c027f(0x5cb,0x572,0x5a0,0x553)]=function(_0x266ee9,_0xcaee67){return _0x266ee9==_0xcaee67;},_0x288e21[_0x45753e(0x4a3,0x4ce,0x588,0x584)]=_0x45753e(0x46a,0x4d7,0x574,0x4f9)+_0x45753e(0x4de,0x536,0x4ab,0x548),_0x288e21[_0x4c027f(0x4e9,0x51a,0x471,0x543)]=_0x51860e[_0x4c027f(0x53f,0x4df,0x4f5,0x4e3)],_0x288e21['TPFpL']=_0x51860e[_0x45753e(0x3dd,0x46b,0x483,0x4be)],_0x288e21[_0x4c027f(0x535,0x579,0x4d7,0x4cb)]=function(_0x3a321a,_0x57c980){return _0x51860e['BTCTr'](_0x3a321a,_0x57c980);},_0x288e21[_0x45753e(0x533,0x4f3,0x583,0x5a3)]=_0x4c027f(0x58a,0x528,0x478,0x4aa)+_0x4c027f(0x569,0x4d6,0x50e,0x469),_0x288e21[_0x4c027f(0x4bb,0x4de,0x50f,0x550)]='SystemAnim'+_0x45753e(0x564,0x537,0x4d9,0x4ef),_0x288e21[_0x45753e(0x499,0x464,0x467,0x50d)]=function(_0x5634ca,_0x1d9c0e){return _0x51860e['tiyTm'](_0x5634ca,_0x1d9c0e);},_0x288e21[_0x45753e(0x52d,0x55b,0x592,0x514)]=function(_0x61bc45,_0x58bf84){return _0x61bc45(_0x58bf84);},_0x288e21[_0x4c027f(0x468,0x46d,0x4a5,0x431)]=_0x51860e[_0x45753e(0x3d0,0x467,0x40c,0x422)],_0x288e21['ugvrz']=function(_0x3f6e2d,_0x409f87,_0x1d658f){var _0x41c353=function(_0x26eac1,_0xe4c6e6,_0xf0eaa1,_0x38c6aa){return _0x45753e(_0x26eac1-0x1a2,_0xe4c6e6- -0x137,_0xf0eaa1-0x85,_0xf0eaa1);};return _0x51860e[_0x41c353(0x3d0,0x3ba,0x38d,0x3eb)](_0x3f6e2d,_0x409f87,_0x1d658f);};var _0x44db8a=_0x288e21;return new Promise(function(_0x26a4c4){var _0x32405e=function(_0x5ecae9,_0x17cc45,_0x10174b,_0x35bafa){return _0x4c027f(_0x5ecae9-0x98,_0x17cc45- -0x191,_0x10174b-0x101,_0x10174b);},_0x53963d=function(_0x3b9573,_0x53b1c1,_0x38d13e,_0x1c7be2){return _0x45753e(_0x3b9573-0x85,_0x53b1c1- -0x191,_0x38d13e-0x197,_0x38d13e);},_0x35d24f={};_0x35d24f[_0x32405e(0x378,0x336,0x3c0,0x318)]=function(_0x51f4dc,_0x268eb4){return _0x51f4dc(_0x268eb4);},_0x35d24f[_0x32405e(0x2ef,0x2f8,0x275,0x2b1)]=_0x44db8a[_0x32405e(0x2a5,0x34d,0x345,0x2ae)],_0x35d24f[_0x53963d(0x336,0x2b2,0x26b,0x228)]=function(_0x319976,_0x30ecbd){var _0x5428a9=function(_0x12d615,_0x623ec9,_0x381c22,_0x41e989){return _0x32405e(_0x12d615-0x121,_0x623ec9- -0xc4,_0x12d615,_0x41e989-0x101);};return _0x44db8a[_0x5428a9(0x2c4,0x20f,0x164,0x262)](_0x319976,_0x30ecbd);},_0x35d24f[_0x53963d(0x350,0x381,0x359,0x42b)]=_0x32405e(0x3eb,0x3e9,0x3e0,0x364),_0x35d24f[_0x32405e(0x3b6,0x390,0x368,0x2f7)]=_0x32405e(0x2c6,0x2db,0x29d,0x234),_0x35d24f['cPCQP']=function(_0x4c33cf,_0xaa0ef9){var _0x3a874c=function(_0x37c23f,_0x570288,_0x1967f8,_0x536ca5){return _0x53963d(_0x37c23f-0x1b5,_0x570288- -0x270,_0x37c23f,_0x536ca5-0x1e8);};return _0x44db8a[_0x3a874c(0xdd,0x15a,0x202,0x19e)](_0x4c33cf,_0xaa0ef9);};var _0x1a9c9c=_0x35d24f;if(_0x44db8a['BbfCv'](_0x44db8a[_0x53963d(0x2b9,0x2dc,0x2b9,0x36e)],_0x44db8a['FYEWg'])){if(!SystemAnimator_caches[_0x32405e(0x3f1,0x3f1,0x339,0x4a7)])return;_0x33b938?_0x44db8a[_0x32405e(0x336,0x2c3,0x372,0x37e)](setTimeout,function(){_0x26a4c4(_0x33b938);},0x1*0x1767+-0x1d48+0x5e1*0x1):caches[_0x53963d(0x2e0,0x2a5,0x314,0x332)](_0x53963d(0x1de,0x28b,0x2d7,0x1db)+'ator')[_0x32405e(0x283,0x2b1,0x32a,0x2b6)](_0x502039=>{var _0x1f3c6b=function(_0x45689e,_0x125c95,_0x278372,_0x114428){return _0x53963d(_0x45689e-0xc1,_0x114428-0xf7,_0x45689e,_0x114428-0x16);},_0x4504da=function(_0x162d40,_0x46bc3a,_0x4a5d4a,_0x192cd9){return _0x53963d(_0x162d40-0x1a0,_0x192cd9-0xf7,_0x162d40,_0x192cd9-0x1de);};if(_0x1a9c9c[_0x1f3c6b(0x42c,0x300,0x348,0x3a9)](_0x1a9c9c[_0x4504da(0x4a5,0x41c,0x40a,0x478)],_0x1a9c9c[_0x4504da(0x4c2,0x4b5,0x45f,0x487)])){function _0x3e61cf(){var _0x4120d4=function(_0x2c30aa,_0x1ec315,_0x49d6f7,_0x4025d3){return _0x1f3c6b(_0x49d6f7,_0x1ec315-0x3b,_0x49d6f7-0xae,_0x4025d3-0xbb);},_0x336aea=function(_0x4dc74b,_0x57e996,_0xaf2f01,_0x443a39){return _0x1f3c6b(_0xaf2f01,_0x57e996-0x19d,_0xaf2f01-0x140,_0x443a39-0xbb);},_0x5c62d6={};_0x5c62d6[_0x4120d4(0x506,0x663,0x572,0x5a8)]=function(_0x1033be,_0x1cafd4){var _0x4d25bf=function(_0x58be61,_0x3b69ee,_0x24f423,_0x17ece2){return _0x4120d4(_0x58be61-0xe6,_0x3b69ee-0x9b,_0x58be61,_0x3b69ee- -0x180);};return _0x1a9c9c[_0x4d25bf(0x32c,0x368,0x2b6,0x34b)](_0x1033be,_0x1cafd4);};var _0x1117f0=_0x5c62d6;_0xf8d65['open'](_0x1a9c9c[_0x336aea(0x464,0x452,0x483,0x4aa)])[_0x4120d4(0x3d7,0x3b2,0x4b4,0x463)](_0x2f9091=>{var _0x1d8949=function(_0x386adb,_0x313bce,_0x4c1e0b,_0x669dfe){return _0x336aea(_0x386adb-0x37,_0x313bce-0x118,_0x669dfe,_0x386adb-0xc8);};_0xb65317=_0x2f9091,_0x1117f0[_0x1d8949(0x670,0x6c4,0x5e3,0x69a)](_0x486510,_0x188f40);});}}else _0x33b938=_0x502039,_0x1a9c9c['cPCQP'](_0x26a4c4,_0x33b938);});}else{function _0x2f1248(){var _0x57077a=function(_0x599a8e,_0x1cb1a6,_0x2058dd,_0x3c933d){return _0x32405e(_0x599a8e-0x1c6,_0x2058dd- -0x312,_0x599a8e,_0x3c933d-0x197);},_0x4c0183=function(_0x516364,_0x77189b,_0x2bf8e3,_0x44282a){return _0x32405e(_0x516364-0xb3,_0x2bf8e3- -0x312,_0x516364,_0x44282a-0x0);},_0x414d5f=_0x44db8a[_0x57077a(0x117,0x77,0xe7,0x4f)][_0x57077a(0x6,-0x5d,0x14,-0x9)]('|'),_0x1969f0=-0x157*0x7+0x2*0xb83+-0xda5*0x1;while(!![]){switch(_0x414d5f[_0x1969f0++]){case'0':var _0xb8b18f=_0x44db8a['DdgNh'](!_0x2df774,!_0x4fe728)||/sao\.animetheme\.com/i[_0x57077a(0x4c,-0x47,0x3e,-0x8)](_0x31bc6[_0x57077a(0xa3,0xb8,0x1c,-0x21)][_0x4c0183(0x46,-0xd0,-0x44,-0x51)]);continue;case'1':var _0x24d6f8=!_0x1e40ef||!_0x1b58cd;continue;case'2':var _0x1b58cd=_0x502e3f['headers'][_0x4c0183(-0x3c,0x6d,0x39,0x2a)](_0x44db8a['TiTmD']);continue;case'3':if(!_0xb8b18f&&_0x44db8a['xBBTp'](_0x4fe728,_0xcde145)||!_0x24d6f8&&_0x44db8a[_0x4c0183(0xbb,0xa7,0xcf,0xc7)](_0x1b58cd,_0x34fbc8)||_0xb8b18f&&_0x24d6f8){if(_0xb8b18f&&_0x24d6f8)_0x55f086[_0x4c0183(0x14f,0x69,0xb3,0xfc)](_0x44db8a[_0x4c0183(-0x49,0x5e,0x2b,0x19)]);else{if(!_0xb8b18f)_0x43c050[_0x57077a(0x96,0xba,0xb3,0xce)](_0x44db8a[_0x4c0183(0x3f,0xc,0x77,0x0)]);else _0x586362[_0x4c0183(0x51,0x143,0xb3,0x12c)](_0x44db8a[_0x4c0183(-0x44,-0x11,-0x12,0xe)]);}_0x44db8a[_0x57077a(0xa5,0x72,0xd6,0x143)](_0x5e8d14,_0x38d771);}else _0x281160[_0x4c0183(0x142,0x156,0xb3,0xdc)](_0x44db8a[_0x4c0183(0xc0,0x59,0x50,0xd)],_0x41a912[_0x4c0183(0x77,-0x74,-0xd,0x19)],_0x4334c2,_0x4fe728,_0x195995,_0x1b58cd),_0x5f44d3();continue;case'4':var _0x4fe728=_0x13c993[_0x4c0183(0x3e,0x6e,0xbe,0x128)][_0x4c0183(0xd2,-0x73,0x39,-0xa)](_0x4c0183(0x28,0x0,0x41,0x89));continue;}break;}}}});};}(),'request':function(_0x459f48,_0x4522fd){var _0x5e81af=function(_0x40b317,_0x4fe588,_0x5eecfb,_0x1a6453){return _0x14e3c4(_0x40b317-0x69,_0x40b317- -0x25b,_0x5eecfb-0x156,_0x1a6453);},_0x1ce632=function(_0x5f33b0,_0x89e112,_0x2d5d09,_0x2b4b14){return _0x14e3c4(_0x5f33b0-0xb3,_0x5f33b0- -0x25b,_0x2d5d09-0x3c,_0x2b4b14);},_0x224a03={};_0x224a03['chqVr']=_0x5e81af(0x14a,0xed,0xe4,0x16f),_0x224a03[_0x5e81af(0x1a8,0x262,0x24f,0x121)]=_0x1ce632(0x1a1,0x1c6,0x202,0x12b);var _0x511db4=_0x224a03;return this[_0x1ce632(0x1f2,0x290,0x27d,0x1a7)]&&typeof _0x459f48==_0x511db4['chqVr']?new Request(_0x459f48,_0x4522fd||(localhost_mode?{'cache':_0x511db4[_0x1ce632(0x1a8,0x146,0x1fb,0x1d1)]}:{})):_0x459f48;},'put':function(_0x1e63d1,_0x343752){var _0x2c7424=function(_0x552fc1,_0x5f2454,_0x357452,_0x1b7791){return _0x14e3c4(_0x552fc1-0x93,_0x357452-0x132,_0x357452-0x136,_0x1b7791);},_0x207c39=function(_0x3dd5ea,_0x4d3880,_0x16b7a6,_0x5e37c5){return _0x14e3c4(_0x3dd5ea-0x1da,_0x16b7a6-0x132,_0x16b7a6-0x132,_0x5e37c5);},_0x2ff773={};_0x2ff773[_0x2c7424(0x4de,0x462,0x48b,0x47e)]=function(_0x15e7c6,_0x6e9d61){return _0x15e7c6!==_0x6e9d61;},_0x2ff773[_0x2c7424(0x516,0x5e9,0x55b,0x561)]=_0x207c39(0x47c,0x467,0x4df,0x564),_0x2ff773[_0x2c7424(0x5c5,0x583,0x562,0x52c)]='XMLHttpReq'+_0x207c39(0x439,0x4c6,0x459,0x49a)+_0x207c39(0x49a,0x52f,0x47c,0x42b),_0x2ff773[_0x2c7424(0x3e2,0x3fd,0x458,0x3af)]=_0x2c7424(0x4a9,0x558,0x4ad,0x54b);var _0x186c01=_0x2ff773;SystemAnimator_caches[_0x207c39(0x4c1,0x400,0x433,0x477)]()[_0x2c7424(0x3ca,0x3d4,0x43f,0x4f8)](function(_0x53d20e){var _0x1cbb31=function(_0x186d22,_0x3dbf3a,_0x562ced,_0x59c187){return _0x207c39(_0x186d22-0x184,_0x3dbf3a-0xc7,_0x186d22- -0x162,_0x562ced);},_0x3ecbe5=function(_0xafb1a0,_0x2800ab,_0x2f4318,_0x59ac21){return _0x2c7424(_0xafb1a0-0xa3,_0x2800ab-0x1e2,_0xafb1a0- -0x162,_0x2f4318);},_0x14dced={};_0x14dced['ROEZC']=_0x186c01[_0x1cbb31(0x400,0x42e,0x420,0x407)];var _0x355cea=_0x14dced;if(_0x186c01[_0x3ecbe5(0x2f6,0x323,0x325,0x24d)]===_0x186c01[_0x3ecbe5(0x2f6,0x294,0x3aa,0x24f)])_0x53d20e[_0x3ecbe5(0x424,0x488,0x496,0x38b)](_0x1e63d1,_0x343752)[_0x1cbb31(0x2dd,0x29f,0x2f9,0x2cf)](function(){var _0x22ceac=function(_0xed1de6,_0xf01135,_0x48aa5a,_0x54ced8){return _0x3ecbe5(_0x54ced8- -0xf5,_0xf01135-0x8f,_0xf01135,_0x54ced8-0x7d);},_0xa3ffdf=function(_0x212679,_0x51e3e2,_0x1f1a17,_0x56d1ad){return _0x3ecbe5(_0x56d1ad- -0xf5,_0x51e3e2-0x9d,_0x51e3e2,_0x56d1ad-0x65);};if(_0x186c01[_0x22ceac(0x251,0x194,0x1a2,0x234)](_0x186c01['tPbeA'],_0x22ceac(0x207,0x2ad,0x256,0x288))){function _0x3c6111(){var _0x15e248=function(_0x243dec,_0x278dcc,_0xeba82b,_0x326a47){return _0x22ceac(_0x243dec-0x4f,_0x243dec,_0xeba82b-0x1ad,_0x278dcc-0x317);},_0x253905=function(_0x5c18b5,_0x363e7f,_0x41ab50,_0x11a45b){return _0xa3ffdf(_0x5c18b5-0x40,_0x5c18b5,_0x41ab50-0x1ec,_0x363e7f-0x317);};_0x10a012[_0x15e248(0x53a,0x56b,0x5ce,0x57b)]=-0xc97+-0x4c3+-0xd3*-0x16,_0x506de6['response']=_0x1f466a,_0x2af6b4[_0x253905(0x67e,0x5cc,0x655,0x630)](),_0x2b676b=_0x456df0=null;}}else console[_0x22ceac(0x2f0,0x395,0x31b,0x2fc)](_0xa3ffdf(0x332,0x30f,0x2b1,0x2b9)+_0x22ceac(0x2bc,0x1f1,0x19e,0x239),_0x343752[_0x22ceac(0x2c3,0x2b8,0x1ef,0x23c)]);});else{function _0x188266(){var _0x105c17=function(_0x52fc5d,_0x4e9d96,_0x270e64,_0x3db378){return _0x3ecbe5(_0x270e64-0x3b5,_0x4e9d96-0x112,_0x52fc5d,_0x3db378-0x12c);},_0x26e0c7=function(_0x53b934,_0x1360f9,_0x7920f3,_0x3b0d07){return _0x1cbb31(_0x7920f3-0x3b5,_0x1360f9-0x18,_0x53b934,_0x3b0d07-0x1da);};_0x1198c1[_0x105c17(0x84d,0x81c,0x7b8,0x70c)]=_0x355cea[_0x105c17(0x63a,0x71b,0x6d1,0x6e3)],_0x3f24ad[_0x26e0c7(0x667,0x674,0x6b8,0x708)]&&_0x34ee13[_0x105c17(0x704,0x6f0,0x6b8,0x6fd)]();}}});},'match':function(_0x18aa33,_0x4d3145){var _0x567ca4=function(_0x5e8760,_0x3bfe9e,_0x1f62bb,_0x41536f){return _0x14e3c4(_0x5e8760-0x31,_0x1f62bb-0x1ff,_0x1f62bb-0x1e2,_0x3bfe9e);},_0x181fc9=function(_0xf63e95,_0x2f36c1,_0x167a64,_0x4e2299){return _0x14e3c4(_0xf63e95-0x63,_0x167a64-0x1ff,_0x167a64-0x19a,_0x2f36c1);},_0x120dbf={};_0x120dbf[_0x567ca4(0x56e,0x526,0x5c2,0x5bb)]=function(_0x1db7b2){return _0x1db7b2();},_0x120dbf[_0x567ca4(0x627,0x632,0x61b,0x592)]=_0x567ca4(0x5af,0x663,0x5b5,0x66a)+'ngth',_0x120dbf[_0x567ca4(0x4a9,0x5c0,0x552,0x4aa)]=function(_0x2c5662,_0xd23da0){return _0x2c5662||_0xd23da0;},_0x120dbf[_0x567ca4(0x5df,0x63f,0x5aa,0x608)]=function(_0xf83cf,_0x79b412){return _0xf83cf!==_0x79b412;},_0x120dbf[_0x181fc9(0x645,0x551,0x5ce,0x62e)]=function(_0x43b738,_0xac6860){return _0x43b738&&_0xac6860;},_0x120dbf[_0x567ca4(0x57e,0x56b,0x621,0x6c5)]=_0x567ca4(0x59c,0x69f,0x603,0x55f),_0x120dbf[_0x181fc9(0x59b,0x4dc,0x597,0x50e)]=_0x567ca4(0x60e,0x632,0x595,0x4f3),_0x120dbf[_0x181fc9(0x4b2,0x4b5,0x515,0x49a)]=function(_0x57018e,_0x442582,_0x26a8ae){return _0x57018e(_0x442582,_0x26a8ae);},_0x120dbf['sHuoS']=_0x181fc9(0x54c,0x561,0x5ca,0x529),_0x120dbf['NDTLX']=_0x181fc9(0x592,0x55f,0x57f,0x555),_0x120dbf[_0x567ca4(0x5c7,0x591,0x5f0,0x542)]=_0x567ca4(0x5a2,0x573,0x5db,0x5c6),_0x120dbf[_0x181fc9(0x574,0x67e,0x5d3,0x5b3)]=function(_0xa0839c,_0x4bbb12){return _0xa0839c===_0x4bbb12;};var _0x374ca1=_0x120dbf;return _0x18aa33=SystemAnimator_caches[_0x567ca4(0x4ec,0x58b,0x4e7,0x49e)](_0x18aa33),new Promise(function(_0x885807,_0x2dd0c9){var _0x4660d7=function(_0x304590,_0x1f5540,_0x389716,_0x27f179){return _0x567ca4(_0x304590-0xd1,_0x304590,_0x389716-0x110,_0x27f179-0xde);},_0x1a0863=function(_0x44fc52,_0x32620b,_0xf22866,_0x6cce90){return _0x181fc9(_0x44fc52-0x9a,_0x44fc52,_0xf22866-0x110,_0x6cce90-0x1e5);},_0x18ccbb={};_0x18ccbb['kIPoP']=function(_0x49040b){return _0x374ca1['JtXDM'](_0x49040b);},_0x18ccbb[_0x4660d7(0x563,0x5af,0x602,0x5bc)]=function(_0x2e658a,_0x399587){return _0x2e658a(_0x399587);},_0x18ccbb['kguQm']=_0x374ca1[_0x1a0863(0x6bf,0x6e0,0x72b,0x6f4)],_0x18ccbb[_0x4660d7(0x6fb,0x6b6,0x653,0x6fb)]=function(_0x495173,_0x5026a2){return _0x374ca1['irXgL'](_0x495173,_0x5026a2);},_0x18ccbb['USAde']=function(_0x931c61,_0x57b7d3){var _0x318729=function(_0x4072fd,_0x251467,_0x4f6c78,_0x49b47f){return _0x1a0863(_0x4072fd,_0x251467-0x151,_0x251467-0x27f,_0x49b47f-0xa2);};return _0x374ca1[_0x318729(0x9e6,0x939,0x954,0x905)](_0x931c61,_0x57b7d3);},_0x18ccbb[_0x4660d7(0x740,0x756,0x743,0x71d)]='Enjxr',_0x18ccbb[_0x4660d7(0x645,0x6a0,0x621,0x675)]=function(_0x4846ac,_0x1fdbc6){var _0x56bbdd=function(_0x1d6cf4,_0x376fe,_0x3bcca8,_0x5bd7dc){return _0x4660d7(_0x376fe,_0x376fe-0x8e,_0x1d6cf4-0x190,_0x5bd7dc-0x75);};return _0x374ca1[_0x56bbdd(0x86e,0x903,0x821,0x7cc)](_0x4846ac,_0x1fdbc6);},_0x18ccbb[_0x4660d7(0x6c4,0x74a,0x740,0x693)]=_0x374ca1[_0x1a0863(0x774,0x73a,0x731,0x69e)],_0x18ccbb['ggoHd']=function(_0x1cbbcc,_0x3d358c){return _0x1cbbcc!==_0x3d358c;},_0x18ccbb[_0x1a0863(0x634,0x6ff,0x682,0x61f)]=_0x374ca1['drRuw'],_0x18ccbb[_0x4660d7(0x5de,0x673,0x60f,0x631)]=function(_0x22c5ca,_0x3f574e,_0x292736){return _0x374ca1['uiFMd'](_0x22c5ca,_0x3f574e,_0x292736);},_0x18ccbb[_0x1a0863(0x751,0x7a0,0x721,0x6c3)]=_0x374ca1[_0x4660d7(0x6f0,0x77f,0x732,0x724)],_0x18ccbb[_0x4660d7(0x7df,0x6cf,0x762,0x764)]=function(_0x19fb3b,_0xfa16b){var _0xb6b6a6=function(_0x467eda,_0x463252,_0x40e270,_0xca482e){return _0x4660d7(_0x40e270,_0x463252-0x189,_0x463252- -0x20e,_0xca482e-0xec);};return _0x374ca1[_0xb6b6a6(0x3fa,0x454,0x422,0x4b0)](_0x19fb3b,_0xfa16b);};var _0x13a459=_0x18ccbb;if(_0x374ca1[_0x4660d7(0x6ad,0x739,0x6ba,0x6d3)](_0x374ca1[_0x1a0863(0x770,0x76f,0x6ff,0x746)],_0x374ca1[_0x1a0863(0x75b,0x74c,0x700,0x79a)])){if(!SystemAnimator_caches['enabled']){if(_0x374ca1['FoQRd']('EqNox','EqNox')){setTimeout(function(){var _0x3d63d5=function(_0x3c344e,_0x40500f,_0x3b1a3,_0x6c65ed){return _0x4660d7(_0x6c65ed,_0x40500f-0x13d,_0x40500f-0xb5,_0x6c65ed-0x183);};_0x13a459[_0x3d63d5(0x68d,0x73c,0x6af,0x6a1)](_0x2dd0c9);},0x1b5a+0x1*0x72b+0x2285*-0x1);return;}else{function _0x22092c(){var _0x416b78=function(_0x3d1c4e,_0x4bf3c1,_0x15e954,_0x40b828){return _0x4660d7(_0x4bf3c1,_0x4bf3c1-0xbc,_0x40b828-0x154,_0x40b828-0x1e);},_0x329da3=function(_0x2c7bef,_0x2cba3f,_0x228b56,_0x38b7b0){return _0x4660d7(_0x2cba3f,_0x2cba3f-0x1ac,_0x38b7b0-0x154,_0x38b7b0-0x5e);};_0x13a459[_0x416b78(0x767,0x7fc,0x707,0x756)](_0x17ed16,_0x468412[_0x329da3(0x7f8,0x84f,0x7d8,0x829)]);}}}SystemAnimator_caches[_0x1a0863(0x663,0x6bb,0x610,0x6be)]()[_0x1a0863(0x592,0x571,0x61c,0x563)](function(_0x27600b){var _0x1611b0=function(_0x531c7e,_0x39f1e1,_0x51ca35,_0x182071){return _0x4660d7(_0x182071,_0x39f1e1-0x12b,_0x51ca35- -0x232,_0x182071-0x4b);},_0x278303=function(_0x16c648,_0x3fb731,_0x2b6281,_0x2c2fcd){return _0x4660d7(_0x2c2fcd,_0x3fb731-0x6c,_0x2b6281- -0x232,_0x2c2fcd-0xd1);},_0x46d1ff={};_0x46d1ff[_0x1611b0(0x397,0x413,0x406,0x40e)]=_0x13a459[_0x278303(0x498,0x435,0x41b,0x471)],_0x46d1ff[_0x278303(0x5a4,0x553,0x517,0x485)]=function(_0x49597c,_0x34bbc4){return _0x13a459['wgtIY'](_0x49597c,_0x34bbc4);},_0x46d1ff[_0x1611b0(0x372,0x444,0x3ee,0x38d)]=function(_0xb51a30,_0x4b83d9){return _0xb51a30==_0x4b83d9;},_0x46d1ff[_0x1611b0(0x582,0x448,0x4cb,0x560)]=function(_0x52ac7a,_0x2d93d6){var _0x516cef=function(_0x44177e,_0x2c3720,_0x2224f2,_0x506374){return _0x1611b0(_0x44177e-0x163,_0x2c3720-0xe5,_0x2224f2-0x1c9,_0x2c3720);};return _0x13a459[_0x516cef(0x4f8,0x53a,0x5a4,0x644)](_0x52ac7a,_0x2d93d6);},_0x46d1ff[_0x278303(0x496,0x585,0x514,0x549)]=_0x1611b0(0x47c,0x52d,0x490,0x3f3),_0x46d1ff[_0x278303(0x544,0x476,0x4d3,0x4bf)]=_0x13a459[_0x1611b0(0x52d,0x584,0x511,0x5bb)],_0x46d1ff[_0x278303(0x4b4,0x52b,0x4d4,0x542)]=function(_0x48a37a,_0x934533){var _0x159829=function(_0x2e9ef0,_0x2b9914,_0x25ce06,_0x15f087){return _0x278303(_0x2e9ef0-0x4c,_0x2b9914-0x11c,_0x2b9914-0x365,_0x2e9ef0);};return _0x13a459[_0x159829(0x740,0x754,0x7e6,0x774)](_0x48a37a,_0x934533);},_0x46d1ff['UjaOq']=_0x278303(0x49f,0x4d4,0x47f,0x4cb)+_0x278303(0x55e,0x476,0x4de,0x4de),_0x46d1ff[_0x278303(0x34d,0x454,0x400,0x4b9)]=_0x278303(0x462,0x457,0x47f,0x473)+_0x1611b0(0x53a,0x4c4,0x493,0x47c)+_0x1611b0(0x450,0x4ca,0x4cc,0x4d6),_0x46d1ff[_0x278303(0x5b2,0x568,0x4fc,0x5b3)]=function(_0x3974a2,_0x5f1a1b){return _0x3974a2(_0x5f1a1b);},_0x46d1ff[_0x1611b0(0x360,0x3c2,0x41a,0x3ca)]=function(_0x444551){return _0x444551();},_0x46d1ff['uMwvm']=_0x13a459['ghrkN'],_0x46d1ff['buMMg']=function(_0x4f19fd,_0x5810d7){var _0x36ef3e=function(_0xb64e31,_0x62390c,_0x4b7cdd,_0x319c4d){return _0x278303(_0xb64e31-0x6b,_0x62390c-0x197,_0xb64e31- -0x44,_0x62390c);};return _0x13a459[_0x36ef3e(0x4e3,0x46e,0x57e,0x44b)](_0x4f19fd,_0x5810d7);},_0x46d1ff[_0x278303(0x349,0x4a8,0x3f1,0x410)]=_0x13a459[_0x1611b0(0x4dc,0x42c,0x450,0x41d)],_0x46d1ff[_0x1611b0(0x594,0x544,0x504,0x468)]=function(_0x37e654,_0x43c16d,_0x3c452c){return _0x13a459['lBEQp'](_0x37e654,_0x43c16d,_0x3c452c);},_0x46d1ff[_0x1611b0(0x3af,0x462,0x411,0x3a1)]=_0x13a459[_0x1611b0(0x556,0x4a2,0x4ef,0x49d)];var _0x490eb0=_0x46d1ff,_0x260d85={};_0x260d85[_0x278303(0x3ea,0x4f6,0x454,0x3be)+'ch']=!![],_0x27600b['match'](_0x18aa33,_0x13a459['yPMCB'](_0x4d3145,_0x260d85))[_0x278303(0x429,0x34a,0x3ea,0x43e)](function(_0x49c5d9){var _0x304919=function(_0xbb722c,_0x14985c,_0x6f1337,_0x38e38d){return _0x278303(_0xbb722c-0x2f,_0x14985c-0x1f2,_0x38e38d- -0x20b,_0xbb722c);},_0x2a5070=function(_0x2c08e2,_0x167ae3,_0x571e46,_0x490bf6){return _0x1611b0(_0x2c08e2-0x1b8,_0x167ae3-0xa5,_0x490bf6- -0x20b,_0x2c08e2);},_0x18e067={};_0x18e067[_0x304919(0x275,0x18f,0x2b8,0x202)]=_0x2a5070(0x20f,0x345,0x227,0x2b0)+'ED:',_0x18e067[_0x304919(0x2b4,0x2e2,0x2f3,0x2e9)]=_0x490eb0[_0x304919(0x265,0x346,0x357,0x2e6)];var _0x49b251=_0x18e067;if(!_0x49c5d9){if(_0x490eb0[_0x2a5070(0x1f9,0x14b,0x239,0x1f2)](_0x490eb0[_0x2a5070(0x133,0x228,0x152,0x1e6)],_0x490eb0[_0x2a5070(0x145,0x15a,0x25f,0x1e6)])){function _0x57e57c(){var _0x4b3356=function(_0xf4efe2,_0x3e1f69,_0x1d6e33,_0x394a02){return _0x2a5070(_0x1d6e33,_0x3e1f69-0xe8,_0x1d6e33-0x1a4,_0xf4efe2- -0x208);};_0x156d67['put'](_0x475bf7,_0x35e3a4)[_0x4b3356(-0x29,-0x4f,0xc,-0xc4)](function(){var _0x509e2e=function(_0x21844d,_0x130b2f,_0x16c826,_0x12edac){return _0x4b3356(_0x21844d-0x3b9,_0x130b2f-0x13f,_0x12edac,_0x12edac-0x2e);},_0x2bbb79=function(_0x11df40,_0x1fde78,_0x20c512,_0x222d74){return _0x4b3356(_0x11df40-0x3b9,_0x1fde78-0x74,_0x222d74,_0x222d74-0xfb);};_0x301871[_0x509e2e(0x4a4,0x41b,0x4a7,0x54b)](_0x49b251[_0x2bbb79(0x3b3,0x388,0x45b,0x3bb)],_0x3c4845[_0x2bbb79(0x3e4,0x450,0x401,0x36f)]);});}}else{_0x490eb0['kPTtX'](_0x2dd0c9);return;}}if(/\/user\-defined\-local\//[_0x2a5070(0x323,0x271,0x226,0x27e)](_0x18aa33[_0x304919(0x1b1,0x25c,0x23a,0x233)])){_0x490eb0[_0x2a5070(0x374,0x246,0x2b0,0x2f1)](_0x885807,_0x49c5d9);return;}var _0x852198=_0x49c5d9[_0x2a5070(0x2c6,0x358,0x35c,0x2fe)]['get']('ETag'),_0x250b5f=_0x49c5d9[_0x304919(0x37e,0x378,0x388,0x2fe)]['get'](_0x2a5070(0x203,0x2e2,0x2f9,0x288)+'ngth');_0x490eb0[_0x2a5070(0x2a7,0x383,0x326,0x2f9)](fetch,SystemAnimator_caches[_0x2a5070(0x138,0x1bc,0x11d,0x1ba)](_0x49c5d9[_0x304919(0x2ab,0x17e,0x1c5,0x233)]),{'method':_0x490eb0[_0x2a5070(0x1d3,0x24e,0x235,0x206)]})[_0x304919(0x286,0x137,0x17b,0x1df)](function(_0x2410f8){var _0x149572=function(_0x4997c4,_0x32e115,_0x2ebf66,_0x2b39e2){return _0x2a5070(_0x2b39e2,_0x32e115-0xb9,_0x2ebf66-0x173,_0x2ebf66- -0x205);},_0x33d942=function(_0x19bec7,_0x39fe84,_0x3919eb,_0xcff9a0){return _0x304919(_0xcff9a0,_0x39fe84-0x1d4,_0x3919eb-0x1b4,_0x3919eb- -0x205);},_0xfdc4dc=_0x2410f8[_0x149572(0x129,0x3e,0xf9,0xc1)][_0x33d942(0x3b,-0x18,0x74,0x10b)](_0x33d942(0x27,0x1b,0x7c,0xb)),_0xf845b=_0x2410f8['headers'][_0x33d942(0x74,0xf8,0x74,-0x4)](_0x490eb0['sgpyv']),_0x4b10e6=!_0x852198||!_0xfdc4dc||/sao\.animetheme\.com/i['test'](window[_0x149572(0x28,-0x4c,0x57,0x4b)][_0x33d942(-0x8c,-0x9e,-0x9,-0xc4)]),_0x18b15f=_0x490eb0[_0x33d942(0x73,0x138,0x107,0x19f)](!_0x250b5f,!_0xf845b);if(!_0x4b10e6&&_0x490eb0['SzeCI'](_0xfdc4dc,_0x852198)||!_0x18b15f&&_0x490eb0[_0x33d942(0x2d,-0xb5,-0x22,-0x85)](_0xf845b,_0x250b5f)||_0x4b10e6&&_0x18b15f){if(_0x490eb0['DLcOz'](_0x490eb0[_0x33d942(0x160,0x14e,0x104,0xbb)],_0x490eb0[_0x149572(0x151,0x106,0xc3,0x41)])){if(_0x490eb0[_0x149572(0x33,0x16d,0xc4,0x171)](_0x4b10e6,_0x18b15f))console[_0x149572(0x10b,0xea,0xee,0x13f)](_0x490eb0[_0x149572(0xdb,0x99,0xf1,0x56)]);else{if(!_0x4b10e6)console[_0x149572(0x194,0xc7,0xee,0x3f)]('(match\x20by\x20'+_0x149572(0xb5,0x91,0xc6,0xe9));else console['log'](_0x490eb0[_0x149572(0x3d,0x99,-0x10,0x92)]);}_0x490eb0[_0x149572(0x70,0x98,0xec,0x1a3)](_0x885807,_0x49c5d9);}else{function _0x31a260(){var _0x3b6f3d=function(_0x391d2e,_0x20b43e,_0x4644cc,_0xa7eaf8){return _0x33d942(_0x391d2e-0x189,_0x20b43e-0x1b5,_0xa7eaf8-0x12d,_0x20b43e);},_0x9c6583=function(_0x43e97a,_0xd38562,_0x3a7a85,_0x58a522){return _0x149572(_0x43e97a-0xd,_0xd38562-0x1e3,_0x58a522-0x12d,_0xd38562);},_0x1a28ad={};_0x1a28ad[_0x3b6f3d(0x1fc,0x1f3,0x1d3,0x173)]=_0x5ea351['status'],_0x1a28ad[_0x9c6583(0x2cb,0x1b2,0x1c6,0x22d)]=_0x3e31a2['statusText'],_0x1a28ad['response']=_0x187773,_0x5f39d7=_0x1a28ad,_0x110735['log'](_0x49b251[_0x3b6f3d(0x1a4,0x221,0x25d,0x211)],_0x5a4163[_0x9c6583(0xcf,0x117,0x1c5,0x15b)]),_0x53c00c['call'](_0x5b7eb0);}}}else console[_0x33d942(0x17e,0x42,0xee,0x13c)](_0x33d942(0x28,0x129,0xc0,0x9c)+_0x149572(-0xc,0x2c,0x6e,0xb3),_0x49c5d9[_0x33d942(-0x52,0xe9,0x2e,0x3f)],_0x852198,_0xfdc4dc,_0x250b5f,_0xf845b),_0x490eb0[_0x33d942(0x12,0x6e,0xa,0x9e)](_0x2dd0c9);});});});}else{function _0x4dfd33(){var _0xab6c71=function(_0x553bb2,_0x56c51b,_0x37d2ea,_0x4b0ebe){return _0x4660d7(_0x37d2ea,_0x56c51b-0xa2,_0x4b0ebe-0xa5,_0x4b0ebe-0xaf);},_0x5e77ca=function(_0x5edbae,_0x2bd357,_0x223c41,_0x42632a){return _0x4660d7(_0x223c41,_0x2bd357-0x1da,_0x42632a-0xa5,_0x42632a-0x1ea);};this[_0xab6c71(0x6c0,0x609,0x740,0x6ac)]=_0x3555cb,this[_0x5e77ca(0x79f,0x773,0x670,0x715)]=_0x3816c4,this[_0x5e77ca(0x7e8,0x784,0x7f2,0x76c)]=!!_0x3b87c0;}}});},'delete':function(_0x28abaf,_0x4458a2){var _0x4c018d=function(_0x2914e9,_0x4e2d26,_0x55af18,_0x5634c9){return _0x14e3c4(_0x2914e9-0x17b,_0x4e2d26- -0x29a,_0x55af18-0x101,_0x2914e9);},_0x50289c=function(_0x230240,_0x390142,_0xd12df5,_0x3f0a8e){return _0x14e3c4(_0x230240-0x17d,_0x390142- -0x29a,_0xd12df5-0xcc,_0x230240);},_0x5cad8d={};_0x5cad8d[_0x4c018d(-0x14,0x65,0x1e,0x10f)]=function(_0x34f54a,_0x579ba7){return _0x34f54a(_0x579ba7);},_0x5cad8d[_0x4c018d(0x8a,0x13b,0x112,0x1ed)]=function(_0x1eaa98,_0x584f74){return _0x1eaa98===_0x584f74;},_0x5cad8d[_0x4c018d(0x17e,0xf7,0xf0,0x92)]=_0x4c018d(0x95,0x10a,0xbe,0x18a),_0x5cad8d['YgCBX']=function(_0x390c46,_0x105191){return _0x390c46||_0x105191;},_0x5cad8d['TsNZu']=function(_0x533e9f,_0x5809af){return _0x533e9f===_0x5809af;},_0x5cad8d[_0x50289c(0x15c,0x170,0x1b5,0x150)]=_0x4c018d(0x127,0x1a6,0x18e,0x1df);var _0x567d9f=_0x5cad8d;return new Promise(function(_0x5a7165){var _0x4fdf49=function(_0x2edd4e,_0x2d80b4,_0x54cc09,_0x3d501f){return _0x50289c(_0x3d501f,_0x2edd4e- -0x354,_0x54cc09-0x11f,_0x3d501f-0xd2);},_0x24c1ab=function(_0x916c4f,_0x27a824,_0xdaffef,_0x70e7b0){return _0x4c018d(_0x70e7b0,_0x916c4f- -0x354,_0xdaffef-0x141,_0x70e7b0-0x177);},_0x420489={};_0x420489[_0x4fdf49(-0x293,-0x229,-0x203,-0x287)]=function(_0x53aa18,_0x45aef8){var _0xf2c221=function(_0x20ab43,_0xea899f,_0x204c2f,_0x315f90){return _0x4fdf49(_0x20ab43-0x82,_0xea899f-0xe2,_0x204c2f-0xc5,_0x315f90);};return _0x567d9f[_0xf2c221(-0x251,-0x296,-0x1c8,-0x235)](_0x53aa18,_0x45aef8);},_0x420489[_0x24c1ab(-0x246,-0x276,-0x289,-0x2f1)]=_0x567d9f[_0x4fdf49(-0x1e4,-0x1ab,-0x245,-0x1a5)],_0x420489['tbDTs']=function(_0x3cb4ac,_0x161e43){var _0x534274=function(_0x80f4c2,_0x272d58,_0x13d122,_0xa07454){return _0x24c1ab(_0x272d58-0x42,_0x272d58-0xf0,_0x13d122-0x10a,_0x80f4c2);};return _0x567d9f[_0x534274(-0x2ae,-0x2ad,-0x228,-0x34e)](_0x3cb4ac,_0x161e43);};var _0x118fec=_0x420489;if(!SystemAnimator_caches[_0x4fdf49(-0x1a1,-0x1fe,-0x113,-0x259)])return;SystemAnimator_caches[_0x4fdf49(-0x2ed,-0x3a6,-0x268,-0x2fc)]()['then'](function(_0x159b99){var _0x15d370=function(_0x286e17,_0x372413,_0xae5271,_0x5718de){return _0x24c1ab(_0x286e17-0x397,_0x372413-0x16a,_0xae5271-0xac,_0x372413);},_0x21944f=function(_0x55abaf,_0x3ff3c3,_0x11a70f,_0x2a87df){return _0x4fdf49(_0x55abaf-0x397,_0x3ff3c3-0x19e,_0x11a70f-0xbc,_0x3ff3c3);},_0x5eac69={};_0x5eac69[_0x15d370(0x123,0x17a,0xc2,0x130)]=function(_0x4d44e1,_0x420790){return _0x567d9f['dbzGI'](_0x4d44e1,_0x420790);};var _0x39a4fc=_0x5eac69;if(_0x567d9f['EynUW'](_0x567d9f[_0x21944f(0x13a,0xff,0xe5,0x193)],'iTGQr')){var _0x27f139={};_0x27f139[_0x15d370(0x120,0x6a,0x86,0x194)+'ch']=!![],_0x159b99['delete'](_0x28abaf,_0x567d9f['YgCBX'](_0x4458a2,_0x27f139))[_0x21944f(0xb6,0x42,0x105,0x14d)](function(_0x3b9521){var _0x5a33f5=function(_0x1f6e8c,_0x576a79,_0x537dcb,_0x177e67){return _0x15d370(_0x537dcb- -0x242,_0x177e67,_0x537dcb-0x12c,_0x177e67-0x1ea);},_0x1f32dd=function(_0x48acb7,_0x2eaeb2,_0x3d4d8c,_0x374734){return _0x15d370(_0x3d4d8c- -0x242,_0x374734,_0x3d4d8c-0x1b8,_0x374734-0x112);};if(_0x118fec[_0x5a33f5(-0x1c0,-0x1b9,-0x13e,-0x1cf)](_0x118fec[_0x5a33f5(-0xa3,-0x4b,-0xf1,-0x197)],_0x118fec[_0x1f32dd(-0x4a,-0xa6,-0xf1,-0xd1)]))_0x118fec['tbDTs'](_0x5a7165,_0x3b9521);else{function _0x39faa2(){var _0x229b1b=function(_0x204a3a,_0x4afbda,_0x4e087,_0x4acd5f){return _0x1f32dd(_0x204a3a-0xfd,_0x4afbda-0xdd,_0x4afbda- -0x2e2,_0x4acd5f);};_0x39a4fc[_0x229b1b(-0x459,-0x401,-0x355,-0x36d)](_0x2802ba,_0x54c2a7);}}});}else{function _0x474d14(){var _0x40b222=function(_0x57dc01,_0x58fc8b,_0x16be30,_0x84664b){return _0x15d370(_0x84664b- -0x2ff,_0x58fc8b,_0x16be30-0x2c,_0x84664b-0x103);},_0x16f73f=function(_0x5bebec,_0x3694b3,_0x55d817,_0x24cf35){return _0x21944f(_0x24cf35- -0x2ff,_0x3694b3,_0x55d817-0x175,_0x24cf35-0x109);},_0x2f2a2c={};_0x2f2a2c[_0x40b222(-0x249,-0x165,-0x1cb,-0x204)]=_0x593046[_0x40b222(-0x129,-0xe0,-0x1b7,-0x159)][_0x40b222(-0x1b9,-0xd3,-0x12e,-0x11b)+'l'][_0x439dfe],_0x2f2a2c[_0x16f73f(-0x1a9,-0x11b,-0x16a,-0x14e)]=[],_0x23620e[_0x46185c]=_0x2f2a2c;}}});});}};
(function(d){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=d();else if("function"==typeof define&&define.amd)define([],d);else{var _;_="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,_.JSZip=d()}})(function(){return function x(z,S,C){function E(A,B){if(!S[A]){if(!z[A]){var R="function"==typeof require&&require;if(!B&&R)return R(A,!0);if(I)return I(A,!0);var T=new Error("Cannot find module '"+A+"'");throw T.code="MODULE_NOT_FOUND",T}var D=S[A]={exports:{}};z[A][0].call(D.exports,function(F){var N=z[A][1][F];return E(N?N:F)},D,D.exports,x,z,S,C)}return S[A].exports}for(var I="function"==typeof require&&require,O=0;O<C.length;O++)E(C[O]);return E}({1:[function(x,z,S){"use strict";var C=x("./utils"),E=x("./support"),I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";S.encode=function(O){for(var A=[],L=0,U=O.length,Z=U,W="string"!==C.getTypeOf(O),B,R,T,D,F,N,P;L<O.length;)Z=U-L,W?(B=O[L++],R=L<U?O[L++]:0,T=L<U?O[L++]:0):(B=O.charCodeAt(L++),R=L<U?O.charCodeAt(L++):0,T=L<U?O.charCodeAt(L++):0),D=B>>2,F=(3&B)<<4|R>>4,N=1<Z?(15&R)<<2|T>>6:64,P=2<Z?63&T:64,A.push(I.charAt(D)+I.charAt(F)+I.charAt(N)+I.charAt(P));return A.join("")},S.decode=function(O){var P=0,L=0,U="data:",A,B,R,T,D,F,N;if(O.substr(0,U.length)===U)throw new Error("Invalid base64 input, it looks like a data url.");O=O.replace(/[^A-Za-z0-9\+\/\=]/g,"");var Z=3*O.length/4;if(O.charAt(O.length-1)===I.charAt(64)&&Z--,O.charAt(O.length-2)===I.charAt(64)&&Z--,0!=Z%1)throw new Error("Invalid base64 input, bad content length.");var W;for(W=E.uint8array?new Uint8Array(0|Z):Array(0|Z);P<O.length;)T=I.indexOf(O.charAt(P++)),D=I.indexOf(O.charAt(P++)),F=I.indexOf(O.charAt(P++)),N=I.indexOf(O.charAt(P++)),A=T<<2|D>>4,B=(15&D)<<4|F>>2,R=(3&F)<<6|N,W[L++]=A,64!==F&&(W[L++]=B),64!==N&&(W[L++]=R);return W}},{"./support":30,"./utils":32}],2:[function(x,z){"use strict";function C(B,R,T,D,F){this.compressedSize=B,this.uncompressedSize=R,this.crc32=T,this.compression=D,this.compressedContent=F}var E=x("./external"),I=x("./stream/DataWorker"),O=x("./stream/DataLengthProbe"),A=x("./stream/Crc32Probe"),O=x("./stream/DataLengthProbe");C.prototype={getContentWorker:function(){var B=new I(E.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new O("data_length")),R=this;return B.on("end",function(){if(this.streamInfo.data_length!==R.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),B},getCompressedWorker:function(){return new I(E.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},C.createWorkerFrom=function(B,R,T){return B.pipe(new A).pipe(new O("uncompressedSize")).pipe(R.compressWorker(T)).pipe(new O("compressedSize")).withStreamInfo("compression",R)},z.exports=C},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(x,z,S){"use strict";var C=x("./stream/GenericWorker");S.STORE={magic:"\0\0",compressWorker:function(){return new C("STORE compression")},uncompressWorker:function(){return new C("STORE decompression")}},S.DEFLATE=x("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(x,z){"use strict";function E(B,R,T,D){B^=-1;for(var P=D;P<D+T;P++)B=B>>>8^A[255&(B^R[P])];return-1^B}function I(B,R,T,D){B^=-1;for(var P=D;P<D+T;P++)B=B>>>8^A[255&(B^R.charCodeAt(P))];return-1^B}var O=x("./utils"),A=function(){for(var R=[],T=0,B;256>T;T++){B=T;for(var D=0;8>D;D++)B=1&B?3988292384^B>>>1:B>>>1;R[T]=B}return R}();z.exports=function(R,T){if("undefined"==typeof R||!R.length)return 0;var D="string"!==O.getTypeOf(R);return D?E(0|T,R,R.length,0):I(0|T,R,R.length,0)}},{"./utils":32}],5:[function(x,z,S){"use strict";S.base64=!1,S.binary=!1,S.dir=!1,S.createFolders=!0,S.date=null,S.compression=null,S.compressionOptions=null,S.comment=null,S.unixPermissions=null,S.dosPermissions=null},{}],6:[function(x,z){"use strict";var C=null;C="undefined"==typeof Promise?x("lie"):Promise,z.exports={Promise:C}},{lie:37}],7:[function(x,z,S){"use strict";function C(R,T){A.call(this,"FlateWorker/"+R),this._pako=null,this._pakoAction=R,this._pakoOptions=T,this.meta={}}var E="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,I=x("pako"),O=x("./utils"),A=x("./stream/GenericWorker"),B=E?"uint8array":"array";S.magic="\b\0",O.inherits(C,A),C.prototype.processChunk=function(R){this.meta=R.meta,null===this._pako&&this._createPako(),this._pako.push(O.transformTo(B,R.data),!1)},C.prototype.flush=function(){A.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},C.prototype.cleanUp=function(){A.prototype.cleanUp.call(this),this._pako=null},C.prototype._createPako=function(){this._pako=new I[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var R=this;this._pako.onData=function(T){R.push({data:T,meta:R.meta})}},S.compressWorker=function(R){return new C("Deflate",R)},S.uncompressWorker=function(){return new C("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(x,z){"use strict";function C(L,U,Z,W){I.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=U,this.zipPlatform=Z,this.encodeFileName=W,this.streamFiles=L,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}var E=x("../utils"),I=x("../stream/GenericWorker"),O=x("../utf8"),A=x("../crc32"),B=x("../signature"),R=function(L,U){var Z="",W;for(W=0;W<U;W++)Z+=String.fromCharCode(255&L),L>>>=8;return Z},T=function(L,U){var Z=L;return L||(Z=U?16893:33204),(65535&Z)<<16},D=function(L){return 63&(L||0)},F=function(L,U,Z,W,M,H){var G=L.file,K=L.compression,Y=H!==O.utf8encode,X=E.transformTo("string",H(G.name)),V=E.transformTo("string",O.utf8encode(G.name)),J=G.comment,Q=E.transformTo("string",H(J)),$=E.transformTo("string",O.utf8encode(J)),ee=V.length!==G.name.length,te=$.length!==J.length,ne="",se="",ie="",oe=G.dir,de=G.date,re,ae,le={crc32:0,compressedSize:0,uncompressedSize:0};(!U||Z)&&(le.crc32=L.crc32,le.compressedSize=L.compressedSize,le.uncompressedSize=L.uncompressedSize);var ue=0;U&&(ue|=8),!Y&&(ee||te)&&(ue|=2048);var pe=0,ce=0;oe&&(pe|=16),"UNIX"===M?(ce=798,pe|=T(G.unixPermissions,oe)):(ce=20,pe|=D(G.dosPermissions,oe)),re=de.getUTCHours(),re<<=6,re|=de.getUTCMinutes(),re<<=5,re|=de.getUTCSeconds()/2,ae=de.getUTCFullYear()-1980,ae<<=4,ae|=de.getUTCMonth()+1,ae<<=5,ae|=de.getUTCDate(),ee&&(se=R(1,1)+R(A(X),4)+V,ne+="up"+R(se.length,2)+se),te&&(ie=R(1,1)+R(A(Q),4)+$,ne+="uc"+R(ie.length,2)+ie);var he="";he+="\n\0",he+=R(ue,2),he+=K.magic,he+=R(re,2),he+=R(ae,2),he+=R(le.crc32,4),he+=R(le.compressedSize,4),he+=R(le.uncompressedSize,4),he+=R(X.length,2),he+=R(ne.length,2);var fe=B.LOCAL_FILE_HEADER+he+X+ne,_e=B.CENTRAL_FILE_HEADER+R(ce,2)+he+R(Q.length,2)+"\0\0\0\0"+R(pe,4)+R(W,4)+X+ne+Q;return{fileRecord:fe,dirRecord:_e}},N=function(L,U,Z,W,M){var H="",G=E.transformTo("string",M(W));return H=B.CENTRAL_DIRECTORY_END+"\0\0\0\0"+R(L,2)+R(L,2)+R(U,4)+R(Z,4)+R(G.length,2)+G,H},P=function(L){var U="";return U=B.DATA_DESCRIPTOR+R(L.crc32,4)+R(L.compressedSize,4)+R(L.uncompressedSize,4),U};E.inherits(C,I),C.prototype.push=function(L){var U=L.meta.percent||0,Z=this.entriesCount,W=this._sources.length;this.accumulate?this.contentBuffer.push(L):(this.bytesWritten+=L.data.length,I.prototype.push.call(this,{data:L.data,meta:{currentFile:this.currentFile,percent:Z?(U+100*(Z-W-1))/Z:100}}))},C.prototype.openedSource=function(L){this.currentSourceOffset=this.bytesWritten,this.currentFile=L.file.name;var U=this.streamFiles&&!L.file.dir;if(U){var Z=F(L,U,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:Z.fileRecord,meta:{percent:0}})}else this.accumulate=!0},C.prototype.closedSource=function(L){this.accumulate=!1;var U=this.streamFiles&&!L.file.dir,Z=F(L,U,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(Z.dirRecord),U)this.push({data:P(L),meta:{percent:100}});else for(this.push({data:Z.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},C.prototype.flush=function(){for(var L=this.bytesWritten,U=0;U<this.dirRecords.length;U++)this.push({data:this.dirRecords[U],meta:{percent:100}});var Z=this.bytesWritten-L,W=N(this.dirRecords.length,Z,L,this.zipComment,this.encodeFileName);this.push({data:W,meta:{percent:100}})},C.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},C.prototype.registerPrevious=function(L){this._sources.push(L);var U=this;return L.on("data",function(Z){U.processChunk(Z)}),L.on("end",function(){U.closedSource(U.previous.streamInfo),U._sources.length?U.prepareNextSource():U.end()}),L.on("error",function(Z){U.error(Z)}),this},C.prototype.resume=function(){return!!I.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},C.prototype.error=function(L){var U=this._sources;if(!I.prototype.error.call(this,L))return!1;for(var Z=0;Z<U.length;Z++)try{U[Z].error(L)}catch(W){}return!0},C.prototype.lock=function(){I.prototype.lock.call(this);for(var L=this._sources,U=0;U<L.length;U++)L[U].lock()},z.exports=C},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(x,z,S){"use strict";var C=x("../compressions"),E=x("./ZipFileWorker"),I=function(O,A){var B=O||A,R=C[B];if(!R)throw new Error(B+" is not a valid compression method !");return R};S.generateWorker=function(O,A,B){var R=new E(A.streamFiles,B,A.platform,A.encodeFileName),T=0;try{O.forEach(function(D,F){T++;var N=I(F.options.compression,A.compression),P=F.options.compressionOptions||A.compressionOptions||{},L=F.dir,U=F.date;F._compressWorker(N,P).withStreamInfo("file",{name:D,dir:L,date:U,comment:F.comment||"",unixPermissions:F.unixPermissions,dosPermissions:F.dosPermissions}).pipe(R)}),R.entriesCount=T}catch(D){R.error(D)}return R}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(x,z){"use strict";function C(){if(!(this instanceof C))return new C;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var E=new C;for(var I in this)"function"!=typeof this[I]&&(E[I]=this[I]);return E}}C.prototype=x("./object"),C.prototype.loadAsync=x("./load"),C.support=x("./support"),C.defaults=x("./defaults"),C.version="3.5.0",C.loadAsync=function(E,I){return new C().loadAsync(E,I)},C.external=x("./external"),z.exports=C},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(x,z){"use strict";function C(T){return new I.Promise(function(D,F){var N=T.decompressed.getContentWorker().pipe(new B);N.on("error",function(P){F(P)}).on("end",function(){N.streamInfo.crc32===T.decompressed.crc32?D():F(new Error("Corrupted zip : CRC32 mismatch"))}).resume()})}var E=x("./utils"),I=x("./external"),O=x("./utf8"),E=x("./utils"),A=x("./zipEntries"),B=x("./stream/Crc32Probe"),R=x("./nodejsUtils");z.exports=function(T,D){var F=this;return D=E.extend(D||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:O.utf8decode}),R.isNode&&R.isStream(T)?I.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):E.prepareContent("the loaded zip file",T,!0,D.optimizedBinaryString,D.base64).then(function(N){var P=new A(D);return P.load(N),P}).then(function(P){var L=[I.Promise.resolve(P)],U=P.files;if(D.checkCRC32)for(var Z=0;Z<U.length;Z++)L.push(C(U[Z]));return I.Promise.all(L)}).then(function(P){for(var L=P.shift(),U=L.files,Z=0,W;Z<U.length;Z++)W=U[Z],F.file(W.fileNameStr,W.decompressed,{binary:!0,optimizedBinaryString:!0,date:W.date,dir:W.dir,comment:W.fileCommentStr.length?W.fileCommentStr:null,unixPermissions:W.unixPermissions,dosPermissions:W.dosPermissions,createFolders:D.createFolders});return L.zipComment.length&&(F.comment=L.zipComment),F})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(x,z){"use strict";function C(O,A){I.call(this,"Nodejs stream input adapter for "+O),this._upstreamEnded=!1,this._bindStream(A)}var E=x("../utils"),I=x("../stream/GenericWorker");E.inherits(C,I),C.prototype._bindStream=function(O){var A=this;this._stream=O,O.pause(),O.on("data",function(B){A.push({data:B,meta:{percent:0}})}).on("error",function(B){A.isPaused?this.generatedError=B:A.error(B)}).on("end",function(){A.isPaused?A._upstreamEnded=!0:A.end()})},C.prototype.pause=function(){return!!I.prototype.pause.call(this)&&(this._stream.pause(),!0)},C.prototype.resume=function(){return!!I.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},z.exports=C},{"../stream/GenericWorker":28,"../utils":32}],13:[function(x,z){"use strict";function C(O,A,B){E.call(this,A),this._helper=O;var R=this;O.on("data",function(T,D){R.push(T)||R._helper.pause(),B&&B(D)}).on("error",function(T){R.emit("error",T)}).on("end",function(){R.push(null)})}var E=x("readable-stream").Readable,I=x("../utils");I.inherits(C,E),C.prototype._read=function(){this._helper.resume()},z.exports=C},{"../utils":32,"readable-stream":16}],14:[function(x,z){"use strict";z.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(C,E){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(C,E);if("number"==typeof C)throw new Error("The \"data\" argument must not be a number");return new Buffer(C,E)},allocBuffer:function(C){if(Buffer.alloc)return Buffer.alloc(C);var E=new Buffer(C);return E.fill(0),E},isBuffer:function(C){return Buffer.isBuffer(C)},isStream:function(C){return C&&"function"==typeof C.on&&"function"==typeof C.pause&&"function"==typeof C.resume}}},{}],15:[function(x,z){"use strict";function C(M){return"[object RegExp]"===Object.prototype.toString.call(M)}var E=x("./utf8"),I=x("./utils"),O=x("./stream/GenericWorker"),A=x("./stream/StreamHelper"),B=x("./defaults"),R=x("./compressedObject"),T=x("./zipObject"),D=x("./generate"),F=x("./nodejsUtils"),N=x("./nodejs/NodejsStreamInputAdapter"),P=function(M,H,G){var K=I.getTypeOf(H),Y,X=I.extend(G||{},B);X.date=X.date||new Date,null!==X.compression&&(X.compression=X.compression.toUpperCase()),"string"==typeof X.unixPermissions&&(X.unixPermissions=parseInt(X.unixPermissions,8)),X.unixPermissions&&16384&X.unixPermissions&&(X.dir=!0),X.dosPermissions&&16&X.dosPermissions&&(X.dir=!0),X.dir&&(M=U(M)),X.createFolders&&(Y=L(M))&&Z.call(this,Y,!0);var V="string"===K&&!1===X.binary&&!1===X.base64;G&&"undefined"!=typeof G.binary||(X.binary=!V);var J=H instanceof R&&0===H.uncompressedSize;(J||X.dir||!H||0===H.length)&&(X.base64=!1,X.binary=!0,H="",X.compression="STORE",K="string");var Q=null;Q=H instanceof R||H instanceof O?H:F.isNode&&F.isStream(H)?new N(M,H):I.prepareContent(M,H,X.binary,X.optimizedBinaryString,X.base64);var $=new T(M,Q,X);this.files[M]=$},L=function(M){"/"===M.slice(-1)&&(M=M.substring(0,M.length-1));var H=M.lastIndexOf("/");return 0<H?M.substring(0,H):""},U=function(M){return"/"!==M.slice(-1)&&(M+="/"),M},Z=function(M,H){return H="undefined"==typeof H?B.createFolders:H,M=U(M),this.files[M]||P.call(this,M,null,{dir:!0,createFolders:H}),this.files[M]};z.exports={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(M){var H,G,K;for(H in this.files)this.files.hasOwnProperty(H)&&(K=this.files[H],G=H.slice(this.root.length,H.length),G&&H.slice(0,this.root.length)===this.root&&M(G,K))},filter:function(M){var H=[];return this.forEach(function(G,K){M(G,K)&&H.push(K)}),H},file:function(M,H,G){if(1===arguments.length){if(C(M)){var K=M;return this.filter(function(X,V){return!V.dir&&K.test(X)})}var Y=this.files[this.root+M];return Y&&!Y.dir?Y:null}return M=this.root+M,P.call(this,M,H,G),this},folder:function(M){if(!M)return this;if(C(M))return this.filter(function(Y,X){return X.dir&&M.test(Y)});var H=this.root+M,G=Z.call(this,H),K=this.clone();return K.root=G.name,K},remove:function(M){M=this.root+M;var H=this.files[M];if(H||("/"!==M.slice(-1)&&(M+="/"),H=this.files[M]),H&&!H.dir)delete this.files[M];else for(var G=this.filter(function(Y,X){return X.name.slice(0,M.length)===M}),K=0;K<G.length;K++)delete this.files[G[K].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(M){var G={},H;try{if(G=I.extend(M||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:E.utf8encode}),G.type=G.type.toLowerCase(),G.compression=G.compression.toUpperCase(),"binarystring"===G.type&&(G.type="string"),!G.type)throw new Error("No output type specified.");I.checkSupport(G.type),("darwin"===G.platform||"freebsd"===G.platform||"linux"===G.platform||"sunos"===G.platform)&&(G.platform="UNIX"),"win32"===G.platform&&(G.platform="DOS");var K=G.comment||this.comment||"";H=D.generateWorker(this,G,K)}catch(Y){H=new O("error"),H.error(Y)}return new A(H,G.type||"string",G.mimeType)},generateAsync:function(M,H){return this.generateInternalStream(M).accumulate(H)},generateNodeStream:function(M,H){return M=M||{},M.type||(M.type="nodebuffer"),this.generateInternalStream(M).toNodejsStream(H)}}},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(x,z){z.exports=x("stream")},{stream:void 0}],17:[function(x,z){"use strict";function C(O){E.call(this,O);for(var A=0;A<this.data.length;A++)O[A]&=255}var E=x("./DataReader"),I=x("../utils");I.inherits(C,E),C.prototype.byteAt=function(O){return this.data[this.zero+O]},C.prototype.lastIndexOfSignature=function(O){for(var A=O.charCodeAt(0),B=O.charCodeAt(1),R=O.charCodeAt(2),T=O.charCodeAt(3),D=this.length-4;0<=D;--D)if(this.data[D]===A&&this.data[D+1]===B&&this.data[D+2]===R&&this.data[D+3]===T)return D-this.zero;return-1},C.prototype.readAndCheckSignature=function(O){var A=O.charCodeAt(0),B=O.charCodeAt(1),R=O.charCodeAt(2),T=O.charCodeAt(3),D=this.readData(4);return A===D[0]&&B===D[1]&&R===D[2]&&T===D[3]},C.prototype.readData=function(O){if(this.checkOffset(O),0===O)return[];var A=this.data.slice(this.zero+this.index,this.zero+this.index+O);return this.index+=O,A},z.exports=C},{"../utils":32,"./DataReader":18}],18:[function(x,z){"use strict";function C(I){this.data=I,this.length=I.length,this.index=0,this.zero=0}var E=x("../utils");C.prototype={checkOffset:function(I){this.checkIndex(this.index+I)},checkIndex:function(I){if(this.length<this.zero+I||0>I)throw new Error("End of data reached (data length = "+this.length+", asked index = "+I+"). Corrupted zip ?")},setIndex:function(I){this.checkIndex(I),this.index=I},skip:function(I){this.setIndex(this.index+I)},byteAt:function(){},readInt:function(I){var O=0,A;for(this.checkOffset(I),A=this.index+I-1;A>=this.index;A--)O=(O<<8)+this.byteAt(A);return this.index+=I,O},readString:function(I){return E.transformTo("string",this.readData(I))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var I=this.readInt(4);return new Date(Date.UTC((127&I>>25)+1980,(15&I>>21)-1,31&I>>16,31&I>>11,63&I>>5,(31&I)<<1))}},z.exports=C},{"../utils":32}],19:[function(x,z){"use strict";function C(O){E.call(this,O)}var E=x("./Uint8ArrayReader"),I=x("../utils");I.inherits(C,E),C.prototype.readData=function(O){this.checkOffset(O);var A=this.data.slice(this.zero+this.index,this.zero+this.index+O);return this.index+=O,A},z.exports=C},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(x,z){"use strict";function C(O){E.call(this,O)}var E=x("./DataReader"),I=x("../utils");I.inherits(C,E),C.prototype.byteAt=function(O){return this.data.charCodeAt(this.zero+O)},C.prototype.lastIndexOfSignature=function(O){return this.data.lastIndexOf(O)-this.zero},C.prototype.readAndCheckSignature=function(O){var A=this.readData(4);return O===A},C.prototype.readData=function(O){this.checkOffset(O);var A=this.data.slice(this.zero+this.index,this.zero+this.index+O);return this.index+=O,A},z.exports=C},{"../utils":32,"./DataReader":18}],21:[function(x,z){"use strict";function C(O){E.call(this,O)}var E=x("./ArrayReader"),I=x("../utils");I.inherits(C,E),C.prototype.readData=function(O){if(this.checkOffset(O),0===O)return new Uint8Array(0);var A=this.data.subarray(this.zero+this.index,this.zero+this.index+O);return this.index+=O,A},z.exports=C},{"../utils":32,"./ArrayReader":17}],22:[function(x,z){"use strict";var C=x("../utils"),E=x("../support"),I=x("./ArrayReader"),O=x("./StringReader"),A=x("./NodeBufferReader"),B=x("./Uint8ArrayReader");z.exports=function(R){var T=C.getTypeOf(R);return C.checkSupport(T),"string"!==T||E.uint8array?"nodebuffer"===T?new A(R):E.uint8array?new B(C.transformTo("uint8array",R)):new I(C.transformTo("array",R)):new O(R)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(x,z,S){"use strict";S.LOCAL_FILE_HEADER="PK\x03\x04",S.CENTRAL_FILE_HEADER="PK\x01\x02",S.CENTRAL_DIRECTORY_END="PK\x05\x06",S.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",S.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",S.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(x,z){"use strict";function C(O){E.call(this,"ConvertWorker to "+O),this.destType=O}var E=x("./GenericWorker"),I=x("../utils");I.inherits(C,E),C.prototype.processChunk=function(O){this.push({data:I.transformTo(this.destType,O.data),meta:O.meta})},z.exports=C},{"../utils":32,"./GenericWorker":28}],25:[function(x,z){"use strict";function C(){E.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}var E=x("./GenericWorker"),I=x("../crc32"),O=x("../utils");O.inherits(C,E),C.prototype.processChunk=function(A){this.streamInfo.crc32=I(A.data,this.streamInfo.crc32||0),this.push(A)},z.exports=C},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(x,z){"use strict";function C(O){I.call(this,"DataLengthProbe for "+O),this.propName=O,this.withStreamInfo(O,0)}var E=x("../utils"),I=x("./GenericWorker");E.inherits(C,I),C.prototype.processChunk=function(O){if(O){var A=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=A+O.data.length}I.prototype.processChunk.call(this,O)},z.exports=C},{"../utils":32,"./GenericWorker":28}],27:[function(x,z){"use strict";function C(A){I.call(this,"DataWorker");var B=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,A.then(function(R){B.dataIsReady=!0,B.data=R,B.max=R&&R.length||0,B.type=E.getTypeOf(R),B.isPaused||B._tickAndRepeat()},function(R){B.error(R)})}var E=x("../utils"),I=x("./GenericWorker");E.inherits(C,I),C.prototype.cleanUp=function(){I.prototype.cleanUp.call(this),this.data=null},C.prototype.resume=function(){return!!I.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,E.delay(this._tickAndRepeat,[],this)),!0)},C.prototype._tickAndRepeat=function(){this._tickScheduled=!1;this.isPaused||this.isFinished||(this._tick(),!this.isFinished&&(E.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},C.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var B=null,R=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":B=this.data.substring(this.index,R);break;case"uint8array":B=this.data.subarray(this.index,R);break;case"array":case"nodebuffer":B=this.data.slice(this.index,R);}return this.index=R,this.push({data:B,meta:{percent:this.max?100*(this.index/this.max):0}})},z.exports=C},{"../utils":32,"./GenericWorker":28}],28:[function(x,z){"use strict";function C(E){this.name=E||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}C.prototype={push:function(E){this.emit("data",E)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(E){this.emit("error",E)}return!0},error:function(E){return!this.isFinished&&(this.isPaused?this.generatedError=E:(this.isFinished=!0,this.emit("error",E),this.previous&&this.previous.error(E),this.cleanUp()),!0)},on:function(E,I){return this._listeners[E].push(I),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(E,I){if(this._listeners[E])for(var O=0;O<this._listeners[E].length;O++)this._listeners[E][O].call(this,I)},pipe:function(E){return E.registerPrevious(this)},registerPrevious:function(E){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=E.streamInfo,this.mergeStreamInfo(),this.previous=E;var I=this;return E.on("data",function(O){I.processChunk(O)}),E.on("end",function(){I.end()}),E.on("error",function(O){I.error(O)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var E=!1;return this.generatedError&&(this.error(this.generatedError),E=!0),this.previous&&this.previous.resume(),!E},flush:function(){},processChunk:function(E){this.push(E)},withStreamInfo:function(E,I){return this.extraStreamInfo[E]=I,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var E in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(E)&&(this.streamInfo[E]=this.extraStreamInfo[E])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var E="Worker "+this.name;return this.previous?this.previous+" -> "+E:E}},z.exports=C},{}],29:[function(x,z){"use strict";function C(P,L,U){return"blob"===P?A.newBlob(A.transformTo("arraybuffer",L),U):"base64"===P?T.encode(L):A.transformTo(P,L)}function E(P,L){var Z=0,W=null,M=0,U;for(U=0;U<L.length;U++)M+=L[U].length;switch(P){case"string":return L.join("");case"array":return Array.prototype.concat.apply([],L);case"uint8array":for(W=new Uint8Array(M),U=0;U<L.length;U++)W.set(L[U],Z),Z+=L[U].length;return W;case"nodebuffer":return Buffer.concat(L);default:throw new Error("concat : unsupported type '"+P+"'");}}function I(P,L){return new F.Promise(function(U,Z){var W=[],M=P._internalType,H=P._outputType,G=P._mimeType;P.on("data",function(K,Y){W.push(K),L&&L(Y)}).on("error",function(K){W=[],Z(K)}).on("end",function(){try{var K=C(H,E(M,W),G);U(K)}catch(Y){Z(Y)}W=[]}).resume()})}function O(P,L,U){var Z=L;"blob"===L||"arraybuffer"===L?Z="uint8array":"base64"===L?Z="string":void 0;try{this._internalType=Z,this._outputType=L,this._mimeType=U,A.checkSupport(Z),this._worker=P.pipe(new B(Z)),P.lock()}catch(W){this._worker=new R("error"),this._worker.error(W)}}var A=x("../utils"),B=x("./ConvertWorker"),R=x("./GenericWorker"),T=x("../base64"),D=x("../support"),F=x("../external"),N=null;if(D.nodestream)try{N=x("../nodejs/NodejsStreamOutputAdapter")}catch(P){}O.prototype={accumulate:function(P){return I(this,P)},on:function(P,L){var U=this;return"data"===P?this._worker.on(P,function(Z){L.call(U,Z.data,Z.meta)}):this._worker.on(P,function(){A.delay(L,arguments,U)}),this},resume:function(){return A.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(P){if(A.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new N(this,{objectMode:"nodebuffer"!==this._outputType},P)}},z.exports=O},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(x,z,S){"use strict";if(S.base64=!0,S.array=!0,S.string=!0,S.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,S.nodebuffer="undefined"!=typeof Buffer,S.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)S.blob=!1;else{var C=new ArrayBuffer(0);try{S.blob=0===new Blob([C],{type:"application/zip"}).size}catch(O){try{var E=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,I=new E;I.append(C),S.blob=0===I.getBlob("application/zip").size}catch(A){S.blob=!1}}}try{S.nodestream=!!x("readable-stream").Readable}catch(O){S.nodestream=!1}},{"readable-stream":16}],31:[function(x,z,S){"use strict";function C(){B.call(this,"utf-8 decode"),this.leftOver=null}function E(){B.call(this,"utf-8 encode")}for(var I=x("./utils"),O=x("./support"),A=x("./nodejsUtils"),B=x("./stream/GenericWorker"),R=Array(256),T=0;256>T;T++)R[T]=252<=T?6:248<=T?5:240<=T?4:224<=T?3:192<=T?2:1;R[254]=R[254]=1;var D=function(P){var H=P.length,G=0,L,U,Z,W,M;for(W=0;W<H;W++)U=P.charCodeAt(W),55296==(64512&U)&&W+1<H&&(Z=P.charCodeAt(W+1),56320==(64512&Z)&&(U=65536+(U-55296<<10)+(Z-56320),W++)),G+=128>U?1:2048>U?2:65536>U?3:4;for(L=O.uint8array?new Uint8Array(G):Array(G),M=0,W=0;M<G;W++)U=P.charCodeAt(W),55296==(64512&U)&&W+1<H&&(Z=P.charCodeAt(W+1),56320==(64512&Z)&&(U=65536+(U-55296<<10)+(Z-56320),W++)),128>U?L[M++]=U:2048>U?(L[M++]=192|U>>>6,L[M++]=128|63&U):65536>U?(L[M++]=224|U>>>12,L[M++]=128|63&U>>>6,L[M++]=128|63&U):(L[M++]=240|U>>>18,L[M++]=128|63&U>>>12,L[M++]=128|63&U>>>6,L[M++]=128|63&U);return L},F=function(P,L){var U;for(L=L||P.length,L>P.length&&(L=P.length),U=L-1;0<=U&&128==(192&P[U]);)U--;return 0>U?L:0===U?L:U+R[P[U]]>L?U:L},N=function(P){var H=P.length,G=Array(2*H),U,Z,W,M;for(Z=0,U=0;U<H;){if(W=P[U++],128>W){G[Z++]=W;continue}if(M=R[W],4<M){G[Z++]=65533,U+=M-1;continue}for(W&=2===M?31:3===M?15:7;1<M&&U<H;)W=W<<6|63&P[U++],M--;if(1<M){G[Z++]=65533;continue}65536>W?G[Z++]=W:(W-=65536,G[Z++]=55296|1023&W>>10,G[Z++]=56320|1023&W)}return G.length!==Z&&(G.subarray?G=G.subarray(0,Z):G.length=Z),I.applyFromCharCode(G)};S.utf8encode=function(L){return O.nodebuffer?A.newBufferFrom(L,"utf-8"):D(L)},S.utf8decode=function(L){return O.nodebuffer?I.transformTo("nodebuffer",L).toString("utf-8"):(L=I.transformTo(O.uint8array?"uint8array":"array",L),N(L))},I.inherits(C,B),C.prototype.processChunk=function(P){var L=I.transformTo(O.uint8array?"uint8array":"array",P.data);if(this.leftOver&&this.leftOver.length){if(O.uint8array){var U=L;L=new Uint8Array(U.length+this.leftOver.length),L.set(this.leftOver,0),L.set(U,this.leftOver.length)}else L=this.leftOver.concat(L);this.leftOver=null}var Z=F(L),W=L;Z!==L.length&&(O.uint8array?(W=L.subarray(0,Z),this.leftOver=L.subarray(Z,L.length)):(W=L.slice(0,Z),this.leftOver=L.slice(Z,L.length))),this.push({data:S.utf8decode(W),meta:P.meta})},C.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:S.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},S.Utf8DecodeWorker=C,I.inherits(E,B),E.prototype.processChunk=function(P){this.push({data:S.utf8encode(P.data),meta:P.meta})},S.Utf8EncodeWorker=E},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(x,z,S){"use strict";function C(L){var U=null;return U=B.uint8array?new Uint8Array(L.length):Array(L.length),I(L,U)}function E(L){return L}function I(L,U){for(var Z=0;Z<L.length;++Z)U[Z]=255&L.charCodeAt(Z);return U}function O(L){var U=65536,Z=S.getTypeOf(L),W=!0;if("uint8array"===Z?W=N.applyCanBeUsed.uint8array:"nodebuffer"===Z&&(W=N.applyCanBeUsed.nodebuffer),W)for(;1<U;)try{return N.stringifyByChunk(L,Z,U)}catch(M){U=Math.floor(U/2)}return N.stringifyByChar(L)}function A(L,U){for(var Z=0;Z<L.length;Z++)U[Z]=L[Z];return U}var B=x("./support"),R=x("./base64"),T=x("./nodejsUtils"),D=x("set-immediate-shim"),F=x("./external");S.newBlob=function(L,U){S.checkSupport("blob");try{return new Blob([L],{type:U})}catch(M){try{var Z=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,W=new Z;return W.append(L),W.getBlob(U)}catch(H){throw new Error("Bug : can't construct the Blob.")}}};var N={stringifyByChunk:function(L,U,Z){var W=[],M=0,H=L.length;if(H<=Z)return String.fromCharCode.apply(null,L);for(;M<H;)"array"===U||"nodebuffer"===U?W.push(String.fromCharCode.apply(null,L.slice(M,Math.min(M+Z,H)))):W.push(String.fromCharCode.apply(null,L.subarray(M,Math.min(M+Z,H)))),M+=Z;return W.join("")},stringifyByChar:function(L){for(var U="",Z=0;Z<L.length;Z++)U+=String.fromCharCode(L[Z]);return U},applyCanBeUsed:{uint8array:function(){try{return B.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(L){return!1}}(),nodebuffer:function(){try{return B.nodebuffer&&1===String.fromCharCode.apply(null,T.allocBuffer(1)).length}catch(L){return!1}}()}};S.applyFromCharCode=O;var P={};P.string={string:E,array:function(L){return I(L,Array(L.length))},arraybuffer:function(L){return P.string.uint8array(L).buffer},uint8array:function(L){return I(L,new Uint8Array(L.length))},nodebuffer:function(L){return I(L,T.allocBuffer(L.length))}},P.array={string:O,array:E,arraybuffer:function(L){return new Uint8Array(L).buffer},uint8array:function(L){return new Uint8Array(L)},nodebuffer:function(L){return T.newBufferFrom(L)}},P.arraybuffer={string:function(L){return O(new Uint8Array(L))},array:function(L){return A(new Uint8Array(L),Array(L.byteLength))},arraybuffer:E,uint8array:function(L){return new Uint8Array(L)},nodebuffer:function(L){return T.newBufferFrom(new Uint8Array(L))}},P.uint8array={string:O,array:function(L){return A(L,Array(L.length))},arraybuffer:function(L){return L.buffer},uint8array:E,nodebuffer:function(L){return T.newBufferFrom(L)}},P.nodebuffer={string:O,array:function(L){return A(L,Array(L.length))},arraybuffer:function(L){return P.nodebuffer.uint8array(L).buffer},uint8array:function(L){return A(L,new Uint8Array(L.length))},nodebuffer:E},S.transformTo=function(L,U){if(U||(U=""),!L)return U;S.checkSupport(L);var Z=S.getTypeOf(U),W=P[Z][L](U);return W},S.getTypeOf=function(L){return"string"==typeof L?"string":"[object Array]"===Object.prototype.toString.call(L)?"array":B.nodebuffer&&T.isBuffer(L)?"nodebuffer":B.uint8array&&L instanceof Uint8Array?"uint8array":B.arraybuffer&&L instanceof ArrayBuffer?"arraybuffer":void 0},S.checkSupport=function(L){var U=B[L.toLowerCase()];if(!U)throw new Error(L+" is not supported by this platform")},S.MAX_VALUE_16BITS=65535,S.MAX_VALUE_32BITS=-1,S.pretty=function(L){var U="",Z,W;for(W=0;W<(L||"").length;W++)Z=L.charCodeAt(W),U+="\\x"+(16>Z?"0":"")+Z.toString(16).toUpperCase();return U},S.delay=function(){var L=webkit_electron_mode?U=>{setTimeout(U,0)}:D;return function(U,Z,W){L(function(){U.apply(W||null,Z||[])})}}(),S.inherits=function(L,U){var Z=function(){};Z.prototype=U.prototype,L.prototype=new Z},S.extend=function(){var L={},U,Z;for(U=0;U<arguments.length;U++)for(Z in arguments[U])arguments[U].hasOwnProperty(Z)&&"undefined"==typeof L[Z]&&(L[Z]=arguments[U][Z]);return L},S.prepareContent=function(L,U,Z,W,M){var H=F.Promise.resolve(U).then(function(G){var K=B.blob&&(G instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(G)));return K&&"undefined"!=typeof FileReader?new F.Promise(function(Y,X){var V=new FileReader;V.onload=function(J){Y(J.target.result)},V.onerror=function(J){X(J.target.error)},V.readAsArrayBuffer(G)}):G});return H.then(function(G){var K=S.getTypeOf(G);return K?("arraybuffer"===K?G=S.transformTo("uint8array",G):"string"===K&&(M?G=R.decode(G):Z&&!0!==W&&(G=C(G))),G):F.Promise.reject(new Error("Can't read the data of '"+L+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(x,z){"use strict";function C(T){this.files=[],this.loadOptions=T}var E=x("./reader/readerFor"),I=x("./utils"),O=x("./signature"),A=x("./zipEntry"),B=x("./utf8"),R=x("./support");C.prototype={checkSignature:function(T){if(!this.reader.readAndCheckSignature(T)){this.reader.index-=4;var D=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+I.pretty(D)+", expected "+I.pretty(T)+")")}},isSignature:function(T,D){var F=this.reader.index;this.reader.setIndex(T);var N=this.reader.readString(4);return this.reader.setIndex(F),N===D},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var T=this.reader.readData(this.zipCommentLength),D=R.uint8array?"uint8array":"array",F=I.transformTo(D,T);this.zipComment=this.loadOptions.decodeFileName(F)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var T=this.zip64EndOfCentralSize-44,F,N,P;0<T;)F=this.reader.readInt(2),N=this.reader.readInt(4),P=this.reader.readData(N),this.zip64ExtensibleData[F]={id:F,length:N,value:P}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var T,D;for(T=0;T<this.files.length;T++)D=this.files[T],this.reader.setIndex(D.localHeaderOffset),this.checkSignature(O.LOCAL_FILE_HEADER),D.readLocalPart(this.reader),D.handleUTF8(),D.processAttributes()},readCentralDir:function(){var T;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(O.CENTRAL_FILE_HEADER);)T=new A({zip64:this.zip64},this.loadOptions),T.readCentralPart(this.reader),this.files.push(T);if(this.centralDirRecords!==this.files.length)if(0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length);else;},readEndOfCentral:function(){var T=this.reader.lastIndexOfSignature(O.CENTRAL_DIRECTORY_END);if(0>T){var D=!this.isSignature(0,O.LOCAL_FILE_HEADER);if(D)throw new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");else throw new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(T);var F=T;if(this.checkSignature(O.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===I.MAX_VALUE_16BITS||this.diskWithCentralDirStart===I.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===I.MAX_VALUE_16BITS||this.centralDirRecords===I.MAX_VALUE_16BITS||this.centralDirSize===I.MAX_VALUE_32BITS||this.centralDirOffset===I.MAX_VALUE_32BITS){if(this.zip64=!0,T=this.reader.lastIndexOfSignature(O.ZIP64_CENTRAL_DIRECTORY_LOCATOR),0>T)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(T),this.checkSignature(O.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,O.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(O.ZIP64_CENTRAL_DIRECTORY_END),0>this.relativeOffsetEndOfZip64CentralDir))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(O.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var N=this.centralDirOffset+this.centralDirSize;this.zip64&&(N+=20,N+=12+this.zip64EndOfCentralSize);var P=F-N;if(0<P)this.isSignature(F,O.CENTRAL_FILE_HEADER)||(this.reader.zero=P);else if(0>P)throw new Error("Corrupted zip: missing "+Math.abs(P)+" bytes.")},prepareReader:function(T){this.reader=E(T)},load:function(T){this.prepareReader(T),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},z.exports=C},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(x,z){"use strict";function C(P,L){this.options=P,this.loadOptions=L}var E=x("./reader/readerFor"),I=x("./utils"),O=x("./compressedObject"),A=x("./crc32"),B=x("./utf8"),R=x("./compressions"),T=x("./support"),N=function(P){for(var L in R)if(R.hasOwnProperty(L)&&R[L].magic===P)return R[L];return null};C.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(P){var L,U;if(P.skip(22),this.fileNameLength=P.readInt(2),U=P.readInt(2),this.fileName=P.readData(this.fileNameLength),P.skip(U),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(L=N(this.compressionMethod),null===L)throw new Error("Corrupted zip : compression "+I.pretty(this.compressionMethod)+" unknown (inner file : "+I.transformTo("string",this.fileName)+")");this.decompressed=new O(this.compressedSize,this.uncompressedSize,this.crc32,L,P.readData(this.compressedSize))},readCentralPart:function(P){this.versionMadeBy=P.readInt(2),P.skip(2),this.bitFlag=P.readInt(2),this.compressionMethod=P.readString(2),this.date=P.readDate(),this.crc32=P.readInt(4),this.compressedSize=P.readInt(4),this.uncompressedSize=P.readInt(4);var L=P.readInt(2);if(this.extraFieldsLength=P.readInt(2),this.fileCommentLength=P.readInt(2),this.diskNumberStart=P.readInt(2),this.internalFileAttributes=P.readInt(2),this.externalFileAttributes=P.readInt(4),this.localHeaderOffset=P.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");P.skip(L),this.readExtraFields(P),this.parseZIP64ExtraField(P),this.fileComment=P.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var P=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),P==0&&(this.dosPermissions=63&this.externalFileAttributes),P==3&&(this.unixPermissions=65535&this.externalFileAttributes>>16),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var L=E(this.extraFields[1].value);this.uncompressedSize===I.MAX_VALUE_32BITS&&(this.uncompressedSize=L.readInt(8)),this.compressedSize===I.MAX_VALUE_32BITS&&(this.compressedSize=L.readInt(8)),this.localHeaderOffset===I.MAX_VALUE_32BITS&&(this.localHeaderOffset=L.readInt(8)),this.diskNumberStart===I.MAX_VALUE_32BITS&&(this.diskNumberStart=L.readInt(4))}},readExtraFields:function(P){var L=P.index+this.extraFieldsLength,U,Z,W;for(this.extraFields||(this.extraFields={});P.index+4<L;)U=P.readInt(2),Z=P.readInt(2),W=P.readData(Z),this.extraFields[U]={id:U,length:Z,value:W};P.setIndex(L)},handleUTF8:function(){var P=T.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=B.utf8decode(this.fileName),this.fileCommentStr=B.utf8decode(this.fileComment);else{var L=this.findExtraFieldUnicodePath();if(null!==L)this.fileNameStr=L;else{var U=I.transformTo(P,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(U)}var Z=this.findExtraFieldUnicodeComment();if(null!==Z)this.fileCommentStr=Z;else{var W=I.transformTo(P,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(W)}}},findExtraFieldUnicodePath:function(){var P=this.extraFields[28789];if(P){var L=E(P.value);return 1===L.readInt(1)?A(this.fileName)===L.readInt(4)?B.utf8decode(L.readData(P.length-5)):null:null}return null},findExtraFieldUnicodeComment:function(){var P=this.extraFields[25461];if(P){var L=E(P.value);return 1===L.readInt(1)?A(this.fileComment)===L.readInt(4)?B.utf8decode(L.readData(P.length-5)):null:null}return null}},z.exports=C},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(x,z){"use strict";var C=x("./stream/StreamHelper"),E=x("./stream/DataWorker"),I=x("./utf8"),O=x("./compressedObject"),A=x("./stream/GenericWorker"),B=function(F,N,P){this.name=F,this.dir=P.dir,this.date=P.date,this.comment=P.comment,this.unixPermissions=P.unixPermissions,this.dosPermissions=P.dosPermissions,this._data=N,this._dataBinary=P.binary,this.options={compression:P.compression,compressionOptions:P.compressionOptions}};B.prototype={internalStream:function(F){var N=null,P="string";try{if(!F)throw new Error("No output type specified.");P=F.toLowerCase();var L="string"==P||"text"==P;("binarystring"==P||"text"==P)&&(P="string"),N=this._decompressWorker();var U=!this._dataBinary;U&&!L&&(N=N.pipe(new I.Utf8EncodeWorker)),!U&&L&&(N=N.pipe(new I.Utf8DecodeWorker))}catch(Z){N=new A("error"),N.error(Z)}return new C(N,P,"")},async:function(F,N){return this.internalStream(F).accumulate(N)},nodeStream:function(F,N){return this.internalStream(F||"nodebuffer").toNodejsStream(N)},_compressWorker:function(F,N){if(this._data instanceof O&&this._data.compression.magic===F.magic)return this._data.getCompressedWorker();var P=this._decompressWorker();return this._dataBinary||(P=P.pipe(new I.Utf8EncodeWorker)),O.createWorkerFrom(P,F,N)},_decompressWorker:function(){return this._data instanceof O?this._data.getContentWorker():this._data instanceof A?this._data:new E(this._data)}};for(var R=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],T=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},D=0;D<R.length;D++)B.prototype[R[D]]=T;z.exports=B},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(x,z){(function(C){"use strict";function E(){F=!0;for(var U=N.length,P,L;U;){for(L=N,N=[],P=-1;++P<U;)L[P]();U=N.length}F=!1}var O=C.MutationObserver||C.WebKitMutationObserver,A;if(O){var B=0,R=new O(E),T=C.document.createTextNode("");R.observe(T,{characterData:!0}),A=function(){T.data=B=++B%2}}else if(!C.setImmediate&&"undefined"!=typeof C.MessageChannel){var D=new C.MessageChannel;D.port1.onmessage=E,A=function(){D.port2.postMessage(0)}}else A="document"in C&&"onreadystatechange"in C.document.createElement("script")?function(){var P=C.document.createElement("script");P.onreadystatechange=function(){E(),P.onreadystatechange=null,P.parentNode.removeChild(P),P=null},C.document.documentElement.appendChild(P)}:function(){setTimeout(E,0)};var F,N=[];z.exports=function(P){1!==N.push(P)||F||A()}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],37:[function(x,z){"use strict";function C(){}function E(M){if("function"!=typeof M)throw new TypeError("resolver must be a function");this.state=W,this.queue=[],this.outcome=void 0,M!==C&&B(this,M)}function I(M,H,G){this.promise=M,"function"==typeof H&&(this.onFulfilled=H,this.callFulfilled=this.otherCallFulfilled),"function"==typeof G&&(this.onRejected=G,this.callRejected=this.otherCallRejected)}function O(M,H,G){P(function(){var K;try{K=H(G)}catch(Y){return L.reject(M,Y)}K===M?L.reject(M,new TypeError("Cannot resolve promise with itself")):L.resolve(M,K)})}function A(M){var H=M&&M.then;if(M&&("object"==typeof M||"function"==typeof M)&&"function"==typeof H)return function(){H.apply(M,arguments)}}function B(M,H){function G(J){X||(X=!0,L.reject(M,J))}function K(J){X||(X=!0,L.resolve(M,J))}var X=!1,V=R(function(){H(K,G)});"error"===V.status&&G(V.value)}function R(M,H){var G={};try{G.value=M(H),G.status="success"}catch(K){G.status="error",G.value=K}return G}var P=x("immediate"),L={},U=["REJECTED"],Z=["FULFILLED"],W=["PENDING"];z.exports=E,E.prototype["finally"]=function(M){if("function"!=typeof M)return this;var K=this.constructor;return this.then(function(Y){return K.resolve(M()).then(function(){return Y})},function(Y){return K.resolve(M()).then(function(){throw Y})})},E.prototype["catch"]=function(M){return this.then(null,M)},E.prototype.then=function(M,H){if("function"!=typeof M&&this.state===Z||"function"!=typeof H&&this.state===U)return this;var G=new this.constructor(C);if(this.state!==W){var K=this.state===Z?M:H;O(G,K,this.outcome)}else this.queue.push(new I(G,M,H));return G},I.prototype.callFulfilled=function(M){L.resolve(this.promise,M)},I.prototype.otherCallFulfilled=function(M){O(this.promise,this.onFulfilled,M)},I.prototype.callRejected=function(M){L.reject(this.promise,M)},I.prototype.otherCallRejected=function(M){O(this.promise,this.onRejected,M)},L.resolve=function(M,H){var G=R(A,H);if("error"===G.status)return L.reject(M,G.value);var K=G.value;if(K)B(M,K);else{M.state=Z,M.outcome=H;for(var Y=-1,X=M.queue.length;++Y<X;)M.queue[Y].callFulfilled(H)}return M},L.reject=function(M,H){M.state=U,M.outcome=H;for(var G=-1,K=M.queue.length;++G<K;)M.queue[G].callRejected(H);return M},E.resolve=function(M){return M instanceof this?M:L.resolve(new this(C),M)},E.reject=function(M){var H=new this(C);return L.reject(H,M)},E.all=function(M){function H($,ee){G.resolve($).then(function(re){X[ee]=re,++V!==K||Y||(Y=!0,L.resolve(Q,X))},function(re){Y||(Y=!0,L.reject(Q,re))})}var G=this;if("[object Array]"!==Object.prototype.toString.call(M))return this.reject(new TypeError("must be an array"));var K=M.length,Y=!1;if(!K)return this.resolve([]);for(var X=Array(K),V=0,J=-1,Q=new this(C);++J<K;)H(M[J],J);return Q},E.race=function(M){function H(J){G.resolve(J).then(function(Q){Y||(Y=!0,L.resolve(V,Q))},function(Q){Y||(Y=!0,L.reject(V,Q))})}var G=this;if("[object Array]"!==Object.prototype.toString.call(M))return this.reject(new TypeError("must be an array"));var K=M.length,Y=!1;if(!K)return this.resolve([]);for(var X=-1,V=new this(C);++X<K;)H(M[X]);return V}},{immediate:36}],38:[function(x,z){"use strict";var C=x("./lib/utils/common").assign,E=x("./lib/deflate"),I=x("./lib/inflate"),O=x("./lib/zlib/constants"),A={};C(A,E,I,O),z.exports=A},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(x,z,S){"use strict";function C(G){if(!(this instanceof C))return new C(G);this.options=B.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},G||{});var K=this.options;K.raw&&0<K.windowBits?K.windowBits=-K.windowBits:K.gzip&&0<K.windowBits&&16>K.windowBits&&(K.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D,this.strm.avail_out=0;var Y=A.deflateInit2(this.strm,K.level,K.method,K.windowBits,K.memLevel,K.strategy);if(Y!==L)throw new Error(T[Y]);if(K.header&&A.deflateSetHeader(this.strm,K.header),K.dictionary){var X;if(X="string"==typeof K.dictionary?R.string2buf(K.dictionary):"[object ArrayBuffer]"===F.call(K.dictionary)?new Uint8Array(K.dictionary):K.dictionary,Y=A.deflateSetDictionary(this.strm,X),Y!==L)throw new Error(T[Y]);this._dict_set=!0}}function E(G,K){var Y=new C(K);if(Y.push(G,!0),Y.err)throw Y.msg||T[Y.err];return Y.result}var A=x("./zlib/deflate"),B=x("./utils/common"),R=x("./utils/strings"),T=x("./zlib/messages"),D=x("./zlib/zstream"),F=Object.prototype.toString,P=4,L=0,U=1,Z=2;C.prototype.push=function(G,K){var Y=this.strm,X=this.options.chunkSize,V,J;if(this.ended)return!1;J=K===~~K?K:!0===K?P:0,Y.input="string"==typeof G?R.string2buf(G):"[object ArrayBuffer]"===F.call(G)?new Uint8Array(G):G,Y.next_in=0,Y.avail_in=Y.input.length;do{if(0===Y.avail_out&&(Y.output=new B.Buf8(X),Y.next_out=0,Y.avail_out=X),V=A.deflate(Y,J),V!==U&&V!==L)return this.onEnd(V),this.ended=!0,!1;(0===Y.avail_out||0===Y.avail_in&&(J===P||J===Z))&&("string"===this.options.to?this.onData(R.buf2binstring(B.shrinkBuf(Y.output,Y.next_out))):this.onData(B.shrinkBuf(Y.output,Y.next_out)))}while((0<Y.avail_in||0===Y.avail_out)&&V!==U);return J===P?(V=A.deflateEnd(this.strm),this.onEnd(V),this.ended=!0,V===L):J!==Z||(this.onEnd(L),Y.avail_out=0,!0)},C.prototype.onData=function(G){this.chunks.push(G)},C.prototype.onEnd=function(G){G===L&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=B.flattenChunks(this.chunks)),this.chunks=[],this.err=G,this.msg=this.strm.msg},S.Deflate=C,S.deflate=E,S.deflateRaw=function(G,K){return K=K||{},K.raw=!0,E(G,K)},S.gzip=function(G,K){return K=K||{},K.gzip=!0,E(G,K)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(x,z,S){"use strict";function C(P){if(!(this instanceof C))return new C(P);this.options=A.assign({chunkSize:16384,windowBits:0,to:""},P||{});var L=this.options;L.raw&&0<=L.windowBits&&16>L.windowBits&&(L.windowBits=-L.windowBits,0===L.windowBits&&(L.windowBits=-15)),0<=L.windowBits&&16>L.windowBits&&!(P&&P.windowBits)&&(L.windowBits+=32),15<L.windowBits&&48>L.windowBits&&0==(15&L.windowBits)&&(L.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D,this.strm.avail_out=0;var U=O.inflateInit2(this.strm,L.windowBits);if(U!==R.Z_OK)throw new Error(T[U]);this.header=new F,O.inflateGetHeader(this.strm,this.header)}function E(P,L){var U=new C(L);if(U.push(P,!0),U.err)throw U.msg||T[U.err];return U.result}var O=x("./zlib/inflate"),A=x("./utils/common"),B=x("./utils/strings"),R=x("./zlib/constants"),T=x("./zlib/messages"),D=x("./zlib/zstream"),F=x("./zlib/gzheader"),N=Object.prototype.toString;C.prototype.push=function(P,L){var U=this.strm,Z=this.options.chunkSize,W=this.options.dictionary,V=!1,M,H,G,K,Y,X;if(this.ended)return!1;H=L===~~L?L:!0===L?R.Z_FINISH:R.Z_NO_FLUSH,U.input="string"==typeof P?B.binstring2buf(P):"[object ArrayBuffer]"===N.call(P)?new Uint8Array(P):P,U.next_in=0,U.avail_in=U.input.length;do{if(0===U.avail_out&&(U.output=new A.Buf8(Z),U.next_out=0,U.avail_out=Z),M=O.inflate(U,R.Z_NO_FLUSH),M===R.Z_NEED_DICT&&W&&(X="string"==typeof W?B.string2buf(W):"[object ArrayBuffer]"===N.call(W)?new Uint8Array(W):W,M=O.inflateSetDictionary(this.strm,X)),M===R.Z_BUF_ERROR&&!0==V&&(M=R.Z_OK,V=!1),M!==R.Z_STREAM_END&&M!==R.Z_OK)return this.onEnd(M),this.ended=!0,!1;U.next_out&&(0===U.avail_out||M===R.Z_STREAM_END||0===U.avail_in&&(H===R.Z_FINISH||H===R.Z_SYNC_FLUSH))&&("string"===this.options.to?(G=B.utf8border(U.output,U.next_out),K=U.next_out-G,Y=B.buf2string(U.output,G),U.next_out=K,U.avail_out=Z-K,K&&A.arraySet(U.output,U.output,G,K,0),this.onData(Y)):this.onData(A.shrinkBuf(U.output,U.next_out))),0===U.avail_in&&0===U.avail_out&&(V=!0)}while((0<U.avail_in||0===U.avail_out)&&M!==R.Z_STREAM_END);return M===R.Z_STREAM_END&&(H=R.Z_FINISH),H===R.Z_FINISH?(M=O.inflateEnd(this.strm),this.onEnd(M),this.ended=!0,M===R.Z_OK):H!==R.Z_SYNC_FLUSH||(this.onEnd(R.Z_OK),U.avail_out=0,!0)},C.prototype.onData=function(P){this.chunks.push(P)},C.prototype.onEnd=function(P){P===R.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=A.flattenChunks(this.chunks)),this.chunks=[],this.err=P,this.msg=this.strm.msg},S.Inflate=C,S.inflate=E,S.inflateRaw=function(P,L){return L=L||{},L.raw=!0,E(P,L)},S.ungzip=E},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(x,z,S){"use strict";var C="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;S.assign=function(O){for(var A=Array.prototype.slice.call(arguments,1),B;A.length;)if(B=A.shift(),!!B){if("object"!=typeof B)throw new TypeError(B+"must be non-object");for(var R in B)B.hasOwnProperty(R)&&(O[R]=B[R])}return O},S.shrinkBuf=function(O,A){return O.length===A?O:O.subarray?O.subarray(0,A):(O.length=A,O)};var E={arraySet:function(O,A,B,R,T){if(A.subarray&&O.subarray)return void O.set(A.subarray(B,B+R),T);for(var D=0;D<R;D++)O[T+D]=A[B+D]},flattenChunks:function(O){var A,B,R,T,D,F;for(R=0,A=0,B=O.length;A<B;A++)R+=O[A].length;for(F=new Uint8Array(R),T=0,(A=0,B=O.length);A<B;A++)D=O[A],F.set(D,T),T+=D.length;return F}},I={arraySet:function(O,A,B,R,T){for(var D=0;D<R;D++)O[T+D]=A[B+D]},flattenChunks:function(O){return[].concat.apply([],O)}};S.setTyped=function(O){O?(S.Buf8=Uint8Array,S.Buf16=Uint16Array,S.Buf32=Int32Array,S.assign(S,E)):(S.Buf8=Array,S.Buf16=Array,S.Buf32=Array,S.assign(S,I))},S.setTyped(C)},{}],42:[function(x,z,S){"use strict";function C(R,T){if(65537>T&&(R.subarray&&O||!R.subarray&&I))return String.fromCharCode.apply(null,E.shrinkBuf(R,T));for(var D="",F=0;F<T;F++)D+=String.fromCharCode(R[F]);return D}var E=x("./common"),I=!0,O=!0;try{String.fromCharCode.apply(null,[0])}catch(R){I=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(R){O=!1}for(var A=new E.Buf8(256),B=0;256>B;B++)A[B]=252<=B?6:248<=B?5:240<=B?4:224<=B?3:192<=B?2:1;A[254]=A[254]=1,S.string2buf=function(R){var L=R.length,U=0,T,D,F,N,P;for(N=0;N<L;N++)D=R.charCodeAt(N),55296==(64512&D)&&N+1<L&&(F=R.charCodeAt(N+1),56320==(64512&F)&&(D=65536+(D-55296<<10)+(F-56320),N++)),U+=128>D?1:2048>D?2:65536>D?3:4;for(T=new E.Buf8(U),P=0,N=0;P<U;N++)D=R.charCodeAt(N),55296==(64512&D)&&N+1<L&&(F=R.charCodeAt(N+1),56320==(64512&F)&&(D=65536+(D-55296<<10)+(F-56320),N++)),128>D?T[P++]=D:2048>D?(T[P++]=192|D>>>6,T[P++]=128|63&D):65536>D?(T[P++]=224|D>>>12,T[P++]=128|63&D>>>6,T[P++]=128|63&D):(T[P++]=240|D>>>18,T[P++]=128|63&D>>>12,T[P++]=128|63&D>>>6,T[P++]=128|63&D);return T},S.buf2binstring=function(R){return C(R,R.length)},S.binstring2buf=function(R){for(var T=new E.Buf8(R.length),D=0,F=T.length;D<F;D++)T[D]=R.charCodeAt(D);return T},S.buf2string=function(R,T){var D,F,N,P,L=T||R.length,U=Array(2*L);for(F=0,D=0;D<L;){if(N=R[D++],128>N){U[F++]=N;continue}if(P=A[N],4<P){U[F++]=65533,D+=P-1;continue}for(N&=2===P?31:3===P?15:7;1<P&&D<L;)N=N<<6|63&R[D++],P--;if(1<P){U[F++]=65533;continue}65536>N?U[F++]=N:(N-=65536,U[F++]=55296|1023&N>>10,U[F++]=56320|1023&N)}return C(U,F)},S.utf8border=function(R,T){var D;for(T=T||R.length,T>R.length&&(T=R.length),D=T-1;0<=D&&128==(192&R[D]);)D--;return 0>D?T:0===D?T:D+A[R[D]]>T?D:T}},{"./common":41}],43:[function(x,z){"use strict";z.exports=function(E,I,O,A){for(var B=0|65535&E,R=0|65535&E>>>16,T=0;0!==O;){T=2e3<O?2e3:O,O-=T;do B=0|B+I[A++],R=0|R+B;while(--T);B%=65521,R%=65521}return 0|(B|R<<16)}},{}],44:[function(x,z){"use strict";z.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(x,z){"use strict";var I=function(){for(var A=[],B=0,O;256>B;B++){O=B;for(var R=0;8>R;R++)O=1&O?3988292384^O>>>1:O>>>1;A[B]=O}return A}();z.exports=function(O,A,B,R){O^=-1;for(var F=R;F<R+B;F++)O=O>>>8^I[255&(O^A[F])];return-1^O}},{}],46:[function(x,z,S){"use strict";function C(qe,Qe){return qe.msg=ne[Qe],Qe}function E(qe){return(qe<<1)-(4<qe?9:0)}function I(qe){for(var Qe=qe.length;0<=--Qe;)qe[Qe]=0}function O(qe){var Qe=qe.state,$e=Qe.pending;$e>qe.avail_out&&($e=qe.avail_out);0===$e||(ee.arraySet(qe.output,Qe.pending_buf,Qe.pending_out,$e,qe.next_out),qe.next_out+=$e,Qe.pending_out+=$e,qe.total_out+=$e,qe.avail_out-=$e,Qe.pending-=$e,0===Qe.pending&&(Qe.pending_out=0))}function A(qe,Qe){te._tr_flush_block(qe,0<=qe.block_start?qe.block_start:-1,qe.strstart-qe.block_start,Qe),qe.block_start=qe.strstart,O(qe.strm)}function B(qe,Qe){qe.pending_buf[qe.pending++]=Qe}function R(qe,Qe){qe.pending_buf[qe.pending++]=255&Qe>>>8,qe.pending_buf[qe.pending++]=255&Qe}function T(qe,Qe,$e,et){var tt=qe.avail_in;return(tt>et&&(tt=et),0===tt)?0:(qe.avail_in-=tt,ee.arraySet(Qe,qe.input,qe.next_in,tt,$e),1===qe.state.wrap?qe.adler=re(qe.adler,Qe,tt,$e):2===qe.state.wrap&&(qe.adler=ae(qe.adler,Qe,tt,$e)),qe.next_in+=tt,qe.total_in+=tt,tt)}function D(qe,Qe){var $e=qe.max_chain_length,et=qe.strstart,tt,rt,at=qe.prev_length,nt=qe.nice_match,st=qe.strstart>qe.w_size-Ne?qe.strstart-(qe.w_size-Ne):0,it=qe.window,ot=qe.w_mask,dt=qe.prev,lt=qe.strstart+Fe,ut=it[et+at-1],pt=it[et+at];qe.prev_length>=qe.good_match&&($e>>=2),nt>qe.lookahead&&(nt=qe.lookahead);do{if(tt=Qe,it[tt+at]!==pt||it[tt+at-1]!==ut||it[tt]!==it[et]||it[++tt]!==it[et+1])continue;et+=2,tt++;do;while(it[++et]===it[++tt]&&it[++et]===it[++tt]&&it[++et]===it[++tt]&&it[++et]===it[++tt]&&it[++et]===it[++tt]&&it[++et]===it[++tt]&&it[++et]===it[++tt]&&it[++et]===it[++tt]&&et<lt);if(rt=Fe-(lt-et),et=lt-Fe,rt>at){if(qe.match_start=Qe,at=rt,rt>=nt)break;ut=it[et+at-1],pt=it[et+at]}}while((Qe=dt[Qe&ot])>st&&0!=--$e);return at<=qe.lookahead?at:qe.lookahead}function F(qe){var Qe=qe.w_size,$e,et,tt,rt,at;do{if(rt=qe.window_size-qe.lookahead-qe.strstart,qe.strstart>=Qe+(Qe-Ne)){ee.arraySet(qe.window,qe.window,Qe,Qe,0),qe.match_start-=Qe,qe.strstart-=Qe,qe.block_start-=Qe,et=qe.hash_size,$e=et;do tt=qe.head[--$e],qe.head[$e]=tt>=Qe?tt-Qe:0;while(--et);et=Qe,$e=et;do tt=qe.prev[--$e],qe.prev[$e]=tt>=Qe?tt-Qe:0;while(--et);rt+=Qe}if(0===qe.strm.avail_in)break;if(et=T(qe.strm,qe.window,qe.strstart+qe.lookahead,rt),qe.lookahead+=et,qe.lookahead+qe.insert>=De)for(at=qe.strstart-qe.insert,qe.ins_h=qe.window[at],qe.ins_h=(qe.ins_h<<qe.hash_shift^qe.window[at+1])&qe.hash_mask;qe.insert&&(qe.ins_h=(qe.ins_h<<qe.hash_shift^qe.window[at+De-1])&qe.hash_mask,qe.prev[at&qe.w_mask]=qe.head[qe.ins_h],qe.head[qe.ins_h]=at,at++,qe.insert--,!(qe.lookahead+qe.insert<De)););}while(qe.lookahead<Ne&&0!==qe.strm.avail_in)}function P(qe,Qe){for(var $e,et;;){if(qe.lookahead<Ne){if(F(qe),qe.lookahead<Ne&&Qe===se)return Ge;if(0===qe.lookahead)break}if($e=0,qe.lookahead>=De&&(qe.ins_h=(qe.ins_h<<qe.hash_shift^qe.window[qe.strstart+De-1])&qe.hash_mask,$e=qe.prev[qe.strstart&qe.w_mask]=qe.head[qe.ins_h],qe.head[qe.ins_h]=qe.strstart),0!==$e&&qe.strstart-$e<=qe.w_size-Ne&&(qe.match_length=D(qe,$e)),!(qe.match_length>=De))et=te._tr_tally(qe,0,qe.window[qe.strstart]),qe.lookahead--,qe.strstart++;else if(et=te._tr_tally(qe,qe.strstart-qe.match_start,qe.match_length-De),qe.lookahead-=qe.match_length,qe.match_length<=qe.max_lazy_match&&qe.lookahead>=De){qe.match_length--;do qe.strstart++,qe.ins_h=(qe.ins_h<<qe.hash_shift^qe.window[qe.strstart+De-1])&qe.hash_mask,$e=qe.prev[qe.strstart&qe.w_mask]=qe.head[qe.ins_h],qe.head[qe.ins_h]=qe.strstart;while(0!=--qe.match_length);qe.strstart++}else qe.strstart+=qe.match_length,qe.match_length=0,qe.ins_h=qe.window[qe.strstart],qe.ins_h=(qe.ins_h<<qe.hash_shift^qe.window[qe.strstart+1])&qe.hash_mask;if(et&&(A(qe,!1),0===qe.strm.avail_out))return Ge}return qe.insert=qe.strstart<De-1?qe.strstart:De-1,Qe===de?(A(qe,!0),0===qe.strm.avail_out?Ye:Xe):qe.last_lit&&(A(qe,!1),0===qe.strm.avail_out)?Ge:Ke}function L(qe,Qe){for(var $e,et,tt;;){if(qe.lookahead<Ne){if(F(qe),qe.lookahead<Ne&&Qe===se)return Ge;if(0===qe.lookahead)break}if($e=0,qe.lookahead>=De&&(qe.ins_h=(qe.ins_h<<qe.hash_shift^qe.window[qe.strstart+De-1])&qe.hash_mask,$e=qe.prev[qe.strstart&qe.w_mask]=qe.head[qe.ins_h],qe.head[qe.ins_h]=qe.strstart),qe.prev_length=qe.match_length,qe.prev_match=qe.match_start,qe.match_length=De-1,0!==$e&&qe.prev_length<qe.max_lazy_match&&qe.strstart-$e<=qe.w_size-Ne&&(qe.match_length=D(qe,$e),5>=qe.match_length&&(qe.strategy===1||qe.match_length===De&&4096<qe.strstart-qe.match_start)&&(qe.match_length=De-1)),qe.prev_length>=De&&qe.match_length<=qe.prev_length){tt=qe.strstart+qe.lookahead-De,et=te._tr_tally(qe,qe.strstart-1-qe.prev_match,qe.prev_length-De),qe.lookahead-=qe.prev_length-1,qe.prev_length-=2;do++qe.strstart<=tt&&(qe.ins_h=(qe.ins_h<<qe.hash_shift^qe.window[qe.strstart+De-1])&qe.hash_mask,$e=qe.prev[qe.strstart&qe.w_mask]=qe.head[qe.ins_h],qe.head[qe.ins_h]=qe.strstart);while(0!=--qe.prev_length);if(qe.match_available=0,qe.match_length=De-1,qe.strstart++,et&&(A(qe,!1),0===qe.strm.avail_out))return Ge}else if(!qe.match_available)qe.match_available=1,qe.strstart++,qe.lookahead--;else if(et=te._tr_tally(qe,0,qe.window[qe.strstart-1]),et&&A(qe,!1),qe.strstart++,qe.lookahead--,0===qe.strm.avail_out)return Ge}return qe.match_available&&(et=te._tr_tally(qe,0,qe.window[qe.strstart-1]),qe.match_available=0),qe.insert=qe.strstart<De-1?qe.strstart:De-1,Qe===de?(A(qe,!0),0===qe.strm.avail_out?Ye:Xe):qe.last_lit&&(A(qe,!1),0===qe.strm.avail_out)?Ge:Ke}function U(qe,Qe){for(var at=qe.window,$e,et,tt,rt;;){if(qe.lookahead<=Fe){if(F(qe),qe.lookahead<=Fe&&Qe===se)return Ge;if(0===qe.lookahead)break}if(qe.match_length=0,qe.lookahead>=De&&0<qe.strstart&&(tt=qe.strstart-1,et=at[tt],et===at[++tt]&&et===at[++tt]&&et===at[++tt])){rt=qe.strstart+Fe;do;while(et===at[++tt]&&et===at[++tt]&&et===at[++tt]&&et===at[++tt]&&et===at[++tt]&&et===at[++tt]&&et===at[++tt]&&et===at[++tt]&&tt<rt);qe.match_length=Fe-(rt-tt),qe.match_length>qe.lookahead&&(qe.match_length=qe.lookahead)}if(qe.match_length>=De?($e=te._tr_tally(qe,1,qe.match_length-De),qe.lookahead-=qe.match_length,qe.strstart+=qe.match_length,qe.match_length=0):($e=te._tr_tally(qe,0,qe.window[qe.strstart]),qe.lookahead--,qe.strstart++),$e&&(A(qe,!1),0===qe.strm.avail_out))return Ge}return qe.insert=0,Qe===de?(A(qe,!0),0===qe.strm.avail_out?Ye:Xe):qe.last_lit&&(A(qe,!1),0===qe.strm.avail_out)?Ge:Ke}function Z(qe,Qe){for(var $e;;){if(0===qe.lookahead&&(F(qe),0===qe.lookahead)){if(Qe===se)return Ge;break}if(qe.match_length=0,$e=te._tr_tally(qe,0,qe.window[qe.strstart]),qe.lookahead--,qe.strstart++,$e&&(A(qe,!1),0===qe.strm.avail_out))return Ge}return qe.insert=0,Qe===de?(A(qe,!0),0===qe.strm.avail_out?Ye:Xe):qe.last_lit&&(A(qe,!1),0===qe.strm.avail_out)?Ge:Ke}function W(qe,Qe,$e,et,tt){this.good_length=qe,this.max_lazy=Qe,this.nice_length=$e,this.max_chain=et,this.func=tt}function M(qe){qe.window_size=2*qe.w_size,I(qe.head),qe.max_lazy_match=Je[qe.level].max_lazy,qe.good_match=Je[qe.level].good_length,qe.nice_match=Je[qe.level].nice_length,qe.max_chain_length=Je[qe.level].max_chain,qe.strstart=0,qe.block_start=0,qe.lookahead=0,qe.insert=0,qe.match_length=qe.prev_length=De-1,qe.match_available=0,qe.ins_h=0}function H(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ve,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new ee.Buf16(2*(2*Oe+1)),this.dyn_dtree=new ee.Buf16(2*(2*30+1)),this.bl_tree=new ee.Buf16(2*(2*19+1)),I(this.dyn_ltree),I(this.dyn_dtree),I(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new ee.Buf16(15+1),this.heap=new ee.Buf16(2*Oe+1),I(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new ee.Buf16(2*Oe+1),I(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function G(qe){var Qe;return qe&&qe.state?(qe.total_in=qe.total_out=0,qe.data_type=2,Qe=qe.state,Qe.pending=0,Qe.pending_out=0,0>Qe.wrap&&(Qe.wrap=-Qe.wrap),Qe.status=Qe.wrap?Le:Me,qe.adler=2===Qe.wrap?0:1,Qe.last_flush=se,te._tr_init(Qe),ue):C(qe,ce)}function K(qe){var Qe=G(qe);return Qe===ue&&M(qe.state),Qe}function X(qe,Qe,$e,et,tt,rt){if(!qe)return ce;var at=1;if(Qe===-1&&(Qe=6),0>et?(at=0,et=-et):15<et&&(at=2,et-=16),1>tt||tt>9||$e!==ve||8>et||15<et||0>Qe||9<Qe||0>rt||rt>4)return C(qe,ce);8===et&&(et=9);var nt=new H;return qe.state=nt,nt.strm=qe,nt.wrap=at,nt.gzhead=null,nt.w_bits=et,nt.w_size=1<<nt.w_bits,nt.w_mask=nt.w_size-1,nt.hash_bits=tt+7,nt.hash_size=1<<nt.hash_bits,nt.hash_mask=nt.hash_size-1,nt.hash_shift=~~((nt.hash_bits+De-1)/De),nt.window=new ee.Buf8(2*nt.w_size),nt.head=new ee.Buf16(nt.hash_size),nt.prev=new ee.Buf16(nt.w_size),nt.lit_bufsize=1<<tt+6,nt.pending_buf_size=4*nt.lit_bufsize,nt.pending_buf=new ee.Buf8(nt.pending_buf_size),nt.d_buf=1*nt.lit_bufsize,nt.l_buf=3*nt.lit_bufsize,nt.level=Qe,nt.strategy=rt,nt.method=$e,K(qe)}var ee=x("../utils/common"),te=x("./trees"),re=x("./adler32"),ae=x("./crc32"),ne=x("./messages"),se=0,de=4,le=5,ue=0,pe=1,ce=-2,fe=-5,be=2,ve=8,Oe=256+1+29,De=3,Fe=258,Ne=Fe+De+1,Le=42,Ue=69,je=73,Ze=91,We=103,Me=113,He=666,Ge=1,Ke=2,Ye=3,Xe=4,Je;Je=[new W(0,0,0,0,function(qe,Qe){var $e=65535;for($e>qe.pending_buf_size-5&&($e=qe.pending_buf_size-5);;){if(1>=qe.lookahead){if(F(qe),0===qe.lookahead&&Qe===se)return Ge;if(0===qe.lookahead)break}qe.strstart+=qe.lookahead,qe.lookahead=0;var et=qe.block_start+$e;if((0===qe.strstart||qe.strstart>=et)&&(qe.lookahead=qe.strstart-et,qe.strstart=et,A(qe,!1),0===qe.strm.avail_out))return Ge;if(qe.strstart-qe.block_start>=qe.w_size-Ne&&(A(qe,!1),0===qe.strm.avail_out))return Ge}return qe.insert=0,Qe===de?(A(qe,!0),0===qe.strm.avail_out?Ye:Xe):qe.strstart>qe.block_start&&(A(qe,!1),0===qe.strm.avail_out)?Ge:Ge}),new W(4,4,8,4,P),new W(4,5,16,8,P),new W(4,6,32,32,P),new W(4,4,16,16,L),new W(8,16,32,32,L),new W(8,16,128,128,L),new W(8,32,128,256,L),new W(32,128,258,1024,L),new W(32,258,258,4096,L)],S.deflateInit=function(qe,Qe){return X(qe,Qe,ve,15,8,0)},S.deflateInit2=X,S.deflateReset=K,S.deflateResetKeep=G,S.deflateSetHeader=function(qe,Qe){return qe&&qe.state?2===qe.state.wrap?(qe.state.gzhead=Qe,ue):ce:ce},S.deflate=function(qe,Qe){var $e,et,tt,rt;if(!qe||!qe.state||Qe>le||0>Qe)return qe?C(qe,ce):ce;if(et=qe.state,!qe.output||!qe.input&&0!==qe.avail_in||et.status===He&&Qe!==de)return C(qe,0===qe.avail_out?fe:ce);if(et.strm=qe,$e=et.last_flush,et.last_flush=Qe,et.status===Le)if(2===et.wrap)qe.adler=0,B(et,31),B(et,139),B(et,8),et.gzhead?(B(et,(et.gzhead.text?1:0)+(et.gzhead.hcrc?2:0)+(et.gzhead.extra?4:0)+(et.gzhead.name?8:0)+(et.gzhead.comment?16:0)),B(et,255&et.gzhead.time),B(et,255&et.gzhead.time>>8),B(et,255&et.gzhead.time>>16),B(et,255&et.gzhead.time>>24),B(et,9===et.level?2:et.strategy>=be||2>et.level?4:0),B(et,255&et.gzhead.os),et.gzhead.extra&&et.gzhead.extra.length&&(B(et,255&et.gzhead.extra.length),B(et,255&et.gzhead.extra.length>>8)),et.gzhead.hcrc&&(qe.adler=ae(qe.adler,et.pending_buf,et.pending,0)),et.gzindex=0,et.status=Ue):(B(et,0),B(et,0),B(et,0),B(et,0),B(et,0),B(et,9===et.level?2:et.strategy>=be||2>et.level?4:0),B(et,3),et.status=Me);else{var at=ve+(et.w_bits-8<<4)<<8,nt=-1;nt=et.strategy>=be||2>et.level?0:6>et.level?1:6===et.level?2:3,at|=nt<<6,0!==et.strstart&&(at|=32),at+=31-at%31,et.status=Me,R(et,at),0!==et.strstart&&(R(et,qe.adler>>>16),R(et,65535&qe.adler)),qe.adler=1}if(et.status===Ue)if(et.gzhead.extra){for(tt=et.pending;et.gzindex<(65535&et.gzhead.extra.length)&&!(et.pending===et.pending_buf_size&&(et.gzhead.hcrc&&et.pending>tt&&(qe.adler=ae(qe.adler,et.pending_buf,et.pending-tt,tt)),O(qe),tt=et.pending,et.pending===et.pending_buf_size));)B(et,255&et.gzhead.extra[et.gzindex]),et.gzindex++;et.gzhead.hcrc&&et.pending>tt&&(qe.adler=ae(qe.adler,et.pending_buf,et.pending-tt,tt)),et.gzindex===et.gzhead.extra.length&&(et.gzindex=0,et.status=je)}else et.status=je;if(et.status===je)if(et.gzhead.name){tt=et.pending;do{if(et.pending===et.pending_buf_size&&(et.gzhead.hcrc&&et.pending>tt&&(qe.adler=ae(qe.adler,et.pending_buf,et.pending-tt,tt)),O(qe),tt=et.pending,et.pending===et.pending_buf_size)){rt=1;break}rt=et.gzindex<et.gzhead.name.length?255&et.gzhead.name.charCodeAt(et.gzindex++):0,B(et,rt)}while(0!==rt);et.gzhead.hcrc&&et.pending>tt&&(qe.adler=ae(qe.adler,et.pending_buf,et.pending-tt,tt)),0===rt&&(et.gzindex=0,et.status=Ze)}else et.status=Ze;if(et.status===Ze)if(et.gzhead.comment){tt=et.pending;do{if(et.pending===et.pending_buf_size&&(et.gzhead.hcrc&&et.pending>tt&&(qe.adler=ae(qe.adler,et.pending_buf,et.pending-tt,tt)),O(qe),tt=et.pending,et.pending===et.pending_buf_size)){rt=1;break}rt=et.gzindex<et.gzhead.comment.length?255&et.gzhead.comment.charCodeAt(et.gzindex++):0,B(et,rt)}while(0!==rt);et.gzhead.hcrc&&et.pending>tt&&(qe.adler=ae(qe.adler,et.pending_buf,et.pending-tt,tt)),0===rt&&(et.status=We)}else et.status=We;if(et.status===We&&(et.gzhead.hcrc?(et.pending+2>et.pending_buf_size&&O(qe),et.pending+2<=et.pending_buf_size&&(B(et,255&qe.adler),B(et,255&qe.adler>>8),qe.adler=0,et.status=Me)):et.status=Me),0!==et.pending){if(O(qe),0===qe.avail_out)return et.last_flush=-1,ue;}else if(0===qe.avail_in&&E(Qe)<=E($e)&&Qe!==de)return C(qe,fe);if(et.status===He&&0!==qe.avail_in)return C(qe,fe);if(0!==qe.avail_in||0!==et.lookahead||Qe!==se&&et.status!==He){var st=et.strategy===be?Z(et,Qe):et.strategy===3?U(et,Qe):Je[et.level].func(et,Qe);if((st===Ye||st===Xe)&&(et.status=He),st===Ge||st===Ye)return 0===qe.avail_out&&(et.last_flush=-1),ue;if(st===Ke&&(Qe===1?te._tr_align(et):Qe!==le&&(te._tr_stored_block(et,0,0,!1),Qe===3&&(I(et.head),0===et.lookahead&&(et.strstart=0,et.block_start=0,et.insert=0))),O(qe),0===qe.avail_out))return et.last_flush=-1,ue}return Qe===de?0>=et.wrap?pe:(2===et.wrap?(B(et,255&qe.adler),B(et,255&qe.adler>>8),B(et,255&qe.adler>>16),B(et,255&qe.adler>>24),B(et,255&qe.total_in),B(et,255&qe.total_in>>8),B(et,255&qe.total_in>>16),B(et,255&qe.total_in>>24)):(R(et,qe.adler>>>16),R(et,65535&qe.adler)),O(qe),0<et.wrap&&(et.wrap=-et.wrap),0===et.pending?pe:ue):ue},S.deflateEnd=function(qe){var Qe;return qe&&qe.state?(Qe=qe.state.status,Qe!==Le&&Qe!==Ue&&Qe!==je&&Qe!==Ze&&Qe!==We&&Qe!==Me&&Qe!==He)?C(qe,ce):(qe.state=null,Qe===Me?C(qe,-3):ue):ce},S.deflateSetDictionary=function(qe,Qe){var $e=Qe.length,et,tt,rt,at,nt,st,it,ot;if(!qe||!qe.state)return ce;if(et=qe.state,at=et.wrap,2===at||1===at&&et.status!==Le||et.lookahead)return ce;for(1===at&&(qe.adler=re(qe.adler,Qe,$e,0)),et.wrap=0,$e>=et.w_size&&(0===at&&(I(et.head),et.strstart=0,et.block_start=0,et.insert=0),ot=new ee.Buf8(et.w_size),ee.arraySet(ot,Qe,$e-et.w_size,et.w_size,0),Qe=ot,$e=et.w_size),nt=qe.avail_in,st=qe.next_in,it=qe.input,qe.avail_in=$e,qe.next_in=0,qe.input=Qe,F(et);et.lookahead>=De;){tt=et.strstart,rt=et.lookahead-(De-1);do et.ins_h=(et.ins_h<<et.hash_shift^et.window[tt+De-1])&et.hash_mask,et.prev[tt&et.w_mask]=et.head[et.ins_h],et.head[et.ins_h]=tt,tt++;while(--rt);et.strstart=tt,et.lookahead=De-1,F(et)}return et.strstart+=et.lookahead,et.block_start=et.strstart,et.insert=et.lookahead,et.lookahead=0,et.match_length=et.prev_length=De-1,et.match_available=0,qe.next_in=st,qe.input=it,qe.avail_in=nt,et.wrap=at,ue},S.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(x,z){"use strict";z.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(x,z){"use strict";var C=30;z.exports=function(O,A){var B,R,T,D,F,N,P,L,U,Z,W,M,H,G,K,Y,X,V,J,Q,$,ee,te,re,ae;B=O.state,R=O.next_in,re=O.input,T=R+(O.avail_in-5),D=O.next_out,ae=O.output,F=D-(A-O.avail_out),N=D+(O.avail_out-257),P=B.dmax,L=B.wsize,U=B.whave,Z=B.wnext,W=B.window,M=B.hold,H=B.bits,G=B.lencode,K=B.distcode,Y=(1<<B.lenbits)-1,X=(1<<B.distbits)-1;top:do{15>H&&(M+=re[R++]<<H,H+=8,M+=re[R++]<<H,H+=8),V=G[M&Y];dolen:for(;;){if(J=V>>>24,M>>>=J,H-=J,J=255&V>>>16,0===J)ae[D++]=65535&V;else if(16&J){Q=65535&V,J&=15,J&&(H<J&&(M+=re[R++]<<H,H+=8),Q+=M&(1<<J)-1,M>>>=J,H-=J),15>H&&(M+=re[R++]<<H,H+=8,M+=re[R++]<<H,H+=8),V=K[M&X];dodist:for(;;){if(J=V>>>24,M>>>=J,H-=J,J=255&V>>>16,16&J){if($=65535&V,J&=15,H<J&&(M+=re[R++]<<H,H+=8,H<J&&(M+=re[R++]<<H,H+=8)),$+=M&(1<<J)-1,$>P){O.msg="invalid distance too far back",B.mode=C;break top}if(M>>>=J,H-=J,J=D-F,$>J){if(J=$-J,J>U&&B.sane){O.msg="invalid distance too far back",B.mode=C;break top}if(ee=0,te=W,0===Z){if(ee+=L-J,J<Q){Q-=J;do ae[D++]=W[ee++];while(--J);ee=D-$,te=ae}}else if(Z<J){if(ee+=L+Z-J,J-=Z,J<Q){Q-=J;do ae[D++]=W[ee++];while(--J);if(ee=0,Z<Q){J=Z,Q-=J;do ae[D++]=W[ee++];while(--J);ee=D-$,te=ae}}}else if(ee+=Z-J,J<Q){Q-=J;do ae[D++]=W[ee++];while(--J);ee=D-$,te=ae}for(;2<Q;)ae[D++]=te[ee++],ae[D++]=te[ee++],ae[D++]=te[ee++],Q-=3;Q&&(ae[D++]=te[ee++],1<Q&&(ae[D++]=te[ee++]))}else{ee=D-$;do ae[D++]=ae[ee++],ae[D++]=ae[ee++],ae[D++]=ae[ee++],Q-=3;while(2<Q);Q&&(ae[D++]=ae[ee++],1<Q&&(ae[D++]=ae[ee++]))}}else if(0==(64&J)){V=K[(65535&V)+(M&(1<<J)-1)];continue dodist}else{O.msg="invalid distance code",B.mode=C;break top}break}}else if(0==(64&J)){V=G[(65535&V)+(M&(1<<J)-1)];continue dolen}else if(32&J){B.mode=12;break top}else{O.msg="invalid literal/length code",B.mode=C;break top}break}}while(R<T&&D<N);return Q=H>>3,R-=Q,H-=Q<<3,M&=(1<<H)-1,O.next_in=R,O.next_out=D,O.avail_in=R<T?5+(T-R):5-(R-T),O.avail_out=D<N?257+(N-D):257-(D-N),B.hold=M,void(B.bits=H)}},{}],49:[function(x,z,S){"use strict";function C(Ke){return(255&Ke>>>24)+(65280&Ke>>>8)+((65280&Ke)<<8)+((255&Ke)<<24)}function E(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new U.Buf16(320),this.work=new U.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function I(Ke){var Ye;return Ke&&Ke.state?(Ye=Ke.state,Ke.total_in=Ke.total_out=Ye.total=0,Ke.msg="",Ye.wrap&&(Ke.adler=1&Ye.wrap),Ye.mode=ie,Ye.last=0,Ye.havedict=0,Ye.dmax=32768,Ye.head=null,Ye.hold=0,Ye.bits=0,Ye.lencode=Ye.lendyn=new U.Buf32(852),Ye.distcode=Ye.distdyn=new U.Buf32(592),Ye.sane=1,Ye.back=-1,Q):te}function O(Ke){var Ye;return Ke&&Ke.state?(Ye=Ke.state,Ye.wsize=0,Ye.whave=0,Ye.wnext=0,I(Ke)):te}function A(Ke,Ye){var Xe,Ve;return Ke&&Ke.state?(Ve=Ke.state,0>Ye?(Xe=0,Ye=-Ye):(Xe=(Ye>>4)+1,48>Ye&&(Ye&=15)),Ye&&(8>Ye||15<Ye))?te:(null!==Ve.window&&Ve.wbits!==Ye&&(Ve.window=null),Ve.wrap=Xe,Ve.wbits=Ye,O(Ke)):te}function B(Ke,Ye){var Xe,Ve;return Ke?(Ve=new E,Ke.state=Ve,Ve.window=null,Xe=A(Ke,Ye),Xe!==Q&&(Ke.state=null),Xe):te}function T(Ke){if(Me){var Ye;for(He=new U.Buf32(512),Ge=new U.Buf32(32),Ye=0;144>Ye;)Ke.lens[Ye++]=8;for(;256>Ye;)Ke.lens[Ye++]=9;for(;280>Ye;)Ke.lens[Ye++]=7;for(;288>Ye;)Ke.lens[Ye++]=8;for(H(K,Ke.lens,0,288,He,0,Ke.work,{bits:9}),Ye=0;32>Ye;)Ke.lens[Ye++]=5;H(Y,Ke.lens,0,32,Ge,0,Ke.work,{bits:5}),Me=!1}Ke.lencode=He,Ke.lenbits=9,Ke.distcode=Ge,Ke.distbits=5}function D(Ke,Ye,Xe,Ve){var qe=Ke.state,Je;return null===qe.window&&(qe.wsize=1<<qe.wbits,qe.wnext=0,qe.whave=0,qe.window=new U.Buf8(qe.wsize)),Ve>=qe.wsize?(U.arraySet(qe.window,Ye,Xe-qe.wsize,qe.wsize,0),qe.wnext=0,qe.whave=qe.wsize):(Je=qe.wsize-qe.wnext,Je>Ve&&(Je=Ve),U.arraySet(qe.window,Ye,Xe-Ve,Je,qe.wnext),Ve-=Je,Ve?(U.arraySet(qe.window,Ye,Xe-Ve,Ve,0),qe.wnext=Ve,qe.whave=qe.wsize):(qe.wnext+=Je,qe.wnext===qe.wsize&&(qe.wnext=0),qe.whave<qe.wsize&&(qe.whave+=Je))),0}var U=x("../utils/common"),Z=x("./adler32"),W=x("./crc32"),M=x("./inffast"),H=x("./inftrees"),K=1,Y=2,X=4,J=6,Q=0,te=-2,re=-3,ae=-4,se=8,ie=1,oe=2,de=3,le=4,ue=5,pe=6,ce=7,he=8,fe=9,_e=10,ge=11,be=12,ye=13,ke=14,xe=15,we=16,ve=17,ze=18,Se=19,Ce=20,Ee=21,Ie=22,Oe=23,Ae=24,Be=25,Re=26,Te=27,De=28,Fe=29,Ne=30,Pe=31,Me=!0,He,Ge;S.inflateReset=O,S.inflateReset2=A,S.inflateResetKeep=I,S.inflateInit=function(Ke){return B(Ke,15)},S.inflateInit2=B,S.inflate=function(Ke,Ye){var dt=0,gt=new U.Buf8(4),kt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Xe,Ve,Je,qe,Qe,$e,et,tt,rt,at,nt,st,it,ot,lt,ut,pt,ct,ht,mt,ft,_t,bt,yt;if(!Ke||!Ke.state||!Ke.output||!Ke.input&&0!==Ke.avail_in)return te;Xe=Ke.state,Xe.mode===be&&(Xe.mode=ye),Qe=Ke.next_out,Je=Ke.output,et=Ke.avail_out,qe=Ke.next_in,Ve=Ke.input,$e=Ke.avail_in,tt=Xe.hold,rt=Xe.bits,at=$e,nt=et,_t=Q;inf_leave:for(;;)switch(Xe.mode){case ie:if(0===Xe.wrap){Xe.mode=ye;break}for(;16>rt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}if(2&Xe.wrap&&35615===tt){Xe.check=0,gt[0]=255&tt,gt[1]=255&tt>>>8,Xe.check=W(Xe.check,gt,2,0),tt=0,rt=0,Xe.mode=oe;break}if(Xe.flags=0,Xe.head&&(Xe.head.done=!1),!(1&Xe.wrap)||(((255&tt)<<8)+(tt>>8))%31){Ke.msg="incorrect header check",Xe.mode=Ne;break}if((15&tt)!==se){Ke.msg="unknown compression method",Xe.mode=Ne;break}if(tt>>>=4,rt-=4,ft=(15&tt)+8,0===Xe.wbits)Xe.wbits=ft;else if(ft>Xe.wbits){Ke.msg="invalid window size",Xe.mode=Ne;break}Xe.dmax=1<<ft,Ke.adler=Xe.check=1,Xe.mode=512&tt?_e:be,tt=0,rt=0;break;case oe:for(;16>rt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}if(Xe.flags=tt,(255&Xe.flags)!==se){Ke.msg="unknown compression method",Xe.mode=Ne;break}if(57344&Xe.flags){Ke.msg="unknown header flags set",Xe.mode=Ne;break}Xe.head&&(Xe.head.text=1&tt>>8),512&Xe.flags&&(gt[0]=255&tt,gt[1]=255&tt>>>8,Xe.check=W(Xe.check,gt,2,0)),tt=0,rt=0,Xe.mode=de;case de:for(;32>rt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}Xe.head&&(Xe.head.time=tt),512&Xe.flags&&(gt[0]=255&tt,gt[1]=255&tt>>>8,gt[2]=255&tt>>>16,gt[3]=255&tt>>>24,Xe.check=W(Xe.check,gt,4,0)),tt=0,rt=0,Xe.mode=le;case le:for(;16>rt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}Xe.head&&(Xe.head.xflags=255&tt,Xe.head.os=tt>>8),512&Xe.flags&&(gt[0]=255&tt,gt[1]=255&tt>>>8,Xe.check=W(Xe.check,gt,2,0)),tt=0,rt=0,Xe.mode=ue;case ue:if(1024&Xe.flags){for(;16>rt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}Xe.length=tt,Xe.head&&(Xe.head.extra_len=tt),512&Xe.flags&&(gt[0]=255&tt,gt[1]=255&tt>>>8,Xe.check=W(Xe.check,gt,2,0)),tt=0,rt=0}else Xe.head&&(Xe.head.extra=null);Xe.mode=pe;case pe:if(1024&Xe.flags&&(st=Xe.length,st>$e&&(st=$e),st&&(Xe.head&&(ft=Xe.head.extra_len-Xe.length,!Xe.head.extra&&(Xe.head.extra=Array(Xe.head.extra_len)),U.arraySet(Xe.head.extra,Ve,qe,st,ft)),512&Xe.flags&&(Xe.check=W(Xe.check,Ve,st,qe)),$e-=st,qe+=st,Xe.length-=st),Xe.length))break inf_leave;Xe.length=0,Xe.mode=ce;case ce:if(2048&Xe.flags){if(0===$e)break inf_leave;st=0;do ft=Ve[qe+st++],Xe.head&&ft&&65536>Xe.length&&(Xe.head.name+=String.fromCharCode(ft));while(ft&&st<$e);if(512&Xe.flags&&(Xe.check=W(Xe.check,Ve,st,qe)),$e-=st,qe+=st,ft)break inf_leave}else Xe.head&&(Xe.head.name=null);Xe.length=0,Xe.mode=he;case he:if(4096&Xe.flags){if(0===$e)break inf_leave;st=0;do ft=Ve[qe+st++],Xe.head&&ft&&65536>Xe.length&&(Xe.head.comment+=String.fromCharCode(ft));while(ft&&st<$e);if(512&Xe.flags&&(Xe.check=W(Xe.check,Ve,st,qe)),$e-=st,qe+=st,ft)break inf_leave}else Xe.head&&(Xe.head.comment=null);Xe.mode=fe;case fe:if(512&Xe.flags){for(;16>rt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}if(tt!==(65535&Xe.check)){Ke.msg="header crc mismatch",Xe.mode=Ne;break}tt=0,rt=0}Xe.head&&(Xe.head.hcrc=1&Xe.flags>>9,Xe.head.done=!0),Ke.adler=Xe.check=0,Xe.mode=be;break;case _e:for(;32>rt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}Ke.adler=Xe.check=C(tt),tt=0,rt=0,Xe.mode=ge;case ge:if(0===Xe.havedict)return Ke.next_out=Qe,Ke.avail_out=et,Ke.next_in=qe,Ke.avail_in=$e,Xe.hold=tt,Xe.bits=rt,2;Ke.adler=Xe.check=1,Xe.mode=be;case be:if(Ye===5||Ye===J)break inf_leave;case ye:if(Xe.last){tt>>>=7&rt,rt-=7&rt,Xe.mode=Te;break}for(;3>rt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}switch(Xe.last=1&tt,tt>>>=1,rt-=1,3&tt){case 0:Xe.mode=ke;break;case 1:if(T(Xe),Xe.mode=Ce,Ye===J){tt>>>=2,rt-=2;break inf_leave}break;case 2:Xe.mode=ve;break;case 3:Ke.msg="invalid block type",Xe.mode=Ne;}tt>>>=2,rt-=2;break;case ke:for(tt>>>=7&rt,rt-=7&rt;32>rt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}if((65535&tt)!=(65535^tt>>>16)){Ke.msg="invalid stored block lengths",Xe.mode=Ne;break}if(Xe.length=65535&tt,tt=0,rt=0,Xe.mode=xe,Ye===J)break inf_leave;case xe:Xe.mode=we;case we:if(st=Xe.length,st){if(st>$e&&(st=$e),st>et&&(st=et),0===st)break inf_leave;U.arraySet(Je,Ve,qe,st,Qe),$e-=st,qe+=st,et-=st,Qe+=st,Xe.length-=st;break}Xe.mode=be;break;case ve:for(;14>rt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}if(Xe.nlen=(31&tt)+257,tt>>>=5,rt-=5,Xe.ndist=(31&tt)+1,tt>>>=5,rt-=5,Xe.ncode=(15&tt)+4,tt>>>=4,rt-=4,286<Xe.nlen||30<Xe.ndist){Ke.msg="too many length or distance symbols",Xe.mode=Ne;break}Xe.have=0,Xe.mode=ze;case ze:for(;Xe.have<Xe.ncode;){for(;3>rt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}Xe.lens[kt[Xe.have++]]=7&tt,tt>>>=3,rt-=3}for(;19>Xe.have;)Xe.lens[kt[Xe.have++]]=0;if(Xe.lencode=Xe.lendyn,Xe.lenbits=7,bt={bits:Xe.lenbits},_t=H(0,Xe.lens,0,19,Xe.lencode,0,Xe.work,bt),Xe.lenbits=bt.bits,_t){Ke.msg="invalid code lengths set",Xe.mode=Ne;break}Xe.have=0,Xe.mode=Se;case Se:for(;Xe.have<Xe.nlen+Xe.ndist;){for(;;){if(dt=Xe.lencode[tt&(1<<Xe.lenbits)-1],lt=dt>>>24,ut=255&dt>>>16,pt=65535&dt,lt<=rt)break;if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}if(16>pt)tt>>>=lt,rt-=lt,Xe.lens[Xe.have++]=pt;else{if(16===pt){for(yt=lt+2;rt<yt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}if(tt>>>=lt,rt-=lt,0===Xe.have){Ke.msg="invalid bit length repeat",Xe.mode=Ne;break}ft=Xe.lens[Xe.have-1],st=3+(3&tt),tt>>>=2,rt-=2}else if(17===pt){for(yt=lt+3;rt<yt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}tt>>>=lt,rt-=lt,ft=0,st=3+(7&tt),tt>>>=3,rt-=3}else{for(yt=lt+7;rt<yt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}tt>>>=lt,rt-=lt,ft=0,st=11+(127&tt),tt>>>=7,rt-=7}if(Xe.have+st>Xe.nlen+Xe.ndist){Ke.msg="invalid bit length repeat",Xe.mode=Ne;break}for(;st--;)Xe.lens[Xe.have++]=ft}}if(Xe.mode===Ne)break;if(0===Xe.lens[256]){Ke.msg="invalid code -- missing end-of-block",Xe.mode=Ne;break}if(Xe.lenbits=9,bt={bits:Xe.lenbits},_t=H(K,Xe.lens,0,Xe.nlen,Xe.lencode,0,Xe.work,bt),Xe.lenbits=bt.bits,_t){Ke.msg="invalid literal/lengths set",Xe.mode=Ne;break}if(Xe.distbits=6,Xe.distcode=Xe.distdyn,bt={bits:Xe.distbits},_t=H(Y,Xe.lens,Xe.nlen,Xe.ndist,Xe.distcode,0,Xe.work,bt),Xe.distbits=bt.bits,_t){Ke.msg="invalid distances set",Xe.mode=Ne;break}if(Xe.mode=Ce,Ye===J)break inf_leave;case Ce:Xe.mode=Ee;case Ee:if(6<=$e&&258<=et){Ke.next_out=Qe,Ke.avail_out=et,Ke.next_in=qe,Ke.avail_in=$e,Xe.hold=tt,Xe.bits=rt,M(Ke,nt),Qe=Ke.next_out,Je=Ke.output,et=Ke.avail_out,qe=Ke.next_in,Ve=Ke.input,$e=Ke.avail_in,tt=Xe.hold,rt=Xe.bits,Xe.mode===be&&(Xe.back=-1);break}for(Xe.back=0;;){if(dt=Xe.lencode[tt&(1<<Xe.lenbits)-1],lt=dt>>>24,ut=255&dt>>>16,pt=65535&dt,lt<=rt)break;if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}if(ut&&0==(240&ut)){for(ct=lt,ht=ut,mt=pt;;){if(dt=Xe.lencode[mt+((tt&(1<<ct+ht)-1)>>ct)],lt=dt>>>24,ut=255&dt>>>16,pt=65535&dt,ct+lt<=rt)break;if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}tt>>>=ct,rt-=ct,Xe.back+=ct}if(tt>>>=lt,rt-=lt,Xe.back+=lt,Xe.length=pt,0===ut){Xe.mode=Re;break}if(32&ut){Xe.back=-1,Xe.mode=be;break}if(64&ut){Ke.msg="invalid literal/length code",Xe.mode=Ne;break}Xe.extra=15&ut,Xe.mode=Ie;case Ie:if(Xe.extra){for(yt=Xe.extra;rt<yt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}Xe.length+=tt&(1<<Xe.extra)-1,tt>>>=Xe.extra,rt-=Xe.extra,Xe.back+=Xe.extra}Xe.was=Xe.length,Xe.mode=Oe;case Oe:for(;;){if(dt=Xe.distcode[tt&(1<<Xe.distbits)-1],lt=dt>>>24,ut=255&dt>>>16,pt=65535&dt,lt<=rt)break;if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}if(0==(240&ut)){for(ct=lt,ht=ut,mt=pt;;){if(dt=Xe.distcode[mt+((tt&(1<<ct+ht)-1)>>ct)],lt=dt>>>24,ut=255&dt>>>16,pt=65535&dt,ct+lt<=rt)break;if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}tt>>>=ct,rt-=ct,Xe.back+=ct}if(tt>>>=lt,rt-=lt,Xe.back+=lt,64&ut){Ke.msg="invalid distance code",Xe.mode=Ne;break}Xe.offset=pt,Xe.extra=15&ut,Xe.mode=Ae;case Ae:if(Xe.extra){for(yt=Xe.extra;rt<yt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}Xe.offset+=tt&(1<<Xe.extra)-1,tt>>>=Xe.extra,rt-=Xe.extra,Xe.back+=Xe.extra}if(Xe.offset>Xe.dmax){Ke.msg="invalid distance too far back",Xe.mode=Ne;break}Xe.mode=Be;case Be:if(0===et)break inf_leave;if(st=nt-et,Xe.offset>st){if(st=Xe.offset-st,st>Xe.whave&&Xe.sane){Ke.msg="invalid distance too far back",Xe.mode=Ne;break}st>Xe.wnext?(st-=Xe.wnext,it=Xe.wsize-st):it=Xe.wnext-st,st>Xe.length&&(st=Xe.length),ot=Xe.window}else ot=Je,it=Qe-Xe.offset,st=Xe.length;st>et&&(st=et),et-=st,Xe.length-=st;do Je[Qe++]=ot[it++];while(--st);0===Xe.length&&(Xe.mode=Ee);break;case Re:if(0===et)break inf_leave;Je[Qe++]=Xe.length,et--,Xe.mode=Ee;break;case Te:if(Xe.wrap){for(;32>rt;){if(0===$e)break inf_leave;$e--,tt|=Ve[qe++]<<rt,rt+=8}if(nt-=et,Ke.total_out+=nt,Xe.total+=nt,nt&&(Ke.adler=Xe.check=Xe.flags?W(Xe.check,Je,nt,Qe-nt):Z(Xe.check,Je,nt,Qe-nt)),nt=et,(Xe.flags?tt:C(tt))!==Xe.check){Ke.msg="incorrect data check",Xe.mode=Ne;break}tt=0,rt=0}Xe.mode=De;case De:if(Xe.wrap&&Xe.flags){for(;32>rt;){if(0===$e)break inf_leave;$e--,tt+=Ve[qe++]<<rt,rt+=8}if(tt!==(4294967295&Xe.total)){Ke.msg="incorrect length check",Xe.mode=Ne;break}tt=0,rt=0}Xe.mode=Fe;case Fe:_t=1;break inf_leave;case Ne:_t=re;break inf_leave;case Pe:return ae;case 32:default:return te;}return(Ke.next_out=Qe,Ke.avail_out=et,Ke.next_in=qe,Ke.avail_in=$e,Xe.hold=tt,Xe.bits=rt,(Xe.wsize||nt!==Ke.avail_out&&Xe.mode<Ne&&(Xe.mode<Te||Ye!==X))&&D(Ke,Ke.output,Ke.next_out,nt-Ke.avail_out))?(Xe.mode=Pe,ae):(at-=Ke.avail_in,nt-=Ke.avail_out,Ke.total_in+=at,Ke.total_out+=nt,Xe.total+=nt,Xe.wrap&&nt&&(Ke.adler=Xe.check=Xe.flags?W(Xe.check,Je,nt,Ke.next_out-nt):Z(Xe.check,Je,nt,Ke.next_out-nt)),Ke.data_type=Xe.bits+(Xe.last?64:0)+(Xe.mode===be?128:0)+(Xe.mode===Ce||Xe.mode===xe?256:0),(0===at&&0===nt||Ye===X)&&_t===Q&&(_t=-5),_t)},S.inflateEnd=function(Ke){if(!Ke||!Ke.state)return te;var Ye=Ke.state;return Ye.window&&(Ye.window=null),Ke.state=null,Q},S.inflateGetHeader=function(Ke,Ye){var Xe;return Ke&&Ke.state?(Xe=Ke.state,0==(2&Xe.wrap))?te:(Xe.head=Ye,Ye.done=!1,Q):te},S.inflateSetDictionary=function(Ke,Ye){var Xe=Ye.length,Ve,Je,qe;return Ke&&Ke.state?(Ve=Ke.state,0!==Ve.wrap&&Ve.mode!==ge)?te:Ve.mode===ge&&(Je=1,Je=Z(Je,Ye,Xe,0),Je!==Ve.check)?re:(qe=D(Ke,Ye,Xe,Xe),qe)?(Ve.mode=Pe,ae):(Ve.havedict=1,Q):te},S.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(x,z){"use strict";var C=x("../utils/common"),E=15,I=852,O=592,A=0,B=1,R=2,T=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],D=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],F=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],N=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];z.exports=function(L,U,Z,W,M,H,G,K){var Y=K.bits,X=0,V=0,J=0,Q=0,$=0,ee=0,te=0,re=0,ae=0,ne=0,ue=null,pe=0,he=new C.Buf16(E+1),fe=new C.Buf16(E+1),_e=null,ge=0,se,ie,oe,de,le,ce,be,ye,ke;for(X=0;X<=E;X++)he[X]=0;for(V=0;V<W;V++)he[U[Z+V]]++;for($=Y,Q=E;1<=Q&&0===he[Q];Q--);if($>Q&&($=Q),0==Q)return M[H++]=20971520,M[H++]=20971520,K.bits=1,0;for(J=1;J<Q&&0===he[J];J++);for($<J&&($=J),re=1,X=1;X<=E;X++)if(re<<=1,re-=he[X],0>re)return-1;if(0<re&&(L===A||1!=Q))return-1;for(fe[1]=0,X=1;X<E;X++)fe[X+1]=fe[X]+he[X];for(V=0;V<W;V++)0!==U[Z+V]&&(G[fe[U[Z+V]]++]=V);if(L===A?(ue=_e=G,ce=19):L===B?(ue=T,pe-=257,_e=D,ge-=257,ce=256):(ue=F,_e=N,ce=-1),ne=0,V=0,X=J,le=H,ee=$,te=0,oe=-1,ae=1<<$,de=ae-1,L===B&&ae>I||L===R&&ae>O)return 1;for(;;){be=X-te,G[V]<ce?(ye=0,ke=G[V]):G[V]>ce?(ye=_e[ge+G[V]],ke=ue[pe+G[V]]):(ye=96,ke=0),se=1<<X-te,ie=1<<ee,J=ie;do ie-=se,M[le+(ne>>te)+ie]=0|(be<<24|ye<<16|ke);while(0!==ie);for(se=1<<X-1;ne&se;)se>>=1;if(0===se?ne=0:(ne&=se-1,ne+=se),V++,0==--he[X]){if(X==Q)break;X=U[Z+G[V]]}if(X>$&&(ne&de)!==oe){for(0==te&&(te=$),le+=J,ee=X-te,re=1<<ee;ee+te<Q&&(re-=he[ee+te],!(0>=re));)ee++,re<<=1;if(ae+=1<<ee,L===B&&ae>I||L===R&&ae>O)return 1;oe=ne&de,M[oe]=0|($<<24|ee<<16|le-H)}}return 0!=ne&&(M[le+ne]=0|(4194304|X-te<<24)),K.bits=$,0}},{"../utils/common":41}],51:[function(x,z){"use strict";z.exports={0:"",1:"stream end",2:"need dictionary","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(x,z,S){"use strict";function C(We){for(var Me=We.length;0<=--Me;)We[Me]=0}function E(We,Me,He,Ge,Ke){this.static_tree=We,this.extra_bits=Me,this.extra_base=He,this.elems=Ge,this.max_length=Ke,this.has_stree=We&&We.length}function I(We,Me){this.dyn_tree=We,this.max_code=0,this.stat_desc=Me}function O(We){return 256>We?De[We]:De[256+(We>>>7)]}function A(We,Me){We.pending_buf[We.pending++]=255&Me,We.pending_buf[We.pending++]=255&Me>>>8}function B(We,Me,He){We.bi_valid>xe-He?(We.bi_buf|=65535&Me<<We.bi_valid,A(We,We.bi_buf),We.bi_buf=Me>>xe-We.bi_valid,We.bi_valid+=He-xe):(We.bi_buf|=65535&Me<<We.bi_valid,We.bi_valid+=He)}function R(We,Me,He){B(We,He[2*Me],He[2*Me+1])}function T(We,Me){var He=0;do He|=1&We,We>>>=1,He<<=1;while(0<--Me);return He>>>1}function D(We){16===We.bi_valid?(A(We,We.bi_buf),We.bi_buf=0,We.bi_valid=0):8<=We.bi_valid&&(We.pending_buf[We.pending++]=255&We.bi_buf,We.bi_buf>>=8,We.bi_valid-=8)}function F(We,Me){var He=Me.dyn_tree,Ge=Me.max_code,Ke=Me.stat_desc.static_tree,Ye=Me.stat_desc.has_stree,Xe=Me.stat_desc.extra_bits,Ve=Me.stat_desc.extra_base,Je=Me.stat_desc.max_length,qe,Qe,$e,et,tt,rt,at=0;for(et=0;et<=ke;et++)We.bl_count[et]=0;for(He[2*We.heap[We.heap_max]+1]=0,qe=We.heap_max+1;qe<ye;qe++)(Qe=We.heap[qe],et=He[2*He[2*Qe+1]+1]+1,et>Je&&(et=Je,at++),He[2*Qe+1]=et,!(Qe>Ge))&&(We.bl_count[et]++,tt=0,Qe>=Ve&&(tt=Xe[Qe-Ve]),rt=He[2*Qe],We.opt_len+=rt*(et+tt),Ye&&(We.static_len+=rt*(Ke[2*Qe+1]+tt)));if(0!=at){do{for(et=Je-1;0===We.bl_count[et];)et--;We.bl_count[et]--,We.bl_count[et+1]+=2,We.bl_count[Je]--,at-=2}while(0<at);for(et=Je;0!==et;et--)for(Qe=We.bl_count[et];0!==Qe;)($e=We.heap[--qe],!($e>Ge))&&(He[2*$e+1]!==et&&(We.opt_len+=(et-He[2*$e+1])*He[2*$e],He[2*$e+1]=et),Qe--)}}function N(We,Me,He){var Ge=Array(ke+1),Ke=0,Ye,Xe;for(Ye=1;Ye<=ke;Ye++)Ge[Ye]=Ke=Ke+He[Ye-1]<<1;for(Xe=0;Xe<=Me;Xe++){var Ve=We[2*Xe+1];0!==Ve&&(We[2*Xe]=T(Ge[Ve]++,Ve))}}function P(){var We,Me,He,Ge,Ke,Ye=Array(ke+1);for(He=0,Ge=0;Ge<he-1;Ge++)for(Ne[Ge]=He,We=0;We<1<<Ee[Ge];We++)Fe[He++]=Ge;for(Fe[He-1]=Ge,Ke=0,Ge=0;16>Ge;Ge++)for(Pe[Ge]=Ke,We=0;We<1<<Ie[Ge];We++)De[Ke++]=Ge;for(Ke>>=7;Ge<ge;Ge++)for(Pe[Ge]=Ke<<7,We=0;We<1<<Ie[Ge]-7;We++)De[256+Ke++]=Ge;for(Me=0;Me<=ke;Me++)Ye[Me]=0;for(We=0;143>=We;)Re[2*We+1]=8,We++,Ye[8]++;for(;255>=We;)Re[2*We+1]=9,We++,Ye[9]++;for(;279>=We;)Re[2*We+1]=7,We++,Ye[7]++;for(;287>=We;)Re[2*We+1]=8,We++,Ye[8]++;for(N(Re,_e+1,Ye),We=0;We<ge;We++)Te[2*We+1]=5,Te[2*We]=T(We,5);Le=new E(Re,Ee,fe+1,_e,ke),Ue=new E(Te,Ie,0,ge,ke),je=new E([],Oe,0,be,7)}function L(We){var Me;for(Me=0;Me<_e;Me++)We.dyn_ltree[2*Me]=0;for(Me=0;Me<ge;Me++)We.dyn_dtree[2*Me]=0;for(Me=0;Me<be;Me++)We.bl_tree[2*Me]=0;We.dyn_ltree[2*ve]=1,We.opt_len=We.static_len=0,We.last_lit=We.matches=0}function U(We){8<We.bi_valid?A(We,We.bi_buf):0<We.bi_valid&&(We.pending_buf[We.pending++]=We.bi_buf),We.bi_buf=0,We.bi_valid=0}function Z(We,Me,He,Ge){U(We),Ge&&(A(We,He),A(We,~He)),ae.arraySet(We.pending_buf,We.window,Me,He,We.pending),We.pending+=He}function W(We,Me,He,Ge){var Ke=2*Me,Ye=2*He;return We[Ke]<We[Ye]||We[Ke]===We[Ye]&&Ge[Me]<=Ge[He]}function M(We,Me,He){for(var Ge=We.heap[He],Ke=He<<1;Ke<=We.heap_len&&(Ke<We.heap_len&&W(Me,We.heap[Ke+1],We.heap[Ke],We.depth)&&Ke++,!W(Me,Ge,We.heap[Ke],We.depth));)We.heap[He]=We.heap[Ke],He=Ke,Ke<<=1;We.heap[He]=Ge}function H(We,Me,He){var Ge,Ke,Ye=0,Xe,Ve;if(0!==We.last_lit)do Ge=We.pending_buf[We.d_buf+2*Ye]<<8|We.pending_buf[We.d_buf+2*Ye+1],Ke=We.pending_buf[We.l_buf+Ye],Ye++,0===Ge?R(We,Ke,Me):(Xe=Fe[Ke],R(We,Xe+fe+1,Me),Ve=Ee[Xe],0!==Ve&&(Ke-=Ne[Xe],B(We,Ke,Ve)),Ge--,Xe=O(Ge),R(We,Xe,He),Ve=Ie[Xe],0!==Ve&&(Ge-=Pe[Xe],B(We,Ge,Ve)));while(Ye<We.last_lit);R(We,ve,Me)}function G(We,Me){var He=Me.dyn_tree,Ge=Me.stat_desc.static_tree,Ke=Me.stat_desc.has_stree,Ye=Me.stat_desc.elems,Xe,Ve,Je=-1,qe;for(We.heap_len=0,We.heap_max=ye,Xe=0;Xe<Ye;Xe++)0===He[2*Xe]?He[2*Xe+1]=0:(We.heap[++We.heap_len]=Je=Xe,We.depth[Xe]=0);for(;2>We.heap_len;)qe=We.heap[++We.heap_len]=2>Je?++Je:0,He[2*qe]=1,We.depth[qe]=0,We.opt_len--,Ke&&(We.static_len-=Ge[2*qe+1]);for(Me.max_code=Je,Xe=We.heap_len>>1;1<=Xe;Xe--)M(We,He,Xe);qe=Ye;do Xe=We.heap[1],We.heap[1]=We.heap[We.heap_len--],M(We,He,1),Ve=We.heap[1],We.heap[--We.heap_max]=Xe,We.heap[--We.heap_max]=Ve,He[2*qe]=He[2*Xe]+He[2*Ve],We.depth[qe]=(We.depth[Xe]>=We.depth[Ve]?We.depth[Xe]:We.depth[Ve])+1,He[2*Xe+1]=He[2*Ve+1]=qe,We.heap[1]=qe++,M(We,He,1);while(2<=We.heap_len);We.heap[--We.heap_max]=We.heap[1],F(We,Me),N(He,Je,We.bl_count)}function K(We,Me,He){var Ge,Ke=-1,Ye,Xe=Me[1],Ve=0,Je=7,qe=4;for(0===Xe&&(Je=138,qe=3),Me[2*(He+1)+1]=65535,Ge=0;Ge<=He;Ge++){if(Ye=Xe,Xe=Me[2*(Ge+1)+1],++Ve<Je&&Ye===Xe)continue;else Ve<qe?We.bl_tree[2*Ye]+=Ve:0===Ye?10>=Ve?We.bl_tree[2*Se]++:We.bl_tree[2*Ce]++:(Ye!==Ke&&We.bl_tree[2*Ye]++,We.bl_tree[2*ze]++);Ve=0,Ke=Ye,0===Xe?(Je=138,qe=3):Ye===Xe?(Je=6,qe=3):(Je=7,qe=4)}}function Y(We,Me,He){var Ge,Ke=-1,Ye,Xe=Me[1],Ve=0,Je=7,qe=4;for(0===Xe&&(Je=138,qe=3),Ge=0;Ge<=He;Ge++){if(Ye=Xe,Xe=Me[2*(Ge+1)+1],++Ve<Je&&Ye===Xe)continue;else if(Ve<qe)do R(We,Ye,We.bl_tree);while(0!=--Ve);else 0===Ye?10>=Ve?(R(We,Se,We.bl_tree),B(We,Ve-3,3)):(R(We,Ce,We.bl_tree),B(We,Ve-11,7)):(Ye!==Ke&&(R(We,Ye,We.bl_tree),Ve--),R(We,ze,We.bl_tree),B(We,Ve-3,2));Ve=0,Ke=Ye,0===Xe?(Je=138,qe=3):Ye===Xe?(Je=6,qe=3):(Je=7,qe=4)}}function X(We){var Me;for(K(We,We.dyn_ltree,We.l_desc.max_code),K(We,We.dyn_dtree,We.d_desc.max_code),G(We,We.bl_desc),Me=be-1;3<=Me&&0===We.bl_tree[2*Ae[Me]+1];Me--);return We.opt_len+=3*(Me+1)+5+5+4,Me}function V(We,Me,He,Ge){var Ke;for(B(We,Me-257,5),B(We,He-1,5),B(We,Ge-4,4),Ke=0;Ke<Ge;Ke++)B(We,We.bl_tree[2*Ae[Ke]+1],3);Y(We,We.dyn_ltree,Me-1),Y(We,We.dyn_dtree,He-1)}function J(We){var Me=4093624447,He;for(He=0;31>=He;He++,Me>>>=1)if(1&Me&&0!==We.dyn_ltree[2*He])return se;if(0!==We.dyn_ltree[18]||0!==We.dyn_ltree[20]||0!==We.dyn_ltree[26])return ie;for(He=32;He<fe;He++)if(0!==We.dyn_ltree[2*He])return ie;return se}function $(We,Me,He,Ge){B(We,(0<<1)+(Ge?1:0),3),Z(We,Me,He,!0)}var ae=x("../utils/common"),se=0,ie=1,le=1,he=29,fe=256,_e=fe+1+he,ge=30,be=19,ye=2*_e+1,ke=15,xe=16,ve=256,ze=16,Se=17,Ce=18,Ee=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ie=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Re=Array(2*(_e+2));C(Re);var Te=Array(2*ge);C(Te);var De=Array(512);C(De);var Fe=Array(258-3+1);C(Fe);var Ne=Array(he);C(Ne);var Pe=Array(ge);C(Pe);var Le,Ue,je,Ze=!1;S._tr_init=function(We){Ze||(P(),Ze=!0),We.l_desc=new I(We.dyn_ltree,Le),We.d_desc=new I(We.dyn_dtree,Ue),We.bl_desc=new I(We.bl_tree,je),We.bi_buf=0,We.bi_valid=0,L(We)},S._tr_stored_block=$,S._tr_flush_block=function(We,Me,He,Ge){var Ke,Ye,Xe=0;0<We.level?(We.strm.data_type===2&&(We.strm.data_type=J(We)),G(We,We.l_desc),G(We,We.d_desc),Xe=X(We),Ke=We.opt_len+3+7>>>3,Ye=We.static_len+3+7>>>3,Ye<=Ke&&(Ke=Ye)):Ke=Ye=He+5,He+4<=Ke&&-1!==Me?$(We,Me,He,Ge):We.strategy===4||Ye===Ke?(B(We,(le<<1)+(Ge?1:0),3),H(We,Re,Te)):(B(We,(2<<1)+(Ge?1:0),3),V(We,We.l_desc.max_code+1,We.d_desc.max_code+1,Xe+1),H(We,We.dyn_ltree,We.dyn_dtree)),L(We),Ge&&U(We)},S._tr_tally=function(We,Me,He){return We.pending_buf[We.d_buf+2*We.last_lit]=255&Me>>>8,We.pending_buf[We.d_buf+2*We.last_lit+1]=255&Me,We.pending_buf[We.l_buf+We.last_lit]=255&He,We.last_lit++,0===Me?We.dyn_ltree[2*He]++:(We.matches++,Me--,We.dyn_ltree[2*(Fe[He]+fe+1)]++,We.dyn_dtree[2*O(Me)]++),We.last_lit===We.lit_bufsize-1},S._tr_align=function(We){B(We,le<<1,3),R(We,ve,Re),D(We)}},{"../utils/common":41}],53:[function(x,z){"use strict";z.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(x,z){"use strict";z.exports="function"==typeof setImmediate?setImmediate:function(){var E=[].slice.apply(arguments);E.splice(1,0,0),setTimeout.apply(null,E)}},{}]},{},[10])(10)});

var THREE={REVISION:'58'};(function(){for(var _=0,S=['ms','moz','webkit','o'],T=0;T<S.length&&!window.requestAnimationFrame;++T)window.requestAnimationFrame=window[S[T]+'RequestAnimationFrame'],window.cancelAnimationFrame=window[S[T]+'CancelAnimationFrame']||window[S[T]+'CancelRequestAnimationFrame'];window.requestAnimationFrame===void 0&&(window.requestAnimationFrame=function(M){var A=Date.now(),E=Math.max(0,16-(A-_)),C=window.setTimeout(function(){M(A+E)},E);return _=A+E,C}),window.cancelAnimationFrame=window.cancelAnimationFrame||function(M){window.clearTimeout(M)}})(),THREE.CullFaceNone=0,THREE.CullFaceBack=1,THREE.CullFaceFront=2,THREE.CullFaceFrontBack=3,THREE.FrontFaceDirectionCW=0,THREE.FrontFaceDirectionCCW=1,THREE.BasicShadowMap=0,THREE.PCFShadowMap=1,THREE.PCFSoftShadowMap=2,THREE.FrontSide=0,THREE.BackSide=1,THREE.DoubleSide=2,THREE.NoShading=0,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.CustomBlending=5,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.AddOperation=2,THREE.UVMapping=function(){},THREE.CubeReflectionMapping=function(){},THREE.CubeRefractionMapping=function(){},THREE.SphericalReflectionMapping=function(){},THREE.SphericalRefractionMapping=function(){},THREE.RepeatWrapping=1e3,THREE.ClampToEdgeWrapping=1001,THREE.MirroredRepeatWrapping=1002,THREE.NearestFilter=1003,THREE.NearestMipMapNearestFilter=1004,THREE.NearestMipMapLinearFilter=1005,THREE.LinearFilter=1006,THREE.LinearMipMapNearestFilter=1007,THREE.LinearMipMapLinearFilter=1008,THREE.UnsignedByteType=1009,THREE.ByteType=1010,THREE.ShortType=1011,THREE.UnsignedShortType=1012,THREE.IntType=1013,THREE.UnsignedIntType=1014,THREE.FloatType=1015,THREE.UnsignedShort4444Type=1016,THREE.UnsignedShort5551Type=1017,THREE.UnsignedShort565Type=1018,THREE.AlphaFormat=1019,THREE.RGBFormat=1020,THREE.RGBAFormat=1021,THREE.LuminanceFormat=1022,THREE.LuminanceAlphaFormat=1023,THREE.RGB_S3TC_DXT1_Format=2001,THREE.RGBA_S3TC_DXT1_Format=2002,THREE.RGBA_S3TC_DXT3_Format=2003,THREE.RGBA_S3TC_DXT5_Format=2004,THREE.Color=function(_){return void 0!==_&&this.set(_),this},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(_){return this.value=_,_ instanceof THREE.Color?this.copy(_):'number'==typeof _?this.setHex(_):'string'==typeof _?this.setStyle(_):Array.isArray(_)&&this.setArray(_),this},setArray:function(_){return this.r=_[0]/255,this.g=_[1]/255,this.b=_[2]/255,this},setHex:function(_){return _=Math.floor(_),this.r=(255&_>>16)/255,this.g=(255&_>>8)/255,this.b=(255&_)/255,this},setRGB:function(_,S,T){return this.r=_,this.g=S,this.b=T,this},setHSL:function(_,S,T){if(0===S)this.r=this.g=this.b=T;else{var M=function(C,D,R){return 0>R&&(R+=1),1<R&&(R-=1),R<1/6?C+6*(D-C)*R:R<1/2?D:R<2/3?C+6*(D-C)*(2/3-R):C},A=0.5>=T?T*(1+S):T+S-T*S,E=2*T-A;this.r=M(E,A,_+1/3),this.g=M(E,A,_),this.b=M(E,A,_-1/3)}return this},setStyle:function(_){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(_)){var S=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(_);return this.r=Math.min(255,parseInt(S[1],10))/255,this.g=Math.min(255,parseInt(S[2],10))/255,this.b=Math.min(255,parseInt(S[3],10))/255,this}if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(_)){var S=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(_);return this.r=Math.min(100,parseInt(S[1],10))/100,this.g=Math.min(100,parseInt(S[2],10))/100,this.b=Math.min(100,parseInt(S[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(_)){var S=/^\#([0-9a-f]{6})$/i.exec(_);return this.setHex(parseInt(S[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(_)){var S=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(_);return this.setHex(parseInt(S[1]+S[1]+S[2]+S[2]+S[3]+S[3],16)),this}return /^(\w+)$/i.test(_)?(this.setHex(THREE.ColorKeywords[_]),this):void 0},copy:function(_){return this.r=_.r,this.g=_.g,this.b=_.b,this},copyGammaToLinear:function(_){return this.r=_.r*_.r,this.g=_.g*_.g,this.b=_.b*_.b,this},copyLinearToGamma:function(_){return this.r=Math.sqrt(_.r),this.g=Math.sqrt(_.g),this.b=Math.sqrt(_.b),this},convertGammaToLinear:function(){var _=this.r,S=this.g,T=this.b;return this.r=_*_,this.g=S*S,this.b=T*T,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return('000000'+this.getHex().toString(16)).slice(-6)},getHSL:function(){var _={h:0,s:0,l:0};return function(){var S=this.r,T=this.g,M=this.b,A=Math.max(S,T,M),E=Math.min(S,T,M),R=(E+A)/2,C,D;if(E===A)C=0,D=0;else{var P=A-E;D=0.5>=R?P/(A+E):P/(2-A-E),A===S?C=(T-M)/P+(T<M?6:0):A===T?C=(M-S)/P+2:A===M?C=(S-T)/P+4:void 0,C/=6}return _.h=C,_.s=D,_.l=R,_}}(),getStyle:function(){return'rgb('+(0|255*this.r)+','+(0|255*this.g)+','+(0|255*this.b)+')'},offsetHSL:function(_,S,T){var M=this.getHSL();return M.h+=_,M.s+=S,M.l+=T,this.setHSL(M.h,M.s,M.l),this},add:function(_){return this.r+=_.r,this.g+=_.g,this.b+=_.b,this},addColors:function(_,S){return this.r=_.r+S.r,this.g=_.g+S.g,this.b=_.b+S.b,this},addScalar:function(_){return this.r+=_,this.g+=_,this.b+=_,this},multiply:function(_){return this.r*=_.r,this.g*=_.g,this.b*=_.b,this},multiplyScalar:function(_){return this.r*=_,this.g*=_,this.b*=_,this},lerp:function(_,S){return this.r+=(_.r-this.r)*S,this.g+=(_.g-this.g)*S,this.b+=(_.b-this.b)*S,this},equals:function(_){return _.r===this.r&&_.g===this.g&&_.b===this.b},clone:function(){return new THREE.Color().setRGB(this.r,this.g,this.b)}},THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},THREE.Quaternion=function(_,S,T,M){this.x=_||0,this.y=S||0,this.z=T||0,this.w=M===void 0?1:M},THREE.Quaternion.prototype={constructor:THREE.Quaternion,set:function(_,S,T,M){return this.x=_,this.y=S,this.z=T,this.w=M,this},copy:function(_){return this.x=_.x,this.y=_.y,this.z=_.z,this.w=_.w,this},setFromEuler:function(_,S){var T=Math.cos(_.x/2),M=Math.cos(_.y/2),A=Math.cos(_.z/2),E=Math.sin(_.x/2),C=Math.sin(_.y/2),D=Math.sin(_.z/2);return void 0===S||'XYZ'===S?(this.x=E*M*A+T*C*D,this.y=T*C*A-E*M*D,this.z=T*M*D+E*C*A,this.w=T*M*A-E*C*D):'YXZ'===S?(this.x=E*M*A+T*C*D,this.y=T*C*A-E*M*D,this.z=T*M*D-E*C*A,this.w=T*M*A+E*C*D):'ZXY'===S?(this.x=E*M*A-T*C*D,this.y=T*C*A+E*M*D,this.z=T*M*D+E*C*A,this.w=T*M*A-E*C*D):'ZYX'===S?(this.x=E*M*A-T*C*D,this.y=T*C*A+E*M*D,this.z=T*M*D-E*C*A,this.w=T*M*A+E*C*D):'YZX'===S?(this.x=E*M*A+T*C*D,this.y=T*C*A+E*M*D,this.z=T*M*D-E*C*A,this.w=T*M*A-E*C*D):'XZY'==S&&(this.x=E*M*A-T*C*D,this.y=T*C*A-E*M*D,this.z=T*M*D+E*C*A,this.w=T*M*A+E*C*D),this},setFromAxisAngle:function(_,S){var T=S/2,M=Math.sin(T);return this.x=_.x*M,this.y=_.y*M,this.z=_.z*M,this.w=Math.cos(T),this},setFromRotationMatrix:function(_){var S=_.elements,T=S[0],M=S[4],A=S[8],E=S[1],C=S[5],D=S[9],R=S[2],P=S[6],L=S[10],U=T+C+L,N;return 0<U?(N=0.5/Math.sqrt(U+1),this.w=0.25/N,this.x=(P-D)*N,this.y=(A-R)*N,this.z=(E-M)*N):T>C&&T>L?(N=2*Math.sqrt(1+T-C-L),this.w=(P-D)/N,this.x=0.25*N,this.y=(M+E)/N,this.z=(A+R)/N):C>L?(N=2*Math.sqrt(1+C-T-L),this.w=(A-R)/N,this.x=(M+E)/N,this.y=0.25*N,this.z=(D+P)/N):(N=2*Math.sqrt(1+L-T-C),this.w=(E-M)/N,this.x=(A+R)/N,this.y=(D+P)/N,this.z=0.25*N),this},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var _=this.length();return 0===_?(this.x=0,this.y=0,this.z=0,this.w=1):(_=1/_,this.x*=_,this.y*=_,this.z*=_,this.w*=_),this},multiply:function(_,S){return void 0===S?this.multiplyQuaternions(this,_):this.multiplyQuaternions(_,S)},multiplyQuaternions:function(_,S){var T=_.x,M=_.y,A=_.z,E=_.w,C=S.x,D=S.y,R=S.z,P=S.w;return this.x=T*P+E*C+M*R-A*D,this.y=M*P+E*D+A*C-T*R,this.z=A*P+E*R+T*D-M*C,this.w=E*P-T*C-M*D-A*R,this},slerp:function(_,S){var T=this.x,M=this.y,A=this.z,E=this.w,C=E*_.w+T*_.x+M*_.y+A*_.z;if(0>C?(this.w=-_.w,this.x=-_.x,this.y=-_.y,this.z=-_.z,C=-C):this.copy(_),1<=C)return this.w=E,this.x=T,this.y=M,this.z=A,this;const D=1-C*C;if(D<=Number.EPSILON){const N=1-S;return this.w=N*E+S*this.w,this.x=N*T+S*this.x,this.y=N*M+S*this.y,this.z=N*A+S*this.z,this.normalize(),this}const R=Math.sqrt(D),P=Math.atan2(R,C);var L=Math.sin((1-S)*P)/R,U=Math.sin(S*P)/R;return this.w=E*L+this.w*U,this.x=T*L+this.x*U,this.y=M*L+this.y*U,this.z=A*L+this.z*U,this},equals:function(_){return _.x===this.x&&_.y===this.y&&_.z===this.z&&_.w===this.w},fromArray:function(_){return this.x=_[0],this.y=_[1],this.z=_[2],this.w=_[3],this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Quaternion(this.x,this.y,this.z,this.w)},toAxisAngle:function(){1<this.w&&this.normalise();var _=2*Math.acos(this.w),S=Math.sqrt(1-this.w*this.w);return 1e-3>S?(x=this.x,y=this.y,z=this.z):(x=this.x/S,y=this.y/S,z=this.z/S),[new THREE.Vector3(x,y,z),_]}},THREE.Quaternion.slerp=function(_,S,T,M){return T.copy(_).slerp(S,M)},THREE.Vector2=function(_,S){this.x=_||0,this.y=S||0},THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(_,S){return this.x=_,this.y=S,this},setX:function(_){return this.x=_,this},setY:function(_){return this.y=_,this},setComponent:function(_,S){this[_?'y':'x']=S},getComponent:function(_){return this[_?'y':'x']},copy:function(_){return this.x=_.x,this.y=_.y,this},add:function(_){return this.x+=_.x,this.y+=_.y,this},addVectors:function(_,S){return this.x=_.x+S.x,this.y=_.y+S.y,this},addScalar:function(_){return this.x+=_,this.y+=_,this},sub:function(_){return this.x-=_.x,this.y-=_.y,this},subVectors:function(_,S){return this.x=_.x-S.x,this.y=_.y-S.y,this},multiplyScalar:function(_){return this.x*=_,this.y*=_,this},divideScalar:function(_){return 0===_?this.set(0,0):(this.x/=_,this.y/=_),this},min:function(_){return this.x>_.x&&(this.x=_.x),this.y>_.y&&(this.y=_.y),this},max:function(_){return this.x<_.x&&(this.x=_.x),this.y<_.y&&(this.y=_.y),this},clamp:function(_,S){return this.x<_.x?this.x=_.x:this.x>S.x&&(this.x=S.x),this.y<_.y?this.y=_.y:this.y>S.y&&(this.y=S.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(_){return this.x*_.x+this.y*_.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(_){return Math.sqrt(this.distanceToSquared(_))},distanceToSquared:function(_){var S=this.x-_.x,T=this.y-_.y;return S*S+T*T},setLength:function(_){var S=this.length();return 0!==S&&_!==S&&this.multiplyScalar(_/S),this},lerp:function(_,S){return this.x+=(_.x-this.x)*S,this.y+=(_.y-this.y)*S,this},equals:function(_){return _.x===this.x&&_.y===this.y},fromArray:function(_){return this.x=_[0],this.y=_[1],this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}},THREE.Vector3=function(_,S,T){this.x=_||0,this.y=S||0,this.z=T||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(_,S,T){return this.x=_,this.y=S,this.z=T,this},setX:function(_){return this.x=_,this},setY:function(_){return this.y=_,this},setZ:function(_){return this.z=_,this},setComponent:function(_,S){this[0===_?'x':1===_?'y':'z']=S},getComponent:function(_){return this[0===_?'x':1===_?'y':'z']},copy:function(_){return this.x=_.x,this.y=_.y,this.z=_.z,this},add:function(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this},addScalar:function(_){return this.x+=_,this.y+=_,this.z+=_,this},addVectors:function(_,S){return this.x=_.x+S.x,this.y=_.y+S.y,this.z=_.z+S.z,this},sub:function(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this},subVectors:function(_,S){return this.x=_.x-S.x,this.y=_.y-S.y,this.z=_.z-S.z,this},multiply:function(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this},multiplyScalar:function(_){return this.x*=_,this.y*=_,this.z*=_,this},multiplyVectors:function(_,S){return this.x=_.x*S.x,this.y=_.y*S.y,this.z=_.z*S.z,this},applyMatrix3:function(_){var S=this.x,T=this.y,M=this.z,A=_.elements;return this.x=A[0]*S+A[3]*T+A[6]*M,this.y=A[1]*S+A[4]*T+A[7]*M,this.z=A[2]*S+A[5]*T+A[8]*M,this},applyMatrix4:function(_){var S=this.x,T=this.y,M=this.z,A=_.elements;return this.x=A[0]*S+A[4]*T+A[8]*M+A[12],this.y=A[1]*S+A[5]*T+A[9]*M+A[13],this.z=A[2]*S+A[6]*T+A[10]*M+A[14],this},applyProjection:function(_){var S=this.x,T=this.y,M=this.z,A=_.elements,E=1/(A[3]*S+A[7]*T+A[11]*M+A[15]);return this.x=(A[0]*S+A[4]*T+A[8]*M+A[12])*E,this.y=(A[1]*S+A[5]*T+A[9]*M+A[13])*E,this.z=(A[2]*S+A[6]*T+A[10]*M+A[14])*E,this},applyQuaternion:function(_){var S=this.x,T=this.y,M=this.z,A=_.x,E=_.y,C=_.z,D=_.w,R=D*S+E*M-C*T,P=D*T+C*S-A*M,L=D*M+A*T-E*S,U=-A*S-E*T-C*M;return this.x=R*D+U*-A+P*-C-L*-E,this.y=P*D+U*-E+L*-A-R*-C,this.z=L*D+U*-C+R*-E-P*-A,this},transformDirection:function(_){var S=this.x,T=this.y,M=this.z,A=_.elements;return this.x=A[0]*S+A[4]*T+A[8]*M,this.y=A[1]*S+A[5]*T+A[9]*M,this.z=A[2]*S+A[6]*T+A[10]*M,this.normalize(),this},divide:function(_){return this.x/=_.x,this.y/=_.y,this.z/=_.z,this},divideScalar:function(_){return 0===_?(this.x=0,this.y=0,this.z=0):(this.x/=_,this.y/=_,this.z/=_),this},min:function(_){return this.x>_.x&&(this.x=_.x),this.y>_.y&&(this.y=_.y),this.z>_.z&&(this.z=_.z),this},max:function(_){return this.x<_.x&&(this.x=_.x),this.y<_.y&&(this.y=_.y),this.z<_.z&&(this.z=_.z),this},clamp:function(_,S){return this.x<_.x?this.x=_.x:this.x>S.x&&(this.x=S.x),this.y<_.y?this.y=_.y:this.y>S.y&&(this.y=S.y),this.z<_.z?this.z=_.z:this.z>S.z&&(this.z=S.z),this},negate:function(){return this.multiplyScalar(-1)},dot:function(_){return this.x*_.x+this.y*_.y+this.z*_.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(_){var S=this.length();return 0!==S&&_!==S&&this.multiplyScalar(_/S),this},lerp:function(_,S){return this.x+=(_.x-this.x)*S,this.y+=(_.y-this.y)*S,this.z+=(_.z-this.z)*S,this},cross:function(_){var T=this.x,M=this.y,A=this.z;return this.x=M*_.z-A*_.y,this.y=A*_.x-T*_.z,this.z=T*_.y-M*_.x,this},crossVectors:function(_,S){return this.x=_.y*S.z-_.z*S.y,this.y=_.z*S.x-_.x*S.z,this.z=_.x*S.y-_.y*S.x,this},angleTo:function(_){var S=this.dot(_)/(this.length()*_.length());return Math.acos(THREE.Math.clamp(S,-1,1))},distanceTo:function(_){return Math.sqrt(this.distanceToSquared(_))},distanceToSquared:function(_){var S=this.x-_.x,T=this.y-_.y,M=this.z-_.z;return S*S+T*T+M*M},setEulerFromRotationMatrix:function(_,S){function T(F){return Math.min(Math.max(F,-1),1)}var M=_.elements,A=M[0],E=M[4],C=M[8],D=M[1],R=M[5],P=M[9],L=M[2],U=M[6],N=M[10];return void 0===S||'XYZ'===S?(this.y=Math.asin(T(C)),0.99999>Math.abs(C)?(this.x=Math.atan2(-P,N),this.z=Math.atan2(-E,A)):(this.x=Math.atan2(U,R),this.z=0)):'YXZ'===S?(this.x=Math.asin(-T(P)),0.99999>Math.abs(P)?(this.y=Math.atan2(C,N),this.z=Math.atan2(D,R)):(this.y=Math.atan2(-L,A),this.z=0)):'ZXY'===S?(this.x=Math.asin(T(U)),0.99999>Math.abs(U)?(this.y=Math.atan2(-L,N),this.z=Math.atan2(-E,R)):(this.y=0,this.z=Math.atan2(D,A))):'ZYX'===S?(this.y=Math.asin(-T(L)),0.99999>Math.abs(L)?(this.x=Math.atan2(U,N),this.z=Math.atan2(D,A)):(this.x=0,this.z=Math.atan2(-E,R))):'YZX'===S?(this.z=Math.asin(T(D)),0.99999>Math.abs(D)?(this.x=Math.atan2(-P,R),this.y=Math.atan2(-L,A)):(this.x=0,this.y=Math.atan2(C,N))):'XZY'==S&&(this.z=Math.asin(-T(E)),0.99999>Math.abs(E)?(this.x=Math.atan2(U,R),this.y=Math.atan2(C,A)):(this.x=Math.atan2(-P,N),this.y=0)),this},setEulerFromQuaternion:function(_,S){function T(D){return Math.min(Math.max(D,-1),1)}var M=_.x*_.x,A=_.y*_.y,E=_.z*_.z,C=_.w*_.w;return void 0===S||'XYZ'===S?(this.x=Math.atan2(2*(_.x*_.w-_.y*_.z),C-M-A+E),this.y=Math.asin(T(2*(_.x*_.z+_.y*_.w))),this.z=Math.atan2(2*(_.z*_.w-_.x*_.y),C+M-A-E)):'YXZ'===S?(this.x=Math.asin(T(2*(_.x*_.w-_.y*_.z))),this.y=Math.atan2(2*(_.x*_.z+_.y*_.w),C-M-A+E),this.z=Math.atan2(2*(_.x*_.y+_.z*_.w),C-M+A-E)):'ZXY'===S?(this.x=Math.asin(T(2*(_.x*_.w+_.y*_.z))),this.y=Math.atan2(2*(_.y*_.w-_.z*_.x),C-M-A+E),this.z=Math.atan2(2*(_.z*_.w-_.x*_.y),C-M+A-E)):'ZYX'===S?(this.x=Math.atan2(2*(_.x*_.w+_.z*_.y),C-M-A+E),this.y=Math.asin(T(2*(_.y*_.w-_.x*_.z))),this.z=Math.atan2(2*(_.x*_.y+_.z*_.w),C+M-A-E)):'YZX'===S?(this.x=Math.atan2(2*(_.x*_.w-_.z*_.y),C-M+A-E),this.y=Math.atan2(2*(_.y*_.w-_.x*_.z),C+M-A-E),this.z=Math.asin(T(2*(_.x*_.y+_.z*_.w)))):'XZY'==S&&(this.x=Math.atan2(2*(_.x*_.w+_.y*_.z),C-M+A-E),this.y=Math.atan2(2*(_.x*_.z+_.y*_.w),C+M-A-E),this.z=Math.asin(T(2*(_.z*_.w-_.x*_.y)))),this},getPositionFromMatrix:function(_){return this.x=_.elements[12],this.y=_.elements[13],this.z=_.elements[14],this},getScaleFromMatrix:function(_){var S=this.set(_.elements[0],_.elements[1],_.elements[2]).length(),T=this.set(_.elements[4],_.elements[5],_.elements[6]).length(),M=this.set(_.elements[8],_.elements[9],_.elements[10]).length();return this.x=S,this.y=T,this.z=M,this},getColumnFromMatrix:function(_,S){var T=4*_,M=S.elements;return this.x=M[T],this.y=M[T+1],this.z=M[T+2],this},equals:function(_){return _.x===this.x&&_.y===this.y&&_.z===this.z},fromArray:function(_){return this.x=_[0],this.y=_[1],this.z=_[2],this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)},applyEuler:function(){var _=new THREE.Quaternion;return function(S,T){var M=_.setFromEuler(S,T);return this.applyQuaternion(M),this}}(),applyAxisAngle:function(){var _=new THREE.Quaternion;return function(S,T){var M=_.setFromAxisAngle(S,T);return this.applyQuaternion(M),this}}(),project:function(){var _;return function(T){return void 0==_&&(_=new THREE.Matrix4),_.multiplyMatrices(T.projectionMatrix,_.getInverse(T.matrixWorld)),this.applyProjection(_)}}(),unproject:function(){var _;return function(T){return void 0==_&&(_=new THREE.Matrix4),_.multiplyMatrices(T.matrixWorld,_.getInverse(T.projectionMatrix)),this.applyProjection(_)}}()},THREE.Vector3.prototype.projectOnVector=function(){var _=new THREE.Vector3;return function(S){_.copy(S).normalize();var T=this.dot(_);return this.copy(_).multiplyScalar(T)}}(),THREE.Vector3.prototype.projectOnPlane=function(){var _=new THREE.Vector3;return function(S){return _.copy(this).projectOnVector(S),this.sub(_)}}(),THREE.Vector3.prototype.reflect=function(){var _=new THREE.Vector3;return function(S){return _.copy(this).projectOnVector(S).multiplyScalar(2),this.subVectors(_,this)}}(),THREE.Vector4=function(_,S,T,M){this.x=_||0,this.y=S||0,this.z=T||0,this.w=M===void 0?1:M},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(_,S,T,M){return this.x=_,this.y=S,this.z=T,this.w=M,this},setX:function(_){return this.x=_,this},setY:function(_){return this.y=_,this},setZ:function(_){return this.z=_,this},setW:function(_){return this.w=_,this},setComponent:function(_,S){this[0===_?'x':1===_?'y':2===_?'z':'w']=S},getComponent:function(_){return this[0===_?'x':1===_?'y':2===_?'z':'w']},copy:function(_){return this.x=_.x,this.y=_.y,this.z=_.z,this.w=void 0===_.w?1:_.w,this},add:function(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this.w+=_.w,this},addScalar:function(_){return this.x+=_,this.y+=_,this.z+=_,this.w+=_,this},addVectors:function(_,S){return this.x=_.x+S.x,this.y=_.y+S.y,this.z=_.z+S.z,this.w=_.w+S.w,this},sub:function(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this.w-=_.w,this},subVectors:function(_,S){return this.x=_.x-S.x,this.y=_.y-S.y,this.z=_.z-S.z,this.w=_.w-S.w,this},multiplyScalar:function(_){return this.x*=_,this.y*=_,this.z*=_,this.w*=_,this},applyMatrix4:function(_){var S=this.x,T=this.y,M=this.z,A=this.w,E=_.elements;return this.x=E[0]*S+E[4]*T+E[8]*M+E[12]*A,this.y=E[1]*S+E[5]*T+E[9]*M+E[13]*A,this.z=E[2]*S+E[6]*T+E[10]*M+E[14]*A,this.w=E[3]*S+E[7]*T+E[11]*M+E[15]*A,this},divideScalar:function(_){return 0===_?(this.x=0,this.y=0,this.z=0,this.w=1):(this.x/=_,this.y/=_,this.z/=_,this.w/=_),this},setAxisAngleFromQuaternion:function(_){this.w=2*Math.acos(_.w);var S=Math.sqrt(1-_.w*_.w);return 1e-4>S?(this.x=1,this.y=0,this.z=0):(this.x=_.x/S,this.y=_.y/S,this.z=_.z/S),this},setAxisAngleFromRotationMatrix:function(_){var E=0.01,C=0.1,D=_.elements,R=D[0],P=D[4],L=D[8],U=D[1],N=D[5],F=D[9],V=D[2],I=D[6],O=D[10],S,T,M,A;if(Math.abs(P-U)<E&&Math.abs(L-V)<E&&Math.abs(F-I)<E){if(Math.abs(P+U)<C&&Math.abs(L+V)<C&&Math.abs(F+I)<C&&Math.abs(R+N+O-3)<C)return this.set(1,0,0,0),this;S=Math.PI;var B=(R+1)/2,G=(N+1)/2,H=(O+1)/2,W=(P+U)/4,X=(L+V)/4,Y=(F+I)/4;return B>G&&B>H?B<E?(T=0,M=0.707106781,A=0.707106781):(T=Math.sqrt(B),M=W/T,A=X/T):G>H?G<E?(T=0.707106781,M=0,A=0.707106781):(M=Math.sqrt(G),T=W/M,A=Y/M):H<E?(T=0.707106781,M=0.707106781,A=0):(A=Math.sqrt(H),T=X/A,M=Y/A),this.set(T,M,A,S),this}var K=Math.sqrt((I-F)*(I-F)+(L-V)*(L-V)+(U-P)*(U-P));return 1e-3>Math.abs(K)&&(K=1),this.x=(I-F)/K,this.y=(L-V)/K,this.z=(U-P)/K,this.w=Math.acos((R+N+O-1)/2),this},min:function(_){return this.x>_.x&&(this.x=_.x),this.y>_.y&&(this.y=_.y),this.z>_.z&&(this.z=_.z),this.w>_.w&&(this.w=_.w),this},max:function(_){return this.x<_.x&&(this.x=_.x),this.y<_.y&&(this.y=_.y),this.z<_.z&&(this.z=_.z),this.w<_.w&&(this.w=_.w),this},clamp:function(_,S){return this.x<_.x?this.x=_.x:this.x>S.x&&(this.x=S.x),this.y<_.y?this.y=_.y:this.y>S.y&&(this.y=S.y),this.z<_.z?this.z=_.z:this.z>S.z&&(this.z=S.z),this.w<_.w?this.w=_.w:this.w>S.w&&(this.w=S.w),this},negate:function(){return this.multiplyScalar(-1)},dot:function(_){return this.x*_.x+this.y*_.y+this.z*_.z+this.w*_.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(_){var S=this.length();return 0!==S&&_!==S&&this.multiplyScalar(_/S),this},lerp:function(_,S){return this.x+=(_.x-this.x)*S,this.y+=(_.y-this.y)*S,this.z+=(_.z-this.z)*S,this.w+=(_.w-this.w)*S,this},equals:function(_){return _.x===this.x&&_.y===this.y&&_.z===this.z&&_.w===this.w},fromArray:function(_){return this.x=_[0],this.y=_[1],this.z=_[2],this.w=_[3],this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}},THREE.Line3=function(_,S){this.start=_===void 0?new THREE.Vector3:_,this.end=S===void 0?new THREE.Vector3:S},THREE.Line3.prototype={constructor:THREE.Line3,set:function(_,S){return this.start.copy(_),this.end.copy(S),this},copy:function(_){return this.start.copy(_.start),this.end.copy(_.end),this},center:function(_){var S=_||new THREE.Vector3;return S.addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(_){var S=_||new THREE.Vector3;return S.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(_,S){var T=S||new THREE.Vector3;return this.delta(T).multiplyScalar(_).add(this.start)},closestPointToPointParameter:function(){var _=new THREE.Vector3,S=new THREE.Vector3;return function(T,M){_.subVectors(T,this.start),S.subVectors(this.end,this.start);var A=S.dot(S),E=S.dot(_),C=E/A;return M&&(C=THREE.Math.clamp(C,0,1)),C}}(),closestPointToPoint:function(_,S,T){var M=this.closestPointToPointParameter(_,S),A=T||new THREE.Vector3;return this.delta(A).multiplyScalar(M).add(this.start)},applyMatrix4:function(_){return this.start.applyMatrix4(_),this.end.applyMatrix4(_),this},equals:function(_){return _.start.equals(this.start)&&_.end.equals(this.end)},clone:function(){return new THREE.Line3().copy(this)}},THREE.Box2=function(_,S){this.min=_===void 0?new THREE.Vector2(Infinity,Infinity):_,this.max=S===void 0?new THREE.Vector2(-Infinity,-Infinity):S},THREE.Box2.prototype={constructor:THREE.Box2,set:function(_,S){return this.min.copy(_),this.max.copy(S),this},setFromPoints:function(_){if(0<_.length){var S=_[0];this.min.copy(S),this.max.copy(S);for(var T=1,M=_.length;T<M;T++)S=_[T],S.x<this.min.x?this.min.x=S.x:S.x>this.max.x&&(this.max.x=S.x),S.y<this.min.y?this.min.y=S.y:S.y>this.max.y&&(this.max.y=S.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var _=new THREE.Vector2;return function(S,T){var M=_.copy(T).multiplyScalar(0.5);return this.min.copy(S).sub(M),this.max.copy(S).add(M),this}}(),copy:function(_){return this.min.copy(_.min),this.max.copy(_.max),this},makeEmpty:function(){return this.min.x=this.min.y=Infinity,this.max.x=this.max.y=-Infinity,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(_){var S=_||new THREE.Vector2;return S.addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(_){var S=_||new THREE.Vector2;return S.subVectors(this.max,this.min)},expandByPoint:function(_){return this.min.min(_),this.max.max(_),this},expandByVector:function(_){return this.min.sub(_),this.max.add(_),this},expandByScalar:function(_){return this.min.addScalar(-_),this.max.addScalar(_),this},containsPoint:function(_){return _.x<this.min.x||_.x>this.max.x||_.y<this.min.y||_.y>this.max.y?!1:!0},containsBox:function(_){return this.min.x<=_.min.x&&_.max.x<=this.max.x&&this.min.y<=_.min.y&&_.max.y<=this.max.y},getParameter:function(_){return new THREE.Vector2((_.x-this.min.x)/(this.max.x-this.min.x),(_.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(_){return _.max.x<this.min.x||_.min.x>this.max.x||_.max.y<this.min.y||_.min.y>this.max.y?!1:!0},clampPoint:function(_,S){var T=S||new THREE.Vector2;return T.copy(_).clamp(this.min,this.max)},distanceToPoint:function(){var _=new THREE.Vector2;return function(S){var T=_.copy(S).clamp(this.min,this.max);return T.sub(S).length()}}(),intersect:function(_){return this.min.max(_.min),this.max.min(_.max),this},union:function(_){return this.min.min(_.min),this.max.max(_.max),this},translate:function(_){return this.min.add(_),this.max.add(_),this},equals:function(_){return _.min.equals(this.min)&&_.max.equals(this.max)},clone:function(){return new THREE.Box2().copy(this)}},THREE.Box3=function(_,S){this.min=_===void 0?new THREE.Vector3(Infinity,Infinity,Infinity):_,this.max=S===void 0?new THREE.Vector3(-Infinity,-Infinity,-Infinity):S},THREE.Box3.prototype={constructor:THREE.Box3,set:function(_,S){return this.min.copy(_),this.max.copy(S),this},setFromPoints:function(_){if(0<_.length){var S=_[0];this.min.copy(S),this.max.copy(S);for(var T=1,M=_.length;T<M;T++)S=_[T],S.x<this.min.x?this.min.x=S.x:S.x>this.max.x&&(this.max.x=S.x),S.y<this.min.y?this.min.y=S.y:S.y>this.max.y&&(this.max.y=S.y),S.z<this.min.z?this.min.z=S.z:S.z>this.max.z&&(this.max.z=S.z)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var _=new THREE.Vector3;return function(S,T){var M=_.copy(T).multiplyScalar(0.5);return this.min.copy(S).sub(M),this.max.copy(S).add(M),this}}(),copy:function(_){return this.min.copy(_.min),this.max.copy(_.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-Infinity,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(_){var S=_||new THREE.Vector3;return S.addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(_){var S=_||new THREE.Vector3;return S.subVectors(this.max,this.min)},expandByPoint:function(_){return this.min.min(_),this.max.max(_),this},expandByVector:function(_){return this.min.sub(_),this.max.add(_),this},expandByScalar:function(_){return this.min.addScalar(-_),this.max.addScalar(_),this},containsPoint:function(_){return _.x<this.min.x||_.x>this.max.x||_.y<this.min.y||_.y>this.max.y||_.z<this.min.z||_.z>this.max.z?!1:!0},containsBox:function(_){return this.min.x<=_.min.x&&_.max.x<=this.max.x&&this.min.y<=_.min.y&&_.max.y<=this.max.y&&this.min.z<=_.min.z&&_.max.z<=this.max.z},getParameter:function(_){return new THREE.Vector3((_.x-this.min.x)/(this.max.x-this.min.x),(_.y-this.min.y)/(this.max.y-this.min.y),(_.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(_){return _.max.x<this.min.x||_.min.x>this.max.x||_.max.y<this.min.y||_.min.y>this.max.y||_.max.z<this.min.z||_.min.z>this.max.z?!1:!0},clampPoint:function(_,S){var T=S||new THREE.Vector3;return T.copy(_).clamp(this.min,this.max)},distanceToPoint:function(){var _=new THREE.Vector3;return function(S){var T=_.copy(S).clamp(this.min,this.max);return T.sub(S).length()}}(),getBoundingSphere:function(){var _=new THREE.Vector3;return function(S){var T=S||new THREE.Sphere;return T.center=this.center(),T.radius=0.5*this.size(_).length(),T}}(),intersect:function(_){return this.min.max(_.min),this.max.min(_.max),this},union:function(_){return this.min.min(_.min),this.max.max(_.max),this},applyMatrix4:function(){var _=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(S){return _[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(S),_[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(S),_[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(S),_[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(S),_[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(S),_[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(S),_[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(S),_[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(S),this.makeEmpty(),this.setFromPoints(_),this}}(),translate:function(_){return this.min.add(_),this.max.add(_),this},equals:function(_){return _.min.equals(this.min)&&_.max.equals(this.max)},clone:function(){return new THREE.Box3().copy(this)}},THREE.Matrix3=function(_,S,T,M,A,E,C,D,R){this.elements=new Float32Array(9),this.set(_===void 0?1:_,S||0,T||0,M||0,A===void 0?1:A,E||0,C||0,D||0,R===void 0?1:R)},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(_,S,T,M,A,E,C,D,R){var P=this.elements;return P[0]=_,P[3]=S,P[6]=T,P[1]=M,P[4]=A,P[7]=E,P[2]=C,P[5]=D,P[8]=R,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(_){var S=_.elements;return this.set(S[0],S[3],S[6],S[1],S[4],S[7],S[2],S[5],S[8]),this},multiplyVector3Array:function(){var _=new THREE.Vector3;return function(S){for(var T=0,M=S.length;T<M;T+=3)_.x=S[T],_.y=S[T+1],_.z=S[T+2],_.applyMatrix3(this),S[T]=_.x,S[T+1]=_.y,S[T+2]=_.z;return S}}(),multiplyScalar:function(_){var S=this.elements;return S[0]*=_,S[3]*=_,S[6]*=_,S[1]*=_,S[4]*=_,S[7]*=_,S[2]*=_,S[5]*=_,S[8]*=_,this},determinant:function(){var _=this.elements,S=_[0],T=_[1],M=_[2],A=_[3],E=_[4],C=_[5],D=_[6],R=_[7],P=_[8];return S*E*P-S*C*R-T*A*P+T*C*D+M*A*R-M*E*D},getInverse:function(_){var S=_.elements,T=this.elements;T[0]=S[10]*S[5]-S[6]*S[9],T[1]=-S[10]*S[1]+S[2]*S[9],T[2]=S[6]*S[1]-S[2]*S[5],T[3]=-S[10]*S[4]+S[6]*S[8],T[4]=S[10]*S[0]-S[2]*S[8],T[5]=-S[6]*S[0]+S[2]*S[4],T[6]=S[9]*S[4]-S[5]*S[8],T[7]=-S[9]*S[0]+S[1]*S[8],T[8]=S[5]*S[0]-S[1]*S[4];var M=S[0]*T[0]+S[1]*T[3]+S[2]*T[6];return 0==M?(this.identity(),this):(this.multiplyScalar(1/M),this)},transpose:function(){var S=this.elements,_;return _=S[1],S[1]=S[3],S[3]=_,_=S[2],S[2]=S[6],S[6]=_,_=S[5],S[5]=S[7],S[7]=_,this},getNormalMatrix:function(_){return this.getInverse(_).transpose(),this},transposeIntoArray:function(_){var S=this.elements;return _[0]=S[0],_[1]=S[3],_[2]=S[6],_[3]=S[1],_[4]=S[4],_[5]=S[7],_[6]=S[2],_[7]=S[5],_[8]=S[8],this},clone:function(){var _=this.elements;return new THREE.Matrix3(_[0],_[3],_[6],_[1],_[4],_[7],_[2],_[5],_[8])}},THREE.Matrix4=function(_,S,T,M,A,E,C,D,R,P,L,U,N,F,V,I){var O=this.elements=new Float32Array(16);O[0]=_===void 0?1:_,O[4]=S||0,O[8]=T||0,O[12]=M||0,O[1]=A||0,O[5]=E===void 0?1:E,O[9]=C||0,O[13]=D||0,O[2]=R||0,O[6]=P||0,O[10]=L===void 0?1:L,O[14]=U||0,O[3]=N||0,O[7]=F||0,O[11]=V||0,O[15]=I===void 0?1:I},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(_,S,T,M,A,E,C,D,R,P,L,U,N,F,V,I){var O=this.elements;return O[0]=_,O[4]=S,O[8]=T,O[12]=M,O[1]=A,O[5]=E,O[9]=C,O[13]=D,O[2]=R,O[6]=P,O[10]=L,O[14]=U,O[3]=N,O[7]=F,O[11]=V,O[15]=I,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(_){var S=_.elements;return this.set(S[0],S[4],S[8],S[12],S[1],S[5],S[9],S[13],S[2],S[6],S[10],S[14],S[3],S[7],S[11],S[15]),this},copyPosition:function(_){var S=this.elements,T=_.elements;return S[12]=T[12],S[13]=T[13],S[14]=T[14],this},extractRotation:function(){var _=new THREE.Vector3;return function(S){var T=this.elements,M=S.elements,A=1/_.set(M[0],M[1],M[2]).length(),E=1/_.set(M[4],M[5],M[6]).length(),C=1/_.set(M[8],M[9],M[10]).length();return T[0]=M[0]*A,T[1]=M[1]*A,T[2]=M[2]*A,T[4]=M[4]*E,T[5]=M[5]*E,T[6]=M[6]*E,T[8]=M[8]*C,T[9]=M[9]*C,T[10]=M[10]*C,this}}(),makeRotationFromEuler:function(_,S){var T=this.elements,M=_.x,A=_.y,E=_.z,C=Math.cos(M),D=Math.sin(M),R=Math.cos(A),P=Math.sin(A),L=Math.cos(E),U=Math.sin(E);if(void 0===S||'XYZ'===S){var N=C*L,F=C*U,V=D*L,I=D*U;T[0]=R*L,T[4]=-R*U,T[8]=P,T[1]=F+V*P,T[5]=N-I*P,T[9]=-D*R,T[2]=I-N*P,T[6]=V+F*P,T[10]=C*R}else if('YXZ'===S){var O=R*L,B=R*U,G=P*L,H=P*U;T[0]=O+H*D,T[4]=G*D-B,T[8]=C*P,T[1]=C*U,T[5]=C*L,T[9]=-D,T[2]=B*D-G,T[6]=H+O*D,T[10]=C*R}else if('ZXY'===S){var O=R*L,B=R*U,G=P*L,H=P*U;T[0]=O-H*D,T[4]=-C*U,T[8]=G+B*D,T[1]=B+G*D,T[5]=C*L,T[9]=H-O*D,T[2]=-C*P,T[6]=D,T[10]=C*R}else if('ZYX'===S){var N=C*L,F=C*U,V=D*L,I=D*U;T[0]=R*L,T[4]=V*P-F,T[8]=N*P+I,T[1]=R*U,T[5]=I*P+N,T[9]=F*P-V,T[2]=-P,T[6]=D*R,T[10]=C*R}else if('YZX'===S){var W=C*R,X=C*P,Y=D*R,K=D*P;T[0]=R*L,T[4]=K-W*U,T[8]=Y*U+X,T[1]=U,T[5]=C*L,T[9]=-D*L,T[2]=-P*L,T[6]=X*U+Y,T[10]=W-K*U}else if('XZY'===S){var W=C*R,X=C*P,Y=D*R,K=D*P;T[0]=R*L,T[4]=-U,T[8]=P*L,T[1]=W*U+K,T[5]=C*L,T[9]=X*U-Y,T[2]=Y*U-X,T[6]=D*L,T[10]=K*U+W}return T[3]=0,T[7]=0,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,this},makeRotationFromQuaternion:function(_){var S=this.elements,T=_.x,M=_.y,A=_.z,E=_.w,C=T+T,D=M+M,R=A+A,P=T*C,L=T*D,U=T*R,N=M*D,F=M*R,V=A*R,I=E*C,O=E*D,B=E*R;return S[0]=1-(N+V),S[4]=L-B,S[8]=U+O,S[1]=L+B,S[5]=1-(P+V),S[9]=F-I,S[2]=U-O,S[6]=F+I,S[10]=1-(P+N),S[3]=0,S[7]=0,S[11]=0,S[12]=0,S[13]=0,S[14]=0,S[15]=1,this},lookAt:function(){var _=new THREE.Vector3,S=new THREE.Vector3,T=new THREE.Vector3;return function(M,A,E){var C=this.elements;return T.subVectors(M,A).normalize(),0===T.length()&&(T.z=1),_.crossVectors(E,T).normalize(),0===_.length()&&(T.x+=1e-4,_.crossVectors(E,T).normalize()),S.crossVectors(T,_),C[0]=_.x,C[4]=S.x,C[8]=T.x,C[1]=_.y,C[5]=S.y,C[9]=T.y,C[2]=_.z,C[6]=S.z,C[10]=T.z,this}}(),multiply:function(_){return this.multiplyMatrices(this,_)},multiplyMatrices:function(_,S){var T=_.elements,M=S.elements,A=this.elements,E=T[0],C=T[4],D=T[8],R=T[12],P=T[1],L=T[5],U=T[9],N=T[13],F=T[2],V=T[6],I=T[10],O=T[14],B=T[3],G=T[7],H=T[11],W=T[15],X=M[0],Y=M[4],K=M[8],Q=M[12],Z=M[1],J=M[5],ee=M[9],oe=M[13],ie=M[2],ne=M[6],se=M[10],le=M[14],pe=M[3],ue=M[7],fe=M[11],he=M[15];return A[0]=E*X+C*Z+D*ie+R*pe,A[4]=E*Y+C*J+D*ne+R*ue,A[8]=E*K+C*ee+D*se+R*fe,A[12]=E*Q+C*oe+D*le+R*he,A[1]=P*X+L*Z+U*ie+N*pe,A[5]=P*Y+L*J+U*ne+N*ue,A[9]=P*K+L*ee+U*se+N*fe,A[13]=P*Q+L*oe+U*le+N*he,A[2]=F*X+V*Z+I*ie+O*pe,A[6]=F*Y+V*J+I*ne+O*ue,A[10]=F*K+V*ee+I*se+O*fe,A[14]=F*Q+V*oe+I*le+O*he,A[3]=B*X+G*Z+H*ie+W*pe,A[7]=B*Y+G*J+H*ne+W*ue,A[11]=B*K+G*ee+H*se+W*fe,A[15]=B*Q+G*oe+H*le+W*he,this},multiplyToArray:function(_,S,T){var M=this.elements;return this.multiplyMatrices(_,S),T[0]=M[0],T[1]=M[1],T[2]=M[2],T[3]=M[3],T[4]=M[4],T[5]=M[5],T[6]=M[6],T[7]=M[7],T[8]=M[8],T[9]=M[9],T[10]=M[10],T[11]=M[11],T[12]=M[12],T[13]=M[13],T[14]=M[14],T[15]=M[15],this},multiplyScalar:function(_){var S=this.elements;return S[0]*=_,S[4]*=_,S[8]*=_,S[12]*=_,S[1]*=_,S[5]*=_,S[9]*=_,S[13]*=_,S[2]*=_,S[6]*=_,S[10]*=_,S[14]*=_,S[3]*=_,S[7]*=_,S[11]*=_,S[15]*=_,this},multiplyVector3Array:function(){var _=new THREE.Vector3;return function(S){for(var T=0,M=S.length;T<M;T+=3)_.x=S[T],_.y=S[T+1],_.z=S[T+2],_.applyProjection(this),S[T]=_.x,S[T+1]=_.y,S[T+2]=_.z;return S}}(),determinant:function(){var _=this.elements,S=_[0],T=_[4],M=_[8],A=_[12],E=_[1],C=_[5],D=_[9],R=_[13],P=_[2],L=_[6],U=_[10],N=_[14],F=_[3],V=_[7],I=_[11],O=_[15];return F*(+A*D*L-M*R*L-A*C*U+T*R*U+M*C*N-T*D*N)+V*(+S*D*N-S*R*U+A*E*U-M*E*N+M*R*P-A*D*P)+I*(+S*R*L-S*C*N-A*E*L+T*E*N+A*C*P-T*R*P)+O*(-M*C*P-S*D*L+S*C*U+M*E*L-T*E*U+T*D*P)},transpose:function(){var _=this.elements,S;return S=_[1],_[1]=_[4],_[4]=S,S=_[2],_[2]=_[8],_[8]=S,S=_[6],_[6]=_[9],_[9]=S,S=_[3],_[3]=_[12],_[12]=S,S=_[7],_[7]=_[13],_[13]=S,S=_[11],_[11]=_[14],_[14]=S,this},flattenToArray:function(_){var S=this.elements;return _[0]=S[0],_[1]=S[1],_[2]=S[2],_[3]=S[3],_[4]=S[4],_[5]=S[5],_[6]=S[6],_[7]=S[7],_[8]=S[8],_[9]=S[9],_[10]=S[10],_[11]=S[11],_[12]=S[12],_[13]=S[13],_[14]=S[14],_[15]=S[15],_},flattenToArrayOffset:function(_,S){var T=this.elements;return _[S]=T[0],_[S+1]=T[1],_[S+2]=T[2],_[S+3]=T[3],_[S+4]=T[4],_[S+5]=T[5],_[S+6]=T[6],_[S+7]=T[7],_[S+8]=T[8],_[S+9]=T[9],_[S+10]=T[10],_[S+11]=T[11],_[S+12]=T[12],_[S+13]=T[13],_[S+14]=T[14],_[S+15]=T[15],_},setPosition:function(_){var S=this.elements;return S[12]=_.x,S[13]=_.y,S[14]=_.z,this},getInverse:function(_){var S=this.elements,T=_.elements,M=T[0],A=T[4],E=T[8],C=T[12],D=T[1],R=T[5],P=T[9],L=T[13],U=T[2],N=T[6],F=T[10],V=T[14],I=T[3],O=T[7],B=T[11],G=T[15];S[0]=P*V*O-L*F*O+L*N*B-R*V*B-P*N*G+R*F*G,S[4]=C*F*O-E*V*O-C*N*B+A*V*B+E*N*G-A*F*G,S[8]=E*L*O-C*P*O+C*R*B-A*L*B-E*R*G+A*P*G,S[12]=C*P*N-E*L*N-C*R*F+A*L*F+E*R*V-A*P*V,S[1]=L*F*I-P*V*I-L*U*B+D*V*B+P*U*G-D*F*G,S[5]=E*V*I-C*F*I+C*U*B-M*V*B-E*U*G+M*F*G,S[9]=C*P*I-E*L*I-C*D*B+M*L*B+E*D*G-M*P*G,S[13]=E*L*U-C*P*U+C*D*F-M*L*F-E*D*V+M*P*V,S[2]=R*V*I-L*N*I+L*U*O-D*V*O-R*U*G+D*N*G,S[6]=C*N*I-A*V*I-C*U*O+M*V*O+A*U*G-M*N*G,S[10]=A*L*I-C*R*I+C*D*O-M*L*O-A*D*G+M*R*G,S[14]=C*R*U-A*L*U-C*D*N+M*L*N+A*D*V-M*R*V,S[3]=P*N*I-R*F*I-P*U*O+D*F*O+R*U*B-D*N*B,S[7]=A*F*I-E*N*I+E*U*O-M*F*O-A*U*B+M*N*B,S[11]=E*R*I-A*P*I-E*D*O+M*P*O+A*D*B-M*R*B,S[15]=A*P*U-E*R*U+E*D*N-M*P*N-A*D*F+M*R*F;var H=T[0]*S[0]+T[1]*S[4]+T[2]*S[8]+T[3]*S[12];return 0==H?(this.identity(),this):(this.multiplyScalar(1/H),this)},scale:function(_){var S=this.elements,T=_.x,M=_.y,A=_.z;return S[0]*=T,S[4]*=M,S[8]*=A,S[1]*=T,S[5]*=M,S[9]*=A,S[2]*=T,S[6]*=M,S[10]*=A,S[3]*=T,S[7]*=M,S[11]*=A,this},getMaxScaleOnAxis:function(){var _=this.elements,S=_[0]*_[0]+_[1]*_[1]+_[2]*_[2],T=_[4]*_[4]+_[5]*_[5]+_[6]*_[6],M=_[8]*_[8]+_[9]*_[9]+_[10]*_[10];return Math.sqrt(Math.max(S,Math.max(T,M)))},makeTranslation:function(_,S,T){return this.set(1,0,0,_,0,1,0,S,0,0,1,T,0,0,0,1),this},makeRotationX:function(_){var S=Math.cos(_),T=Math.sin(_);return this.set(1,0,0,0,0,S,-T,0,0,T,S,0,0,0,0,1),this},makeRotationY:function(_){var S=Math.cos(_),T=Math.sin(_);return this.set(S,0,T,0,0,1,0,0,-T,0,S,0,0,0,0,1),this},makeRotationZ:function(_){var S=Math.cos(_),T=Math.sin(_);return this.set(S,-T,0,0,T,S,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(_,S){var T=Math.cos(S),M=Math.sin(S),A=1-T,E=_.x,C=_.y,D=_.z,R=A*E,P=A*C;return this.set(R*E+T,R*C-M*D,R*D+M*C,0,R*C+M*D,P*C+T,P*D-M*E,0,R*D-M*C,P*D+M*E,A*D*D+T,0,0,0,0,1),this},makeScale:function(_,S,T){return this.set(_,0,0,0,0,S,0,0,0,0,T,0,0,0,0,1),this},makeFromPositionQuaternionScale:function(_,S,T){return this.makeRotationFromQuaternion(S),this.scale(T),this.setPosition(_),this},makeFromPositionEulerScale:function(_,S,T,M){return this.makeRotationFromEuler(S,T),this.scale(M),this.setPosition(_),this},makeFrustum:function(_,S,T,M,A,E){var C=this.elements;return C[0]=2*A/(S-_),C[4]=0,C[8]=(S+_)/(S-_),C[12]=0,C[1]=0,C[5]=2*A/(M-T),C[9]=(M+T)/(M-T),C[13]=0,C[2]=0,C[6]=0,C[10]=-(E+A)/(E-A),C[14]=-2*E*A/(E-A),C[3]=0,C[7]=0,C[11]=-1,C[15]=0,this},makePerspective:function(_,S,T,M){var A=T*Math.tan(THREE.Math.degToRad(0.5*_)),E=-A;return this.makeFrustum(E*S,A*S,E,A,T,M)},makeOrthographic:function(_,S,T,M,A,E){var C=this.elements,D=S-_,R=T-M,P=E-A;return C[0]=2/D,C[4]=0,C[8]=0,C[12]=-((S+_)/D),C[1]=0,C[5]=2/R,C[9]=0,C[13]=-((T+M)/R),C[2]=0,C[6]=0,C[10]=-2/P,C[14]=-((E+A)/P),C[3]=0,C[7]=0,C[11]=0,C[15]=1,this},clone:function(){var _=this.elements;return new THREE.Matrix4(_[0],_[4],_[8],_[12],_[1],_[5],_[9],_[13],_[2],_[6],_[10],_[14],_[3],_[7],_[11],_[15])}},THREE.Matrix4.prototype.decompose=function(){var _=new THREE.Vector3,S=new THREE.Vector3,T=new THREE.Vector3,M=new THREE.Matrix4;return function(A,E,C){var D=this.elements;return _.set(D[0],D[1],D[2]),S.set(D[4],D[5],D[6]),T.set(D[8],D[9],D[10]),A=A instanceof THREE.Vector3?A:new THREE.Vector3,E=E instanceof THREE.Quaternion?E:new THREE.Quaternion,C=C instanceof THREE.Vector3?C:new THREE.Vector3,C.x=_.length(),C.y=S.length(),C.z=T.length(),A.x=D[12],A.y=D[13],A.z=D[14],M instanceof THREE.Matrix4||(M=new THREE.Matrix4),M.copy(this),M.elements[0]/=C.x,M.elements[1]/=C.x,M.elements[2]/=C.x,M.elements[4]/=C.y,M.elements[5]/=C.y,M.elements[6]/=C.y,M.elements[8]/=C.z,M.elements[9]/=C.z,M.elements[10]/=C.z,E.setFromRotationMatrix(M),[A,E,C]}}(),THREE.Matrix4.prototype.fromArray=function(_,S){S===void 0&&(S=0);for(var T=0;16>T;T++)this.elements[T]=_[T+S];return this},THREE.Ray=function(_,S){this.origin=_===void 0?new THREE.Vector3:_,this.direction=S===void 0?new THREE.Vector3:S},THREE.Ray.prototype={constructor:THREE.Ray,set:function(_,S){return this.origin.copy(_),this.direction.copy(S),this},copy:function(_){return this.origin.copy(_.origin),this.direction.copy(_.direction),this},at:function(_,S){var T=S||new THREE.Vector3;return T.copy(this.direction).multiplyScalar(_).add(this.origin)},recast:function(){var _=new THREE.Vector3;return function(S){return this.origin.copy(this.at(S,_)),this}}(),closestPointToPoint:function(_,S){var T=S||new THREE.Vector3;T.subVectors(_,this.origin);var M=T.dot(this.direction);return T.copy(this.direction).multiplyScalar(M).add(this.origin)},distanceToPoint:function(){var _=new THREE.Vector3;return function(S){var T=_.subVectors(S,this.origin).dot(this.direction);return _.copy(this.direction).multiplyScalar(T).add(this.origin),_.distanceTo(S)}}(),isIntersectionSphere:function(_){return this.distanceToPoint(_.center)<=_.radius},isIntersectionPlane:function(_){var S=_.normal.dot(this.direction);return 0!=S||!(0!=_.distanceToPoint(this.origin))},distanceToPlane:function(_){var S=_.normal.dot(this.direction);if(0==S)return 0==_.distanceToPoint(this.origin)?0:void 0;var T=-(this.origin.dot(_.normal)+_.constant)/S;return T},intersectPlane:function(_,S){var T=this.distanceToPlane(_);return void 0===T?void 0:this.at(T,S)},applyMatrix4:function(_){return this.direction.add(this.origin).applyMatrix4(_),this.origin.applyMatrix4(_),this.direction.sub(this.origin),this},equals:function(_){return _.origin.equals(this.origin)&&_.direction.equals(this.direction)},clone:function(){return new THREE.Ray().copy(this)},intersectBox:function(_,S){var R=1/this.direction.x,P=1/this.direction.y,L=1/this.direction.z,U=this.origin,T,M,A,E,C,D;return(0<=R?(T=(_.min.x-U.x)*R,M=(_.max.x-U.x)*R):(T=(_.max.x-U.x)*R,M=(_.min.x-U.x)*R),0<=P?(A=(_.min.y-U.y)*P,E=(_.max.y-U.y)*P):(A=(_.max.y-U.y)*P,E=(_.min.y-U.y)*P),T>E||A>M)?null:((A>T||T!=T)&&(T=A),(E<M||M!=M)&&(M=E),0<=L?(C=(_.min.z-U.z)*L,D=(_.max.z-U.z)*L):(C=(_.max.z-U.z)*L,D=(_.min.z-U.z)*L),T>D||C>M)?null:((C>T||T!=T)&&(T=C),(D<M||M!=M)&&(M=D),0>M?null:this.at(0<=T?T:M,S))}},THREE.Sphere=function(_,S){this.center=_===void 0?new THREE.Vector3:_,this.radius=S===void 0?0:S},THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(_,S){return this.center.copy(_),this.radius=S,this},setFromCenterAndPoints:function(_,S){for(var T=0,M=0,A=S.length,E;M<A;M++)E=_.distanceToSquared(S[M]),T=Math.max(T,E);return this.center=_,this.radius=Math.sqrt(T),this},copy:function(_){return this.center.copy(_.center),this.radius=_.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(_){return _.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(_){return _.distanceTo(this.center)-this.radius},intersectsSphere:function(_){var S=this.radius+_.radius;return _.center.distanceToSquared(this.center)<=S*S},clampPoint:function(_,S){var T=this.center.distanceToSquared(_),M=S||new THREE.Vector3;return M.copy(_),T>this.radius*this.radius&&(M.sub(this.center).normalize(),M.multiplyScalar(this.radius).add(this.center)),M},getBoundingBox:function(_){var S=_||new THREE.Box3;return S.set(this.center,this.center),S.expandByScalar(this.radius),S},applyMatrix4:function(_){return this.center.applyMatrix4(_),this.radius*=_.getMaxScaleOnAxis(),this},translate:function(_){return this.center.add(_),this},equals:function(_){return _.center.equals(this.center)&&_.radius===this.radius},clone:function(){return new THREE.Sphere().copy(this)}},THREE.Frustum=function(_,S,T,M,A,E){this.planes=[_===void 0?new THREE.Plane:_,S===void 0?new THREE.Plane:S,T===void 0?new THREE.Plane:T,M===void 0?new THREE.Plane:M,A===void 0?new THREE.Plane:A,E===void 0?new THREE.Plane:E]},THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(_,S,T,M,A,E){var C=this.planes;return C[0].copy(_),C[1].copy(S),C[2].copy(T),C[3].copy(M),C[4].copy(A),C[5].copy(E),this},copy:function(_){for(var S=this.planes,T=0;6>T;T++)S[T].copy(_.planes[T]);return this},setFromMatrix:function(_){var S=this.planes,T=_.elements,M=T[0],A=T[1],E=T[2],C=T[3],D=T[4],R=T[5],P=T[6],L=T[7],U=T[8],N=T[9],F=T[10],V=T[11],I=T[12],O=T[13],B=T[14],G=T[15];return S[0].setComponents(C-M,L-D,V-U,G-I).normalize(),S[1].setComponents(C+M,L+D,V+U,G+I).normalize(),S[2].setComponents(C+A,L+R,V+N,G+O).normalize(),S[3].setComponents(C-A,L-R,V-N,G-O).normalize(),S[4].setComponents(C-E,L-P,V-F,G-B).normalize(),S[5].setComponents(C+E,L+P,V+F,G+B).normalize(),this},_containing:!1,intersectsOrContainsObject:function(){var _=new THREE.Vector3;return function(S){this._containing=!0;var T=S.geometry,M=S.matrixWorld;null===T.boundingSphere&&T.computeBoundingSphere();var A=-T.boundingSphere.radius*M.getMaxScaleOnAxis();_.getPositionFromMatrix(M);for(var E=this.planes,C=0,D;6>C;C++){if(D=E[C].distanceToPoint(_),D<A)return!1;D<-A&&(this._containing=!1)}return!0}}(),intersectsObject:function(){var _=new THREE.Vector3;return function(S){null===S.geometry.boundingSphere&&S.geometry.computeBoundingSphere();var T=S.matrixWorld,M=this.planes,A=-S.geometry.boundingSphere.radius*T.getMaxScaleOnAxis(),E=6;for(_.copy(S.geometry.boundingSphere.center).applyMatrix4(T);E;){var C=M[--E].distanceToPoint(_);if(C<A)return!1}return!0}}(),intersectsSphere:function(_){for(var S=this.planes,T=_.center,M=-_.radius,A=0,E;6>A;A++)if(E=S[A].distanceToPoint(T),E<M)return!1;return!0},containsPoint:function(_){for(var S=this.planes,T=0;6>T;T++)if(0>S[T].distanceToPoint(_))return!1;return!0},clone:function(){return new THREE.Frustum().copy(this)}},THREE.Plane=function(_,S){this.normal=_===void 0?new THREE.Vector3(1,0,0):_,this.constant=S===void 0?0:S},THREE.Plane.prototype={constructor:THREE.Plane,set:function(_,S){return this.normal.copy(_),this.constant=S,this},setComponents:function(_,S,T,M){return this.normal.set(_,S,T),this.constant=M,this},setFromNormalAndCoplanarPoint:function(_,S){return this.normal.copy(_),this.constant=-S.dot(this.normal),this},setFromCoplanarPoints:function(){var _=new THREE.Vector3,S=new THREE.Vector3;return function(T,M,A){var E=_.subVectors(A,M).cross(S.subVectors(T,M)).normalize();return this.setFromNormalAndCoplanarPoint(E,T),this}}(),copy:function(_){return this.normal.copy(_.normal),this.constant=_.constant,this},normalize:function(){var _=1/this.normal.length();return this.normal.multiplyScalar(_),this.constant*=_,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(_){return this.normal.dot(_)+this.constant},distanceToSphere:function(_){return this.distanceToPoint(_.center)-_.radius},projectPoint:function(_,S){return this.orthoPoint(_,S).sub(_).negate()},orthoPoint:function(_,S){var T=this.distanceToPoint(_),M=S||new THREE.Vector3;return M.copy(this.normal).multiplyScalar(T)},isIntersectionLine:function(_){var S=this.distanceToPoint(_.start),T=this.distanceToPoint(_.end);return 0>S&&0<T||0>T&&0<S},intersectLine:function(){var _=new THREE.Vector3;return function(S,T){var M=T||new THREE.Vector3,A=S.delta(_),E=this.normal.dot(A);if(0==E)return 0==this.distanceToPoint(S.start)?M.copy(S.start):void 0;var C=-(S.start.dot(this.normal)+this.constant)/E;return 0>C||1<C?void 0:M.copy(A).multiplyScalar(C).add(S.start)}}(),coplanarPoint:function(_){var S=_||new THREE.Vector3;return S.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var _=new THREE.Vector3,S=new THREE.Vector3;return function(T,M){M=M||new THREE.Matrix3().getNormalMatrix(T);var A=_.copy(this.normal).applyMatrix3(M),E=this.coplanarPoint(S);return E.applyMatrix4(T),this.setFromNormalAndCoplanarPoint(A,E),this}}(),translate:function(_){return this.constant-=_.dot(this.normal),this},equals:function(_){return _.normal.equals(this.normal)&&_.constant==this.constant},clone:function(){return new THREE.Plane().copy(this)}},THREE.Math={generateUUID:function(){for(var _=[],S=0;256>S;S++)_[S]=(16>S?'0':'')+S.toString(16);return function(){var M=0|4294967295*Math.random(),A=0|4294967295*Math.random(),E=0|4294967295*Math.random(),C=0|4294967295*Math.random(),D=_[255&M]+_[255&M>>8]+_[255&M>>16]+_[255&M>>24]+'-'+_[255&A]+_[255&A>>8]+'-'+_[64|15&A>>16]+_[255&A>>24]+'-'+_[128|63&E]+_[255&E>>8]+'-'+_[255&E>>16]+_[255&E>>24]+_[255&C]+_[255&C>>8]+_[255&C>>16]+_[255&C>>24];return D.toUpperCase()}}(),clamp:function(_,S,T){return _<S?S:_>T?T:_},clampBottom:function(_,S){return _<S?S:_},mapLinear:function(_,S,T,M,A){return M+(_-S)*(A-M)/(T-S)},smoothstep:function(_,S,T){return _<=S?0:_>=T?1:(_=(_-S)/(T-S),_*_*(3-2*_))},smootherstep:function(_,S,T){return _<=S?0:_>=T?1:(_=(_-S)/(T-S),_*_*_*(_*(6*_-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(_,S){return _+Math.floor(Math.random()*(S-_+1))},randFloat:function(_,S){return _+Math.random()*(S-_)},randFloatSpread:function(_){return _*(0.5-Math.random())},sign:function(_){return 0>_?-1:0<_?1:0},degToRad:function(){var _=Math.PI/180;return function(S){return S*_}}(),radToDeg:function(){var _=180/Math.PI;return function(S){return S*_}}()},THREE.Spline=function(_){function S(F,V,I,O,B,G,H){var W=0.5*(I-F),X=0.5*(O-V);return(2*(V-I)+W+X)*H+(-3*(V-I)-2*W-X)*G+W*B+V}this.points=_;var T=[],M={x:0,y:0,z:0},A,E,C,D,R,P,L,U,N;this.initFromArray=function(F){this.points=[];for(var V=0;V<F.length;V++)this.points[V]={x:F[V][0],y:F[V][1],z:F[V][2]}},this.getPoint=function(F){return A=(this.points.length-1)*F,E=Math.floor(A),C=A-E,T[0]=0===E?E:E-1,T[1]=E,T[2]=E>this.points.length-2?this.points.length-1:E+1,T[3]=E>this.points.length-3?this.points.length-1:E+2,P=this.points[T[0]],L=this.points[T[1]],U=this.points[T[2]],N=this.points[T[3]],D=C*C,R=C*D,M.x=S(P.x,L.x,U.x,N.x,C,D,R),M.y=S(P.y,L.y,U.y,N.y,C,D,R),M.z=S(P.z,L.z,U.z,N.z,C,D,R),M},this.getControlPointsArray=function(){var I=this.points.length,O=[],F,V;for(F=0;F<I;F++)V=this.points[F],O[F]=[V.x,V.y,V.z];return O},this.getLength=function(F){var G=0,H=0,W=0,X=new THREE.Vector3,Y=new THREE.Vector3,K=[],Q=0,V,I,O,B;for(K[0]=0,F||(F=100),O=this.points.length*F,X.copy(this.points[0]),V=1;V<O;V++)I=V/O,B=this.getPoint(I),Y.copy(B),Q+=Y.distanceTo(X),X.copy(B),G=(this.points.length-1)*I,H=Math.floor(G),H!=W&&(K[H]=Q,W=H);return K[K.length]=Q,{chunks:K,total:Q}},this.reparametrizeByArcLength=function(F){var K=[],Q=new THREE.Vector3,Z=this.getLength(),V,I,O,B,G,W,X,Y;for(K.push(Q.copy(this.points[0]).clone()),V=1;V<this.points.length;V++){for(W=Z.chunks[V]-Z.chunks[V-1],X=Math.ceil(F*W/Z.total),B=(V-1)/(this.points.length-1),G=V/(this.points.length-1),I=1;I<X-1;I++)O=B+I*(1/X)*(G-B),Y=this.getPoint(O),K.push(Q.copy(Y).clone());K.push(Q.copy(this.points[V]).clone())}this.points=K}},THREE.Triangle=function(_,S,T){this.a=_===void 0?new THREE.Vector3:_,this.b=S===void 0?new THREE.Vector3:S,this.c=T===void 0?new THREE.Vector3:T},THREE.Triangle.normal=function(){var _=new THREE.Vector3;return function(S,T,M,A){var E=A||new THREE.Vector3;E.subVectors(M,T),_.subVectors(S,T),E.cross(_);var C=E.lengthSq();return 0<C?E.multiplyScalar(1/Math.sqrt(C)):E.set(0,0,0)}}(),THREE.Triangle.barycoordFromPoint=function(){var _=new THREE.Vector3,S=new THREE.Vector3,T=new THREE.Vector3;return function(M,A,E,C,D){_.subVectors(C,A),S.subVectors(E,A),T.subVectors(M,A);var R=_.dot(_),P=_.dot(S),L=_.dot(T),U=S.dot(S),N=S.dot(T),F=R*U-P*P,V=D||new THREE.Vector3;if(0==F)return V.set(-2,-1,-1);var I=1/F,O=(U*L-P*N)*I,B=(R*N-P*L)*I;return V.set(1-O-B,B,O)}}(),THREE.Triangle.containsPoint=function(){var _=new THREE.Vector3;return function(S,T,M,A){var E=THREE.Triangle.barycoordFromPoint(S,T,M,A,_);return 0<=E.x&&0<=E.y&&1>=E.x+E.y}}(),THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(_,S,T){return this.a.copy(_),this.b.copy(S),this.c.copy(T),this},setFromPointsAndIndices:function(_,S,T,M){return this.a.copy(_[S]),this.b.copy(_[T]),this.c.copy(_[M]),this},copy:function(_){return this.a.copy(_.a),this.b.copy(_.b),this.c.copy(_.c),this},area:function(){var _=new THREE.Vector3,S=new THREE.Vector3;return function(){return _.subVectors(this.c,this.b),S.subVectors(this.a,this.b),0.5*_.cross(S).length()}}(),midpoint:function(_){var S=_||new THREE.Vector3;return S.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(_){return THREE.Triangle.normal(this.a,this.b,this.c,_)},plane:function(_){var S=_||new THREE.Plane;return S.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(_,S){return THREE.Triangle.barycoordFromPoint(_,this.a,this.b,this.c,S)},containsPoint:function(_){return THREE.Triangle.containsPoint(_,this.a,this.b,this.c)},equals:function(_){return _.a.equals(this.a)&&_.b.equals(this.b)&&_.c.equals(this.c)},clone:function(){return new THREE.Triangle().copy(this)}},THREE.now=function(){var _=self.performance!==void 0&&self.performance.now!==void 0?self.performance:Date;return function(){return _.now()}}(),THREE.Clock=function(_){this.autoStart=!(_!==void 0)||_,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.startTime=('undefined'==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var _=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var S=('undefined'==typeof performance?Date:performance).now();_=(S-this.oldTime)/1e3,this.oldTime=S,this.elapsedTime+=_}return _}},THREE.EventDispatcher=function(){},THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(_){_.addEventListener=THREE.EventDispatcher.prototype.addEventListener,_.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener,_.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener,_.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(_,S){this._listeners===void 0&&(this._listeners={});var T=this._listeners;T[_]===void 0&&(T[_]=[]),-1===T[_].indexOf(S)&&T[_].push(S)},hasEventListener:function(_,S){if(this._listeners===void 0)return!1;var T=this._listeners;return void 0!==T[_]&&-1!==T[_].indexOf(S)},removeEventListener:function(_,S){if(void 0!==this._listeners){var T=this._listeners,M=T[_].indexOf(S);-1!==M&&T[_].splice(M,1)}},dispatchEvent:function(_){if(void 0!==this._listeners){var S=this._listeners,T=S[_.type];if(void 0!==T){_.target=this;for(var M=0,A=T.length;M<A;M++)T[M].call(this,_)}}}},function(_){_.Raycaster=function(L,U,N,F){this.ray=new _.Ray(L,U),0<this.ray.direction.lengthSq()&&this.ray.direction.normalize(),this.near=N||0,this.far=F||Infinity};var S=new _.Sphere,T=new _.Ray,M=new _.Plane,A=new _.Vector3,E=new _.Vector3,C=new _.Matrix4,D=function(L,U){return L.distance-U.distance},R=function(L,U,N){if(L instanceof _.Particle){E.getPositionFromMatrix(L.matrixWorld);var F=U.ray.distanceToPoint(E);if(F>L.scale.x)return N;N.push({distance:F,point:L.position,face:null,object:L})}else if(L instanceof _.LOD){E.getPositionFromMatrix(L.matrixWorld);var F=U.ray.origin.distanceTo(E);R(L.getObjectForDistance(F),U,N)}else if(L instanceof _.Mesh){if(E.getPositionFromMatrix(L.matrixWorld),S.set(E,L.geometry.boundingSphere.radius*L.matrixWorld.getMaxScaleOnAxis()),!U.ray.isIntersectionSphere(S))return N;var V=L.geometry,I=V.vertices,O=L.material instanceof _.MeshFaceMaterial,B=!0===O?L.material.materials:null,G=L.material.side,K=U.precision,H,W,X,Y;C.getInverse(L.matrixWorld),T.copy(U.ray).applyMatrix4(C);for(var Q=0,Z=V.faces.length;Q<Z;Q++){var J=V.faces[Q],ee=!0==O?B[J.materialIndex]:L.material;if(void 0!==ee){M.setFromNormalAndCoplanarPoint(J.normal,I[J.a]);var oe=T.distanceToPlane(M);if(!(Math.abs(oe)<K)&&!(0>oe)){if(G=ee.side,G!==_.DoubleSide){var ie=T.direction.dot(M.normal);if(G===_.FrontSide?!(0>ie):!(0<ie))continue}if(!(oe<U.near||oe>U.far)){if(A=T.at(oe,A),J instanceof _.Face3){if(H=I[J.a],W=I[J.b],X=I[J.c],!_.Triangle.containsPoint(A,H,W,X))continue;}else if(J instanceof _.Face4&&(H=I[J.a],W=I[J.b],X=I[J.c],Y=I[J.d],!_.Triangle.containsPoint(A,H,W,Y)&&!_.Triangle.containsPoint(A,W,X,Y)))continue;N.push({distance:oe,point:U.ray.at(oe),face:J,faceIndex:Q,object:L})}}}}}},P=function(L,U,N){for(var F=L.getDescendants(),V=0,I=F.length;V<I;V++)R(F[V],U,N)};_.Raycaster.prototype.precision=1e-4,_.Raycaster.prototype.set=function(L,U){this.ray.set(L,U),0<this.ray.direction.length()&&this.ray.direction.normalize()},_.Raycaster.prototype.intersectObject=function(L,U){var N=[];return!0===U&&P(L,this,N),R(L,this,N),N.sort(D),N},_.Raycaster.prototype.intersectObjects=function(L,U){for(var N=[],F=L.length;F;)R(L[--F],this,N),U&&P(L[F],this,N);return N.sort(D),N},_.Raycaster.prototype.setFromCamera=function(L,U){U&&U instanceof _.PerspectiveCamera?(this.ray.origin.getPositionFromMatrix(U.matrixWorld),this.ray.direction.set(L.x,L.y,0.5).unproject(U).sub(this.ray.origin).normalize()):U&&U instanceof _.OrthographicCamera?(this.ray.origin.set(L.x,L.y,(U.near+U.far)/(U.near-U.far)).unproject(U),this.ray.direction.set(0,0,-1).transformDirection(U.matrixWorld)):console.error('THREE.Raycaster: Unsupported camera type.')}}(THREE),THREE.Object3D=function(){this.id=THREE.Object3DIdCount++,this.name='',this.parent=void 0,this.children=[],this.up=new THREE.Vector3(0,1,0),this.position=new THREE.Vector3,this.rotate=this.rotation=new THREE.Vector3,this.eulerOrder=THREE.Object3D.defaultEulerOrder,this.scale=new THREE.Vector3(1,1,1),this.renderDepth=null,this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.quaternion=new THREE.Quaternion,this.useQuaternion=!1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.userData={},this._lookAt=new THREE.Vector3,this.qtAxisAngle=new THREE.Quaternion},THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function(){var _=new THREE.Matrix4;return function(S){this.matrix.multiplyMatrices(S,this.matrix),this.position.getPositionFromMatrix(this.matrix),this.scale.getScaleFromMatrix(this.matrix),_.extractRotation(this.matrix),!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(_):this.rotation.setEulerFromRotationMatrix(_,this.eulerOrder)}}(),rotateOnAxis:function(){var _=new THREE.Quaternion,S=new THREE.Quaternion;return function(T,M){return _.setFromAxisAngle(T,M),!0===this.useQuaternion?this.quaternion.multiply(_):(S.setFromEuler(this.rotation,this.eulerOrder),S.multiply(_),this.rotation.setEulerFromQuaternion(S,this.eulerOrder)),this}}(),translateOnAxis:function(){var _=new THREE.Vector3;return function(S,T){return _.copy(S),!0===this.useQuaternion?_.applyQuaternion(this.quaternion):_.applyEuler(this.rotation,this.eulerOrder),this.position.add(_.multiplyScalar(T)),this}}(),translateX:function(){var _=new THREE.Vector3(1,0,0);return function(S){return this.translateOnAxis(_,S)}}(),translateY:function(){var _=new THREE.Vector3(0,1,0);return function(S){return this.translateOnAxis(_,S)}}(),translateZ:function(){var _=new THREE.Vector3(0,0,1);return function(S){return this.translateOnAxis(_,S)}}(),localToWorld:function(_){return _.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var _=new THREE.Matrix4;return function(S){return S.applyMatrix4(_.getInverse(this.matrixWorld))}}(),lookAt:function(){var _=new THREE.Matrix4;return function(S){_.lookAt(S,this.position,this.up),this._lookAt.copy(S),!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(_):this.rotation.setEulerFromRotationMatrix(_,this.eulerOrder)}}(),add:function(_){_.parent!==void 0&&_.parent.remove(_),_.parent=this,_.dispatchEvent({type:'added'}),jThree.styleHooks.display.set(_),jThree.styleHooks.opacity.set(_),this.children.push(_);for(var S=this;S.parent!==void 0;)S=S.parent;S!==void 0&&S instanceof THREE.Scene&&(S.__addObject(_),_.userData.dom&&(_.userData.scene=S,S.eventChange($._data(_.userData.dom,'events'),_)))},remove:function(_){var S=this.children.indexOf(_);if(-1!==S){_.parent=void 0,_.traverse(function(M){M.dispatchEvent({type:'removed'})}),this.children.splice(S,1);for(var T=this;T.parent!==void 0;)T=T.parent;T!==void 0&&T instanceof THREE.Scene&&(T.__removeObject(_),_.userData.dom&&(_.userData.scene=void 0,T.eventChange(!1,_)))}},traverse:function(_){_(this);for(var S=0,T=this.children.length;S<T&&!(!1===this.children[S].traverse(_));S++);},getObjectById:function(_,S){for(var T=0,M=this.children.length,A;T<M;T++){if(A=this.children[T],A.id===_)return A;if(!0===S&&(A=A.getObjectById(_,S),void 0!==A))return A}},getObjectByName:function(_,S){for(var T=0,M=this.children.length,A;T<M;T++){if(A=this.children[T],A.name===_)return A;if(!0===S&&(A=A.getObjectByName(_,S),void 0!==A))return A}},getDescendants:function(_){_===void 0&&(_=[]),Array.prototype.push.apply(_,this.children);for(var S=0,T=this.children.length;S<T;S++)this.children[S].getDescendants(_);return _},updateMatrix:function(){!1===this.useQuaternion?this.matrix.makeFromPositionEulerScale(this.position,this.rotation,this.eulerOrder,this.scale):this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(_){!0===this.matrixAutoUpdate&&this.updateMatrix(),(!0===this.matrixWorldNeedsUpdate||!0===_)&&(this.parent===void 0?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,_=!0);for(var S=0,T=this.children.length;S<T;S++)this.children[S].updateMatrixWorld(_)},clone:function(_){_===void 0&&(_=new THREE.Object3D),_.name=this.name,_.up.copy(this.up),_.position.copy(this.position),_.rotation instanceof THREE.Vector3&&_.rotation.copy(this.rotation),_.eulerOrder=this.eulerOrder,_.scale.copy(this.scale),_.renderDepth=this.renderDepth,_.rotationAutoUpdate=this.rotationAutoUpdate,_.matrix.copy(this.matrix),_.matrixWorld.copy(this.matrixWorld),_.matrixAutoUpdate=this.matrixAutoUpdate,_.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,_.quaternion.copy(this.quaternion),_.useQuaternion=this.useQuaternion,_.visible=this.visible,_.castShadow=this.castShadow,_.receiveShadow=this.receiveShadow,_.frustumCulled=this.frustumCulled,_.userData=this.userData.dom?jQuery.extend(!0,{},this.userData):JSON.parse(JSON.stringify(this.userData)),_._lookAt.copy(this._lookAt),_.instanced_drawing=this.instanced_drawing;for(var S=0,T;S<this.children.length;S++)T=this.children[S],_.add(T.clone());return _}},THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype),THREE.Object3D.defaultEulerOrder='XYZ',THREE.Object3DIdCount=0,THREE.Projector=function(){function _(){if(P===U){var De=new THREE.RenderableObject;return L.push(De),U++,P++,De}return L[P++]}function S(){if(F===I){var De=new THREE.RenderableVertex;return V.push(De),I++,F++,De}return V[F++]}function T(){if(B===H){var De=new THREE.RenderableFace3;return G.push(De),H++,B++,De}return G[B++]}function M(){if(W===Y){var De=new THREE.RenderableFace4;return X.push(De),Y++,W++,De}return X[W++]}function A(){if(Q===J){var De=new THREE.RenderableLine;return Z.push(De),J++,Q++,De}return Z[Q++]}function E(){if(oe===ne){var De=new THREE.RenderableParticle;return ie.push(De),ne++,oe++,De}return ie[oe++]}function C(De,Re){return Re.z-De.z}function D(De,Re){var Pe=0,Le=1,Ue=De.z+De.w,Ne=Re.z+Re.w,Fe=-De.z+De.w,ze=-Re.z+Re.w;return 0<=Ue&&0<=Ne&&0<=Fe&&0<=ze||(0>Ue&&0>Ne||0>Fe&&0>ze?!1:(0>Ue?Pe=Math.max(Pe,Ue/(Ue-Ne)):0>Ne&&(Le=Math.min(Le,Ue/(Ue-Ne))),0>Fe?Pe=Math.max(Pe,Fe/(Fe-ze)):0>ze&&(Le=Math.min(Le,Fe/(Fe-ze))),!(Le<Pe)&&(De.lerp(Re,Pe),Re.lerp(De,1-Le),!0)))}var L=[],U=0,V=[],I=0,G=[],H=0,X=[],Y=0,Z=[],J=0,ie=[],ne=0,se={objects:[],sprites:[],lights:[],elements:[]},le=new THREE.Vector3,pe=new THREE.Vector4,ue=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),fe=new THREE.Box3,he=[,,,],ge=[,,,,],ye=new THREE.Matrix4,_e=new THREE.Matrix4,ve=new THREE.Matrix4,Se=new THREE.Matrix3,Te=new THREE.Matrix3,Me=new THREE.Vector3,Ae=new THREE.Frustum,we=new THREE.Vector4,Ee=new THREE.Vector4,R,P,N,F,O,B,W,K,Q,ee,oe,xe;this.projectVector=function(De,Re){return Re.matrixWorldInverse.getInverse(Re.matrixWorld),_e.multiplyMatrices(Re.projectionMatrix,Re.matrixWorldInverse),De.applyProjection(_e)},this.unprojectVector=function(De,Re){return Re.projectionMatrixInverse.getInverse(Re.projectionMatrix),_e.multiplyMatrices(Re.matrixWorld,Re.projectionMatrixInverse),De.applyProjection(_e)},this.pickingRay=function(De,Re){De.z=-1;var Pe=new THREE.Vector3(De.x,De.y,1);return this.unprojectVector(De,Re),this.unprojectVector(Pe,Re),Pe.sub(De).normalize(),new THREE.Raycaster(De,Pe)};var Ce=function(De,Re){P=0,se.objects.length=0,se.sprites.length=0,se.lights.length=0;var Pe=function(Le){for(var Ue=0,Ne=Le.children.length,Fe;Ue<Ne;Ue++)Fe=Le.children[Ue],!1===Fe.visible||(Fe instanceof THREE.Light?se.lights.push(Fe):Fe instanceof THREE.Mesh||Fe instanceof THREE.Line?(!1===Fe.frustumCulled||!0===Ae.intersectsObject(Fe))&&(R=_(),R.object=Fe,null===Fe.renderDepth?(le.getPositionFromMatrix(Fe.matrixWorld),le.applyProjection(_e),R.z=le.z):R.z=Fe.renderDepth,se.objects.push(R)):Fe instanceof THREE.Sprite||Fe instanceof THREE.Particle?(R=_(),R.object=Fe,null===Fe.renderDepth?(le.getPositionFromMatrix(Fe.matrixWorld),le.applyProjection(_e),R.z=le.z):R.z=Fe.renderDepth,se.sprites.push(R)):(R=_(),R.object=Fe,null===Fe.renderDepth?(le.getPositionFromMatrix(Fe.matrixWorld),le.applyProjection(_e),R.z=le.z):R.z=Fe.renderDepth,se.objects.push(R)),Pe(Fe))};return Pe(De),!0===Re&&se.objects.sort(C),se};this.projectScene=function(De,Re,Pe,Le){var Ue=!1,Ne,Fe,ze,Ve,Ie,Oe,Be,ke,Ge,He,We,je,Xe,Ye,qe,Ke,Qe,Ze,Je,$e,et,tt,rt,at,ot,it;for(B=0,W=0,Q=0,oe=0,se.elements.length=0,!0===De.autoUpdate&&De.updateMatrixWorld(),void 0===Re.parent&&Re.updateMatrixWorld(),ye.copy(Re.matrixWorldInverse.getInverse(Re.matrixWorld)),_e.multiplyMatrices(Re.projectionMatrix,ye),Te.getNormalMatrix(ye),Ae.setFromMatrix(_e),se=Ce(De,Pe),(Ne=0,Fe=se.objects.length);Ne<Fe;Ne++)if(Xe=se.objects[Ne].object,xe=Xe.matrixWorld,F=0,Xe instanceof THREE.Mesh){for(Ye=Xe.geometry,qe=Ye.vertices,Ke=Ye.faces,Je=Ye.faceVertexUvs,Se.getNormalMatrix(xe),ot=Xe.material instanceof THREE.MeshFaceMaterial,it=!0===ot?Xe.material:null,(ze=0,Ve=qe.length);ze<Ve;ze++)N=S(),N.positionWorld.copy(qe[ze]).applyMatrix4(xe),N.positionScreen.copy(N.positionWorld).applyMatrix4(_e),N.positionScreen.x/=N.positionScreen.w,N.positionScreen.y/=N.positionScreen.w,N.positionScreen.z/=N.positionScreen.w,N.visible=!(-1>N.positionScreen.x||1<N.positionScreen.x||-1>N.positionScreen.y||1<N.positionScreen.y||-1>N.positionScreen.z||1<N.positionScreen.z);for(Ie=0,Oe=Ke.length;Ie<Oe;Ie++){Qe=Ke[Ie];var nt=!0===ot?it.materials[Qe.materialIndex]:Xe.material;if(void 0!==nt){var st=nt.side;if(Qe instanceof THREE.Face3){if(et=V[Qe.a],tt=V[Qe.b],rt=V[Qe.c],he[0]=et.positionScreen,he[1]=tt.positionScreen,he[2]=rt.positionScreen,!(!0===et.visible||!0===tt.visible||!0===rt.visible||ue.isIntersectionBox(fe.setFromPoints(he))))continue;else if(Ue=0>(rt.positionScreen.x-et.positionScreen.x)*(tt.positionScreen.y-et.positionScreen.y)-(rt.positionScreen.y-et.positionScreen.y)*(tt.positionScreen.x-et.positionScreen.x),st===THREE.DoubleSide||Ue==(st===THREE.FrontSide))O=T(),O.v1.copy(et),O.v2.copy(tt),O.v3.copy(rt);else continue;}else if(Qe instanceof THREE.Face4)if(et=V[Qe.a],tt=V[Qe.b],rt=V[Qe.c],at=V[Qe.d],ge[0]=et.positionScreen,ge[1]=tt.positionScreen,ge[2]=rt.positionScreen,ge[3]=at.positionScreen,!(!0===et.visible||!0===tt.visible||!0===rt.visible||!0===at.visible||ue.isIntersectionBox(fe.setFromPoints(ge))))continue;else if(Ue=0>(at.positionScreen.x-et.positionScreen.x)*(tt.positionScreen.y-et.positionScreen.y)-(at.positionScreen.y-et.positionScreen.y)*(tt.positionScreen.x-et.positionScreen.x)||0>(tt.positionScreen.x-rt.positionScreen.x)*(at.positionScreen.y-rt.positionScreen.y)-(tt.positionScreen.y-rt.positionScreen.y)*(at.positionScreen.x-rt.positionScreen.x),st===THREE.DoubleSide||Ue==(st===THREE.FrontSide))O=M(),O.v1.copy(et),O.v2.copy(tt),O.v3.copy(rt),O.v4.copy(at);else continue;for(O.normalModel.copy(Qe.normal),!1==Ue&&(st===THREE.BackSide||st===THREE.DoubleSide)&&O.normalModel.negate(),O.normalModel.applyMatrix3(Se).normalize(),O.normalModelView.copy(O.normalModel).applyMatrix3(Te),O.centroidModel.copy(Qe.centroid).applyMatrix4(xe),Ze=Qe.vertexNormals,(Be=0,ke=Ze.length);Be<ke;Be++){var lt=O.vertexNormalsModel[Be];lt.copy(Ze[Be]),!1==Ue&&(st===THREE.BackSide||st===THREE.DoubleSide)&&lt.negate(),lt.applyMatrix3(Se).normalize();var dt=O.vertexNormalsModelView[Be];dt.copy(lt).applyMatrix3(Te)}for(O.vertexNormalsLength=Ze.length,Ge=0,He=Je.length;Ge<He;Ge++)if($e=Je[Ge][Ie],void 0!=$e)for(We=0,je=$e.length;We<je;We++)O.uvs[Ge][We]=$e[We];O.color=Qe.color,O.material=nt,Me.copy(O.centroidModel).applyProjection(_e),O.z=Me.z,se.elements.push(O)}}}else if(Xe instanceof THREE.Line){ve.multiplyMatrices(_e,xe),qe=Xe.geometry.vertices,et=S(),et.positionScreen.copy(qe[0]).applyMatrix4(ve);var ct=Xe.type===THREE.LinePieces?2:1;for(ze=1,Ve=qe.length;ze<Ve;ze++)et=S(),et.positionScreen.copy(qe[ze]).applyMatrix4(ve),0<(ze+1)%ct||(tt=V[F-2],we.copy(et.positionScreen),Ee.copy(tt.positionScreen),!0===D(we,Ee)&&(we.multiplyScalar(1/we.w),Ee.multiplyScalar(1/Ee.w),K=A(),K.v1.positionScreen.copy(we),K.v2.positionScreen.copy(Ee),K.z=Math.max(we.z,Ee.z),K.material=Xe.material,Xe.material.vertexColors===THREE.VertexColors&&(K.vertexColors[0].copy(Xe.geometry.colors[ze]),K.vertexColors[1].copy(Xe.geometry.colors[ze-1])),se.elements.push(K)))}for(Ne=0,Fe=se.sprites.length;Ne<Fe;Ne++)Xe=se.sprites[Ne].object,xe=Xe.matrixWorld,Xe instanceof THREE.Particle&&(pe.set(xe.elements[12],xe.elements[13],xe.elements[14],1),pe.applyMatrix4(_e),pe.z/=pe.w,0<pe.z&&1>pe.z&&(ee=E(),ee.object=Xe,ee.x=pe.x/pe.w,ee.y=pe.y/pe.w,ee.z=pe.z,ee.rotation=Xe.rotation.z,ee.scale.x=Xe.scale.x*Math.abs(ee.x-(pe.x+Re.projectionMatrix.elements[0])/(pe.w+Re.projectionMatrix.elements[12])),ee.scale.y=Xe.scale.y*Math.abs(ee.y-(pe.y+Re.projectionMatrix.elements[5])/(pe.w+Re.projectionMatrix.elements[13])),ee.material=Xe.material,se.elements.push(ee)));return!0===Le&&se.elements.sort(C),se}},THREE.Face3=function(_,S,T,M,A,E){this.a=_,this.b=S,this.c=T,this.normal=M instanceof THREE.Vector3?M:new THREE.Vector3,this.vertexNormals=M instanceof Array?M:[],this.color=A instanceof THREE.Color?A:new THREE.Color,this.vertexColors=A instanceof Array?A:[],this.vertexTangents=[],this.materialIndex=E===void 0?0:E,this.centroid=new THREE.Vector3},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var _=new THREE.Face3(this.a,this.b,this.c);_.normal.copy(this.normal),_.color.copy(this.color),_.centroid.copy(this.centroid),_.materialIndex=this.materialIndex;var S,T;for(S=0,T=this.vertexNormals.length;S<T;S++)_.vertexNormals[S]=this.vertexNormals[S].clone();for(S=0,T=this.vertexColors.length;S<T;S++)_.vertexColors[S]=this.vertexColors[S].clone();for(S=0,T=this.vertexTangents.length;S<T;S++)_.vertexTangents[S]=this.vertexTangents[S].clone();return _}},THREE.Face4=function(_,S,T,M,A,E,C){this.a=_,this.b=S,this.c=T,this.d=M,this.normal=A instanceof THREE.Vector3?A:new THREE.Vector3,this.vertexNormals=A instanceof Array?A:[],this.color=E instanceof THREE.Color?E:new THREE.Color,this.vertexColors=E instanceof Array?E:[],this.vertexTangents=[],this.materialIndex=C===void 0?0:C,this.centroid=new THREE.Vector3},THREE.Face4.prototype={constructor:THREE.Face4,clone:function(){var _=new THREE.Face4(this.a,this.b,this.c,this.d);_.normal.copy(this.normal),_.color.copy(this.color),_.centroid.copy(this.centroid),_.materialIndex=this.materialIndex;var S,T;for(S=0,T=this.vertexNormals.length;S<T;S++)_.vertexNormals[S]=this.vertexNormals[S].clone();for(S=0,T=this.vertexColors.length;S<T;S++)_.vertexColors[S]=this.vertexColors[S].clone();for(S=0,T=this.vertexTangents.length;S<T;S++)_.vertexTangents[S]=this.vertexTangents[S].clone();return _}},THREE.Geometry=function(){this.id=THREE.GeometryIdCount++,this.name='',this.vertices=[],this.colors=[],this.normals=[],this.faces=[],this.faceUvs=[[]],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.tangentsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.buffersNeedUpdate=!1,this.userData={}},THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(_){for(var S=new THREE.Matrix3().getNormalMatrix(_),T=0,M=this.vertices.length,A;T<M;T++)A=this.vertices[T],A.applyMatrix4(_);for(var T=0,M=this.faces.length,E;T<M;T++){E=this.faces[T],E.normal.applyMatrix3(S).normalize();for(var C=0,D=E.vertexNormals.length;C<D;C++)E.vertexNormals[C].applyMatrix3(S).normalize();E.centroid.applyMatrix4(_)}},computeCentroids:function(){var _,S,T;for(_=0,S=this.faces.length;_<S;_++)T=this.faces[_],T.centroid.set(0,0,0),T instanceof THREE.Face3?(T.centroid.add(this.vertices[T.a]),T.centroid.add(this.vertices[T.b]),T.centroid.add(this.vertices[T.c]),T.centroid.divideScalar(3)):T instanceof THREE.Face4&&(T.centroid.add(this.vertices[T.a]),T.centroid.add(this.vertices[T.b]),T.centroid.add(this.vertices[T.c]),T.centroid.add(this.vertices[T.d]),T.centroid.divideScalar(4))},computeFaceNormals:function(){for(var _=new THREE.Vector3,S=new THREE.Vector3,T=0,M=this.faces.length;T<M;T++){var A=this.faces[T],E=this.vertices[A.a],C=this.vertices[A.b],D=this.vertices[A.c];_.subVectors(D,C),S.subVectors(E,C),_.cross(S),_.normalize(),A.normal.copy(_)}},computeVertexNormals:function(_){var S,T,M,A,E,C;if(this.__tmpVertices===void 0){for(this.__tmpVertices=Array(this.vertices.length),C=this.__tmpVertices,(S=0,T=this.vertices.length);S<T;S++)C[S]=new THREE.Vector3;for(M=0,A=this.faces.length;M<A;M++)E=this.faces[M],E instanceof THREE.Face3?E.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:E instanceof THREE.Face4&&(E.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}else for(C=this.__tmpVertices,S=0,T=this.vertices.length;S<T;S++)C[S].set(0,0,0);if(_){var U=new THREE.Vector3,N=new THREE.Vector3,F=new THREE.Vector3,V=new THREE.Vector3,I=new THREE.Vector3,D,R,P,L;for(M=0,A=this.faces.length;M<A;M++)E=this.faces[M],E instanceof THREE.Face3?(D=this.vertices[E.a],R=this.vertices[E.b],P=this.vertices[E.c],U.subVectors(P,R),N.subVectors(D,R),U.cross(N),C[E.a].add(U),C[E.b].add(U),C[E.c].add(U)):E instanceof THREE.Face4&&(D=this.vertices[E.a],R=this.vertices[E.b],P=this.vertices[E.c],L=this.vertices[E.d],F.subVectors(L,R),N.subVectors(D,R),F.cross(N),C[E.a].add(F),C[E.b].add(F),C[E.d].add(F),V.subVectors(L,P),I.subVectors(R,P),V.cross(I),C[E.b].add(V),C[E.c].add(V),C[E.d].add(V))}else for(M=0,A=this.faces.length;M<A;M++)E=this.faces[M],E instanceof THREE.Face3?(C[E.a].add(E.normal),C[E.b].add(E.normal),C[E.c].add(E.normal)):E instanceof THREE.Face4&&(C[E.a].add(E.normal),C[E.b].add(E.normal),C[E.c].add(E.normal),C[E.d].add(E.normal));for(S=0,T=this.vertices.length;S<T;S++)C[S].normalize();for(M=0,A=this.faces.length;M<A;M++)E=this.faces[M],E instanceof THREE.Face3?(E.vertexNormals[0].copy(C[E.a]),E.vertexNormals[1].copy(C[E.b]),E.vertexNormals[2].copy(C[E.c])):E instanceof THREE.Face4&&(E.vertexNormals[0].copy(C[E.a]),E.vertexNormals[1].copy(C[E.b]),E.vertexNormals[2].copy(C[E.c]),E.vertexNormals[3].copy(C[E.d]))},computeMorphNormals:function(){var _,S,T,M,A;for(T=0,M=this.faces.length;T<M;T++)for(A=this.faces[T],A.__originalFaceNormal?A.__originalFaceNormal.copy(A.normal):A.__originalFaceNormal=A.normal.clone(),A.__originalVertexNormals||(A.__originalVertexNormals=[]),(_=0,S=A.vertexNormals.length);_<S;_++)A.__originalVertexNormals[_]?A.__originalVertexNormals[_].copy(A.vertexNormals[_]):A.__originalVertexNormals[_]=A.vertexNormals[_].clone();var E=new THREE.Geometry;for(E.faces=this.faces,_=0,S=this.morphTargets.length;_<S;_++){if(!this.morphNormals[_]){this.morphNormals[_]={},this.morphNormals[_].faceNormals=[],this.morphNormals[_].vertexNormals=[];var C=this.morphNormals[_].faceNormals,D=this.morphNormals[_].vertexNormals,R,P;for(T=0,M=this.faces.length;T<M;T++)A=this.faces[T],R=new THREE.Vector3,P=A instanceof THREE.Face3?{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3}:{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3,d:new THREE.Vector3},C.push(R),D.push(P)}var L=this.morphNormals[_];E.vertices=this.morphTargets[_].vertices,E.computeFaceNormals(),E.computeVertexNormals();var R,P;for(T=0,M=this.faces.length;T<M;T++)A=this.faces[T],R=L.faceNormals[T],P=L.vertexNormals[T],R.copy(A.normal),A instanceof THREE.Face3?(P.a.copy(A.vertexNormals[0]),P.b.copy(A.vertexNormals[1]),P.c.copy(A.vertexNormals[2])):(P.a.copy(A.vertexNormals[0]),P.b.copy(A.vertexNormals[1]),P.c.copy(A.vertexNormals[2]),P.d.copy(A.vertexNormals[3]))}for(T=0,M=this.faces.length;T<M;T++)A=this.faces[T],A.normal=A.__originalFaceNormal,A.vertexNormals=A.__originalVertexNormals},computeTangents:function(){function _(ye,_e,xe,ve,Se,Te,Me){L=ye.vertices[_e],U=ye.vertices[xe],N=ye.vertices[ve],F=P[Se],V=P[Te],I=P[Me],O=U.x-L.x,B=N.x-L.x,G=U.y-L.y,H=N.y-L.y,W=U.z-L.z,X=N.z-L.z,Y=V.x-F.x,K=I.x-F.x,Q=V.y-F.y,Z=I.y-F.y,J=1/(Y*Z-K*Q),se.set((Z*O-Q*B)*J,(Z*G-Q*H)*J,(Z*W-Q*X)*J),le.set((Y*B-K*O)*J,(Y*H-K*G)*J,(Y*X-K*W)*J),ie[_e].add(se),ie[xe].add(se),ie[ve].add(se),ne[_e].add(le),ne[xe].add(le),ne[ve].add(le)}var ie=[],ne=[],se=new THREE.Vector3,le=new THREE.Vector3,pe=new THREE.Vector3,ue=new THREE.Vector3,fe=new THREE.Vector3,S,T,M,A,E,D,R,P,L,U,N,F,V,I,O,B,G,H,W,X,Y,K,Q,Z,J,ee,oe,he;for(M=0,A=this.vertices.length;M<A;M++)ie[M]=new THREE.Vector3,ne[M]=new THREE.Vector3;for(S=0,T=this.faces.length;S<T;S++)R=this.faces[S],P=this.faceVertexUvs[0][S],R instanceof THREE.Face3?_(this,R.a,R.b,R.c,0,1,2):R instanceof THREE.Face4&&(_(this,R.a,R.b,R.d,0,1,3),_(this,R.b,R.c,R.d,1,2,3));var ge=['a','b','c','d'];for(S=0,T=this.faces.length;S<T;S++)for(R=this.faces[S],E=0;E<R.vertexNormals.length;E++)fe.copy(R.vertexNormals[E]),D=R[ge[E]],ee=ie[D],pe.copy(ee),pe.sub(fe.multiplyScalar(fe.dot(ee))).normalize(),ue.crossVectors(R.vertexNormals[E],ee),oe=ue.dot(ne[D]),he=0>oe?-1:1,R.vertexTangents[E]=new THREE.Vector4(pe.x,pe.y,pe.z,he);this.hasTangents=!0},computeLineDistances:function(){for(var _=0,S=this.vertices,T=0,M=S.length;T<M;T++)0<T&&(_+=S[T].distanceTo(S[T-1])),this.lineDistances[T]=_},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3,!this.boundingBox_list&&(this.boundingBox_list=[this.boundingBox])),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.boundingSphere.setFromCenterAndPoints(this.boundingSphere.center,this.vertices)},mergeVertices:function(){var _={},S=[],T=[],C=Math.pow(10,4),M,A,D,R,P,L,N,F,V;for(this.__tmpVertices=void 0,D=0,R=this.vertices.length;D<R;D++)M=this.vertices[D],A=[Math.round(M.x*C),Math.round(M.y*C),Math.round(M.z*C)].join('_'),void 0===_[A]?(_[A]=D,S.push(this.vertices[D]),T[D]=S.length-1):T[D]=T[_[A]];var I=[];for(D=0,R=this.faces.length;D<R;D++)if(P=this.faces[D],P instanceof THREE.Face3){P.a=T[P.a],P.b=T[P.b],P.c=T[P.c],L=[P.a,P.b,P.c];for(var O=-1,B=0;3>B;B++)if(L[B]==L[(B+1)%3]){O=B,I.push(D);break}}else if(P instanceof THREE.Face4){P.a=T[P.a],P.b=T[P.b],P.c=T[P.c],P.d=T[P.d],L=[P.a,P.b,P.c,P.d];for(var O=-1,B=0;4>B;B++)L[B]==L[(B+1)%4]&&(0<=O&&I.push(D),O=B);if(0<=O){L.splice(O,1);var G=new THREE.Face3(L[0],L[1],L[2],P.normal,P.color,P.materialIndex);for(N=0,F=this.faceVertexUvs.length;N<F;N++)V=this.faceVertexUvs[N][D],V&&V.splice(O,1);P.vertexNormals&&0<P.vertexNormals.length&&(G.vertexNormals=P.vertexNormals,G.vertexNormals.splice(O,1)),P.vertexColors&&0<P.vertexColors.length&&(G.vertexColors=P.vertexColors,G.vertexColors.splice(O,1)),this.faces[D]=G}}for(D=I.length-1;0<=D;D--)for(this.faces.splice(D,1),N=0,F=this.faceVertexUvs.length;N<F;N++)this.faceVertexUvs[N].splice(D,1);var H=this.vertices.length-S.length;return this.vertices=S,H},clone:function(){for(var _=new THREE.Geometry,S=this.vertices,T=0,M=S.length;T<M;T++)_.vertices.push(S[T].clone());for(var A=this.faces,T=0,M=A.length;T<M;T++)_.faces.push(A[T].clone());for(var E=this.faceVertexUvs[0],T=0,M=E.length;T<M;T++){for(var C=E[T],D=[],R=0,P=C.length;R<P;R++)D.push(new THREE.Vector2(C[R].x,C[R].y));_.faceVertexUvs[0].push(D)}return _},dispose:function(){this.dispatchEvent({type:'dispose'})}},THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype),THREE.GeometryIdCount=0,THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++,this.attributes={},this.dynamic=!1,this.offsets=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.morphTargets=[]},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,applyMatrix:function(_){var S,T;if(this.attributes.position&&(S=this.attributes.position.array),this.attributes.normal&&(T=this.attributes.normal.array),void 0!=S&&(_.multiplyVector3Array(S),this.verticesNeedUpdate=!0),void 0!=T){var M=new THREE.Matrix3().getNormalMatrix(_);M.multiplyVector3Array(T),this.normalizeNormals(),this.normalsNeedUpdate=!0}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var _=this.attributes.position.array;if(_){var S=this.boundingBox,T,M,A;3<=_.length&&(S.min.x=S.max.x=_[0],S.min.y=S.max.y=_[1],S.min.z=S.max.z=_[2]);for(var E=3,C=_.length;E<C;E+=3)T=_[E],M=_[E+1],A=_[E+2],T<S.min.x?S.min.x=T:T>S.max.x&&(S.max.x=T),M<S.min.y?S.min.y=M:M>S.max.y&&(S.max.y=M),A<S.min.z?S.min.z=A:A>S.max.z&&(S.max.z=A)}(_===void 0||0===_.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0))},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var _=this.attributes.position.array;if(_){for(var T=0,C=0,D=_.length,S,M,A,E;C<D;C+=3)M=_[C],A=_[C+1],E=_[C+2],S=M*M+A*A+E*E,S>T&&(T=S);this.boundingSphere.radius=Math.sqrt(T)}},computeVertexNormals:function(){if(this.attributes.position){var _,S,T,M,A=this.attributes.position.array.length;if(this.attributes.normal===void 0)this.attributes.normal={itemSize:3,array:new Float32Array(A),numItems:A};else for(_=0,S=this.attributes.normal.array.length;_<S;_++)this.attributes.normal.array[_]=0;var E=this.attributes.position.array,C=this.attributes.normal.array,D,R,P,L,U,N,F=new THREE.Vector3,V=new THREE.Vector3,I=new THREE.Vector3,O=new THREE.Vector3,B=new THREE.Vector3;if(this.attributes.index){var G=this.attributes.index.array,H=this.offsets;for(T=0,M=H.length;T<M;++T){var W=H[T].start,X=H[T].count,Y=H[T].index;for(_=W,S=W+X;_<S;_+=3)D=Y+G[_],R=Y+G[_+1],P=Y+G[_+2],L=E[3*D],U=E[3*D+1],N=E[3*D+2],F.set(L,U,N),L=E[3*R],U=E[3*R+1],N=E[3*R+2],V.set(L,U,N),L=E[3*P],U=E[3*P+1],N=E[3*P+2],I.set(L,U,N),O.subVectors(I,V),B.subVectors(F,V),O.cross(B),C[3*D]+=O.x,C[3*D+1]+=O.y,C[3*D+2]+=O.z,C[3*R]+=O.x,C[3*R+1]+=O.y,C[3*R+2]+=O.z,C[3*P]+=O.x,C[3*P+1]+=O.y,C[3*P+2]+=O.z}}else for(_=0,S=E.length;_<S;_+=9)L=E[_],U=E[_+1],N=E[_+2],F.set(L,U,N),L=E[_+3],U=E[_+4],N=E[_+5],V.set(L,U,N),L=E[_+6],U=E[_+7],N=E[_+8],I.set(L,U,N),O.subVectors(I,V),B.subVectors(F,V),O.cross(B),C[_]=O.x,C[_+1]=O.y,C[_+2]=O.z,C[_+3]=O.x,C[_+4]=O.y,C[_+5]=O.z,C[_+6]=O.x,C[_+7]=O.y,C[_+8]=O.z;this.normalizeNormals(),this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var _=this.attributes.normal.array,E=0,C=_.length,S,T,M,A;E<C;E+=3)S=_[E],T=_[E+1],M=_[E+2],A=1/Math.sqrt(S*S+T*T+M*M),_[E]*=A,_[E+1]*=A,_[E+2]*=A},computeTangents:function(){function _(Ie,Oe,Be){N=M[3*Ie],F=M[3*Ie+1],V=M[3*Ie+2],I=M[3*Oe],O=M[3*Oe+1],B=M[3*Oe+2],G=M[3*Be],H=M[3*Be+1],W=M[3*Be+2],X=E[2*Ie],Y=E[2*Ie+1],K=E[2*Oe],Q=E[2*Oe+1],Z=E[2*Be],J=E[2*Be+1],ee=I-N,oe=G-N,ie=O-F,ne=H-F,se=B-V,le=W-V,pe=K-X,ue=Z-X,fe=Q-Y,he=J-Y,ge=1/(pe*he-ue*fe),ye.set((he*ee-fe*oe)*ge,(he*ie-fe*ne)*ge,(he*se-fe*le)*ge),_e.set((pe*oe-ue*ee)*ge,(pe*ne-ue*ie)*ge,(pe*le-ue*se)*ge),P[Ie].add(ye),P[Oe].add(ye),P[Be].add(ye),L[Ie].add(_e),L[Oe].add(_e),L[Be].add(_e)}function S(Ie){Ue.x=A[3*Ie],Ue.y=A[3*Ie+1],Ue.z=A[3*Ie+2],Ne.copy(Ue),ze=P[Ie],Pe.copy(ze),Pe.sub(Ue.multiplyScalar(Ue.dot(ze))).normalize(),Le.crossVectors(Ne,ze),Ve=Le.dot(L[Ie]),Fe=0>Ve?-1:1,R[4*Ie]=Pe.x,R[4*Ie+1]=Pe.y,R[4*Ie+2]=Pe.z,R[4*Ie+3]=Fe}var T=this.attributes.index.array,M=this.attributes.position.array,A=this.attributes.normal.array,E=this.attributes.uv.array,C=M.length/3;if(this.attributes.tangent===void 0){var D=4*C;this.attributes.tangent={itemSize:4,array:new Float32Array(D),numItems:D}}for(var R=this.attributes.tangent.array,P=[],L=[],U=0;U<C;U++)P[U]=new THREE.Vector3,L[U]=new THREE.Vector3;var N,F,V,I,O,B,G,H,W,X,Y,K,Q,Z,J,ee,oe,ie,ne,se,le,pe,ue,fe,he,ge,ye=new THREE.Vector3,_e=new THREE.Vector3,xe,ve,Se,Te,Me,Ae,we,Ee=this.offsets;for(Se=0,Te=Ee.length;Se<Te;++Se){var Ce=Ee[Se].start,De=Ee[Se].count,Re=Ee[Se].index;for(xe=Ce,ve=Ce+De;xe<ve;xe+=3)Me=Re+T[xe],Ae=Re+T[xe+1],we=Re+T[xe+2],_(Me,Ae,we)}var Pe=new THREE.Vector3,Le=new THREE.Vector3,Ue=new THREE.Vector3,Ne=new THREE.Vector3,Fe,ze,Ve;for(Se=0,Te=Ee.length;Se<Te;++Se){var Ce=Ee[Se].start,De=Ee[Se].count,Re=Ee[Se].index;for(xe=Ce,ve=Ce+De;xe<ve;xe+=3)Me=Re+T[xe],Ae=Re+T[xe+1],we=Re+T[xe+2],S(Me),S(Ae),S(we)}this.hasTangents=!0,this.tangentsNeedUpdate=!0},dispose:function(){this.dispatchEvent({type:'dispose'})}},THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype),THREE.Camera=function(){THREE.Object3D.call(this),this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4,this.projectionMatrixInverse=new THREE.Matrix4},THREE.Camera.prototype=Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.lookAt=function(){var _=new THREE.Matrix4;return function(S){_.lookAt(this.position,S,this.up),this._lookAt.copy(S),!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(_):this.rotation.setEulerFromRotationMatrix(_,this.eulerOrder)}}(),THREE.OrthographicCamera=function(_,S,T,M,A,E){THREE.Camera.call(this),this.left=_,this.right=S,this.top=T,this.bottom=M,this.near=A===void 0?0.1:A,this.far=E===void 0?2e3:E,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype),THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)},THREE.PerspectiveCamera=function(_,S,T,M){THREE.Camera.call(this),this.fov=_===void 0?50:_,this.aspect=S===void 0?1:S,this.near=T===void 0?0.1:T,this.far=M===void 0?2e3:M,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype),THREE.PerspectiveCamera.prototype.setLens=function(_,S){S===void 0&&(S=24),this.fov=2*THREE.Math.radToDeg(Math.atan(S/(2*_))),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.setViewOffset=function(_,S,T,M,A,E){this.fullWidth=_,this.fullHeight=S,this.x=T,this.y=M,this.width=A,this.height=E,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var _=this.fullWidth/this.fullHeight,S=Math.tan(THREE.Math.degToRad(0.5*this.fov))*this.near,T=-S,M=_*T,E=Math.abs(_*S-M),C=Math.abs(S-T);this.projectionMatrix.makeFrustum(M+this.x*E/this.fullWidth,M+(this.x+this.width)*E/this.fullWidth,S-(this.y+this.height)*C/this.fullHeight,S-this.y*C/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)},THREE.Light=function(_){THREE.Object3D.call(this),this.color=new THREE.Color(_||16777215)},THREE.Light.prototype=Object.create(THREE.Object3D.prototype),THREE.Light.prototype.clone=function(_){return void 0===_&&(_=new THREE.Light),THREE.Object3D.prototype.clone.call(this,_),_.color.copy(this.color),_},THREE.AmbientLight=function(_){'object'==typeof _&&(_=_.color),THREE.Light.call(this,_)},THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype),THREE.AmbientLight.prototype.clone=function(){var _=new THREE.AmbientLight;return THREE.Light.prototype.clone.call(this,_),_},THREE.AreaLight=function(_,S){'object'==typeof _&&(S=_.intensity,_=_.color),THREE.Light.call(this,_),this.normal=new THREE.Vector3(0,-1,0),this.right=new THREE.Vector3(1,0,0),this.intensity=S===void 0?1:S,this.width=1,this.height=1,this.constantAttenuation=1.5,this.linearAttenuation=0.5,this.quadraticAttenuation=0.1},THREE.AreaLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight=function(_,S){'object'==typeof _&&(S=_.intensity,_=_.color),THREE.Light.call(this,_),this.position.set(0,1,0),this.target=new THREE.Object3D,this.target.position=this._lookAt,this.intensity=S===void 0?1:S,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=0.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowBias_range=[0.1,100],this.shadowCascade=!1,this.shadowCascadeOffset=new THREE.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,0.99,0.998],this.shadowCascadeFarZ=[0.99,0.998,1],this.shadowCascadeArray=[],this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight.prototype.clone=function(){var _=new THREE.DirectionalLight;return THREE.Light.prototype.clone.call(this,_),_.target=this.target.clone(),_.target.position=_._lookAt,_.intensity=this.intensity,_.castShadow=this.castShadow,_.onlyShadow=this.onlyShadow,_},THREE.HemisphereLight=function(_,S,T){'object'==typeof _&&(T=_.intensity,S=_.ground,_=_.sky),THREE.Light.call(this,_),this.sky=this.color,this.position.set(0,100,0),this.ground=this.groundColor=new THREE.Color(S),this.intensity=T===void 0?1:T},THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype),THREE.HemisphereLight.prototype.clone=function(){var _=new THREE.HemisphereLight;return THREE.Light.prototype.clone.call(this,_),_.groundColor.copy(this.groundColor),_.intensity=this.intensity,_},THREE.PointLight=function(_,S,T){'object'==typeof _&&(S=_.intensity,T=_.distance,_=_.color),THREE.Light.call(this,_),this.intensity=S===void 0?1:S,this.distance=T===void 0?0:T},THREE.PointLight.prototype=Object.create(THREE.Light.prototype),THREE.PointLight.prototype.clone=function(){var _=new THREE.PointLight;return THREE.Light.prototype.clone.call(this,_),_.intensity=this.intensity,_.distance=this.distance,_},THREE.SpotLight=function(_,S,T,M,A){'object'==typeof _&&(S=_.intensity,T=_.distance,M=_.angle,A=_.exponent,_=_.color),THREE.Light.call(this,_),this.position.set(0,1,0),this.target=new THREE.Object3D,this.target.position=this._lookAt,this.intensity=S===void 0?1:S,this.distance=T===void 0?0:T,this.angle=M===void 0?Math.PI/3:M,this.exponent=A===void 0?10:A,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=0.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},THREE.SpotLight.prototype=Object.create(THREE.Light.prototype),THREE.SpotLight.prototype.clone=function(){var _=new THREE.SpotLight;return THREE.Light.prototype.clone.call(this,_),_.target=this.target.clone(),_.target.position=_._lookAt,_.intensity=this.intensity,_.distance=this.distance,_.angle=this.angle,_.exponent=this.exponent,_.castShadow=this.castShadow,_.onlyShadow=this.onlyShadow,_},THREE.ImageLoader=function(){this.crossOrigin=null},THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(_,S){var T=this;if(void 0===S&&(S=new Image),S.addEventListener('load',function(){var E;if(self.MMD_SA){let C=S._texture_resolution_limit||MMD_SA_options.texture_resolution_limit;(S.width>C||S.height>C)&&(E=document.createElement('canvas'),E.width=Math.min(C,S.width),E.height=Math.min(C,S.height),E.getContext('2d').drawImage(S,0,0,E.width,E.height))}E||(E=S),T.dispatchEvent({type:'load',content:E})},!1),S.addEventListener('error',function(){T.dispatchEvent({type:'error',message:'Couldn\'t load URL ['+_+']'})},!1),/^(tga|TGA)/.test(_.split('.').pop())){var M=new THREE.TGA;M.open(_,function(){delete S.crossOrigin,S.src=M.getDataURL(),M=null},function(){var E=document.createEvent('HTMLEvents');E.initEvent('error',!1,!0),S.dispatchEvent(E),M=null})}else if(/^data:image/.test(_)||(S.crossOrigin='anonymous'),!/^(data|blob)\:/.test(_)||/\.zip\#/i.test(toLocalPath(_))){var A=new XMLHttpRequestZIP;A.onload=function(){var E=URL.createObjectURL(this.response);if(/^(.+)\.jpga\.jpg$/i.test(_)){var C=RegExp.$1+'.alpha.png';console.log('Use JPG alpha - '+C);var D=new Image;D.addEventListener('load',function(){URL.revokeObjectURL(E);var R=new XMLHttpRequestZIP;R.onload=function(){E=URL.createObjectURL(this.response);var P=new Image;P.addEventListener('load',function(){URL.revokeObjectURL(E);var L=document.createElement('canvas'),U=L.getContext('2d');L.width=P.width,L.height=P.height,U.drawImage(P,0,0);for(var N=U.getImageData(0,0,L.width,L.height),F=new Uint32Array(N.data.buffer),V=0,I=F.length;V<I;)F[V]=F[V++]<<8;U.putImageData(N,0,0),N=F=null;var O=document.createElement('canvas');O.width=D.width,O.height=D.height;var B=O.getContext('2d');B.drawImage(D,0,0),B.globalCompositeOperation='destination-in',B.drawImage(L,0,0),O.toBlob(function(G){E=URL.createObjectURL(G),S.addEventListener('load',function(){URL.revokeObjectURL(E)}),S.src=E,D=P=null,L.width=L.height=O.width=O.height=0,L=U=O=B=null})}),P.src=E,this.response=R=null},R.open('GET',C,!0),R.responseType='blob',R.send()}),D.src=E}else S.addEventListener('load',function(){URL.revokeObjectURL(E)}),S.src=E;this.response=A=null},A.onerror=function(){var E=document.createElement('canvas');E.width=E.height=1;var C=E.getContext('2d');C.fillStyle='white',C.fillRect(0,0,1,1),T.dispatchEvent({type:'load',content:E})},A.open('GET',_,!0),A.responseType='blob',A.send()}else S.src=_}},THREE.EventDispatcher.prototype.apply(THREE.ImageLoader.prototype),THREE.Material=function(){this.id=THREE.MaterialIdCount++,this.name='',this.side=THREE.FrontSide,this.opacity=1,this.transparent=!0,this.blending=THREE.NormalBlending,this.blendSrc=THREE.SrcAlphaFactor,this.blendDst=THREE.OneMinusSrcAlphaFactor,this.blendEquation=THREE.AddEquation,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=!1,this.visible=!0,this.needsUpdate=!0,this.userData={}},THREE.Material.prototype={constructor:THREE.Material,setValues:function(_){if(void 0!==_)for(var S in _){var T=_[S];if(S in this){var M=this[S];M instanceof THREE.Color?M.set(T):M instanceof THREE.Vector3&&T instanceof THREE.Vector3?M.copy(T):this[S]=T}}},clone:function(_){return void 0===_&&(_=new THREE.Material),_.name=this.name,_.side=this.side,_.opacity=this.opacity,_.transparent=this.transparent,_.blending=this.blending,_.blendSrc=this.blendSrc,_.blendDst=this.blendDst,_.blendEquation=this.blendEquation,_.depthTest=this.depthTest,_.depthWrite=this.depthWrite,_.polygonOffset=this.polygonOffset,_.polygonOffsetFactor=this.polygonOffsetFactor,_.polygonOffsetUnits=this.polygonOffsetUnits,_.alphaTest=this.alphaTest,_.overdraw=this.overdraw,_.visible=this.visible,_.offset=this.offset&&this.offset.clone(),_.repeat=this.repeat&&this.repeat.clone(),'uniTexture'in this&&(_.uniTexture=this.uniTexture),_},dispose:function(){this.dispatchEvent({type:'dispose'})}},THREE.EventDispatcher.prototype.apply(THREE.Material.prototype),THREE.MaterialIdCount=0,THREE.LineBasicMaterial=function(_){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.linecap='round',this.linejoin='round',this.vertexColors=!1,this.fog=!0,this.setValues(_)},THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.clone=function(){var _=new THREE.LineBasicMaterial;return THREE.Material.prototype.clone.call(this,_),_.color.copy(this.color),_.linewidth=this.linewidth,_.linecap=this.linecap,_.linejoin=this.linejoin,_.vertexColors=this.vertexColors,_.fog=this.fog,_},THREE.LineDashedMaterial=function(_){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(_)},THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineDashedMaterial.prototype.clone=function(){var _=new THREE.LineDashedMaterial;return THREE.Material.prototype.clone.call(this,_),_.color.copy(this.color),_.linewidth=this.linewidth,_.scale=this.scale,_.dashSize=this.dashSize,_.gapSize=this.gapSize,_.vertexColors=this.vertexColors,_.fog=this.fog,_},THREE.MeshBasicMaterial=function(_){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.lightMap=null,this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=0.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(_)},THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.clone=function(){var _=new THREE.MeshBasicMaterial;return THREE.Material.prototype.clone.call(this,_),_.color.copy(this.color),_.map=this.map,_.lightMap=this.lightMap,_.specularMap=this.specularMap,_.envMap=this.envMap,_.combine=this.combine,_.reflectivity=this.reflectivity,_.refractionRatio=this.refractionRatio,_.fog=this.fog,_.shading=this.shading,_.wireframe=this.wireframe,_.wireframeLinewidth=this.wireframeLinewidth,_.wireframeLinecap=this.wireframeLinecap,_.wireframeLinejoin=this.wireframeLinejoin,_.vertexColors=this.vertexColors,_.skinning=this.skinning,_.morphTargets=this.morphTargets,_},THREE.MeshLambertMaterial=function(_){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=0.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(_)},THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.clone=function(){var _=new THREE.MeshLambertMaterial;return THREE.Material.prototype.clone.call(this,_),_.color.copy(this.color),_.ambient.copy(this.ambient),_.emissive.copy(this.emissive),_.wrapAround=this.wrapAround,_.wrapRGB.copy(this.wrapRGB),_.map=this.map,_.lightMap=this.lightMap,_.specularMap=this.specularMap,_.envMap=this.envMap,_.combine=this.combine,_.reflectivity=this.reflectivity,_.refractionRatio=this.refractionRatio,_.fog=this.fog,_.shading=this.shading,_.wireframe=this.wireframe,_.wireframeLinewidth=this.wireframeLinewidth,_.wireframeLinecap=this.wireframeLinecap,_.wireframeLinejoin=this.wireframeLinejoin,_.vertexColors=this.vertexColors,_.skinning=this.skinning,_.morphTargets=this.morphTargets,_.morphNormals=this.morphNormals,_},THREE.MeshPhongMaterial=function(_){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.specular=new THREE.Color(1118481),this.shininess=30,this.metal=!1,this.perPixel=!0,this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.bumpMap=null,this.bumpScale=1,this.displacementMap=null,this.uDisplacementBias=0,this.uDisplacementScale=1,this.uDisplacementCustomUVScale=0,this.uDisplacementCustomUVOffset=new THREE.Vector2(0,0),this.edgeRotateDisplacementL=0,this.edgeRotateDisplacementR=0,this.edgeScaleDisplacementU=1,this.waveBaseSpeed=null,this.waveNoiseTexture=null,this.waveNoiseScale=0.5337,this.waveBumpScale=5,this.mirrorTextureIndex=null,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=0.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(_)},THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.clone=function(){var _=new THREE.MeshPhongMaterial;return THREE.Material.prototype.clone.call(this,_),_.color.copy(this.color),_.ambient.copy(this.ambient),_.emissive.copy(this.emissive),_.specular.copy(this.specular),_.shininess=this.shininess,_.metal=this.metal,_.perPixel=this.perPixel,_.wrapAround=this.wrapAround,_.wrapRGB.copy(this.wrapRGB),_.map=this.map,_.lightMap=this.lightMap,_.bumpMap=this.bumpMap,_.bumpScale=this.bumpScale,_.displacementMap=this.displacementMap,_.uDisplacementBias=this.uDisplacementBias,_.uDisplacementScale=this.uDisplacementScale,_.uDisplacementCustomUVScale=this.uDisplacementCustomUVScale,_.uDisplacementCustomUVOffset.copy(this.uDisplacementCustomUVOffset),_.edgeRotateDisplacementL=this.edgeRotateDisplacementL,_.edgeRotateDisplacementR=this.edgeRotateDisplacementR,_.edgeScaleDisplacementU=this.edgeScaleDisplacementU,_.waveBaseSpeed=this.waveBaseSpeed,_.waveNoiseTexture=this.waveNoiseTexture,_.waveNoiseScale=this.waveNoiseScale,_.waveBumpScale=this.waveBumpScale,_.mirrorTextureIndex=this.mirrorTextureIndex,_.normalMap=this.normalMap,_.normalScale.copy(this.normalScale),_.specularMap=this.specularMap,_.envMap=this.envMap,_.combine=this.combine,_.reflectivity=this.reflectivity,_.refractionRatio=this.refractionRatio,_.fog=this.fog,_.shading=this.shading,_.wireframe=this.wireframe,_.wireframeLinewidth=this.wireframeLinewidth,_.wireframeLinecap=this.wireframeLinecap,_.wireframeLinejoin=this.wireframeLinejoin,_.vertexColors=this.vertexColors,_.skinning=this.skinning,_.morphTargets=this.morphTargets,_.morphNormals=this.morphNormals,_},THREE.MeshDepthMaterial=function(_){THREE.Material.call(this),this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(_)},THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshDepthMaterial.prototype.clone=function(){var _=new THREE.MeshDepthMaterial;return THREE.Material.prototype.clone.call(this,_),_.wireframe=this.wireframe,_.wireframeLinewidth=this.wireframeLinewidth,_},THREE.MeshNormalMaterial=function(_){THREE.Material.call(this,_),this.shading=THREE.FlatShading,this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(_)},THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.clone=function(){var _=new THREE.MeshNormalMaterial;return THREE.Material.prototype.clone.call(this,_),_.shading=this.shading,_.wireframe=this.wireframe,_.wireframeLinewidth=this.wireframeLinewidth,_},THREE.MeshFaceMaterial=function(_){this.materials=_ instanceof Array?_:[]},THREE.MeshFaceMaterial.prototype.clone=function(){return new THREE.MeshFaceMaterial(this.materials.slice(0))},THREE.ParticleBasicMaterial=function(_){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=!1,this.fog=!0,this.setValues(_)},THREE.ParticleBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ParticleBasicMaterial.prototype.clone=function(){var _=new THREE.ParticleBasicMaterial;return THREE.Material.prototype.clone.call(this,_),_.color.copy(this.color),_.map=this.map,_.size=this.size,_.sizeAttenuation=this.sizeAttenuation,_.vertexColors=this.vertexColors,_.fog=this.fog,_},THREE.ParticleSystemMaterial=THREE.ParticleBasicMaterial,THREE.ShaderMaterial=function(_){THREE.Material.call(this),this.fragmentShader='void main() {}',this.vertexShader='void main() {}',this.uniforms={},this.defines={},this.attributes=null,this.shading=THREE.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(_)},THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ShaderMaterial.prototype.clone=function(){var _=new THREE.ShaderMaterial;return THREE.Material.prototype.clone.call(this,_),_.fragmentShader=this.fragmentShader,_.vertexShader=this.vertexShader,_.uniforms=THREE.UniformsUtils.clone(this.uniforms),_.attributes=this.attributes,_.defines=this.defines,_.shading=this.shading,_.wireframe=this.wireframe,_.wireframeLinewidth=this.wireframeLinewidth,_.fog=this.fog,_.lights=this.lights,_.vertexColors=this.vertexColors,_.skinning=this.skinning,_.morphTargets=this.morphTargets,_.morphNormals=this.morphNormals,_},THREE.SpriteMaterial=function(_){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=new THREE.Texture,this.useScreenCoordinates=!0,this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.scaleByViewport=!this.sizeAttenuation,this.alignment=THREE.SpriteAlignment.center.clone(),this.fog=!1,this.uvOffset=new THREE.Vector2(0,0),this.uvScale=new THREE.Vector2(1,1),this.setValues(_),_=_||{},_.depthTest===void 0&&(this.depthTest=!this.useScreenCoordinates),_.sizeAttenuation===void 0&&(this.sizeAttenuation=!this.useScreenCoordinates),_.scaleByViewport===void 0&&(this.scaleByViewport=!this.sizeAttenuation)},THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.clone=function(){var _=new THREE.SpriteMaterial;return THREE.Material.prototype.clone.call(this,_),_.color.copy(this.color),_.map=this.map,_.useScreenCoordinates=this.useScreenCoordinates,_.sizeAttenuation=this.sizeAttenuation,_.scaleByViewport=this.scaleByViewport,_.alignment.copy(this.alignment),_.uvOffset.copy(this.uvOffset),_.uvScale.copy(this.uvScale),_.fog=this.fog,_},THREE.SpriteAlignment={},THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1),THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1),THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1),THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0),THREE.SpriteAlignment.center=new THREE.Vector2(0,0),THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0),THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1),THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1),THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1),THREE.Texture=function(_,S,T,M,A,E,C,D,R){this.id=THREE.TextureIdCount++,this.name='',this.image=_,this.mipmaps=[],this.mapping=S===void 0?new THREE.UVMapping:S,this.wrapS=T===void 0?THREE.ClampToEdgeWrapping:T,this.wrapT=M===void 0?THREE.ClampToEdgeWrapping:M,this.magFilter=A===void 0?THREE.LinearFilter:A,this.minFilter=E===void 0?THREE.LinearMipMapLinearFilter:E,this.anisotropy=R===void 0?1:R,this.format=C===void 0?THREE.RGBAFormat:C,this.type=D===void 0?THREE.UnsignedByteType:D,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.needsUpdate=!1,this.onUpdate=null},THREE.Texture.prototype={constructor:THREE.Texture,clone:function(_){return void 0===_&&(_=new THREE.Texture),_.image=this.image,_.mipmaps=this.mipmaps.slice(0),_.mapping=this.mapping,_.wrapS=this.wrapS,_.wrapT=this.wrapT,_.magFilter=this.magFilter,_.minFilter=this.minFilter,_.anisotropy=this.anisotropy,_.format=this.format,_.type=this.type,_.offset.copy(this.offset),_.repeat.copy(this.repeat),_.generateMipmaps=this.generateMipmaps,_.premultiplyAlpha=this.premultiplyAlpha,_.flipY=this.flipY,_.unpackAlignment=this.unpackAlignment,_},dispose:function(){this.dispatchEvent({type:'dispose'})}},THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype),THREE.TextureIdCount=0,THREE.CompressedTexture=function(_,S,T,M,A,E,C,D,R,P,L){THREE.Texture.call(this,null,E,C,D,R,P,M,A,L),this.image={width:S,height:T},this.mipmaps=_,this.generateMipmaps=!1},THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CompressedTexture.prototype.clone=function(){var _=new THREE.CompressedTexture;return THREE.Texture.prototype.clone.call(this,_),_},THREE.DataTexture=function(_,S,T,M,A,E,C,D,R,P,L){THREE.Texture.call(this,null,E,C,D,R,P,M,A,L),this.image={data:_,width:S,height:T}},THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.clone=function(){var _=new THREE.DataTexture;return THREE.Texture.prototype.clone.call(this,_),_},THREE.Particle=function(_){THREE.Object3D.call(this),this.material=_},THREE.Particle.prototype=Object.create(THREE.Object3D.prototype),THREE.Particle.prototype.clone=function(_){return void 0===_&&(_=new THREE.Particle(this.material)),THREE.Object3D.prototype.clone.call(this,_),_},THREE.ParticleSystem=function(_,S){THREE.Object3D.call(this),this.geometry=_,this.material=S===void 0?new THREE.ParticleBasicMaterial({color:16777215*Math.random()}):S,this.sortParticles=!1,this.geometry&&null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere(),this.frustumCulled=!1},THREE.ParticleSystem.prototype=Object.create(THREE.Object3D.prototype),THREE.ParticleSystem.prototype.clone=function(_){return void 0===_&&(_=new THREE.ParticleSystem(this.geometry,this.material)),_.sortParticles=this.sortParticles,THREE.Object3D.prototype.clone.call(this,_),_},THREE.Line=function(_,S,T){THREE.Object3D.call(this),this.geometry=_,this.material=S===void 0?new THREE.LineBasicMaterial({color:16777215*Math.random()}):S,this.type=T===void 0?THREE.LineStrip:T,this.geometry&&!this.geometry.boundingSphere&&this.geometry.computeBoundingSphere()},THREE.LineStrip=0,THREE.LinePieces=1,THREE.Line.prototype=Object.create(THREE.Object3D.prototype),THREE.Line.prototype.clone=function(_){return void 0===_&&(_=new THREE.Line(this.geometry,this.material,this.type)),THREE.Object3D.prototype.clone.call(this,_),_},THREE.Mesh=function(_,S){THREE.Object3D.call(this),this.geometry=null,this.material=null,this.setGeometry(_),this.setMaterial(S)},THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype),THREE.Mesh.prototype.setGeometry=function(_){_!==void 0&&(this.geometry=_,null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere(),this.updateMorphTargets())},THREE.Mesh.prototype.setMaterial=function(_){this.material=void 0===_?new THREE.MeshBasicMaterial({color:16777215*Math.random(),wireframe:!0}):_},THREE.Mesh.prototype.updateMorphTargets=function(){if(0<this.geometry.morphTargets.length){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var _=0,S=this.geometry.morphTargets.length;_<S;_++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[_].name]=_}},THREE.Mesh.prototype.getMorphTargetIndexByName=function(_){return void 0===this.morphTargetDictionary[_]?0:this.morphTargetDictionary[_]},THREE.Mesh.prototype.clone=function(_){return void 0===_&&(_=new THREE.Mesh(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,_),_},THREE.Bone=function(_){THREE.Object3D.call(this),this.skin=_,this.skinMatrix=new THREE.Matrix4},THREE.Bone.prototype=Object.create(THREE.Object3D.prototype),THREE.Bone.prototype.update=function(_,S){this.matrixAutoUpdate&&(S|=this.updateMatrix()),(S||this.matrixWorldNeedsUpdate)&&(_?this.skinMatrix.multiplyMatrices(_,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,S=!0);var A=this.children.length,M;for(M=0;M<A;M++)this.children[M].update(this.skinMatrix,S)},THREE.SkinnedMesh=function(_,S,T){THREE.Mesh.call(this,_,S),this.useVertexTexture=!(T!==void 0)||T,this.identityMatrix=new THREE.Matrix4,this.bones=[],this.boneMatrices=[];var M,A,E,C,D,R;if(this.geometry&&this.geometry.bones!==void 0){for(M=0;M<this.geometry.bones.length;M++)E=this.geometry.bones[M],C=E.pos,D=E.rotq,R=E.scl,A=this.addBone(),A.name=E.name,A.position.set(C[0],C[1],C[2]),A.quaternion.set(D[0],D[1],D[2],D[3]),A.useQuaternion=!0,void 0==R?A.scale.set(1,1,1):A.scale.set(R[0],R[1],R[2]);for(M=0;M<this.bones.length;M++)E=this.geometry.bones[M],A=this.bones[M],-1===E.parent?this.add(A):this.bones[E.parent].add(A);var P=this.bones.length;if(this.useVertexTexture){var L;L=256<P?64:64<P?32:16<P?16:8,this.boneTextureWidth=L,this.boneTextureHeight=L,this.boneMatrices=new Float32Array(4*(this.boneTextureWidth*this.boneTextureHeight)),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1}else this.boneMatrices=new Float32Array(16*P);this.pose()}},THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.SkinnedMesh.prototype.addBone=function(_){return void 0===_&&(_=new THREE.Bone(this)),this.bones.push(_),_},THREE.SkinnedMesh.prototype.updateMatrixWorld=function(_){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_)&&(this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,_=!0);for(var S=0,T=this.children.length,M;S<T;S++)M=this.children[S],M instanceof THREE.Bone?M.update(this.identityMatrix,!1):M.updateMatrixWorld(!0);if(this.boneInverses==void 0){this.boneInverses=[];for(var A=0,E=this.bones.length,C;A<E;A++)C=new THREE.Matrix4,C.getInverse(this.bones[A].skinMatrix),this.boneInverses.push(C)}for(var A=0,E=this.bones.length;A<E;A++)THREE.SkinnedMesh.offsetMatrix.multiplyMatrices(this.bones[A].skinMatrix,this.boneInverses[A]),THREE.SkinnedMesh.offsetMatrix.flattenToArrayOffset(this.boneMatrices,16*A);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)},THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0);for(var _=0;_<this.geometry.skinIndices.length;_++){var S=this.geometry.skinWeights[_],T=1/S.lengthManhattan();T==Infinity?S.set(1):S.multiplyScalar(T)}},THREE.SkinnedMesh.prototype.clone=function(_){return void 0===_&&(_=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),THREE.Mesh.prototype.clone.call(this,_),_},THREE.SkinnedMesh.offsetMatrix=new THREE.Matrix4,THREE.MorphAnimMesh=function(_,S){THREE.Mesh.call(this,_,S),this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphAnimMesh.prototype.setFrameRange=function(_,S){this.startKeyframe=_,this.endKeyframe=S,this.length=this.endKeyframe-this.startKeyframe+1},THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},THREE.MorphAnimMesh.prototype.parseAnimations=function(){var _=this.geometry;_.animations||(_.animations={});for(var T=_.animations,M=/([a-z]+)(\d+)/,A=0,E=_.morphTargets.length,S;A<E;A++){var C=_.morphTargets[A],D=C.name.match(M);if(D&&1<D.length){var R=D[1],P=D[2];T[R]||(T[R]={start:Infinity,end:-Infinity});var L=T[R];A<L.start&&(L.start=A),A>L.end&&(L.end=A),S||(S=R)}}_.firstAnimation=S},THREE.MorphAnimMesh.prototype.setAnimationLabel=function(_,S,T){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[_]={start:S,end:T}},THREE.MorphAnimMesh.prototype.playAnimation=function(_,S){var T=this.geometry.animations[_];T&&(this.setFrameRange(T.start,T.end),this.duration=1e3*((T.end-T.start)/S),this.time=0)},THREE.MorphAnimMesh.prototype.updateAnimation=function(_){var S=this.duration/this.length;this.time+=this.direction*_,this.mirroredLoop?(this.time>this.duration||0>this.time)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),0>this.time&&(this.time=0,this.directionBackwards=!1)):(this.time%=this.duration,0>this.time&&(this.time+=this.duration));var T=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/S),0,this.length-1);T!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[T]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=T);var M=this.time%S/S;this.directionBackwards&&(M=1-M),this.morphTargetInfluences[this.currentKeyframe]=M,this.morphTargetInfluences[this.lastKeyframe]=1-M},THREE.MorphAnimMesh.prototype.clone=function(_){return void 0===_&&(_=new THREE.MorphAnimMesh(this.geometry,this.material)),_.duration=this.duration,_.mirroredLoop=this.mirroredLoop,_.time=this.time,_.lastKeyframe=this.lastKeyframe,_.currentKeyframe=this.currentKeyframe,_.direction=this.direction,_.directionBackwards=this.directionBackwards,THREE.Mesh.prototype.clone.call(this,_),_},THREE.Ribbon=function(_,S){THREE.Object3D.call(this),this.geometry=_,this.material=S},THREE.Ribbon.prototype=Object.create(THREE.Object3D.prototype),THREE.Ribbon.prototype.clone=function(_){return void 0===_&&(_=new THREE.Ribbon(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,_),_},THREE.LOD=function(){THREE.Object3D.call(this),this.objects=[]},THREE.LOD.prototype=Object.create(THREE.Object3D.prototype),THREE.LOD.prototype.addLevel=function(_,S){S===void 0&&(S=0),S=Math.abs(S);for(var T=0;T<this.objects.length&&!(S<this.objects[T].distance);T++);this.objects.splice(T,0,{distance:S,object:_}),this.add(_)},THREE.LOD.prototype.getObjectForDistance=function(_){for(var S=1,T=this.objects.length;S<T&&!(_<this.objects[S].distance);S++);return this.objects[S-1].object},THREE.LOD.prototype.update=function(){var _=new THREE.Vector3,S=new THREE.Vector3;return function(T){if(1<this.objects.length){_.getPositionFromMatrix(T.matrixWorld),S.getPositionFromMatrix(this.matrixWorld);var M=_.distanceTo(S);this.objects[0].object.visible=!0;for(var A=1,E=this.objects.length;A<E&&M>=this.objects[A].distance;A++)this.objects[A-1].object.visible=!1,this.objects[A].object.visible=!0;for(;A<E;A++)this.objects[A].object.visible=!1}}}(),THREE.LOD.prototype.clone=function(){},THREE.Sprite=function(_){THREE.Object3D.call(this),this.material=_===void 0?new THREE.SpriteMaterial:_,this.rotation3d=this.rotation,this.rotation=0},THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype),THREE.Sprite.prototype.updateMatrix=function(){this.rotation3d.set(0,0,this.rotation),this.quaternion.setFromEuler(this.rotation3d,this.eulerOrder),this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},THREE.Sprite.prototype.clone=function(_){return void 0===_&&(_=new THREE.Sprite(this.material)),THREE.Object3D.prototype.clone.call(this,_),_},THREE.Scene=function(){THREE.Object3D.call(this),this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]},THREE.Scene.prototype=Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.__addObject=function(_){if(_ instanceof THREE.Light)-1===this.__lights.indexOf(_)&&this.__lights.push(_),_.target&&void 0===_.target.parent&&this.add(_.target);else if(!(_ instanceof THREE.Camera||_ instanceof THREE.Bone)&&-1===this.__objects.indexOf(_)){this.__objects.push(_),this.__objectsAdded.push(_);var S=this.__objectsRemoved.indexOf(_);-1!==S&&this.__objectsRemoved.splice(S,1)}for(var T=0;T<_.children.length;T++)this.__addObject(_.children[T])},THREE.Scene.prototype.__removeObject=function(_){if(_ instanceof THREE.Light){var S=this.__lights.indexOf(_);-1!==S&&this.__lights.splice(S,1)}else if(!(_ instanceof THREE.Camera)){var S=this.__objects.indexOf(_);if(-1!==S){this.__objects.splice(S,1),this.__objectsRemoved.push(_);var T=this.__objectsAdded.indexOf(_);-1!==T&&this.__objectsAdded.splice(T,1)}}for(var M=0;M<_.children.length;M++)this.__removeObject(_.children[M])},THREE.Fog=function(_,S,T){this.name='',this.color=new THREE.Color(_),this.near=S===void 0?1:S,this.far=T===void 0?1e3:T},THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)},THREE.FogExp2=function(_,S){this.name='',this.color=new THREE.Color(_),this.density=S===void 0?2.5e-4:S},THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)},THREE.ShaderChunk={fog_pars_fragment:['#ifdef USE_FOG','uniform vec3 fogColor;','#ifdef FOG_EXP2','uniform float fogDensity;','#else','uniform float fogNear;','uniform float fogFar;','#endif','#endif'].join('\n'),fog_fragment:['#ifdef USE_FOG','float depth = gl_FragCoord.z / gl_FragCoord.w;','#ifdef FOG_EXP2','const float LOG2 = 1.442695;','float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );','fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );','#else','float fogFactor = smoothstep( fogNear, fogFar, depth );','#endif','gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );','#endif'].join('\n'),envmap_pars_fragment:['#ifdef USE_ENVMAP','uniform float reflectivity;','uniform samplerCube envMap;','uniform float flipEnvMap;','uniform int combine;','#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )','uniform bool useRefract;','uniform float refractionRatio;','#else','varying vec3 vReflect;','#endif','#endif'].join('\n'),envmap_fragment:['#ifdef USE_ENVMAP','vec3 reflectVec;','#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )','vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );','if ( useRefract ) {','reflectVec = refract( cameraToVertex, normal, refractionRatio );','} else { ','reflectVec = reflect( cameraToVertex, normal );','}','#else','reflectVec = vReflect;','#endif','#ifdef DOUBLE_SIDED','float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );','vec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );','#else','vec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );','#endif','#ifdef GAMMA_INPUT','cubeColor.xyz *= cubeColor.xyz;','#endif','if ( combine == 1 ) {','gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );','} else if ( combine == 2 ) {','gl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;','} else {','gl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );','}','#endif'].join('\n'),envmap_pars_vertex:['#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )','varying vec3 vReflect;','uniform float refractionRatio;','uniform bool useRefract;','#endif'].join('\n'),worldpos_vertex:['#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )','#ifdef USE_SKINNING','vec4 worldPosition = modelMatrix * skinned;','#endif','#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )','vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );','#endif','#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )','#if defined( VERTEX_TEXTURES ) && ( defined( USE_DISPLACEMENTMAP ) || defined( USE_WAVE_TEXTURE ) )','vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );','#else','vec4 worldPosition = modelMatrix * vec4( position, 1.0 );','#endif','#endif','#ifdef USE_MIRROR_TEXTURE','mirrorCoord = mirrorTextureMatrix * worldPosition;','#endif','#else','#ifdef USE_UNI_TEXTURE','vec4 worldPosition = modelMatrix * vec4( position, 1.0 );','#endif','#endif','#ifdef USE_UNI_TEXTURE','vec3 uniTexture_pos;','#if defined( USE_MORPHTARGETS )','uniTexture_pos = morphed;','#endif','#if ! defined( USE_MORPHTARGETS )','uniTexture_pos = position;','#endif','uniTexture_pos = uniTexture_pos - vec3(uniTexture_bs, -uniTexture_bs, uniTexture_bs) * 10.;','uniTexture_MatrixRain_opacity = (uniTexture_MatrixRain_height_limit.x > 0.0) ? clamp((1.0 - (uniTexture_MatrixRain_height_limit.y + uniTexture_bs - position.y) / (uniTexture_bs * 2.0) - uniTexture_MatrixRain_height_limit.x) / (uniTexture_MatrixRain_height_limit.x*0.25), 0.0, 1.0) : 1.0;','uniTexture_vUv = vec2(-length(uniTexture_pos.xz), length(uniTexture_pos.yz)) * 0.1 / uniTexture_scale;','#if !(MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined(USE_XRAY_PASS))','  vWorldPosition = worldPosition.xyz;','#endif','#endif'].join('\n'),uniTexture_pars_vertex:['#ifdef USE_UNI_TEXTURE','  uniform float uniTexture_bs;','  uniform float uniTexture_scale;','  uniform vec2 uniTexture_MatrixRain_height_limit;','  varying vec2 uniTexture_vUv;','  varying float uniTexture_MatrixRain_opacity;','  #if !(MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined(USE_XRAY_PASS))','    varying vec3 vWorldPosition;','  #endif','#endif'].join('\n'),uniTexture_pars_fragment:['#ifdef USE_UNI_TEXTURE','  uniform int uniTexture_state;','  uniform sampler2D uniTexture_map;','  uniform vec4 uniTexture_null_zone;','  varying vec2 uniTexture_vUv;','  varying float uniTexture_MatrixRain_opacity;','  #if !(MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined(USE_XRAY_PASS))','    varying vec3 vWorldPosition;','  #endif','#endif'].join('\n'),uniTexture_fragment:['#ifdef USE_UNI_TEXTURE','if (uniTexture_state == 1) {','  vec4 uni_texture = texture2D( uniTexture_map, uniTexture_vUv );','  #ifdef USE_MATRIX_RAIN_GREEN','    vec3 _color_org = gl_FragColor.rgb;','    float _gray = 0.3 * gl_FragColor.r + 0.59 * gl_FragColor.g + 0.11 * gl_FragColor.b;','    gl_FragColor.rgb = vec3(_gray) * uni_texture.rgb;','    if (uniTexture_MatrixRain_opacity < 1.0) { gl_FragColor.rgb = mix(vec3(0.0, _gray, 0.0), gl_FragColor.rgb, uniTexture_MatrixRain_opacity); }','    if (uniTexture_null_zone.w > 0.0) { gl_FragColor.rgb = mix(_color_org, gl_FragColor.rgb, clamp((distance(vWorldPosition, uniTexture_null_zone.xyz) / (uniTexture_null_zone.w * 1.5) - 0.6667) * 3.0, 0.0, 1.0) ); }','  #endif','  #ifdef USE_MATRIX_RAIN_COLOR','    float _rain_a = uniTexture_MatrixRain_opacity * ((uniTexture_null_zone.w > 0.0) ? clamp((distance(vWorldPosition, uniTexture_null_zone.xyz) / (uniTexture_null_zone.w * 1.25) - 0.75) * 4.0, 0.0, 1.0) : 1.0);','    gl_FragColor.rgb *= 1.0-_rain_a + _rain_a*uni_texture.g;','  #endif','} else if (uniTexture_state == 2) {','  gl_FragColor.rgb *= texture2D( uniTexture_map, uniTexture_vUv ).rgb;','}','#endif'].join('\n'),envmap_vertex:['#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )','vec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;','worldNormal = normalize( worldNormal );','vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );','if ( useRefract ) {','vReflect = refract( cameraToVertex, worldNormal, refractionRatio );','} else {','vReflect = reflect( cameraToVertex, worldNormal );','}','#endif'].join('\n'),map_particle_pars_fragment:['#ifdef USE_MAP','uniform sampler2D map;','#endif'].join('\n'),map_particle_fragment:['#ifdef USE_MAP','gl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );','#endif'].join('\n'),map_pars_vertex:['#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_DISPLACEMENTMAP ) || defined( USE_WAVE_TEXTURE )','varying vec2 vUv;','uniform vec4 offsetRepeat;','#endif'].join('\n'),map_pars_fragment:['#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )','varying vec2 vUv;','#endif','#ifdef USE_MAP','uniform sampler2D map;','#endif'].join('\n'),map_vertex:['#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_DISPLACEMENTMAP ) || defined( USE_WAVE_TEXTURE )','vUv = uv * offsetRepeat.zw + offsetRepeat.xy;','#endif'].join('\n'),map_fragment:['#ifdef USE_MAP','#if defined( VERTEX_TEXTURES ) && defined( USE_WAVE_TEXTURE )','  vec2 uvTimeShift = vUv + vec2( -0.7, 1.5 ) * time * waveBaseSpeed;','  vec4 noiseGeneratorTimeShift = texture2D( waveNoiseTexture, mod(uvTimeShift,1.0) );','  vec2 uvNoiseTimeShift = vUv + waveNoiseScale * vec2( noiseGeneratorTimeShift.r, noiseGeneratorTimeShift.b );','  vec4 texelColor = texture2D( map, mod(uvNoiseTimeShift,1.0) );','#else','vec4 texelColor = texture2D( map, vUv );','#endif','#ifdef GAMMA_INPUT','texelColor.xyz *= texelColor.xyz;','#endif','gl_FragColor = gl_FragColor * texelColor;','#endif'].join('\n'),lightmap_pars_fragment:['#ifdef USE_LIGHTMAP','varying vec2 vUv2;','uniform sampler2D lightMap;','#endif'].join('\n'),lightmap_pars_vertex:['#ifdef USE_LIGHTMAP','varying vec2 vUv2;','#endif'].join('\n'),lightmap_fragment:['#ifdef USE_LIGHTMAP','gl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );','#endif'].join('\n'),lightmap_vertex:['#ifdef USE_LIGHTMAP','vUv2 = uv2;','#endif'].join('\n'),bumpmap_pars_fragment:['#ifdef USE_BUMPMAP','uniform sampler2D bumpMap;','uniform float bumpScale;','vec2 dHdxy_fwd() {','vec2 dSTdx = dFdx( vUv );','vec2 dSTdy = dFdy( vUv );','float Hll = bumpScale * texture2D( bumpMap, vUv ).x;','float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;','float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;','return vec2( dBx, dBy );','}','vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {','vec3 vSigmaX = dFdx( surf_pos );','vec3 vSigmaY = dFdy( surf_pos );','vec3 vN = surf_norm;','vec3 R1 = cross( vSigmaY, vN );','vec3 R2 = cross( vN, vSigmaX );','float fDet = dot( vSigmaX, R1 );','vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );','return normalize( abs( fDet ) * surf_norm - vGrad );','}','#endif'].join('\n'),normalmap_pars_fragment:['#ifdef USE_NORMALMAP','uniform sampler2D normalMap;','uniform vec2 normalScale;','vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {','vec3 q0 = dFdx( eye_pos.xyz );','vec3 q1 = dFdy( eye_pos.xyz );','vec2 st0 = dFdx( vUv.st );','vec2 st1 = dFdy( vUv.st );','vec3 S = normalize(  q0 * st1.t - q1 * st0.t );','vec3 T = normalize( -q0 * st1.s + q1 * st0.s );','vec3 N = normalize( surf_norm );','vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;','mapN.xy = normalScale * mapN.xy;','mat3 tsn = mat3( S, T, N );','return normalize( tsn * mapN );','}','#endif'].join('\n'),specularmap_pars_fragment:['#ifdef USE_SPECULARMAP','uniform sampler2D specularMap;','#endif'].join('\n'),specularmap_fragment:['float specularStrength;','#ifdef USE_SPECULARMAP','vec4 texelSpecular = texture2D( specularMap, vUv );','specularStrength = texelSpecular.r;','#else','specularStrength = 1.0;','#endif'].join('\n'),lights_lambert_pars_vertex:['uniform vec3 ambient;','uniform vec3 diffuse;','uniform vec3 emissive;','uniform vec3 ambientLightColor;','#if MAX_DIR_LIGHTS > 0','uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];','uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];','#endif','#if MAX_HEMI_LIGHTS > 0','uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];','uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];','uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];','#endif','#if MAX_POINT_LIGHTS > 0','uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];','uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];','uniform float pointLightDistance[ MAX_POINT_LIGHTS ];','#endif','#if MAX_SPOT_LIGHTS > 0','uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];','uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];','uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];','uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];','uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];','uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];','#endif','#ifdef WRAP_AROUND','uniform vec3 wrapRGB;','#endif'].join('\n'),lights_lambert_vertex:['vLightFront = vec3( 0.0 );','#ifdef DOUBLE_SIDED','vLightBack = vec3( 0.0 );','#endif','transformedNormal = normalize( transformedNormal );','#if MAX_DIR_LIGHTS > 0','for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {','vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );','vec3 dirVector = normalize( lDirection.xyz );','float dotProduct = dot( transformedNormal, dirVector );','vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );','#ifdef DOUBLE_SIDED','vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );','#ifdef WRAP_AROUND','vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );','#endif','#endif','#ifdef WRAP_AROUND','vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );','directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );','#ifdef DOUBLE_SIDED','directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );','#endif','#endif','vLightFront += directionalLightColor[ i ] * directionalLightWeighting;','#ifdef DOUBLE_SIDED','vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;','#endif','}','#endif','#if MAX_POINT_LIGHTS > 0','for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {','vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );','vec3 lVector = lPosition.xyz - mvPosition.xyz;','float lDistance = 1.0;','if ( pointLightDistance[ i ] > 0.0 )','lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );','lVector = normalize( lVector );','float dotProduct = dot( transformedNormal, lVector );','vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );','#ifdef DOUBLE_SIDED','vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );','#ifdef WRAP_AROUND','vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );','#endif','#endif','#ifdef WRAP_AROUND','vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );','pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );','#ifdef DOUBLE_SIDED','pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );','#endif','#endif','vLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;','#ifdef DOUBLE_SIDED','vLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;','#endif','}','#endif','#if MAX_SPOT_LIGHTS > 0','for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {','vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );','vec3 lVector = lPosition.xyz - mvPosition.xyz;','float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );','if ( spotEffect > spotLightAngleCos[ i ] ) {','spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );','float lDistance = 1.0;','if ( spotLightDistance[ i ] > 0.0 )','lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );','lVector = normalize( lVector );','float dotProduct = dot( transformedNormal, lVector );','vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );','#ifdef DOUBLE_SIDED','vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );','#ifdef WRAP_AROUND','vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );','#endif','#endif','#ifdef WRAP_AROUND','vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );','spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );','#ifdef DOUBLE_SIDED','spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );','#endif','#endif','vLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;','#ifdef DOUBLE_SIDED','vLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;','#endif','}','}','#endif','#if MAX_HEMI_LIGHTS > 0','for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {','vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );','vec3 lVector = normalize( lDirection.xyz );','float dotProduct = dot( transformedNormal, lVector );','float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;','float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;','vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );','#ifdef DOUBLE_SIDED','vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );','#endif','}','#endif','vLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;','#ifdef DOUBLE_SIDED','vLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;','#endif'].join('\n'),lights_phong_pars_vertex:['#ifndef PHONG_PER_PIXEL','#if MAX_POINT_LIGHTS > 0','uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];','uniform float pointLightDistance[ MAX_POINT_LIGHTS ];','varying vec4 vPointLight[ MAX_POINT_LIGHTS ];','#endif','#if MAX_SPOT_LIGHTS > 0','uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];','uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];','varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];','#endif','#endif','#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )','varying vec3 vWorldPosition;','#endif'].join('\n'),lights_phong_vertex:['#ifndef PHONG_PER_PIXEL','#if MAX_POINT_LIGHTS > 0','for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {','vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );','vec3 lVector = lPosition.xyz - mvPosition.xyz;','float lDistance = 1.0;','if ( pointLightDistance[ i ] > 0.0 )','lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );','vPointLight[ i ] = vec4( lVector, lDistance );','}','#endif','#if MAX_SPOT_LIGHTS > 0','for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {','vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );','vec3 lVector = lPosition.xyz - mvPosition.xyz;','float lDistance = 1.0;','if ( spotLightDistance[ i ] > 0.0 )','lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );','vSpotLight[ i ] = vec4( lVector, lDistance );','}','#endif','#endif','#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )','vWorldPosition = worldPosition.xyz;','#endif'].join('\n'),lights_phong_pars_fragment:['uniform vec3 ambientLightColor;','#if MAX_DIR_LIGHTS > 0','uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];','uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];','#endif','#if MAX_HEMI_LIGHTS > 0','uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];','uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];','uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];','#endif','#if MAX_POINT_LIGHTS > 0','uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];','#ifdef PHONG_PER_PIXEL','uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];','uniform float pointLightDistance[ MAX_POINT_LIGHTS ];','#else','varying vec4 vPointLight[ MAX_POINT_LIGHTS ];','#endif','#endif','#if MAX_SPOT_LIGHTS > 0','uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];','uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];','uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];','uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];','uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];','#ifdef PHONG_PER_PIXEL','uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];','#else','varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];','#endif','#endif','#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )','varying vec3 vWorldPosition;','#endif','#ifdef WRAP_AROUND','uniform vec3 wrapRGB;','#endif','varying vec3 vViewPosition;','varying vec3 vNormal;'].join('\n'),lights_phong_fragment:['#ifdef COMPUTE_NORMAL_FROM_DISPLACEMENT','  vec3 normal = normalize( cross( dFdx( vViewPosition ), dFdy( vViewPosition ) ) );','#else','vec3 normal = normalize( vNormal );','#endif','vec3 viewPosition = normalize( vViewPosition );','#ifdef DOUBLE_SIDED','normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );','#endif','#ifdef USE_NORMALMAP','normal = perturbNormal2Arb( -vViewPosition, normal );','#elif defined( USE_BUMPMAP )','normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );','#endif','#if MAX_POINT_LIGHTS > 0','vec3 pointDiffuse  = vec3( 0.0 );','vec3 pointSpecular = vec3( 0.0 );','for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {','#ifdef PHONG_PER_PIXEL','vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );','vec3 lVector = lPosition.xyz + vViewPosition.xyz;','float lDistance = 1.0;','if ( pointLightDistance[ i ] > 0.0 )','lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );','lVector = normalize( lVector );','#else','vec3 lVector = normalize( vPointLight[ i ].xyz );','float lDistance = vPointLight[ i ].w;','#endif','float dotProduct = dot( normal, lVector );','#ifdef WRAP_AROUND','float pointDiffuseWeightFull = max( dotProduct, 0.0 );','float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );','vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );','#else','float pointDiffuseWeight = max( dotProduct, 0.0 );','#endif','pointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;','vec3 pointHalfVector = normalize( lVector + viewPosition );','float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );','float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );','#ifdef PHYSICALLY_BASED_SHADING','float specularNormalization = ( shininess + 2.0001 ) / 8.0;','vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );','pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;','#else','pointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;','#endif','}','#endif','#if MAX_SPOT_LIGHTS > 0','vec3 spotDiffuse  = vec3( 0.0 );','vec3 spotSpecular = vec3( 0.0 );','for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {','#ifdef PHONG_PER_PIXEL','vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );','vec3 lVector = lPosition.xyz + vViewPosition.xyz;','float lDistance = 1.0;','if ( spotLightDistance[ i ] > 0.0 )','lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );','lVector = normalize( lVector );','#else','vec3 lVector = normalize( vSpotLight[ i ].xyz );','float lDistance = vSpotLight[ i ].w;','#endif','float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );','if ( spotEffect > spotLightAngleCos[ i ] ) {','spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );','float dotProduct = dot( normal, lVector );','#ifdef WRAP_AROUND','float spotDiffuseWeightFull = max( dotProduct, 0.0 );','float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );','vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );','#else','float spotDiffuseWeight = max( dotProduct, 0.0 );','#endif','spotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;','vec3 spotHalfVector = normalize( lVector + viewPosition );','float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );','float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );','#ifdef PHYSICALLY_BASED_SHADING','float specularNormalization = ( shininess + 2.0001 ) / 8.0;','vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );','spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;','#else','spotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;','#endif','}','}','#endif','#if MAX_DIR_LIGHTS > 0','vec3 dirDiffuse  = vec3( 0.0 );','vec3 dirSpecular = vec3( 0.0 );','for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {','vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );','vec3 dirVector = normalize( lDirection.xyz );','float dotProduct = dot( normal, dirVector );','#ifdef WRAP_AROUND','float dirDiffuseWeightFull = max( dotProduct, 0.0 );','float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );','vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );','#else','float dirDiffuseWeight = max( dotProduct, 0.0 );','#endif','dirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;','vec3 dirHalfVector = normalize( dirVector + viewPosition );','float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );','float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );','#ifdef PHYSICALLY_BASED_SHADING','float specularNormalization = ( shininess + 2.0001 ) / 8.0;','vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );','dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;','#else','dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;','#endif','}','#endif','#if MAX_HEMI_LIGHTS > 0','vec3 hemiDiffuse  = vec3( 0.0 );','vec3 hemiSpecular = vec3( 0.0 );','for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {','vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );','vec3 lVector = normalize( lDirection.xyz );','float dotProduct = dot( normal, lVector );','float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;','vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );','hemiDiffuse += diffuse * hemiColor;','vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );','float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;','float hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );','vec3 lVectorGround = -lVector;','vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );','float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;','float hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );','#ifdef PHYSICALLY_BASED_SHADING','float dotProductGround = dot( normal, lVectorGround );','float specularNormalization = ( shininess + 2.0001 ) / 8.0;','vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );','vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );','hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );','#else','hemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;','#endif','}','#endif','vec3 totalDiffuse = vec3( 0.0 );','vec3 totalSpecular = vec3( 0.0 );','#if MAX_DIR_LIGHTS > 0','totalDiffuse += dirDiffuse;','totalSpecular += dirSpecular;','#endif','#if MAX_HEMI_LIGHTS > 0','totalDiffuse += hemiDiffuse;','totalSpecular += hemiSpecular;','#endif','#if MAX_POINT_LIGHTS > 0','totalDiffuse += pointDiffuse;','totalSpecular += pointSpecular;','#endif','#if MAX_SPOT_LIGHTS > 0','totalDiffuse += spotDiffuse;','totalSpecular += spotSpecular;','#endif','#ifdef METAL','#ifdef USE_SPECULARMAP','float metalness = texelSpecular.g;','gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular*(1.0-metalness) ) + totalSpecular*metalness;','#else','gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );','#endif','#else','gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;','#endif'].join('\n'),color_pars_fragment:['#ifdef USE_COLOR','varying vec3 vColor;','#endif'].join('\n'),color_fragment:['#ifdef USE_COLOR','gl_FragColor = gl_FragColor * vec4( vColor, opacity );','#endif'].join('\n'),color_pars_vertex:['#ifdef USE_COLOR','varying vec3 vColor;','#endif'].join('\n'),color_vertex:['#ifdef USE_COLOR','#ifdef GAMMA_INPUT','vColor = color * color;','#else','vColor = color;','#endif','#endif'].join('\n'),skinning_pars_vertex:['#ifdef USE_SKINNING','#ifdef BONE_TEXTURE','uniform sampler2D boneTexture;','mat4 getBoneMatrix( const in float i ) {','float j = i * 4.0;','float x = mod( j, N_BONE_PIXEL_X );','float y = floor( j / N_BONE_PIXEL_X );','const float dx = 1.0 / N_BONE_PIXEL_X;','const float dy = 1.0 / N_BONE_PIXEL_Y;','y = dy * ( y + 0.5 );','vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );','vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );','vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );','vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );','mat4 bone = mat4( v1, v2, v3, v4 );','return bone;','}','#else','uniform mat4 boneGlobalMatrices[ MAX_BONES ];','mat4 getBoneMatrix( const in float i ) {','mat4 bone = boneGlobalMatrices[ int(i) ];','return bone;','}','#endif','#endif'].join('\n'),skinbase_vertex:['#ifdef USE_SKINNING','mat4 boneMatX = getBoneMatrix( skinIndex.x );','mat4 boneMatY = getBoneMatrix( skinIndex.y );','#endif'].join('\n'),skinning_vertex:['#ifdef USE_SKINNING','#ifdef USE_MORPHTARGETS','vec4 skinVertex = vec4( morphed, 1.0 );','#else','vec4 skinVertex = vec4( position, 1.0 );','#endif','vec4 skinned  = boneMatX * skinVertex * skinWeight.x;','skinned \t  += boneMatY * skinVertex * skinWeight.y;','#endif'].join('\n'),morphtarget_pars_vertex:['#ifdef USE_MORPHTARGETS','#ifndef USE_MORPHNORMALS','uniform float morphTargetInfluences[ 8 ];','#else','uniform float morphTargetInfluences[ 4 ];','#endif','#endif'].join('\n'),morphtarget_vertex:['#ifdef USE_MORPHTARGETS','vec3 morphed = vec3( 0.0 );','morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];','morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];','morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];','morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];','#ifndef USE_MORPHNORMALS','morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];','morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];','morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];','morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];','#endif','morphed += position;','#endif'].join('\n'),default_vertex:['vec4 mvPosition;','#ifdef USE_SKINNING','mvPosition = modelViewMatrix * skinned;','#endif','#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )','mvPosition = modelViewMatrix * vec4( morphed, 1.0 );','#endif','#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )','#if defined( VERTEX_TEXTURES ) && ( defined( USE_DISPLACEMENTMAP ) || defined( USE_WAVE_TEXTURE ) )','mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );','#else','mvPosition = modelViewMatrix * vec4( position, 1.0 );','#endif','#endif','gl_Position = projectionMatrix * mvPosition;'].join('\n'),morphnormal_vertex:['#ifdef USE_MORPHNORMALS','vec3 morphedNormal = vec3( 0.0 );','morphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];','morphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];','morphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];','morphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];','morphedNormal += normal;','#endif'].join('\n'),skinnormal_vertex:['#ifdef USE_SKINNING','mat4 skinMatrix = skinWeight.x * boneMatX;','skinMatrix \t+= skinWeight.y * boneMatY;','#ifdef USE_MORPHNORMALS','vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );','#else','vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );','#endif','#endif'].join('\n'),defaultnormal_vertex:['vec3 objectNormal;','#ifdef USE_SKINNING','objectNormal = skinnedNormal.xyz;','#endif','#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )','objectNormal = morphedNormal;','#endif','#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )','objectNormal = normal;','#endif','#ifdef FLIP_SIDED','objectNormal = -objectNormal;','#endif','#ifdef USE_SHADOWMAP','  normal_untransformed = normalize(mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal);','#endif','vec3 transformedNormal = normalMatrix * objectNormal;'].join('\n'),shadowmap_pars_fragment:['#ifdef USE_SHADOWMAP','uniform sampler2D shadowMap[ MAX_SHADOWS ];','uniform vec2 shadowMapSize[ MAX_SHADOWS ];','uniform float shadowDarkness[ MAX_SHADOWS ];','uniform vec3 shadowBias[ MAX_SHADOWS ];','uniform vec3 shadowPara[ MAX_SHADOWS ];','varying vec3 normal_untransformed;','varying vec4 vShadowCoord[ MAX_SHADOWS ];','float unpackDepth( const in vec4 rgba_depth ) {','const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );','float depth = dot( rgba_depth, bit_shift );','return depth;','}','#endif'].join('\n'),shadowmap_fragment:['#ifdef USE_SHADOWMAP','#ifdef SHADOWMAP_DEBUG','vec3 frustumColors[3];','frustumColors[0] = vec3( 1.0, 0.5, 0.0 );','frustumColors[1] = vec3( 0.0, 1.0, 0.8 );','frustumColors[2] = vec3( 0.0, 0.5, 1.0 );','#endif','#ifdef SHADOWMAP_CASCADE','int inFrustumCount = 0;','float parent_light_id = 0.0;','#endif','float fDepth;','vec3 shadowColor = vec3( 1.0 );','vec3 SP;','#pragma unroll_loop\n','for( int i = 0; i < MAX_SHADOWS; i ++ ) {//LOOP_START','SP = shadowPara[i];','#ifdef SHADOWMAP_CASCADE','if (parent_light_id != SP.y) {','parent_light_id = SP.y;','inFrustumCount = 0;','}','#endif','vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;','bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );','bool inFrustum = all( inFrustumVec );','#ifdef SHADOWMAP_CASCADE','inFrustumCount += int( inFrustum );','bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );','#else','bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );','#endif','bool frustumTest = all( frustumTestVec );','if ( frustumTest ) {','#ifdef PHONG','shadowCoord.z += shadowBias[ i ].x * clamp(pow(abs(tan(acos(clamp(dot(directionalLightDirection[ int(SP.y) ], normal_untransformed), -1., 1.)))), 2.0), shadowBias[ i ].y, shadowBias[ i ].z);','float shadowDarkness_scale = (1.0-emissive.r) * opacity;','#else','shadowCoord.z += shadowBias[ i ].x;','float shadowDarkness_scale = 1.0;','#endif','#if defined( SHADOWMAP_TYPE_PCF )','float shadow = 0.0;','const float shadowDelta = 1.0 / 9.0;','float xPixelOffset = 1.0 / shadowMapSize[ i ].x;','float yPixelOffset = 1.0 / shadowMapSize[ i ].y;','float dx0 = -1.25 * xPixelOffset;','float dy0 = -1.25 * yPixelOffset;','float dx1 = 1.25 * xPixelOffset;','float dy1 = 1.25 * yPixelOffset;','fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );','if ( fDepth < shadowCoord.z ) shadow += shadowDelta;','fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );','if ( fDepth < shadowCoord.z ) shadow += shadowDelta;','fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );','if ( fDepth < shadowCoord.z ) shadow += shadowDelta;','fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );','if ( fDepth < shadowCoord.z ) shadow += shadowDelta;','fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );','if ( fDepth < shadowCoord.z ) shadow += shadowDelta;','fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );','if ( fDepth < shadowCoord.z ) shadow += shadowDelta;','fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );','if ( fDepth < shadowCoord.z ) shadow += shadowDelta;','fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );','if ( fDepth < shadowCoord.z ) shadow += shadowDelta;','fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );','if ( fDepth < shadowCoord.z ) shadow += shadowDelta;','shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] *shadowDarkness_scale * shadow ) );','#elif defined( SHADOWMAP_TYPE_PCF_SOFT )','float shadow = 0.0;','float xPixelOffset = 1.0 / shadowMapSize[ i ].x;','float yPixelOffset = 1.0 / shadowMapSize[ i ].y;','float dx0 = -1.0 * xPixelOffset;','float dy0 = -1.0 * yPixelOffset;','float dx1 = 1.0 * xPixelOffset;','float dy1 = 1.0 * yPixelOffset;','mat3 shadowKernel;','mat3 depthKernel;','depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );','depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );','depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );','depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );','depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );','depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );','depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );','depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );','depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );','vec3 shadowZ = vec3( shadowCoord.z );','shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));','shadowKernel[0] *= vec3(0.25);','shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));','shadowKernel[1] *= vec3(0.25);','shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));','shadowKernel[2] *= vec3(0.25);','vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );','shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );','shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );','vec4 shadowValues;','shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );','shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );','shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );','shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );','shadow = dot( shadowValues, vec4( 1.0 ) );','shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ]*shadowDarkness_scale * shadow ) );','#ifndef SHADOWMAP_CASCADE','float shadow_opacity = 1. - min(pow(length((shadowCoord.xy-0.5)*2.),4.), 1.);','shadowColor = mix(vec3(1.), shadowColor, shadow_opacity);','#endif','#else','vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );','float fDepth = unpackDepth( rgbaDepth );','if ( fDepth < shadowCoord.z )','shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ]*shadowDarkness_scale );','#endif','}//LOOP_END','#ifdef SHADOWMAP_DEBUG','#ifdef SHADOWMAP_CASCADE','if ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];','#else','if ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];','#endif','#endif','}','#ifdef GAMMA_OUTPUT','shadowColor *= shadowColor;','#endif','#ifdef SHADOWMAP_ALPHA','gl_FragColor.a *= 1.0 - shadowColor.r;','#else','gl_FragColor.xyz = gl_FragColor.xyz * shadowColor;','#endif','#endif'].join('\n'),shadowmap_pars_vertex:['#ifdef USE_SHADOWMAP','varying vec3 normal_untransformed;','varying vec4 vShadowCoord[ MAX_SHADOWS ];','uniform mat4 shadowMatrix[ MAX_SHADOWS ];','#endif'].join('\n'),shadowmap_vertex:['#ifdef USE_SHADOWMAP','for( int i = 0; i < MAX_SHADOWS; i ++ ) {','vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;','}','#endif'].join('\n'),alphatest_fragment:['#ifdef ALPHATEST','if ( gl_FragColor.a < ALPHATEST ) discard;','#endif'].join('\n'),linear_to_gamma_fragment:['#ifdef GAMMA_OUTPUT','gl_FragColor.xyz = sqrt( gl_FragColor.xyz );','#endif'].join('\n')},THREE.UniformsUtils={merge:function(_){var A={},S,T,M;for(S=0;S<_.length;S++)for(T in M=this.clone(_[S]),M)A[T]=M[T];return A},clone:function(_){var E={},S,T,A;for(S in _)for(T in E[S]={},_[S])A=_[S][T],E[S][T]=A instanceof THREE.Color||A instanceof THREE.Vector2||A instanceof THREE.Vector3||A instanceof THREE.Vector4||A instanceof THREE.Matrix4||A instanceof THREE.Texture?A.clone():A instanceof Array?A.slice():A;return E}},THREE.ShaderChunk.common='#define PI 3.14159265359\n#define PI2 6.28318530718\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\n\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\n// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.\n// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\n\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\n\n\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n}\n\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n\n}\n\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\n\treturn - distance * planeNormal + point;\n\n}\n\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n\n}\n\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n\n}\n',THREE.ShaderChunk.packing='vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\n\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\n\n\nvec4 packDepthToRGBA( const in float value ) {\n\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( value * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\nfloat unpackRGBAToDepth( const in vec4 rgba ) {\n\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\treturn dot( rgba, bitSh );\n}\n\n// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions\n\nfloat viewZToOrthoDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat OrthoDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\n\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n',THREE.ShaderChunk.AT_depth_render_mode_pars_fragment='uniform int depth_render_mode;\n'+THREE.ShaderChunk.packing,THREE.ShaderChunk.AT_depth_render_mode_fragment='if (depth_render_mode > 0) {\n#ifdef MMD\n#ifdef USE_MAP\nif (mmdEdgeThick <= 0.25) {\n  if (texture2D( map, vUv ).a == 0.0) { discard; }\n}\n#endif\n#endif\n#ifndef SKIP_SAO_DEPTH\n gl_FragColor = packDepthToRGBA( ((depth_render_mode == 1) ? gl_FragCoord.z : gl_FragCoord.w) ); return;\n#else\n gl_FragColor = packDepthToRGBA(gl_FragCoord.w); return;\n#endif\n}\n',THREE.UniformsLib={common:{depth_render_mode:{type:'i',value:0},diffuse:{type:'c',value:new THREE.Color(15658734)},opacity:{type:'f',value:1},map:{type:'t',value:null},offsetRepeat:{type:'v4',value:new THREE.Vector4(0,0,1,1)},lightMap:{type:'t',value:null},specularMap:{type:'t',value:null},envMap:{type:'t',value:null},flipEnvMap:{type:'f',value:-1},useRefract:{type:'i',value:0},reflectivity:{type:'f',value:1},refractionRatio:{type:'f',value:0.98},combine:{type:'i',value:0},morphTargetInfluences:{type:'f',value:0}},bump:{bumpMap:{type:'t',value:null},bumpScale:{type:'f',value:1}},normalmap:{normalMap:{type:'t',value:null},normalScale:{type:'v2',value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:'f',value:2.5e-4},fogNear:{type:'f',value:1},fogFar:{type:'f',value:2e3},fogColor:{type:'c',value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:'fv',value:[]},directionalLightDirection:{type:'fv',value:[]},directionalLightColor:{type:'fv',value:[]},hemisphereLightDirection:{type:'fv',value:[]},hemisphereLightSkyColor:{type:'fv',value:[]},hemisphereLightGroundColor:{type:'fv',value:[]},pointLightColor:{type:'fv',value:[]},pointLightPosition:{type:'fv',value:[]},pointLightDistance:{type:'fv1',value:[]},spotLightColor:{type:'fv',value:[]},spotLightPosition:{type:'fv',value:[]},spotLightDirection:{type:'fv',value:[]},spotLightDistance:{type:'fv1',value:[]},spotLightAngleCos:{type:'fv1',value:[]},spotLightExponent:{type:'fv1',value:[]}},particle:{psColor:{type:'c',value:new THREE.Color(15658734)},opacity:{type:'f',value:1},size:{type:'f',value:1},scale:{type:'f',value:1},map:{type:'t',value:null},fogDensity:{type:'f',value:2.5e-4},fogNear:{type:'f',value:1},fogFar:{type:'f',value:2e3},fogColor:{type:'c',value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:'tv',value:[]},shadowMapSize:{type:'v2v',value:[]},shadowBias:{type:'v3v',value:[]},shadowPara:{type:'v3v',value:[]},shadowDarkness:{type:'fv1',value:[]},shadowMatrix:{type:'m4v',value:[]}},uniTexture:{uniTexture_state:{type:'i',value:0},uniTexture_map:{type:'t',value:null},uniTexture_bs:{type:'f',value:20},uniTexture_scale:{type:'f',value:1},uniTexture_null_zone:{type:'v4',value:new THREE.Vector4(0,0,0,0)},uniTexture_MatrixRain_height_limit:{type:'v2',value:new THREE.Vector2(0,0)}}},THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap,THREE.UniformsLib.uniTexture]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.uniTexture_pars_vertex,'void main() {',THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,'#ifdef USE_ENVMAP',THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,'#else','  #ifdef USE_SHADOWMAP','    normal_untransformed = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * normal;','  #endif','#endif',THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,'}'].join('\n'),fragmentShader:['uniform vec3 diffuse;','uniform float opacity;',THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.uniTexture_pars_fragment,THREE.ShaderChunk.AT_depth_render_mode_pars_fragment,'void main() {',THREE.ShaderChunk.AT_depth_render_mode_fragment,'gl_FragColor = vec4( diffuse, opacity );',THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.uniTexture_fragment,THREE.ShaderChunk.fog_fragment,'}'].join('\n')},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,THREE.UniformsLib.uniTexture,{ambient:{type:'c',value:new THREE.Color(16777215)},emissive:{type:'c',value:new THREE.Color(0)},wrapRGB:{type:'v3',value:new THREE.Vector3(1,1,1)}}]),vertexShader:['#define LAMBERT','varying vec3 vLightFront;','#ifdef DOUBLE_SIDED','varying vec3 vLightBack;','#endif',THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.uniTexture_pars_vertex,'void main() {',THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,'}'].join('\n'),fragmentShader:['uniform float opacity;','varying vec3 vLightFront;','#ifdef DOUBLE_SIDED','varying vec3 vLightBack;','#endif',THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.uniTexture_pars_fragment,THREE.ShaderChunk.AT_depth_render_mode_pars_fragment,'void main() {',THREE.ShaderChunk.AT_depth_render_mode_fragment,'gl_FragColor = vec4( BASE_COLOR, opacity );',THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,'#ifdef DOUBLE_SIDED','if ( gl_FrontFacing )','gl_FragColor.xyz *= vLightFront;','else','gl_FragColor.xyz *= vLightBack;','#else','gl_FragColor.xyz *= vLightFront;','#endif',THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.uniTexture_fragment,THREE.ShaderChunk.fog_fragment,'}'].join('\n')},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.uniTexture,{tDisplacement:{type:'t',value:null},uDisplacementBias:{type:'f',value:0},uDisplacementScale:{type:'f',value:1},uDisplacementCustomUVScale:{type:'f',value:0},uDisplacementCustomUVOffset:{type:'v2',value:new THREE.Vector2(0,0)},edgeRotateDisplacementL:{type:'f',value:0},edgeRotateDisplacementR:{type:'f',value:0},edgeScaleDisplacementU:{type:'f',value:1},waveBaseSpeed:{type:'f',value:0},waveNoiseTexture:{type:'t',value:null},waveNoiseScale:{type:'f',value:0.5337},waveBumpScale:{type:'f',value:5},time:{type:'f',value:0},waveDrops:{type:'v4v',value:[]},mirrorSampler:{type:'t',value:null},mirrorTextureMatrix:{type:'m4',value:new THREE.Matrix4},reflection_alpha:{type:'f',value:1}},THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:'c',value:new THREE.Color(16777215)},emissive:{type:'c',value:new THREE.Color(0)},specular:{type:'c',value:new THREE.Color(1118481)},shininess:{type:'f',value:30},wrapRGB:{type:'v3',value:new THREE.Vector3(1,1,1)}}]),vertexShader:['#define PHONG','varying vec3 vViewPosition;','varying vec3 vNormal;',THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,'#if defined( VERTEX_TEXTURES ) && defined( USE_DISPLACEMENTMAP )','uniform sampler2D tDisplacement;','uniform float uDisplacementScale;','uniform float uDisplacementBias;','uniform float uDisplacementCustomUVScale;','uniform vec2 uDisplacementCustomUVOffset;','uniform float edgeRotateDisplacementL;','uniform float edgeRotateDisplacementR;','uniform float edgeScaleDisplacementU;','vec3 rotate_vector( vec4 quat, vec3 vec ) {','  return vec + 2.0 * cross( cross( vec, quat.xyz ) + quat.w * vec, quat.xyz );','}','#endif','#if defined( VERTEX_TEXTURES ) && defined( USE_WAVE_TEXTURE )','uniform sampler2D waveNoiseTexture;','uniform float waveBumpScale;','uniform float time;','uniform vec4 waveDrops[RIPPLE_MAX];','#endif','#ifdef USE_MIRROR_TEXTURE','uniform mat4 mirrorTextureMatrix;','varying vec4 mirrorCoord;','#endif',THREE.ShaderChunk.uniTexture_pars_vertex,'void main() {',THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,'vNormal = normalize( transformedNormal );',THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,'#if defined( VERTEX_TEXTURES ) && ( defined( USE_DISPLACEMENTMAP ) || defined( USE_WAVE_TEXTURE ) )','vec3 displacedPosition;','#endif','#if defined( VERTEX_TEXTURES ) && defined( USE_DISPLACEMENTMAP )','float df = uDisplacementScale * texture2D( tDisplacement, ((uDisplacementCustomUVScale>0.0) ? uDisplacementCustomUVOffset + uv * uDisplacementCustomUVScale : vUv) ).r + uDisplacementBias;','if ((edgeScaleDisplacementU != 1.0) && (uv.y > 0.95)) {','  df *= mix(1.0, edgeScaleDisplacementU, 20.0*(uv.y-0.95));','}','float a_half = 0.0;','if (uv.x < 0.05) {','  a_half = mix(edgeRotateDisplacementL*0.5, 0.0, 20.0*uv.x);','}','else if (uv.x > 0.95) {','  a_half = mix(0.0, edgeRotateDisplacementR*0.5, 20.0*(uv.x-0.95));','}','if (a_half != 0.0) {','  vec4 quat = vec4(0.0, sin(a_half), 0.0, cos(a_half));','  displacedPosition = position + rotate_vector(quat, normalize(normal)) * df;','  vNormal = rotate_vector(quat, vNormal);','}','else {','  displacedPosition = position + normalize( normal ) * df;','}','#endif','#if defined( VERTEX_TEXTURES ) && defined( USE_WAVE_TEXTURE )','vec2 uvTimeShift = vUv + vec2( 1.1, 1.9 ) * time * 0.15;','vec4 bumpData = texture2D( waveNoiseTexture, mod(uvTimeShift,1.0) );','float displacement = (bumpData.g - 0.25) * waveBumpScale;','float drop_count = 0.0;','vec3 normal_total = vec3(0.0, 0.0, 0.0);','for (int i = 0; i < RIPPLE_MAX; i++) {','  if (waveDrops[i].z > 0.0) {','vec4 _position = modelMatrix * vec4( position, 1.0 );','float dist = distance(_position.xz, waveDrops[i].xy) / RIPPLE_RANGE;','float angle = -( ((4.0 / (1.0 + pow(2.0, dist * 50.0 - waveDrops[i].w))) * 3.14159265359)  + 1.5707963267948966192313216916398 );','float wave = (sin(angle)+1.0)*0.5;','float amp = pow(2.0, -dist * 8.0) * waveDrops[i].z;','displacement += wave * amp;','vec2 dir = normalize(_position.xz - waveDrops[i].xy) * (-amp * 256.0 * cos(angle));','drop_count += 1.0;','normal_total += vec3(dir, 1.0);','  }','}','if (drop_count > 0.0) { vNormal = normalMatrix * normalize(normal_total / drop_count); }','#ifdef USE_DISPLACEMENTMAP','  displacedPosition = displacedPosition + normal * displacement;','#else','  displacedPosition = position + normal * displacement;','#endif','#endif',THREE.ShaderChunk.default_vertex,'vViewPosition = -mvPosition.xyz;',THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,'}'].join('\n'),fragmentShader:['uniform vec3 diffuse;','uniform float opacity;','uniform vec3 ambient;','uniform vec3 emissive;','uniform vec3 specular;','uniform float shininess;','#if defined( VERTEX_TEXTURES ) && defined( USE_WAVE_TEXTURE )','uniform float waveBaseSpeed;','uniform sampler2D waveNoiseTexture;','uniform float waveNoiseScale;','uniform float time;','#endif','#ifdef USE_MIRROR_TEXTURE','uniform sampler2D mirrorSampler;','uniform float reflection_alpha;','varying vec4 mirrorCoord;','#endif',THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.uniTexture_pars_fragment,THREE.ShaderChunk.AT_depth_render_mode_pars_fragment,'void main() {',THREE.ShaderChunk.AT_depth_render_mode_fragment,'gl_FragColor = vec4( BASE_COLOR, opacity );',THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,'#ifdef USE_MIRROR_TEXTURE','if (reflection_alpha > 0.0) {','vec4 mirror_color = texture2DProj(mirrorSampler, mirrorCoord);','gl_FragColor = vec4(mix(mirror_color.rgb, gl_FragColor.rgb, gl_FragColor.a * (1.0 - mirror_color.a*reflection_alpha)), gl_FragColor.a + ((1.0-gl_FragColor.a) * mirror_color.a*reflection_alpha));','}','#endif',THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.uniTexture_fragment,THREE.ShaderChunk.fog_fragment,'}'].join('\n')},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:['uniform float size;','uniform float scale;',THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,'void main() {',THREE.ShaderChunk.color_vertex,'vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );','#ifdef USE_SIZEATTENUATION','gl_PointSize = size * ( scale / length( mvPosition.xyz ) );','#else','gl_PointSize = size;','#endif','gl_Position = projectionMatrix * mvPosition;',THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,'}'].join('\n'),fragmentShader:['uniform vec3 psColor;','uniform float opacity;',THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,'void main() {','gl_FragColor = vec4( psColor, opacity );',THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,'}'].join('\n')},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:'f',value:1},dashSize:{type:'f',value:1},totalSize:{type:'f',value:2}}]),vertexShader:['uniform float scale;','attribute float lineDistance;','varying float vLineDistance;',THREE.ShaderChunk.color_pars_vertex,'void main() {',THREE.ShaderChunk.color_vertex,'vLineDistance = scale * lineDistance;','vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );','gl_Position = projectionMatrix * mvPosition;','}'].join('\n'),fragmentShader:['uniform vec3 diffuse;','uniform float opacity;','uniform float dashSize;','uniform float totalSize;','varying float vLineDistance;',THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.AT_depth_render_mode_pars_fragment,'void main() {',THREE.ShaderChunk.AT_depth_render_mode_fragment,'if ( mod( vLineDistance, totalSize ) > dashSize ) {','discard;','}','gl_FragColor = vec4( diffuse, opacity );',THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,'}'].join('\n')},depth:{uniforms:{mNear:{type:'f',value:1},mFar:{type:'f',value:2e3},opacity:{type:'f',value:1}},vertexShader:['void main() {','gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );','}'].join('\n'),fragmentShader:['uniform float mNear;','uniform float mFar;','uniform float opacity;',THREE.ShaderChunk.packing,'void main() {','gl_FragColor = packDepthToRGBA( gl_FragCoord.z );','}'].join('\n')},normal:{uniforms:{opacity:{type:'f',value:1}},vertexShader:['varying vec3 vNormal;',THREE.ShaderChunk.morphtarget_pars_vertex,'void main() {','vNormal = normalize( normalMatrix * normal );',THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,'}'].join('\n'),fragmentShader:['uniform float opacity;','varying vec3 vNormal;','void main() {','gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );','}'].join('\n')},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:'i',value:0},enableDiffuse:{type:'i',value:0},enableSpecular:{type:'i',value:0},enableReflection:{type:'i',value:0},enableDisplacement:{type:'i',value:0},tDisplacement:{type:'t',value:null},tDiffuse:{type:'t',value:null},tCube:{type:'t',value:null},tNormal:{type:'t',value:null},tSpecular:{type:'t',value:null},tAO:{type:'t',value:null},uNormalScale:{type:'v2',value:new THREE.Vector2(1,1)},uDisplacementBias:{type:'f',value:0},uDisplacementScale:{type:'f',value:1},uDiffuseColor:{type:'c',value:new THREE.Color(16777215)},uSpecularColor:{type:'c',value:new THREE.Color(1118481)},uAmbientColor:{type:'c',value:new THREE.Color(16777215)},uShininess:{type:'f',value:30},uOpacity:{type:'f',value:1},useRefract:{type:'i',value:0},uRefractionRatio:{type:'f',value:0.98},uReflectivity:{type:'f',value:0.5},uOffset:{type:'v2',value:new THREE.Vector2(0,0)},uRepeat:{type:'v2',value:new THREE.Vector2(1,1)},wrapRGB:{type:'v3',value:new THREE.Vector3(1,1,1)}}]),fragmentShader:['uniform vec3 uAmbientColor;','uniform vec3 uDiffuseColor;','uniform vec3 uSpecularColor;','uniform float uShininess;','uniform float uOpacity;','uniform bool enableDiffuse;','uniform bool enableSpecular;','uniform bool enableAO;','uniform bool enableReflection;','uniform sampler2D tDiffuse;','uniform sampler2D tNormal;','uniform sampler2D tSpecular;','uniform sampler2D tAO;','uniform samplerCube tCube;','uniform vec2 uNormalScale;','uniform bool useRefract;','uniform float uRefractionRatio;','uniform float uReflectivity;','varying vec3 vTangent;','varying vec3 vBinormal;','varying vec3 vNormal;','varying vec2 vUv;','uniform vec3 ambientLightColor;','#if MAX_DIR_LIGHTS > 0','uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];','uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];','#endif','#if MAX_HEMI_LIGHTS > 0','uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];','uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];','uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];','#endif','#if MAX_POINT_LIGHTS > 0','uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];','uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];','uniform float pointLightDistance[ MAX_POINT_LIGHTS ];','#endif','#if MAX_SPOT_LIGHTS > 0','uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];','uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];','uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];','uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];','uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];','uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];','#endif','#ifdef WRAP_AROUND','uniform vec3 wrapRGB;','#endif','varying vec3 vWorldPosition;','varying vec3 vViewPosition;',THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,'void main() {','gl_FragColor = vec4( vec3( 1.0 ), uOpacity );','vec3 specularTex = vec3( 1.0 );','vec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;','normalTex.xy *= uNormalScale;','normalTex = normalize( normalTex );','if( enableDiffuse ) {','#ifdef GAMMA_INPUT','vec4 texelColor = texture2D( tDiffuse, vUv );','texelColor.xyz *= texelColor.xyz;','gl_FragColor = gl_FragColor * texelColor;','#else','gl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );','#endif','}','if( enableAO ) {','#ifdef GAMMA_INPUT','vec4 aoColor = texture2D( tAO, vUv );','aoColor.xyz *= aoColor.xyz;','gl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;','#else','gl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;','#endif','}','if( enableSpecular )','specularTex = texture2D( tSpecular, vUv ).xyz;','mat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );','vec3 finalNormal = tsb * normalTex;','#ifdef FLIP_SIDED','finalNormal = -finalNormal;','#endif','vec3 normal = normalize( finalNormal );','vec3 viewPosition = normalize( vViewPosition );','#if MAX_POINT_LIGHTS > 0','vec3 pointDiffuse = vec3( 0.0 );','vec3 pointSpecular = vec3( 0.0 );','for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {','vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );','vec3 pointVector = lPosition.xyz + vViewPosition.xyz;','float pointDistance = 1.0;','if ( pointLightDistance[ i ] > 0.0 )','pointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );','pointVector = normalize( pointVector );','#ifdef WRAP_AROUND','float pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );','float pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );','vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );','#else','float pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );','#endif','pointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;','vec3 pointHalfVector = normalize( pointVector + viewPosition );','float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );','float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );','#ifdef PHYSICALLY_BASED_SHADING','float specularNormalization = ( uShininess + 2.0001 ) / 8.0;','vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );','pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;','#else','pointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;','#endif','}','#endif','#if MAX_SPOT_LIGHTS > 0','vec3 spotDiffuse = vec3( 0.0 );','vec3 spotSpecular = vec3( 0.0 );','for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {','vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );','vec3 spotVector = lPosition.xyz + vViewPosition.xyz;','float spotDistance = 1.0;','if ( spotLightDistance[ i ] > 0.0 )','spotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );','spotVector = normalize( spotVector );','float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );','if ( spotEffect > spotLightAngleCos[ i ] ) {','spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );','#ifdef WRAP_AROUND','float spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );','float spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );','vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );','#else','float spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );','#endif','spotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;','vec3 spotHalfVector = normalize( spotVector + viewPosition );','float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );','float spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );','#ifdef PHYSICALLY_BASED_SHADING','float specularNormalization = ( uShininess + 2.0001 ) / 8.0;','vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );','spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;','#else','spotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;','#endif','}','}','#endif','#if MAX_DIR_LIGHTS > 0','vec3 dirDiffuse = vec3( 0.0 );','vec3 dirSpecular = vec3( 0.0 );','for( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {','vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );','vec3 dirVector = normalize( lDirection.xyz );','#ifdef WRAP_AROUND','float directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );','float directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );','vec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );','#else','float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );','#endif','dirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;','vec3 dirHalfVector = normalize( dirVector + viewPosition );','float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );','float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );','#ifdef PHYSICALLY_BASED_SHADING','float specularNormalization = ( uShininess + 2.0001 ) / 8.0;','vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );','dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;','#else','dirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;','#endif','}','#endif','#if MAX_HEMI_LIGHTS > 0','vec3 hemiDiffuse  = vec3( 0.0 );','vec3 hemiSpecular = vec3( 0.0 );','for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {','vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );','vec3 lVector = normalize( lDirection.xyz );','float dotProduct = dot( normal, lVector );','float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;','vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );','hemiDiffuse += uDiffuseColor * hemiColor;','vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );','float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;','float hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );','vec3 lVectorGround = -lVector;','vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );','float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;','float hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );','#ifdef PHYSICALLY_BASED_SHADING','float dotProductGround = dot( normal, lVectorGround );','float specularNormalization = ( uShininess + 2.0001 ) / 8.0;','vec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );','vec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );','hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );','#else','hemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;','#endif','}','#endif','vec3 totalDiffuse = vec3( 0.0 );','vec3 totalSpecular = vec3( 0.0 );','#if MAX_DIR_LIGHTS > 0','totalDiffuse += dirDiffuse;','totalSpecular += dirSpecular;','#endif','#if MAX_HEMI_LIGHTS > 0','totalDiffuse += hemiDiffuse;','totalSpecular += hemiSpecular;','#endif','#if MAX_POINT_LIGHTS > 0','totalDiffuse += pointDiffuse;','totalSpecular += pointSpecular;','#endif','#if MAX_SPOT_LIGHTS > 0','totalDiffuse += spotDiffuse;','totalSpecular += spotSpecular;','#endif','#ifdef METAL','gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );','#else','gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;','#endif','if ( enableReflection ) {','vec3 vReflect;','vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );','if ( useRefract ) {','vReflect = refract( cameraToVertex, normal, uRefractionRatio );','} else {','vReflect = reflect( cameraToVertex, normal );','}','vec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );','#ifdef GAMMA_INPUT','cubeColor.xyz *= cubeColor.xyz;','#endif','gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );','}',THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,'}'].join('\n'),vertexShader:['attribute vec4 tangent;','uniform vec2 uOffset;','uniform vec2 uRepeat;','uniform bool enableDisplacement;','#ifdef VERTEX_TEXTURES','uniform sampler2D tDisplacement;','uniform float uDisplacementScale;','uniform float uDisplacementBias;','#endif','varying vec3 vTangent;','varying vec3 vBinormal;','varying vec3 vNormal;','varying vec2 vUv;','varying vec3 vWorldPosition;','varying vec3 vViewPosition;',THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,'void main() {',THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,'#ifdef USE_SKINNING','vNormal = normalize( normalMatrix * skinnedNormal.xyz );','vec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );','vTangent = normalize( normalMatrix * skinnedTangent.xyz );','#else','vNormal = normalize( normalMatrix * normal );','vTangent = normalize( normalMatrix * tangent.xyz );','#endif','vBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );','vUv = uv * uRepeat + uOffset;','vec3 displacedPosition;','#ifdef VERTEX_TEXTURES','if ( enableDisplacement ) {','vec3 dv = texture2D( tDisplacement, uv ).xyz;','float df = uDisplacementScale * dv.x + uDisplacementBias;','displacedPosition = position + normalize( normal ) * df;','} else {','#ifdef USE_SKINNING','vec4 skinVertex = vec4( position, 1.0 );','vec4 skinned  = boneMatX * skinVertex * skinWeight.x;','skinned \t  += boneMatY * skinVertex * skinWeight.y;','displacedPosition  = skinned.xyz;','#else','displacedPosition = position;','#endif','}','#else','#ifdef USE_SKINNING','vec4 skinVertex = vec4( position, 1.0 );','vec4 skinned  = boneMatX * skinVertex * skinWeight.x;','skinned \t  += boneMatY * skinVertex * skinWeight.y;','displacedPosition  = skinned.xyz;','#else','displacedPosition = position;','#endif','#endif','vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );','vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );','gl_Position = projectionMatrix * mvPosition;','vWorldPosition = worldPosition.xyz;','vViewPosition = -mvPosition.xyz;','#ifdef USE_SHADOWMAP','for( int i = 0; i < MAX_SHADOWS; i ++ ) {','vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;','}','#endif','}'].join('\n')},cube:{uniforms:{tCube:{type:'t',value:null},tFlip:{type:'f',value:-1}},vertexShader:['varying vec3 vWorldPosition;','void main() {','vec4 worldPosition = modelMatrix * vec4( position, 1.0 );','vWorldPosition = worldPosition.xyz;','gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );','}'].join('\n'),fragmentShader:['uniform samplerCube tCube;','uniform float tFlip;','varying vec3 vWorldPosition;','void main() {','gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );','}'].join('\n')},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,'void main() {',THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,'}'].join('\n'),fragmentShader:[THREE.ShaderChunk.packing,'void main() {','gl_FragColor = packDepthToRGBA( gl_FragCoord.z );','}'].join('\n')}},THREE.WebGLRenderer=function(_){function S(aa){aa.__webglVertexBuffer=ir.createBuffer(),aa.__webglColorBuffer=ir.createBuffer(),bt.info.memory.geometries++}function T(aa){aa.__webglVertexBuffer=ir.createBuffer(),aa.__webglColorBuffer=ir.createBuffer(),aa.__webglLineDistanceBuffer=ir.createBuffer(),bt.info.memory.geometries++}function M(aa){aa.__webglVertexBuffer=ir.createBuffer(),aa.__webglColorBuffer=ir.createBuffer(),aa.__webglNormalBuffer=ir.createBuffer(),bt.info.memory.geometries++}function A(aa){aa.__webglVertexBuffer=ir.createBuffer(),aa.__webglNormalBuffer=ir.createBuffer(),aa.__webglTangentBuffer=ir.createBuffer(),aa.__webglColorBuffer=ir.createBuffer(),aa.__webglUVBuffer=ir.createBuffer(),aa.__webglUV2Buffer=ir.createBuffer(),aa.__webglSkinIndicesBuffer=ir.createBuffer(),aa.__webglSkinWeightsBuffer=ir.createBuffer(),aa.__webglFaceBuffer=ir.createBuffer(),aa.__webglLineBuffer=ir.createBuffer();var oa,ia;if(aa.numMorphTargets)for(aa.__webglMorphTargetsBuffers=[],oa=0,ia=aa.numMorphTargets;oa<ia;oa++)aa.__webglMorphTargetsBuffers.push(ir.createBuffer());if(aa.numMorphNormals)for(aa.__webglMorphNormalsBuffers=[],oa=0,ia=aa.numMorphNormals;oa<ia;oa++)aa.__webglMorphNormalsBuffers.push(ir.createBuffer());bt.info.memory.geometries++}function E(aa){if(aa.__webglCustomAttributesList)for(var oa in aa.__webglCustomAttributesList)ir.deleteBuffer(aa.__webglCustomAttributesList[oa].buffer)}function C(aa,oa){var ia=aa.vertices.length,sa=oa.material;if(sa.attributes)for(var la in void 0===aa.__webglCustomAttributesList&&(aa.__webglCustomAttributesList=[]),sa.attributes){var da=sa.attributes[la];if(!da.__webglInitialized||da.createUniqueBuffers){da.__webglInitialized=!0;var fa=1;'v2'===da.type?fa=2:'v3'===da.type?fa=3:'v4'===da.type?fa=4:'c'===da.type&&(fa=3),da.size=fa,da.array=new Float32Array(ia*fa),da.buffer=ir.createBuffer(),da.buffer.belongsToAttribute=la,da.needsUpdate=!0}aa.__webglCustomAttributesList.push(da)}}function D(aa,oa){var ia=aa.vertices.length;aa.__vertexArray=new Float32Array(3*ia),aa.__colorArray=new Float32Array(3*ia),aa.__sortArray=[],aa.__webglParticleCount=ia,C(aa,oa)}function R(aa,oa){var ia=aa.vertices.length;aa.__vertexArray=new Float32Array(3*ia),aa.__colorArray=new Float32Array(3*ia),aa.__lineDistanceArray=new Float32Array(1*ia),aa.__webglLineCount=ia,C(aa,oa)}function P(aa,oa){var ia=aa.vertices.length;aa.__vertexArray=new Float32Array(3*ia),aa.__colorArray=new Float32Array(3*ia),aa.__normalArray=new Float32Array(3*ia),aa.__webglVertexCount=ia,C(aa,oa)}function L(aa,oa){var ia=oa.geometry,sa=aa.faces3,la=aa.faces4,da=3*sa.length+4*la.length,fa=1*sa.length+2*la.length,ha=3*sa.length+4*la.length,ga=U(oa,aa),ya=I(ga),_a=F(ga),xa=V(ga);aa.__vertexArray=new Float32Array(3*da),_a&&(aa.__normalArray=new Float32Array(3*da)),ia.hasTangents&&(aa.__tangentArray=new Float32Array(4*da)),xa&&(aa.__colorArray=new Float32Array(3*da)),ya&&((0<ia.faceUvs.length||0<ia.faceVertexUvs.length)&&(aa.__uvArray=new Float32Array(2*da)),(1<ia.faceUvs.length||1<ia.faceVertexUvs.length)&&(aa.__uv2Array=new Float32Array(2*da))),oa.geometry.skinWeights.length&&oa.geometry.skinIndices.length&&(aa.__skinIndexArray=new Float32Array(4*da),aa.__skinWeightArray=new Float32Array(4*da)),aa.__faceArray=new Uint16Array(3*fa),aa.__lineArray=new Uint16Array(2*ha);var ba,Sa;if(aa.numMorphTargets)for(aa.__morphTargetsArrays=[],ba=0,Sa=aa.numMorphTargets;ba<Sa;ba++)aa.__morphTargetsArrays.push(new Float32Array(3*da));if(aa.numMorphNormals)for(aa.__morphNormalsArrays=[],ba=0,Sa=aa.numMorphNormals;ba<Sa;ba++)aa.__morphNormalsArrays.push(new Float32Array(3*da));if(aa.__webglFaceCount=3*fa,aa.__webglLineCount=2*ha,ga.attributes)for(var Ta in void 0===aa.__webglCustomAttributesList&&(aa.__webglCustomAttributesList=[]),ga.attributes){var Ma=ga.attributes[Ta],Aa={};for(var wa in Ma)Aa[wa]=Ma[wa];if(!Aa.__webglInitialized||Aa.createUniqueBuffers){Aa.__webglInitialized=!0;var Ea=1;'v2'===Aa.type?Ea=2:'v3'===Aa.type?Ea=3:'v4'===Aa.type?Ea=4:'c'===Aa.type&&(Ea=3),Aa.size=Ea,Aa.array=new Float32Array(da*Ea),Aa.buffer=ir.createBuffer(),Aa.buffer.belongsToAttribute=Ta,Ma.needsUpdate=!0,Aa.__original=Ma}aa.__webglCustomAttributesList.push(Aa)}aa.__inittedArrays=!0}function U(aa,oa){return aa.material instanceof THREE.MeshFaceMaterial?aa.material.materials[oa.materialIndex]:aa.material}function N(aa){return aa&&aa.shading!==void 0&&aa.shading===THREE.SmoothShading}function F(aa){return aa instanceof THREE.MeshBasicMaterial&&!aa.envMap||aa instanceof THREE.MeshDepthMaterial?!1:N(aa)?THREE.SmoothShading:THREE.FlatShading}function V(aa){return!!aa.vertexColors&&aa.vertexColors}function I(aa){return aa.map||aa.lightMap||aa.bumpMap||aa.displacementMap||aa.waveNoiseTexture||aa.normalMap||aa.specularMap||aa instanceof THREE.ShaderMaterial}function O(aa){var oa,ia,sa;for(oa in aa.attributes)sa='index'===oa?ir.ELEMENT_ARRAY_BUFFER:ir.ARRAY_BUFFER,ia=aa.attributes[oa],ia.buffer=ir.createBuffer(),ir.bindBuffer(sa,ia.buffer),ir.bufferData(sa,ia.array,ir.STATIC_DRAW)}function B(aa,oa,ia){var ya=aa.vertices,_a=ya.length,xa=aa.colors,ba=xa.length,Sa=aa.__vertexArray,Ta=aa.__colorArray,Ma=aa.__sortArray,Aa=aa.verticesNeedUpdate,wa=aa.elementsNeedUpdate,Ea=aa.colorsNeedUpdate,Ca=aa.__webglCustomAttributesList,sa,la,da,fa,ha,ga,Da,Ra,La,Ua,Na,Fa;if(ia.sortParticles){for($t.copy(Jt),$t.multiply(ia.matrixWorld),sa=0;sa<_a;sa++)da=ya[sa],er.copy(da),er.applyProjection($t),Ma[sa]=[er.z,sa];for(Ma.sort(ee),sa=0;sa<_a;sa++)da=ya[Ma[sa][1]],fa=3*sa,Sa[fa]=da.x,Sa[fa+1]=da.y,Sa[fa+2]=da.z;for(la=0;la<ba;la++)fa=3*la,ga=xa[Ma[la][1]],Ta[fa]=ga.r,Ta[fa+1]=ga.g,Ta[fa+2]=ga.b;if(Ca)for(Da=0,Ra=Ca.length;Da<Ra;Da++)if(Fa=Ca[Da],void 0===Fa.boundTo||'vertices'===Fa.boundTo)if(fa=0,Ua=Fa.value.length,1===Fa.size)for(La=0;La<Ua;La++)ha=Ma[La][1],Fa.array[La]=Fa.value[ha];else if(2===Fa.size)for(La=0;La<Ua;La++)ha=Ma[La][1],Na=Fa.value[ha],Fa.array[fa]=Na.x,Fa.array[fa+1]=Na.y,fa+=2;else if(3===Fa.size){if('c'===Fa.type)for(La=0;La<Ua;La++)ha=Ma[La][1],Na=Fa.value[ha],Fa.array[fa]=Na.r,Fa.array[fa+1]=Na.g,Fa.array[fa+2]=Na.b,fa+=3;else for(La=0;La<Ua;La++)ha=Ma[La][1],Na=Fa.value[ha],Fa.array[fa]=Na.x,Fa.array[fa+1]=Na.y,Fa.array[fa+2]=Na.z,fa+=3;}else if(4===Fa.size)for(La=0;La<Ua;La++)ha=Ma[La][1],Na=Fa.value[ha],Fa.array[fa]=Na.x,Fa.array[fa+1]=Na.y,Fa.array[fa+2]=Na.z,Fa.array[fa+3]=Na.w,fa+=4}else{if(Aa)for(sa=0;sa<_a;sa++)da=ya[sa],fa=3*sa,Sa[fa]=da.x,Sa[fa+1]=da.y,Sa[fa+2]=da.z;if(Ea)for(la=0;la<ba;la++)ga=xa[la],fa=3*la,Ta[fa]=ga.r,Ta[fa+1]=ga.g,Ta[fa+2]=ga.b;if(Ca)for(Da=0,Ra=Ca.length;Da<Ra;Da++)if(Fa=Ca[Da],Fa.needsUpdate&&(void 0===Fa.boundTo||'vertices'===Fa.boundTo))if(Ua=Fa.value.length,fa=0,1===Fa.size)for(La=0;La<Ua;La++)Fa.array[La]=Fa.value[La];else if(2===Fa.size)for(La=0;La<Ua;La++)Na=Fa.value[La],Fa.array[fa]=Na.x,Fa.array[fa+1]=Na.y,fa+=2;else if(3===Fa.size){if('c'===Fa.type)for(La=0;La<Ua;La++)Na=Fa.value[La],Fa.array[fa]=Na.r,Fa.array[fa+1]=Na.g,Fa.array[fa+2]=Na.b,fa+=3;else for(La=0;La<Ua;La++)Na=Fa.value[La],Fa.array[fa]=Na.x,Fa.array[fa+1]=Na.y,Fa.array[fa+2]=Na.z,fa+=3;}else if(4===Fa.size)for(La=0;La<Ua;La++)Na=Fa.value[La],Fa.array[fa]=Na.x,Fa.array[fa+1]=Na.y,Fa.array[fa+2]=Na.z,Fa.array[fa+3]=Na.w,fa+=4}if((Aa||ia.sortParticles)&&(ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglVertexBuffer),ir.bufferData(ir.ARRAY_BUFFER,Sa,oa)),(Ea||ia.sortParticles)&&(ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglColorBuffer),ir.bufferData(ir.ARRAY_BUFFER,Ta,oa)),Ca)for(Da=0,Ra=Ca.length;Da<Ra;Da++)Fa=Ca[Da],(Fa.needsUpdate||ia.sortParticles)&&(ir.bindBuffer(ir.ARRAY_BUFFER,Fa.buffer),ir.bufferData(ir.ARRAY_BUFFER,Fa.array,oa))}function G(aa,oa){var ga=aa.vertices,ya=aa.colors,_a=aa.lineDistances,xa=ga.length,ba=ya.length,Sa=_a.length,Ta=aa.__vertexArray,Ma=aa.__colorArray,Aa=aa.__lineDistanceArray,wa=aa.verticesNeedUpdate,Ea=aa.colorsNeedUpdate,Ca=aa.lineDistancesNeedUpdate,Da=aa.__webglCustomAttributesList,ia,sa,la,da,fa,ha,Ra,Pa,Ua,Na,Fa,za;if(wa){for(ia=0;ia<xa;ia++)da=ga[ia],fa=3*ia,Ta[fa]=da.x,Ta[fa+1]=da.y,Ta[fa+2]=da.z;ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglVertexBuffer),ir.bufferData(ir.ARRAY_BUFFER,Ta,oa)}if(Ea){for(sa=0;sa<ba;sa++)ha=ya[sa],fa=3*sa,Ma[fa]=ha.r,Ma[fa+1]=ha.g,Ma[fa+2]=ha.b;ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglColorBuffer),ir.bufferData(ir.ARRAY_BUFFER,Ma,oa)}if(Ca){for(la=0;la<Sa;la++)Aa[la]=_a[la];ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglLineDistanceBuffer),ir.bufferData(ir.ARRAY_BUFFER,Aa,oa)}if(Da)for(Ra=0,Pa=Da.length;Ra<Pa;Ra++)if(za=Da[Ra],za.needsUpdate&&(void 0===za.boundTo||'vertices'===za.boundTo)){if(fa=0,Na=za.value.length,1===za.size)for(Ua=0;Ua<Na;Ua++)za.array[Ua]=za.value[Ua];else if(2===za.size)for(Ua=0;Ua<Na;Ua++)Fa=za.value[Ua],za.array[fa]=Fa.x,za.array[fa+1]=Fa.y,fa+=2;else if(3===za.size){if('c'===za.type)for(Ua=0;Ua<Na;Ua++)Fa=za.value[Ua],za.array[fa]=Fa.r,za.array[fa+1]=Fa.g,za.array[fa+2]=Fa.b,fa+=3;else for(Ua=0;Ua<Na;Ua++)Fa=za.value[Ua],za.array[fa]=Fa.x,za.array[fa+1]=Fa.y,za.array[fa+2]=Fa.z,fa+=3;}else if(4===za.size)for(Ua=0;Ua<Na;Ua++)Fa=za.value[Ua],za.array[fa]=Fa.x,za.array[fa+1]=Fa.y,za.array[fa+2]=Fa.z,za.array[fa+3]=Fa.w,fa+=4;ir.bindBuffer(ir.ARRAY_BUFFER,za.buffer),ir.bufferData(ir.ARRAY_BUFFER,za.array,oa)}}function H(aa,oa){var Ma=aa.vertices,Aa=aa.colors,wa=aa.normals,Ea=Ma.length,Ca=Aa.length,Da=wa.length,Ra=aa.__vertexArray,Pa=aa.__colorArray,La=aa.__normalArray,Ua=aa.verticesNeedUpdate,Na=aa.colorsNeedUpdate,Fa=aa.normalsNeedUpdate,za=aa.__webglCustomAttributesList,ia,sa,la,da,fa,ha,ga,ya,_a,xa,ba,Sa,Ta;if(Ua){for(ia=0;ia<Ea;ia++)da=Ma[ia],fa=3*ia,Ra[fa]=da.x,Ra[fa+1]=da.y,Ra[fa+2]=da.z;ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglVertexBuffer),ir.bufferData(ir.ARRAY_BUFFER,Ra,oa)}if(Na){for(sa=0;sa<Ca;sa++)ha=Aa[sa],fa=3*sa,Pa[fa]=ha.r,Pa[fa+1]=ha.g,Pa[fa+2]=ha.b;ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglColorBuffer),ir.bufferData(ir.ARRAY_BUFFER,Pa,oa)}if(Fa){for(la=0;la<Da;la++)ga=wa[la],fa=3*la,La[fa]=ga.x,La[fa+1]=ga.y,La[fa+2]=ga.z;ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglNormalBuffer),ir.bufferData(ir.ARRAY_BUFFER,La,oa)}if(za)for(ya=0,_a=za.length;ya<_a;ya++)if(Sa=za[ya],Sa.needsUpdate&&(void 0===Sa.boundTo||'vertices'===Sa.boundTo)){if(fa=0,ba=Sa.value.length,1===Sa.size)for(xa=0;xa<ba;xa++)Sa.array[xa]=Sa.value[xa];else if(2===Sa.size)for(xa=0;xa<ba;xa++)Ta=Sa.value[xa],Sa.array[fa]=Ta.x,Sa.array[fa+1]=Ta.y,fa+=2;else if(3===Sa.size){if('c'===Sa.type)for(xa=0;xa<ba;xa++)Ta=Sa.value[xa],Sa.array[fa]=Ta.r,Sa.array[fa+1]=Ta.g,Sa.array[fa+2]=Ta.b,fa+=3;else for(xa=0;xa<ba;xa++)Ta=Sa.value[xa],Sa.array[fa]=Ta.x,Sa.array[fa+1]=Ta.y,Sa.array[fa+2]=Ta.z,fa+=3;}else if(4===Sa.size)for(xa=0;xa<ba;xa++)Ta=Sa.value[xa],Sa.array[fa]=Ta.x,Sa.array[fa+1]=Ta.y,Sa.array[fa+2]=Ta.z,Sa.array[fa+3]=Ta.w,fa+=4;ir.bindBuffer(ir.ARRAY_BUFFER,Sa.buffer),ir.bufferData(ir.ARRAY_BUFFER,Sa.array,oa)}}function W(aa,oa,ia,sa,la){if(aa.__inittedArrays){var da=F(la),fa=V(la),ha=I(la),ga=da===THREE.SmoothShading,Ao=0,wo=0,Eo=0,Co=0,Do=0,Ro=0,Po=0,Lo=0,Uo=0,No=0,Fo=0,zo=0,Vo=0,Oo=aa.__vertexArray,Bo=aa.__uvArray,ko=aa.__uv2Array,Go=aa.__normalArray,Ho=aa.__tangentArray,Wo=aa.__colorArray,jo=aa.__skinIndexArray,Xo=aa.__skinWeightArray,Yo=aa.__morphTargetsArrays,qo=aa.__morphNormalsArrays,Ko=aa.__webglCustomAttributesList,Zo=aa.__faceArray,Jo=aa.__lineArray,$o=oa.geometry,ei=$o.verticesNeedUpdate,ti=$o.elementsNeedUpdate,oi=$o.uvsNeedUpdate,ni=$o.normalsNeedUpdate,si=$o.tangentsNeedUpdate,li=$o.colorsNeedUpdate,ci=$o.morphTargetsNeedUpdate,pi=$o.vertices,mi=aa.faces3,ui=aa.faces4,hi=$o.faces,gi=$o.faceVertexUvs[0],yi=$o.faceVertexUvs[1],_i=$o.colors,xi=$o.skinIndices,vi=$o.skinWeights,bi=$o.morphTargets,Si=$o.morphNormals,ya,_a,xa,ba,Sa,Ta,Aa,wa,Ea,Ca,Da,Ra,Pa,La,Ua,Na,Fa,za,Va,Ia,Oa,Ba,ka,Ga,Ha,Wa,ja,Xa,Ya,Ka,Qa,Za,Ja,$a,eo,uo,fo,ho,go,yo,_o,xo,vo,bo,So,To,Io,Qo;if(nr){if(aa._vao)for(let Mi in aa._vao)ir.deleteVertexArray(aa._vao[Mi].vao);aa._vao={}}if(ei){for(ya=0,_a=mi.length;ya<_a;ya++)ba=hi[mi[ya]],Ra=pi[ba.a],Pa=pi[ba.b],La=pi[ba.c],Oo[wo]=Ra.x,Oo[wo+1]=Ra.y,Oo[wo+2]=Ra.z,Oo[wo+3]=Pa.x,Oo[wo+4]=Pa.y,Oo[wo+5]=Pa.z,Oo[wo+6]=La.x,Oo[wo+7]=La.y,Oo[wo+8]=La.z,wo+=9;for(ya=0,_a=ui.length;ya<_a;ya++)ba=hi[ui[ya]],Ra=pi[ba.a],Pa=pi[ba.b],La=pi[ba.c],Ua=pi[ba.d],Oo[wo]=Ra.x,Oo[wo+1]=Ra.y,Oo[wo+2]=Ra.z,Oo[wo+3]=Pa.x,Oo[wo+4]=Pa.y,Oo[wo+5]=Pa.z,Oo[wo+6]=La.x,Oo[wo+7]=La.y,Oo[wo+8]=La.z,Oo[wo+9]=Ua.x,Oo[wo+10]=Ua.y,Oo[wo+11]=Ua.z,wo+=12;ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglVertexBuffer),ir.bufferData(ir.ARRAY_BUFFER,Oo,ia)}if(ci)for(la.morphTargets_dependency={},_o=0,xo=bi.length;_o<xo;_o++){Fo=0;let Mi=!1;for(ya=0,_a=mi.length;ya<_a;ya++)if(So=mi[ya],ba=hi[So],Ra=bi[_o].vertices[ba.a],Pa=bi[_o].vertices[ba.b],La=bi[_o].vertices[ba.c],vo=Yo[_o],!!vo){if(vo[Fo]=Ra.x,vo[Fo+1]=Ra.y,vo[Fo+2]=Ra.z,vo[Fo+3]=Pa.x,vo[Fo+4]=Pa.y,vo[Fo+5]=Pa.z,vo[Fo+6]=La.x,vo[Fo+7]=La.y,vo[Fo+8]=La.z,!Mi){let Ai=pi[ba.a],wi=pi[ba.b],Ei=pi[ba.c];(Ra.x!=Ai.x||Ra.y!=Ai.y||Ra.z!=Ai.z||Pa.x!=wi.x||Pa.y!=wi.y||Pa.z!=wi.z||La.x!=Ei.x||La.y!=Ei.y||La.z!=Ei.z)&&(Mi=!0)}la.morphNormals&&(ga?(To=Si[_o].vertexNormals[So],Ia=To.a,Oa=To.b,Ba=To.c):(Ia=Si[_o].faceNormals[So],Oa=Ia,Ba=Ia),bo=qo[_o],bo[Fo]=Ia.x,bo[Fo+1]=Ia.y,bo[Fo+2]=Ia.z,bo[Fo+3]=Oa.x,bo[Fo+4]=Oa.y,bo[Fo+5]=Oa.z,bo[Fo+6]=Ba.x,bo[Fo+7]=Ba.y,bo[Fo+8]=Ba.z),Fo+=9}for(ya=0,_a=ui.length;ya<_a;ya++)So=ui[ya],ba=hi[So],Ra=bi[_o].vertices[ba.a],Pa=bi[_o].vertices[ba.b],La=bi[_o].vertices[ba.c],Ua=bi[_o].vertices[ba.d],vo=Yo[_o],vo[Fo]=Ra.x,vo[Fo+1]=Ra.y,vo[Fo+2]=Ra.z,vo[Fo+3]=Pa.x,vo[Fo+4]=Pa.y,vo[Fo+5]=Pa.z,vo[Fo+6]=La.x,vo[Fo+7]=La.y,vo[Fo+8]=La.z,vo[Fo+9]=Ua.x,vo[Fo+10]=Ua.y,vo[Fo+11]=Ua.z,la.morphNormals&&(ga?(To=Si[_o].vertexNormals[So],Ia=To.a,Oa=To.b,Ba=To.c,ka=To.d):(Ia=Si[_o].faceNormals[So],Oa=Ia,Ba=Ia,ka=Ia),bo=qo[_o],bo[Fo]=Ia.x,bo[Fo+1]=Ia.y,bo[Fo+2]=Ia.z,bo[Fo+3]=Oa.x,bo[Fo+4]=Oa.y,bo[Fo+5]=Oa.z,bo[Fo+6]=Ba.x,bo[Fo+7]=Ba.y,bo[Fo+8]=Ba.z,bo[Fo+9]=ka.x,bo[Fo+10]=ka.y,bo[Fo+11]=ka.z),Fo+=12;Mi&&(la.morphTargets_dependency[_o]=!0),ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglMorphTargetsBuffers[_o]),ir.bufferData(ir.ARRAY_BUFFER,Yo[_o],ia),la.morphNormals&&(ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglMorphNormalsBuffers[_o]),ir.bufferData(ir.ARRAY_BUFFER,qo[_o],ia))}if(vi.length){for(ya=0,_a=mi.length;ya<_a;ya++)ba=hi[mi[ya]],Xa=vi[ba.a],Ya=vi[ba.b],Ka=vi[ba.c],Xo[No]=Xa.x,Xo[No+1]=Xa.y,Xo[No+2]=Xa.z,Xo[No+3]=Xa.w,Xo[No+4]=Ya.x,Xo[No+5]=Ya.y,Xo[No+6]=Ya.z,Xo[No+7]=Ya.w,Xo[No+8]=Ka.x,Xo[No+9]=Ka.y,Xo[No+10]=Ka.z,Xo[No+11]=Ka.w,Za=xi[ba.a],Ja=xi[ba.b],$a=xi[ba.c],jo[No]=Za.x,jo[No+1]=Za.y,jo[No+2]=Za.z,jo[No+3]=Za.w,jo[No+4]=Ja.x,jo[No+5]=Ja.y,jo[No+6]=Ja.z,jo[No+7]=Ja.w,jo[No+8]=$a.x,jo[No+9]=$a.y,jo[No+10]=$a.z,jo[No+11]=$a.w,No+=12;for(ya=0,_a=ui.length;ya<_a;ya++)ba=hi[ui[ya]],Xa=vi[ba.a],Ya=vi[ba.b],Ka=vi[ba.c],Qa=vi[ba.d],Xo[No]=Xa.x,Xo[No+1]=Xa.y,Xo[No+2]=Xa.z,Xo[No+3]=Xa.w,Xo[No+4]=Ya.x,Xo[No+5]=Ya.y,Xo[No+6]=Ya.z,Xo[No+7]=Ya.w,Xo[No+8]=Ka.x,Xo[No+9]=Ka.y,Xo[No+10]=Ka.z,Xo[No+11]=Ka.w,Xo[No+12]=Qa.x,Xo[No+13]=Qa.y,Xo[No+14]=Qa.z,Xo[No+15]=Qa.w,Za=xi[ba.a],Ja=xi[ba.b],$a=xi[ba.c],eo=xi[ba.d],jo[No]=Za.x,jo[No+1]=Za.y,jo[No+2]=Za.z,jo[No+3]=Za.w,jo[No+4]=Ja.x,jo[No+5]=Ja.y,jo[No+6]=Ja.z,jo[No+7]=Ja.w,jo[No+8]=$a.x,jo[No+9]=$a.y,jo[No+10]=$a.z,jo[No+11]=$a.w,jo[No+12]=eo.x,jo[No+13]=eo.y,jo[No+14]=eo.z,jo[No+15]=eo.w,No+=16;0<No&&(ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglSkinIndicesBuffer),ir.bufferData(ir.ARRAY_BUFFER,jo,ia),ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglSkinWeightsBuffer),ir.bufferData(ir.ARRAY_BUFFER,Xo,ia))}if(li&&fa){for(ya=0,_a=mi.length;ya<_a;ya++)ba=hi[mi[ya]],Aa=ba.vertexColors,wa=ba.color,3===Aa.length&&fa===THREE.VertexColors?(Ga=Aa[0],Ha=Aa[1],Wa=Aa[2]):(Ga=wa,Ha=wa,Wa=wa),Wo[Uo]=Ga.r,Wo[Uo+1]=Ga.g,Wo[Uo+2]=Ga.b,Wo[Uo+3]=Ha.r,Wo[Uo+4]=Ha.g,Wo[Uo+5]=Ha.b,Wo[Uo+6]=Wa.r,Wo[Uo+7]=Wa.g,Wo[Uo+8]=Wa.b,Uo+=9;for(ya=0,_a=ui.length;ya<_a;ya++)ba=hi[ui[ya]],Aa=ba.vertexColors,wa=ba.color,4===Aa.length&&fa===THREE.VertexColors?(Ga=Aa[0],Ha=Aa[1],Wa=Aa[2],ja=Aa[3]):(Ga=wa,Ha=wa,Wa=wa,ja=wa),Wo[Uo]=Ga.r,Wo[Uo+1]=Ga.g,Wo[Uo+2]=Ga.b,Wo[Uo+3]=Ha.r,Wo[Uo+4]=Ha.g,Wo[Uo+5]=Ha.b,Wo[Uo+6]=Wa.r,Wo[Uo+7]=Wa.g,Wo[Uo+8]=Wa.b,Wo[Uo+9]=ja.r,Wo[Uo+10]=ja.g,Wo[Uo+11]=ja.b,Uo+=12;0<Uo&&(ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglColorBuffer),ir.bufferData(ir.ARRAY_BUFFER,Wo,ia))}if(si&&$o.hasTangents){for(ya=0,_a=mi.length;ya<_a;ya++)ba=hi[mi[ya]],Ea=ba.vertexTangents,Na=Ea[0],Fa=Ea[1],za=Ea[2],Ho[Po]=Na.x,Ho[Po+1]=Na.y,Ho[Po+2]=Na.z,Ho[Po+3]=Na.w,Ho[Po+4]=Fa.x,Ho[Po+5]=Fa.y,Ho[Po+6]=Fa.z,Ho[Po+7]=Fa.w,Ho[Po+8]=za.x,Ho[Po+9]=za.y,Ho[Po+10]=za.z,Ho[Po+11]=za.w,Po+=12;for(ya=0,_a=ui.length;ya<_a;ya++)ba=hi[ui[ya]],Ea=ba.vertexTangents,Na=Ea[0],Fa=Ea[1],za=Ea[2],Va=Ea[3],Ho[Po]=Na.x,Ho[Po+1]=Na.y,Ho[Po+2]=Na.z,Ho[Po+3]=Na.w,Ho[Po+4]=Fa.x,Ho[Po+5]=Fa.y,Ho[Po+6]=Fa.z,Ho[Po+7]=Fa.w,Ho[Po+8]=za.x,Ho[Po+9]=za.y,Ho[Po+10]=za.z,Ho[Po+11]=za.w,Ho[Po+12]=Va.x,Ho[Po+13]=Va.y,Ho[Po+14]=Va.z,Ho[Po+15]=Va.w,Po+=16;ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglTangentBuffer),ir.bufferData(ir.ARRAY_BUFFER,Ho,ia)}if(ni&&da){for(ya=0,_a=mi.length;ya<_a;ya++)if(ba=hi[mi[ya]],Sa=ba.vertexNormals,Ta=ba.normal,3===Sa.length&&ga)for(uo=0;3>uo;uo++)ho=Sa[uo],Go[Ro]=ho.x,Go[Ro+1]=ho.y,Go[Ro+2]=ho.z,Ro+=3;else for(uo=0;3>uo;uo++)Go[Ro]=Ta.x,Go[Ro+1]=Ta.y,Go[Ro+2]=Ta.z,Ro+=3;for(ya=0,_a=ui.length;ya<_a;ya++)if(ba=hi[ui[ya]],Sa=ba.vertexNormals,Ta=ba.normal,4===Sa.length&&ga)for(uo=0;4>uo;uo++)ho=Sa[uo],Go[Ro]=ho.x,Go[Ro+1]=ho.y,Go[Ro+2]=ho.z,Ro+=3;else for(uo=0;4>uo;uo++)Go[Ro]=Ta.x,Go[Ro+1]=Ta.y,Go[Ro+2]=Ta.z,Ro+=3;ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglNormalBuffer),ir.bufferData(ir.ARRAY_BUFFER,Go,ia)}if(oi&&gi&&ha){for(ya=0,_a=mi.length;ya<_a;ya++)if(xa=mi[ya],Ca=gi[xa],void 0!=Ca)for(uo=0;3>uo;uo++)go=Ca[uo],Bo[Eo]=go.x,Bo[Eo+1]=go.y,Eo+=2;for(ya=0,_a=ui.length;ya<_a;ya++)if(xa=ui[ya],Ca=gi[xa],void 0!==Ca)for(uo=0;4>uo;uo++)go=Ca[uo],Bo[Eo]=go.x,Bo[Eo+1]=go.y,Eo+=2;0<Eo&&(ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglUVBuffer),ir.bufferData(ir.ARRAY_BUFFER,Bo,ia))}if(oi&&yi&&ha){for(ya=0,_a=mi.length;ya<_a;ya++)if(xa=mi[ya],Da=yi[xa],void 0!=Da)for(uo=0;3>uo;uo++)yo=Da[uo],ko[Co]=yo.x,ko[Co+1]=yo.y,Co+=2;for(ya=0,_a=ui.length;ya<_a;ya++)if(xa=ui[ya],Da=yi[xa],void 0!==Da)for(uo=0;4>uo;uo++)yo=Da[uo],ko[Co]=yo.x,ko[Co+1]=yo.y,Co+=2;0<Co&&(ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglUV2Buffer),ir.bufferData(ir.ARRAY_BUFFER,ko,ia))}if(ti){for(ya=0,_a=mi.length;ya<_a;ya++)Zo[Do]=Ao,Zo[Do+1]=Ao+1,Zo[Do+2]=Ao+2,Do+=3,Jo[Lo]=Ao,Jo[Lo+1]=Ao+1,Jo[Lo+2]=Ao,Jo[Lo+3]=Ao+2,Jo[Lo+4]=Ao+1,Jo[Lo+5]=Ao+2,Lo+=6,Ao+=3;for(ya=0,_a=ui.length;ya<_a;ya++)Zo[Do]=Ao,Zo[Do+1]=Ao+1,Zo[Do+2]=Ao+3,Zo[Do+3]=Ao+1,Zo[Do+4]=Ao+2,Zo[Do+5]=Ao+3,Do+=6,Jo[Lo]=Ao,Jo[Lo+1]=Ao+1,Jo[Lo+2]=Ao,Jo[Lo+3]=Ao+3,Jo[Lo+4]=Ao+1,Jo[Lo+5]=Ao+2,Jo[Lo+6]=Ao+2,Jo[Lo+7]=Ao+3,Lo+=8,Ao+=4;ir.bindBuffer(ir.ELEMENT_ARRAY_BUFFER,aa.__webglFaceBuffer),ir.bufferData(ir.ELEMENT_ARRAY_BUFFER,Zo,ia),ir.bindBuffer(ir.ELEMENT_ARRAY_BUFFER,aa.__webglLineBuffer),ir.bufferData(ir.ELEMENT_ARRAY_BUFFER,Jo,ia)}if(Ko)for(uo=0,fo=Ko.length;uo<fo;uo++)if(Qo=Ko[uo],Qo.__original.needsUpdate){if(zo=0,Vo=0,1===Qo.size){if(void 0===Qo.boundTo||'vertices'===Qo.boundTo){for(ya=0,_a=mi.length;ya<_a;ya++)ba=hi[mi[ya]],Qo.array[zo]=Qo.value[ba.a],Qo.array[zo+1]=Qo.value[ba.b],Qo.array[zo+2]=Qo.value[ba.c],zo+=3;for(ya=0,_a=ui.length;ya<_a;ya++)ba=hi[ui[ya]],Qo.array[zo]=Qo.value[ba.a],Qo.array[zo+1]=Qo.value[ba.b],Qo.array[zo+2]=Qo.value[ba.c],Qo.array[zo+3]=Qo.value[ba.d],zo+=4}else if('faces'===Qo.boundTo){for(ya=0,_a=mi.length;ya<_a;ya++)Io=Qo.value[mi[ya]],Qo.array[zo]=Io,Qo.array[zo+1]=Io,Qo.array[zo+2]=Io,zo+=3;for(ya=0,_a=ui.length;ya<_a;ya++)Io=Qo.value[ui[ya]],Qo.array[zo]=Io,Qo.array[zo+1]=Io,Qo.array[zo+2]=Io,Qo.array[zo+3]=Io,zo+=4}}else if(2===Qo.size){if(void 0===Qo.boundTo||'vertices'===Qo.boundTo){for(ya=0,_a=mi.length;ya<_a;ya++)ba=hi[mi[ya]],Ra=Qo.value[ba.a],Pa=Qo.value[ba.b],La=Qo.value[ba.c],Qo.array[zo]=Ra.x,Qo.array[zo+1]=Ra.y,Qo.array[zo+2]=Pa.x,Qo.array[zo+3]=Pa.y,Qo.array[zo+4]=La.x,Qo.array[zo+5]=La.y,zo+=6;for(ya=0,_a=ui.length;ya<_a;ya++)ba=hi[ui[ya]],Ra=Qo.value[ba.a],Pa=Qo.value[ba.b],La=Qo.value[ba.c],Ua=Qo.value[ba.d],Qo.array[zo]=Ra.x,Qo.array[zo+1]=Ra.y,Qo.array[zo+2]=Pa.x,Qo.array[zo+3]=Pa.y,Qo.array[zo+4]=La.x,Qo.array[zo+5]=La.y,Qo.array[zo+6]=Ua.x,Qo.array[zo+7]=Ua.y,zo+=8}else if('faces'===Qo.boundTo){for(ya=0,_a=mi.length;ya<_a;ya++)Io=Qo.value[mi[ya]],Ra=Io,Pa=Io,La=Io,Qo.array[zo]=Ra.x,Qo.array[zo+1]=Ra.y,Qo.array[zo+2]=Pa.x,Qo.array[zo+3]=Pa.y,Qo.array[zo+4]=La.x,Qo.array[zo+5]=La.y,zo+=6;for(ya=0,_a=ui.length;ya<_a;ya++)Io=Qo.value[ui[ya]],Ra=Io,Pa=Io,La=Io,Ua=Io,Qo.array[zo]=Ra.x,Qo.array[zo+1]=Ra.y,Qo.array[zo+2]=Pa.x,Qo.array[zo+3]=Pa.y,Qo.array[zo+4]=La.x,Qo.array[zo+5]=La.y,Qo.array[zo+6]=Ua.x,Qo.array[zo+7]=Ua.y,zo+=8}}else if(3===Qo.size){var Ti;if(Ti='c'===Qo.type?['r','g','b']:['x','y','z'],void 0===Qo.boundTo||'vertices'===Qo.boundTo){for(ya=0,_a=mi.length;ya<_a;ya++)ba=hi[mi[ya]],Ra=Qo.value[ba.a],Pa=Qo.value[ba.b],La=Qo.value[ba.c],Qo.array[zo]=Ra[Ti[0]],Qo.array[zo+1]=Ra[Ti[1]],Qo.array[zo+2]=Ra[Ti[2]],Qo.array[zo+3]=Pa[Ti[0]],Qo.array[zo+4]=Pa[Ti[1]],Qo.array[zo+5]=Pa[Ti[2]],Qo.array[zo+6]=La[Ti[0]],Qo.array[zo+7]=La[Ti[1]],Qo.array[zo+8]=La[Ti[2]],zo+=9;for(ya=0,_a=ui.length;ya<_a;ya++)ba=hi[ui[ya]],Ra=Qo.value[ba.a],Pa=Qo.value[ba.b],La=Qo.value[ba.c],Ua=Qo.value[ba.d],Qo.array[zo]=Ra[Ti[0]],Qo.array[zo+1]=Ra[Ti[1]],Qo.array[zo+2]=Ra[Ti[2]],Qo.array[zo+3]=Pa[Ti[0]],Qo.array[zo+4]=Pa[Ti[1]],Qo.array[zo+5]=Pa[Ti[2]],Qo.array[zo+6]=La[Ti[0]],Qo.array[zo+7]=La[Ti[1]],Qo.array[zo+8]=La[Ti[2]],Qo.array[zo+9]=Ua[Ti[0]],Qo.array[zo+10]=Ua[Ti[1]],Qo.array[zo+11]=Ua[Ti[2]],zo+=12}else if('faces'===Qo.boundTo){for(ya=0,_a=mi.length;ya<_a;ya++)Io=Qo.value[mi[ya]],Ra=Io,Pa=Io,La=Io,Qo.array[zo]=Ra[Ti[0]],Qo.array[zo+1]=Ra[Ti[1]],Qo.array[zo+2]=Ra[Ti[2]],Qo.array[zo+3]=Pa[Ti[0]],Qo.array[zo+4]=Pa[Ti[1]],Qo.array[zo+5]=Pa[Ti[2]],Qo.array[zo+6]=La[Ti[0]],Qo.array[zo+7]=La[Ti[1]],Qo.array[zo+8]=La[Ti[2]],zo+=9;for(ya=0,_a=ui.length;ya<_a;ya++)Io=Qo.value[ui[ya]],Ra=Io,Pa=Io,La=Io,Ua=Io,Qo.array[zo]=Ra[Ti[0]],Qo.array[zo+1]=Ra[Ti[1]],Qo.array[zo+2]=Ra[Ti[2]],Qo.array[zo+3]=Pa[Ti[0]],Qo.array[zo+4]=Pa[Ti[1]],Qo.array[zo+5]=Pa[Ti[2]],Qo.array[zo+6]=La[Ti[0]],Qo.array[zo+7]=La[Ti[1]],Qo.array[zo+8]=La[Ti[2]],Qo.array[zo+9]=Ua[Ti[0]],Qo.array[zo+10]=Ua[Ti[1]],Qo.array[zo+11]=Ua[Ti[2]],zo+=12}else if('faceVertices'===Qo.boundTo){for(ya=0,_a=mi.length;ya<_a;ya++)Io=Qo.value[mi[ya]],Ra=Io[0],Pa=Io[1],La=Io[2],Qo.array[zo]=Ra[Ti[0]],Qo.array[zo+1]=Ra[Ti[1]],Qo.array[zo+2]=Ra[Ti[2]],Qo.array[zo+3]=Pa[Ti[0]],Qo.array[zo+4]=Pa[Ti[1]],Qo.array[zo+5]=Pa[Ti[2]],Qo.array[zo+6]=La[Ti[0]],Qo.array[zo+7]=La[Ti[1]],Qo.array[zo+8]=La[Ti[2]],zo+=9;for(ya=0,_a=ui.length;ya<_a;ya++)Io=Qo.value[ui[ya]],Ra=Io[0],Pa=Io[1],La=Io[2],Ua=Io[3],Qo.array[zo]=Ra[Ti[0]],Qo.array[zo+1]=Ra[Ti[1]],Qo.array[zo+2]=Ra[Ti[2]],Qo.array[zo+3]=Pa[Ti[0]],Qo.array[zo+4]=Pa[Ti[1]],Qo.array[zo+5]=Pa[Ti[2]],Qo.array[zo+6]=La[Ti[0]],Qo.array[zo+7]=La[Ti[1]],Qo.array[zo+8]=La[Ti[2]],Qo.array[zo+9]=Ua[Ti[0]],Qo.array[zo+10]=Ua[Ti[1]],Qo.array[zo+11]=Ua[Ti[2]],zo+=12}}else if(4===Qo.size)if(void 0===Qo.boundTo||'vertices'===Qo.boundTo){for(ya=0,_a=mi.length;ya<_a;ya++)ba=hi[mi[ya]],Ra=Qo.value[ba.a],Pa=Qo.value[ba.b],La=Qo.value[ba.c],Qo.array[zo]=Ra.x,Qo.array[zo+1]=Ra.y,Qo.array[zo+2]=Ra.z,Qo.array[zo+3]=Ra.w,Qo.array[zo+4]=Pa.x,Qo.array[zo+5]=Pa.y,Qo.array[zo+6]=Pa.z,Qo.array[zo+7]=Pa.w,Qo.array[zo+8]=La.x,Qo.array[zo+9]=La.y,Qo.array[zo+10]=La.z,Qo.array[zo+11]=La.w,zo+=12;for(ya=0,_a=ui.length;ya<_a;ya++)ba=hi[ui[ya]],Ra=Qo.value[ba.a],Pa=Qo.value[ba.b],La=Qo.value[ba.c],Ua=Qo.value[ba.d],Qo.array[zo]=Ra.x,Qo.array[zo+1]=Ra.y,Qo.array[zo+2]=Ra.z,Qo.array[zo+3]=Ra.w,Qo.array[zo+4]=Pa.x,Qo.array[zo+5]=Pa.y,Qo.array[zo+6]=Pa.z,Qo.array[zo+7]=Pa.w,Qo.array[zo+8]=La.x,Qo.array[zo+9]=La.y,Qo.array[zo+10]=La.z,Qo.array[zo+11]=La.w,Qo.array[zo+12]=Ua.x,Qo.array[zo+13]=Ua.y,Qo.array[zo+14]=Ua.z,Qo.array[zo+15]=Ua.w,zo+=16}else if('faces'===Qo.boundTo){for(ya=0,_a=mi.length;ya<_a;ya++)Io=Qo.value[mi[ya]],Ra=Io,Pa=Io,La=Io,Qo.array[zo]=Ra.x,Qo.array[zo+1]=Ra.y,Qo.array[zo+2]=Ra.z,Qo.array[zo+3]=Ra.w,Qo.array[zo+4]=Pa.x,Qo.array[zo+5]=Pa.y,Qo.array[zo+6]=Pa.z,Qo.array[zo+7]=Pa.w,Qo.array[zo+8]=La.x,Qo.array[zo+9]=La.y,Qo.array[zo+10]=La.z,Qo.array[zo+11]=La.w,zo+=12;for(ya=0,_a=ui.length;ya<_a;ya++)Io=Qo.value[ui[ya]],Ra=Io,Pa=Io,La=Io,Ua=Io,Qo.array[zo]=Ra.x,Qo.array[zo+1]=Ra.y,Qo.array[zo+2]=Ra.z,Qo.array[zo+3]=Ra.w,Qo.array[zo+4]=Pa.x,Qo.array[zo+5]=Pa.y,Qo.array[zo+6]=Pa.z,Qo.array[zo+7]=Pa.w,Qo.array[zo+8]=La.x,Qo.array[zo+9]=La.y,Qo.array[zo+10]=La.z,Qo.array[zo+11]=La.w,Qo.array[zo+12]=Ua.x,Qo.array[zo+13]=Ua.y,Qo.array[zo+14]=Ua.z,Qo.array[zo+15]=Ua.w,zo+=16}else if('faceVertices'===Qo.boundTo){for(ya=0,_a=mi.length;ya<_a;ya++)Io=Qo.value[mi[ya]],Ra=Io[0],Pa=Io[1],La=Io[2],Qo.array[zo]=Ra.x,Qo.array[zo+1]=Ra.y,Qo.array[zo+2]=Ra.z,Qo.array[zo+3]=Ra.w,Qo.array[zo+4]=Pa.x,Qo.array[zo+5]=Pa.y,Qo.array[zo+6]=Pa.z,Qo.array[zo+7]=Pa.w,Qo.array[zo+8]=La.x,Qo.array[zo+9]=La.y,Qo.array[zo+10]=La.z,Qo.array[zo+11]=La.w,zo+=12;for(ya=0,_a=ui.length;ya<_a;ya++)Io=Qo.value[ui[ya]],Ra=Io[0],Pa=Io[1],La=Io[2],Ua=Io[3],Qo.array[zo]=Ra.x,Qo.array[zo+1]=Ra.y,Qo.array[zo+2]=Ra.z,Qo.array[zo+3]=Ra.w,Qo.array[zo+4]=Pa.x,Qo.array[zo+5]=Pa.y,Qo.array[zo+6]=Pa.z,Qo.array[zo+7]=Pa.w,Qo.array[zo+8]=La.x,Qo.array[zo+9]=La.y,Qo.array[zo+10]=La.z,Qo.array[zo+11]=La.w,Qo.array[zo+12]=Ua.x,Qo.array[zo+13]=Ua.y,Qo.array[zo+14]=Ua.z,Qo.array[zo+15]=Ua.w,zo+=16}ir.bindBuffer(ir.ARRAY_BUFFER,Qo.buffer),ir.bufferData(ir.ARRAY_BUFFER,Qo.array,ia)}sa&&(delete aa.__inittedArrays,delete aa.__colorArray,delete aa.__normalArray,delete aa.__tangentArray,delete aa.__uvArray,delete aa.__uv2Array,delete aa.__faceArray,delete aa.__vertexArray,delete aa.__lineArray,delete aa.__skinIndexArray,delete aa.__skinWeightArray)}}function X(aa,oa,ia){var sa=aa.attributes,la,da;for(la in sa)da=sa[la],da.needsUpdate&&('index'===la?(ir.bindBuffer(ir.ELEMENT_ARRAY_BUFFER,da.buffer),ir.bufferData(ir.ELEMENT_ARRAY_BUFFER,da.array,oa)):(ir.bindBuffer(ir.ARRAY_BUFFER,da.buffer),ir.bufferData(ir.ARRAY_BUFFER,da.array,oa)),da.needsUpdate=!1),ia&&!da.dynamic&&delete da.array}function Y(aa){Qt[aa]||(ir.enableVertexAttribArray(aa),Qt[aa]=!0)}function K(){for(var aa in Hr&&(ir.bindVertexArray(null),Hr=null),Qt)Qt[aa]&&(ir.disableVertexAttribArray(aa),Qt[aa]=!1)}function Q(aa,oa,ia,sa){function la(Ta,Ma){if(aa.morphTargets_dependency){if(aa.morphTargets_dependency[Ta[1]]&&!aa.morphTargets_dependency[Ma[1]])return-1;if(!aa.morphTargets_dependency[Ta[1]]&&aa.morphTargets_dependency[Ma[1]])return 1}return Ma[0]-Ta[0]}var da=aa.program.attributes;if(sa&&(-1!==ia.morphTargetBase&&0<=da.position?(ir.bindBuffer(ir.ARRAY_BUFFER,oa.__webglMorphTargetsBuffers[ia.morphTargetBase]),Y(da.position),ir.vertexAttribPointer(da.position,3,ir.FLOAT,!1,0,0)):0<=da.position&&(ir.bindBuffer(ir.ARRAY_BUFFER,oa.__webglVertexBuffer),Y(da.position),ir.vertexAttribPointer(da.position,3,ir.FLOAT,!1,0,0))),ia.morphTargetForcedOrder.length)for(var fa=0,ha=ia.morphTargetForcedOrder,ga=ia.morphTargetInfluences;fa<aa.numSupportedMorphTargets&&fa<ha.length;)0<=da['morphTarget'+fa]&&(ir.bindBuffer(ir.ARRAY_BUFFER,oa.__webglMorphTargetsBuffers[ha[fa]]),Y(da['morphTarget'+fa]),ir.vertexAttribPointer(da['morphTarget'+fa],3,ir.FLOAT,!1,0,0)),0<=da['morphNormal'+fa]&&aa.morphNormals&&(ir.bindBuffer(ir.ARRAY_BUFFER,oa.__webglMorphNormalsBuffers[ha[fa]]),Y(da['morphNormal'+fa]),ir.vertexAttribPointer(da['morphNormal'+fa],3,ir.FLOAT,!1,0,0)),ia.__webglMorphTargetInfluences[fa]=ga[ha[fa]],fa++;else{var _a=[],ga=ia.morphTargetInfluences,ba=ga.length,ya,xa;for(xa=0;xa<ba;xa++)ya=ga[xa],0<ya&&_a.push([ya,xa]);_a.length>aa.numSupportedMorphTargets?(_a.sort(la),_a.length=aa.numSupportedMorphTargets):_a.length>aa.numSupportedMorphNormals?_a.sort(la):0===_a.length&&_a.push([0,0]);for(var fa=0,Sa;fa<aa.numSupportedMorphTargets;)_a[fa]?(Sa=_a[fa][1],(!Hr||Hr.morph_state[fa]!=Sa)&&(Hr&&(Hr.morph_state[fa]=Sa),0<=da['morphTarget'+fa]&&(ir.bindBuffer(ir.ARRAY_BUFFER,oa.__webglMorphTargetsBuffers[Sa]),Y(da['morphTarget'+fa]),ir.vertexAttribPointer(da['morphTarget'+fa],3,ir.FLOAT,!1,0,0)),0<=da['morphNormal'+fa]&&aa.morphNormals&&(ir.bindBuffer(ir.ARRAY_BUFFER,oa.__webglMorphNormalsBuffers[Sa]),Y(da['morphNormal'+fa]),ir.vertexAttribPointer(da['morphNormal'+fa],3,ir.FLOAT,!1,0,0))),ia.__webglMorphTargetInfluences[fa]=ga[Sa]):ia.__webglMorphTargetInfluences[fa]=0,fa++}null!==aa.program.uniforms.morphTargetInfluences&&ir.uniform1fv(aa.program.uniforms.morphTargetInfluences,ia.__webglMorphTargetInfluences)}function Z(aa,oa){if(aa.renderOrder!==oa.renderOrder)return oa.z-aa.z;var ia=aa.opaque||aa.transparent,sa=oa.opaque||oa.transparent;return ia.program&&sa.program&&ia.program!==sa.program?ia.program.id-sa.program.id:aa.buffer.id==oa.buffer.id?ia.id===sa.id?aa.z===oa.z?aa.id-oa.id:oa.z-aa.z:ia.id-sa.id:aa.buffer.id-oa.buffer.id}function J(aa,oa){return aa.z===oa.z?aa.id-oa.id:oa.z-aa.z}function ee(aa,oa){return oa[0]-aa[0]}function oe(aa,oa,ia){if(aa.length)for(var sa=0,la=aa.length;sa<la;sa++)Mt=null,Ct=null,Ut=-1,Vt=-1,It=-1,Pt=-1,Lt=-1,Et=-1,wt=-1,ar=!0,aa[sa].render(oa,ia,Yt,Kt),Mt=null,Ct=null,Ut=-1,Vt=-1,It=-1,Pt=-1,Lt=-1,Et=-1,wt=-1,ar=!0}function ie(aa,oa,ia,sa,la,da,fa,ha){var ga,ya,_a,xa,ba,Sa,Ta;oa?(ba=aa.length-1,Sa=-1,Ta=-1):(ba=0,Sa=aa.length,Ta=1),Qr=aa,$r=Sa,Jr=Ta,ta=ha;for(var Ma=ba;Ma!==Sa;Ma+=Ta)if(Zr=Ma,ga=aa[Ma],ga.render){if(ya=ga.object,_a=ga.buffer,ha)xa=ha;else{if(xa=ga[ia],!xa)continue;fa&&bt.setBlending(xa.blending,xa.blendEquation,xa.blendSrc,xa.blendDst),bt.setDepthTest(xa.depthTest),bt.setDepthWrite(xa.depthWrite),Ge(xa.polygonOffset,xa.polygonOffsetFactor,xa.polygonOffsetUnits)}bt.setMaterialFaces(xa),_a instanceof THREE.BufferGeometry?bt.renderBufferDirect(sa,la,da,xa,_a,ya):bt.renderBuffer(sa,la,da,xa,_a,ya)}Hr&&(ir.bindVertexArray(null),Hr=null)}function ne(aa,oa,ia,sa,la,da,fa){for(var xa=0,ba=aa.length,ha,ga,ya;xa<ba;xa++)if(ha=aa[xa],ga=ha.object,ga.visible){if(fa)ya=fa;else{if(ya=ha[oa],!ya)continue;da&&bt.setBlending(ya.blending,ya.blendEquation,ya.blendSrc,ya.blendDst),bt.setDepthTest(ya.depthTest),bt.setDepthWrite(ya.depthWrite),Ge(ya.polygonOffset,ya.polygonOffsetFactor,ya.polygonOffsetUnits)}bt.renderImmediateObject(ia,sa,la,ya,ga)}}function se(aa){var oa=aa.object,ia=oa.material;ia.transparent?(aa.transparent=ia,aa.opaque=null):(aa.opaque=ia,aa.transparent=null)}function le(aa){var oa=aa.object,ia=aa.buffer,sa,la,da;da=oa.material,da instanceof THREE.MeshFaceMaterial?(la=ia.materialIndex,sa=da.materials[la],sa.transparent?(aa.transparent=sa,aa.opaque=null):(aa.opaque=sa,aa.transparent=null)):(sa=da,sa&&(sa.transparent?(aa.transparent=sa,aa.opaque=null):(aa.opaque=sa,aa.transparent=null)))}function pe(aa,oa,ia){var ya={},_a=aa.morphTargets.length,xa=aa.morphNormals.length,sa,la,da,fa,ha,ga;if(self.MMD_SA&&null!=ia){var ba=MMD_SA_options.model_para_obj_all[ia].morphTargets_length_fixed;null==ba&&(ba=MMD_SA_options.morphTargets_length_fixed),ba?_a=ba:_a&&MMD_SA.morphTargets_length_extra&&(_a+=MMD_SA.morphTargets_length_extra)}var Sa=oa instanceof THREE.MeshFaceMaterial;for(aa.geometryGroups={},sa=0,la=aa.faces.length;sa<la;sa++)da=aa.faces[sa],fa=Sa?da.materialIndex:0,void 0===ya[fa]&&(ya[fa]={hash:fa,counter:0}),ga=ya[fa].hash+'_'+ya[fa].counter,void 0===aa.geometryGroups[ga]&&(aa.geometryGroups[ga]={faces3:[],faces4:[],materialIndex:fa,vertices:0,numMorphTargets:_a,numMorphNormals:xa}),ha=da instanceof THREE.Face3?3:4,65535<aa.geometryGroups[ga].vertices+ha&&(ya[fa].counter+=1,ga=ya[fa].hash+'_'+ya[fa].counter,void 0===aa.geometryGroups[ga]&&(aa.geometryGroups[ga]={faces3:[],faces4:[],materialIndex:fa,vertices:0,numMorphTargets:_a,numMorphNormals:xa})),da instanceof THREE.Face3?aa.geometryGroups[ga].faces3.push(sa):aa.geometryGroups[ga].faces4.push(sa),aa.geometryGroups[ga].vertices+=ha;for(var Ta in aa.geometryGroupsList=[],aa.geometryGroups)aa.geometryGroups[Ta].id=Dt++,aa.geometryGroupsList.push(aa.geometryGroups[Ta])}function ue(aa,oa){var ia,sa,la,da;if(void 0===aa.__webglInit)if(aa.__webglInit=!0,aa._modelViewMatrix=new THREE.Matrix4,aa._normalMatrix=new THREE.Matrix3,void 0!==aa.geometry&&void 0===aa.geometry.__webglInit&&(aa.geometry.__webglInit=!0,aa.geometry.addEventListener('dispose',Fr)),sa=aa.geometry,void 0==sa);else if(sa instanceof THREE.BufferGeometry)O(sa);else if(aa instanceof THREE.Mesh)for(ia in la=aa.material,void 0===sa.geometryGroups&&pe(sa,la,aa._model_index),sa.geometryGroups)da=sa.geometryGroups[ia],da.__webglVertexBuffer||(A(da),L(da,aa),sa.verticesNeedUpdate=!0,sa.morphTargetsNeedUpdate=!0,sa.elementsNeedUpdate=!0,sa.uvsNeedUpdate=!0,sa.normalsNeedUpdate=!0,sa.tangentsNeedUpdate=!0,sa.colorsNeedUpdate=!0);else aa instanceof THREE.Ribbon?sa.__webglVertexBuffer||(M(sa),P(sa,aa),sa.verticesNeedUpdate=!0,sa.colorsNeedUpdate=!0,sa.normalsNeedUpdate=!0):aa instanceof THREE.Line?sa.__webglVertexBuffer||(T(sa),R(sa,aa),sa.verticesNeedUpdate=!0,sa.colorsNeedUpdate=!0,sa.lineDistancesNeedUpdate=!0):aa instanceof THREE.ParticleSystem&&(sa.__webglVertexBuffer||(S(sa),D(sa,aa),sa.verticesNeedUpdate=!0,sa.colorsNeedUpdate=!0));if(void 0===aa.__webglActive){if(!(aa instanceof THREE.Mesh))aa instanceof THREE.Ribbon||aa instanceof THREE.Line||aa instanceof THREE.ParticleSystem?(sa=aa.geometry,fe(oa.__webglObjects,sa,aa)):aa instanceof THREE.ImmediateRenderObject||aa.immediateRenderCallback?he(oa.__webglObjectsImmediate,aa):aa instanceof THREE.Sprite?oa.__webglSprites.push(aa):THREE.LensFlare&&aa instanceof THREE.LensFlare&&oa.__webglFlares.push(aa);else if(sa=aa.geometry,sa instanceof THREE.BufferGeometry)fe(oa.__webglObjects,sa,aa);else if(sa instanceof THREE.Geometry)for(ia in sa.geometryGroups)da=sa.geometryGroups[ia],fe(oa.__webglObjects,da,aa),null!=aa._model_index&&/^(\d+)/.test(ia)&&(oa.__webglObjects[oa.__webglObjects.length-1]._material_index=parseInt(RegExp.$1));aa.__webglActive=!0}}function fe(aa,oa,ia){aa.push({id:null,buffer:oa,object:ia,opaque:null,transparent:null,z:0})}function he(aa,oa){aa.push({id:null,object:oa,opaque:null,transparent:null,z:0})}function ge(aa){var oa=aa.geometry,ia,sa,la;if(oa instanceof THREE.BufferGeometry)X(oa,ir.DYNAMIC_DRAW,!oa.dynamic);else if(aa instanceof THREE.Mesh){for(var da=0,fa=oa.geometryGroupsList.length;da<fa;da++)ia=oa.geometryGroupsList[da],la=U(aa,ia),oa.buffersNeedUpdate&&L(ia,aa),sa=la.attributes&&ye(la),(oa.verticesNeedUpdate||oa.morphTargetsNeedUpdate||oa.elementsNeedUpdate||oa.uvsNeedUpdate||oa.normalsNeedUpdate||oa.colorsNeedUpdate||oa.tangentsNeedUpdate||sa)&&W(ia,aa,ir.DYNAMIC_DRAW,!oa.dynamic,la);oa.verticesNeedUpdate=!1,oa.morphTargetsNeedUpdate=!1,oa.elementsNeedUpdate=!1,oa.uvsNeedUpdate=!1,oa.normalsNeedUpdate=!1,oa.colorsNeedUpdate=!1,oa.tangentsNeedUpdate=!1,oa.buffersNeedUpdate=!1,la.attributes&&_e(la)}else aa instanceof THREE.Ribbon?(la=U(aa,oa),sa=la.attributes&&ye(la),(oa.verticesNeedUpdate||oa.colorsNeedUpdate||oa.normalsNeedUpdate||sa)&&H(oa,ir.DYNAMIC_DRAW),oa.verticesNeedUpdate=!1,oa.colorsNeedUpdate=!1,oa.normalsNeedUpdate=!1,la.attributes&&_e(la)):aa instanceof THREE.Line?(la=U(aa,oa),sa=la.attributes&&ye(la),(oa.verticesNeedUpdate||oa.colorsNeedUpdate||oa.lineDistancesNeedUpdate||sa)&&G(oa,ir.DYNAMIC_DRAW),oa.verticesNeedUpdate=!1,oa.colorsNeedUpdate=!1,oa.lineDistancesNeedUpdate=!1,la.attributes&&_e(la)):aa instanceof THREE.ParticleSystem&&(la=U(aa,oa),sa=la.attributes&&ye(la),(oa.verticesNeedUpdate||oa.colorsNeedUpdate||aa.sortParticles||sa)&&B(oa,ir.DYNAMIC_DRAW,aa),oa.verticesNeedUpdate=!1,oa.colorsNeedUpdate=!1,la.attributes&&_e(la))}function ye(aa){for(var oa in aa.attributes)if(aa.attributes[oa].needsUpdate)return!0;return!1}function _e(aa){for(var oa in aa.attributes)aa.attributes[oa].needsUpdate=!1}function xe(aa,oa){aa instanceof THREE.Mesh||aa instanceof THREE.ParticleSystem||aa instanceof THREE.Ribbon||aa instanceof THREE.Line?ve(oa.__webglObjects,aa):aa instanceof THREE.Sprite?Se(oa.__webglSprites,aa):THREE.LensFlare&&aa instanceof THREE.LensFlare?Se(oa.__webglFlares,aa):(aa instanceof THREE.ImmediateRenderObject||aa.immediateRenderCallback)&&ve(oa.__webglObjectsImmediate,aa),delete aa.__webglActive}function ve(aa,oa){for(var ia=aa.length-1;0<=ia;ia--)aa[ia].object===oa&&aa.splice(ia,1)}function Se(aa,oa){for(var ia=aa.length-1;0<=ia;ia--)aa[ia]===oa&&aa.splice(ia,1)}function Te(aa,oa){aa.uniforms=THREE.UniformsUtils.clone(oa.uniforms),aa.vertexShader=oa.vertexShader,aa.fragmentShader=oa.fragmentShader}function Me(aa,oa,ia,sa,la){Rt=0,sa.needsUpdate&&(sa.program&&Gr(sa),bt.initMaterial(sa,oa,ia,la),sa.needsUpdate=!1),sa.morphTargets&&!la.__webglMorphTargetInfluences&&(la.__webglMorphTargetInfluences=new Float32Array(bt.maxMorphTargets));var da=!1,fa=sa.program,ha=fa.uniforms,ga=sa.uniforms;if(fa!==Mt&&(ir.useProgram(fa),Mt=fa,da=!0),sa.id!==wt&&(wt=sa.id,da=!0),(da||aa!==Ct)&&(ir.uniformMatrix4fv(ha.projectionMatrix,!1,aa.projectionMatrix.elements),aa!==Ct&&(Ct=aa)),sa.skinning)if(!(_r&&la.useVertexTexture))null!==ha.boneGlobalMatrices&&ir.uniformMatrix4fv(ha.boneGlobalMatrices,!1,la.boneMatrices);else if(null!==ha.boneTexture){var ya=Fe();ir.uniform1i(ha.boneTexture,ya),bt.setTexture(la.boneTexture,ya)}if(da){if(ia&&sa.fog&&De(ga,ia),(sa instanceof THREE.MeshPhongMaterial||sa instanceof THREE.MeshLambertMaterial||sa.lights)&&(ar&&(Be(fa,oa),ar=!1),Le(ga,or)),(sa instanceof THREE.MeshBasicMaterial||sa instanceof THREE.MeshLambertMaterial||sa instanceof THREE.MeshPhongMaterial)&&Ae(ga,sa),sa instanceof THREE.LineBasicMaterial?we(ga,sa):sa instanceof THREE.LineDashedMaterial?(we(ga,sa),Ee(ga,sa)):sa instanceof THREE.ParticleBasicMaterial?Ce(ga,sa):sa instanceof THREE.MeshPhongMaterial?Re(ga,sa):sa instanceof THREE.MeshLambertMaterial?Pe(ga,sa):sa instanceof THREE.MeshDepthMaterial?(ga.mNear.value=aa.near,ga.mFar.value=aa.far,ga.opacity.value=sa.opacity):sa instanceof THREE.MeshNormalMaterial&&(ga.opacity.value=sa.opacity),la.receiveShadow&&!sa._shadowPass&&Ue(ga,oa),sa.uniTexture){let _a=la.geometry.boundingSphere;if(ga.uniTexture_state&&(ga.uniTexture_state.value=sa.uniTexture.state),ga.uniTexture_scale)if(la._uniTexture_scale)ga.uniTexture_scale.value=la._uniTexture_scale;else{let xa;if(la.material.materials&&null==la._model_index)xa=5/10;else{xa=1;for(let ba=la;ba&&!(ba instanceof THREE.Scene);)xa*=Math.max(ba.scale.x,ba.scale.y,ba.scale.z)||1,ba=ba.parent;xa=Math.min(5/xa,1),0.1>xa&&(xa*=2)}ga.uniTexture_scale.value=Math.min(Math.ceil(_a.radius/50),4)*xa*(sa.uniTexture.scale||1)}if(ga.uniTexture_bs&&(ga.uniTexture_bs.value=_a.radius),ga.uniTexture_null_zone&&MMD_SA.MMD_started){let xa=THREE.MMD.getModels()[0].mesh.position;ga.uniTexture_null_zone.value.set(xa.x,xa.y+10,xa.z,0==la._model_index?999:10)}ga.uniTexture_MatrixRain_height_limit&&ga.uniTexture_MatrixRain_height_limit.value.set(la._uniTexture_fadeout||0,_a.center.y),ga.uniTexture_map&&(ga.uniTexture_map.value=sa.uniTexture.map||MMD_SA.matrix_rain.matrix_texture)}sa.refreshUniforms&&sa.refreshUniforms(bt),ze(fa,sa.uniformsList),(sa instanceof THREE.ShaderMaterial||sa instanceof THREE.MeshPhongMaterial||sa.envMap)&&null!==ha.cameraPosition&&(er.getPositionFromMatrix(aa.matrixWorld),ir.uniform3f(ha.cameraPosition,er.x,er.y,er.z)),(sa instanceof THREE.MeshPhongMaterial||sa instanceof THREE.MeshLambertMaterial||sa instanceof THREE.ShaderMaterial||sa.skinning)&&null!==ha.viewMatrix&&ir.uniformMatrix4fv(ha.viewMatrix,!1,aa.matrixWorldInverse.elements)}return Ne(ha,la),null!==ha.modelMatrix&&ir.uniformMatrix4fv(ha.modelMatrix,!1,la.matrixWorld.elements),fa}function Ae(aa,oa){if(aa.opacity.value=oa.opacity,bt.gammaInput?aa.diffuse.value.copyGammaToLinear(oa.color):aa.diffuse.value=oa.color,aa.map.value=oa.map,aa.lightMap.value=oa.lightMap,aa.specularMap.value=oa.specularMap,oa.bumpMap&&(aa.bumpMap.value=oa.bumpMap,aa.bumpScale.value=oa.bumpScale),oa.displacementMap&&(aa.tDisplacement.value=oa.displacementMap,aa.uDisplacementBias.value=oa.uDisplacementBias,aa.uDisplacementScale.value=oa.uDisplacementScale,aa.uDisplacementCustomUVScale.value=oa.uDisplacementCustomUVScale,aa.uDisplacementCustomUVOffset.value.copy(oa.uDisplacementCustomUVOffset),aa.edgeRotateDisplacementL.value=oa.edgeRotateDisplacementL,aa.edgeRotateDisplacementR.value=oa.edgeRotateDisplacementR,aa.edgeScaleDisplacementU.value=oa.edgeScaleDisplacementU),null!=oa.waveBaseSpeed&&(aa.waveBaseSpeed.value=oa.waveBaseSpeed,aa.waveNoiseTexture.value=oa.waveNoiseTexture,aa.waveNoiseScale.value=oa.waveNoiseScale,aa.waveBumpScale.value=oa.waveBumpScale,aa.time.value=RAF_timestamp/1e3,aa.waveDrops.value=self.MMD_SA&&MMD_SA.ripple_process()||[]),null!=oa.mirrorTextureIndex){var ia=MMD_SA._THREE_mirror[oa.mirrorTextureIndex];ia&&(aa.mirrorSampler.value=ia.texture,aa.mirrorTextureMatrix.value=ia.textureMatrix),aa.reflection_alpha.value=!ia||MMD_SA._mirror_rendering_?0:ia.material.uniforms.reflection_alpha.value}oa.normalMap&&(aa.normalMap.value=oa.normalMap,aa.normalScale.value.copy(oa.normalScale));var sa;if(oa.repeat?sa=oa:oa.map?sa=oa.map:oa.specularMap?sa=oa.specularMap:oa.normalMap?sa=oa.normalMap:oa.bumpMap?sa=oa.bumpMap:oa.displacementMap?sa=oa.displacementMap:oa.waveNoiseTexture&&(sa=oa.waveNoiseTexture),void 0!=sa){var la=sa.offset,da=sa.repeat;aa.offsetRepeat.value.set(la.x,la.y,da.x,da.y)}aa.envMap.value=oa.envMap,aa.flipEnvMap.value=oa.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,aa.reflectivity.value=bt.gammaInput?oa.reflectivity:oa.reflectivity,aa.refractionRatio.value=oa.refractionRatio,aa.combine.value=oa.combine,aa.useRefract.value=oa.envMap&&oa.envMap.mapping instanceof THREE.CubeRefractionMapping}function we(aa,oa){aa.diffuse.value=oa.color,aa.opacity.value=oa.opacity}function Ee(aa,oa){aa.dashSize.value=oa.dashSize,aa.totalSize.value=oa.dashSize+oa.gapSize,aa.scale.value=oa.scale}function Ce(aa,oa){aa.psColor.value=oa.color,aa.opacity.value=oa.opacity,aa.size.value=oa.size,aa.scale.value=mt.height/2,aa.map.value=oa.map}function De(aa,oa){aa.fogColor.value=oa.color,oa instanceof THREE.Fog?(aa.fogNear.value=oa.near,aa.fogFar.value=oa.far):oa instanceof THREE.FogExp2&&(aa.fogDensity.value=oa.density)}function Re(aa,oa){aa.shininess.value=oa.shininess,bt.gammaInput?(aa.ambient.value.copyGammaToLinear(oa.ambient),aa.emissive.value.copyGammaToLinear(oa.emissive),aa.specular.value.copyGammaToLinear(oa.specular)):(aa.ambient.value=oa.ambient,aa.emissive.value=oa.emissive,aa.specular.value=oa.specular),oa.wrapAround&&aa.wrapRGB.value.copy(oa.wrapRGB)}function Pe(aa,oa){bt.gammaInput?(aa.ambient.value.copyGammaToLinear(oa.ambient),aa.emissive.value.copyGammaToLinear(oa.emissive)):(aa.ambient.value=oa.ambient,aa.emissive.value=oa.emissive),oa.wrapAround&&aa.wrapRGB.value.copy(oa.wrapRGB)}function Le(aa,oa){aa.ambientLightColor.value=oa.ambient,aa.directionalLightColor.value=oa.directional.colors,aa.directionalLightDirection.value=oa.directional.positions,aa.pointLightColor.value=oa.point.colors,aa.pointLightPosition.value=oa.point.positions,aa.pointLightDistance.value=oa.point.distances,aa.spotLightColor.value=oa.spot.colors,aa.spotLightPosition.value=oa.spot.positions,aa.spotLightDistance.value=oa.spot.distances,aa.spotLightDirection.value=oa.spot.directions,aa.spotLightAngleCos.value=oa.spot.anglesCos,aa.spotLightExponent.value=oa.spot.exponents,aa.hemisphereLightSkyColor.value=oa.hemi.skyColors,aa.hemisphereLightGroundColor.value=oa.hemi.groundColors,aa.hemisphereLightDirection.value=oa.hemi.positions}function Ue(aa,oa){if(aa.shadowMatrix)for(var ia=0,sa=0,la=oa.length,da;sa<la;sa++)da=oa[sa],da.castShadow&&(da instanceof THREE.SpotLight||da instanceof THREE.DirectionalLight&&!da.shadowCascade?(aa.shadowMap.value[ia]=da.shadowMap,aa.shadowMapSize.value[ia]=da.shadowMapSize,aa.shadowMatrix.value[ia]=da.shadowMatrix,aa.shadowDarkness.value[ia]=da.shadowDarkness,aa.shadowBias.value[ia]=da._shadowBias_range,aa.shadowPara.value[ia]=da._shadowPara,ia++):da instanceof THREE.DirectionalLight&&da.shadowCascadeArray&&da.shadowCascadeArray.forEach(function(ya){aa.shadowMap.value[ia]=ya.shadowMap,aa.shadowMapSize.value[ia]=ya.shadowMapSize,aa.shadowMatrix.value[ia]=ya.shadowMatrix,aa.shadowDarkness.value[ia]=ya.shadowDarkness,aa.shadowBias.value[ia]=ya._shadowBias_range,aa.shadowPara.value[ia]=ya._shadowPara,ia++}))}function Ne(aa,oa){aa.modelViewMatrix&&ir.uniformMatrix4fv(aa.modelViewMatrix,!1,oa._modelViewMatrix.elements),aa.normalMatrix&&ir.uniformMatrix3fv(aa.normalMatrix,!1,oa._normalMatrix.elements)}function Fe(){var aa=Rt;return aa>=mr&&console.warn('WebGLRenderer: trying to use '+aa+' texture units while this GPU supports only '+mr),Rt+=1,aa}function ze(aa,oa){var ia,sa,la,da,fa,ha,ga,ya,_a,xa,ba;for(_a=0,xa=oa.length;_a<xa;_a++)if(da=aa.uniforms[oa[_a][1]],da)if(ia=oa[_a][0],la=ia.type,sa=ia.value,'i'===la)ir.uniform1i(da,sa);else if('f'===la)ir.uniform1f(da,sa);else if('v2'===la)ir.uniform2f(da,sa.x,sa.y);else if('v3'===la)ir.uniform3f(da,sa.x,sa.y,sa.z);else if('v4'===la)ir.uniform4f(da,sa.x,sa.y,sa.z,sa.w);else if('c'===la)ir.uniform3f(da,sa.r,sa.g,sa.b);else if('iv1'===la)ir.uniform1iv(da,sa);else if('iv'===la)ir.uniform3iv(da,sa);else if('fv1'===la||'1fv'===la)ir.uniform1fv(da,sa);else if('fv'===la)ir.uniform3fv(da,sa);else if('v2v'===la){for(void 0===ia._array&&(ia._array=new Float32Array(2*sa.length)),ga=0,ya=sa.length;ga<ya;ga++)ba=2*ga,ia._array[ba]=sa[ga].x,ia._array[ba+1]=sa[ga].y;ir.uniform2fv(da,ia._array)}else if('v3v'===la){for(void 0===ia._array&&(ia._array=new Float32Array(3*sa.length)),ga=0,ya=sa.length;ga<ya;ga++)ba=3*ga,ia._array[ba]=sa[ga].x,ia._array[ba+1]=sa[ga].y,ia._array[ba+2]=sa[ga].z;ir.uniform3fv(da,ia._array)}else if('v4v'===la){for(void 0===ia._array&&(ia._array=new Float32Array(4*sa.length)),ga=0,ya=sa.length;ga<ya;ga++)ba=4*ga,ia._array[ba]=sa[ga].x,ia._array[ba+1]=sa[ga].y,ia._array[ba+2]=sa[ga].z,ia._array[ba+3]=sa[ga].w;ir.uniform4fv(da,ia._array)}else if('m4'===la)void 0===ia._array&&(ia._array=new Float32Array(16)),sa.flattenToArray(ia._array),ir.uniformMatrix4fv(da,!1,ia._array);else if('m4v'===la){for(void 0===ia._array&&(ia._array=new Float32Array(16*sa.length)),ga=0,ya=sa.length;ga<ya;ga++)sa[ga].flattenToArrayOffset(ia._array,16*ga);ir.uniformMatrix4fv(da,!1,ia._array)}else if('t'===la){if(fa=sa,ha=Fe(),ir.uniform1i(da,ha),!fa)continue;fa.image instanceof Array&&6===fa.image.length?$e(fa,ha):fa instanceof THREE.WebGLRenderTargetCube?et(fa,ha):bt.setTexture(fa,ha)}else if('tv'===la){for(void 0===ia._array&&(ia._array=[]),ga=0,ya=ia.value.length;ga<ya;ga++)ia._array[ga]=Fe();for(ir.uniform1iv(da,ia._array),ga=0,ya=ia.value.length;ga<ya;ga++)fa=ia.value[ga],ha=ia._array[ga],fa&&bt.setTexture(fa,ha)}}function Ve(aa,oa){aa._modelViewMatrix.multiplyMatrices(oa.matrixWorldInverse,aa.matrixWorld),aa._normalMatrix.getNormalMatrix(aa._modelViewMatrix)}function Ie(aa,oa,ia,sa){aa[oa]=ia.r*ia.r*sa,aa[oa+1]=ia.g*ia.g*sa,aa[oa+2]=ia.b*ia.b*sa}function Oe(aa,oa,ia,sa){aa[oa]=ia.r*sa,aa[oa+1]=ia.g*sa,aa[oa+2]=ia.b*sa}function Be(aa,oa){var fa=0,ha=0,ga=0,Aa=or,wa=Aa.directional.colors,Ea=Aa.directional.positions,Ca=Aa.point.colors,Da=Aa.point.positions,Ra=Aa.point.distances,Pa=Aa.spot.colors,La=Aa.spot.positions,Ua=Aa.spot.distances,Na=Aa.spot.directions,Fa=Aa.spot.anglesCos,za=Aa.spot.exponents,Va=Aa.hemi.skyColors,Ia=Aa.hemi.groundColors,Oa=Aa.hemi.positions,Ba=0,ka=0,Ga=0,Ha=0,Wa=0,ja=0,Xa=0,Ya=0,Ka=0,Qa=0,Za=0,Ja=0,ia,sa,la,ya,_a,xa,ba,Sa,Ma;for(ia=0,sa=oa.length;ia<sa;ia++)if(la=oa[ia],!la.onlyShadow)if(ya=la.color,ba=la.intensity,Ma=la.distance,la instanceof THREE.AmbientLight){if(!la.visible)continue;bt.gammaInput?(fa+=ya.r*ya.r,ha+=ya.g*ya.g,ga+=ya.b*ya.b):(fa+=ya.r,ha+=ya.g,ga+=ya.b)}else if(la instanceof THREE.DirectionalLight){if(Wa+=1,!la.visible)continue;if(rr.getPositionFromMatrix(la.matrixWorld),er.getPositionFromMatrix(la.target.matrixWorld),rr.sub(er),rr.normalize(),0===rr.x&&0===rr.y&&0===rr.z)continue;Ka=3*Ba,Ea[Ka]=rr.x,Ea[Ka+1]=rr.y,Ea[Ka+2]=rr.z,bt.gammaInput?Ie(wa,Ka,ya,ba*ba):Oe(wa,Ka,ya,ba),Ba+=1}else if(la instanceof THREE.PointLight){if(ja+=1,!la.visible)continue;Qa=3*ka,bt.gammaInput?Ie(Ca,Qa,ya,ba*ba):Oe(Ca,Qa,ya,ba),er.getPositionFromMatrix(la.matrixWorld),Da[Qa]=er.x,Da[Qa+1]=er.y,Da[Qa+2]=er.z,Ra[ka]=Ma,ka+=1}else if(la instanceof THREE.SpotLight){if(Xa+=1,!la.visible)continue;Za=3*Ga,bt.gammaInput?Ie(Pa,Za,ya,ba*ba):Oe(Pa,Za,ya,ba),er.getPositionFromMatrix(la.matrixWorld),La[Za]=er.x,La[Za+1]=er.y,La[Za+2]=er.z,Ua[Ga]=Ma,rr.copy(er),er.getPositionFromMatrix(la.target.matrixWorld),rr.sub(er),rr.normalize(),Na[Za]=rr.x,Na[Za+1]=rr.y,Na[Za+2]=rr.z,Fa[Ga]=Math.cos(la.angle),za[Ga]=la.exponent,Ga+=1}else if(la instanceof THREE.HemisphereLight){if(Ya+=1,!la.visible)continue;if(rr.getPositionFromMatrix(la.matrixWorld),rr.normalize(),0===rr.x&&0===rr.y&&0===rr.z)continue;Ja=3*Ha,Oa[Ja]=rr.x,Oa[Ja+1]=rr.y,Oa[Ja+2]=rr.z,_a=la.color,xa=la.groundColor,bt.gammaInput?(Sa=ba*ba,Ie(Va,Ja,_a,Sa),Ie(Ia,Ja,xa,Sa)):(Oe(Va,Ja,_a,ba),Oe(Ia,Ja,xa,ba)),Ha+=1}for(ia=3*Ba,sa=Math.max(wa.length,3*Wa);ia<sa;ia++)wa[ia]=0;for(ia=3*ka,sa=Math.max(Ca.length,3*ja);ia<sa;ia++)Ca[ia]=0;for(ia=3*Ga,sa=Math.max(Pa.length,3*Xa);ia<sa;ia++)Pa[ia]=0;for(ia=3*Ha,sa=Math.max(Va.length,3*Ya);ia<sa;ia++)Va[ia]=0;for(ia=3*Ha,sa=Math.max(Ia.length,3*Ya);ia<sa;ia++)Ia[ia]=0;Aa.directional.length=Ba,Aa.point.length=ka,Aa.spot.length=Ga,Aa.hemi.length=Ha,Aa.ambient[0]=fa,Aa.ambient[1]=ha,Aa.ambient[2]=ga}function ke(aa){aa!==Gt&&(ir.lineWidth(aa),Gt=aa)}function Ge(aa,oa,ia){Ot!==aa&&(aa?ir.enable(ir.POLYGON_OFFSET_FILL):ir.disable(ir.POLYGON_OFFSET_FILL),Ot=aa),aa&&(Bt!==oa||kt!==ia)&&(ir.polygonOffset(oa,ia),Bt=oa,kt=ia)}function He(aa){var sa=[],oa,ia;for(var la in aa)oa=aa[la],!1===oa||(ia='#define '+la+' '+oa,sa.push(ia));return sa.join('\n')}function We(aa){var ia=/#pragma unroll_loop[\s]+?for[\s]*\([\s]*int i[\s]*\=[\s]*(\d+)\;[\s]i[\s]<[\s](\w+)\;[\s]i[\s]\+\+[\s]\)[\s]\{\/\/LOOP_START([\s\S]+?)(?=\})\}\/\/LOOP_END/g;return aa.replace(ia,function(sa,la,da,fa){var ha='';if(/^\D/.test(da)){let ya=new RegExp('\\#define '+da+' (\\d+)');ya.test(aa)&&(da=RegExp.$1)}for(var ga=parseInt(la);ga<parseInt(da);ga++)ha+=fa.replace(/\[[\s]*i[\s]*\]/g,'[ '+ga+' ]');return ha})}function je(aa,oa,ia,sa,la,da,fa){var ba=[],Sa=['instance_index','modelViewMatrix'],Ta=['_modelMatrix','_normalMatrix'],ha,ga,ya,_a,xa;if(fa.instanced_drawing){aa=null;let Fa=[];Ta.forEach(function(za){let Va='_normalMatrix'==za?'mat3':'mat4';Fa.push(Va+' '+za.substring(1)+'='+za+'[int(instance_index)];')}),ia=ia.replace(/void main\(\)\s?\{/,'void main() {\n'+Fa.join('\n')+'\n')}for(ya in aa?ba.push(aa):(ba.push(oa),ba.push(ia)),da)ba.push(ya),ba.push(da[ya]);for(ha in fa)ba.push(ha),ba.push(fa[ha]);for(xa=ba.join(),ha=0,ga=St.length;ha<ga;ha++){var Ma=St[ha];if(Ma.code===xa)return Ma.usedTimes++,Ma.program}var Aa='SHADOWMAP_TYPE_BASIC';fa.shadowMapType===THREE.PCFShadowMap?Aa='SHADOWMAP_TYPE_PCF':fa.shadowMapType===THREE.PCFSoftShadowMap&&(Aa='SHADOWMAP_TYPE_PCF_SOFT');var wa=He(da);_a=ir.createProgram();var Ea=['precision '+ut+' float;',wa,yr?'#define VERTEX_TEXTURES':'',bt.gammaInput?'#define GAMMA_INPUT':'',bt.gammaOutput?'#define GAMMA_OUTPUT':'',bt.physicallyBasedShading?'#define PHYSICALLY_BASED_SHADING':'','#define MAX_DIR_LIGHTS '+fa.maxDirLights,'#define MAX_POINT_LIGHTS '+fa.maxPointLights,'#define MAX_SPOT_LIGHTS '+fa.maxSpotLights,'#define MAX_HEMI_LIGHTS '+fa.maxHemiLights,'#define MAX_SHADOWS '+fa.maxShadows,'#define MAX_BONES '+fa.maxBones,fa.map?'#define USE_MAP':'',fa.envMap?'#define USE_ENVMAP':'',fa.lightMap?'#define USE_LIGHTMAP':'',fa.bumpMap?'#define USE_BUMPMAP':'',fa.displacementMap?'#define USE_DISPLACEMENTMAP':'',fa.waveTexture?'#define USE_WAVE_TEXTURE':'',fa.waveTexture?'#define RIPPLE_MAX '+(self.MMD_SA&&MMD_SA_options.ripple_max||20):'',fa.waveTexture?'#define RIPPLE_RANGE '+(self.MMD_SA&&MMD_SA_options.ripple_range||128)+'.0':'',fa.mirrorTexture?'#define USE_MIRROR_TEXTURE':'',fa.uniTexture?'#define USE_UNI_TEXTURE':'',fa.normalMap?'#define USE_NORMALMAP':'',fa.specularMap?'#define USE_SPECULARMAP':'',fa.vertexColors?'#define USE_COLOR':'',fa.skinning?'#define USE_SKINNING':'',fa.useVertexTexture?'#define BONE_TEXTURE':'',fa.boneTextureWidth?'#define N_BONE_PIXEL_X '+fa.boneTextureWidth.toFixed(1):'',fa.boneTextureHeight?'#define N_BONE_PIXEL_Y '+fa.boneTextureHeight.toFixed(1):'',fa.morphTargets?'#define USE_MORPHTARGETS':'',fa.morphNormals?'#define USE_MORPHNORMALS':'',fa.perPixel?'#define PHONG_PER_PIXEL':'',fa.wrapAround?'#define WRAP_AROUND':'',fa.doubleSided?'#define DOUBLE_SIDED':'',fa.flipSided?'#define FLIP_SIDED':'',fa.shadowMapEnabled?'#define USE_SHADOWMAP':'',fa.shadowMapEnabled?'#define '+Aa:'',fa.shadowMapDebug?'#define SHADOWMAP_DEBUG':'',fa.shadowMapCascade?'#define SHADOWMAP_CASCADE':'',fa.sizeAttenuation?'#define USE_SIZEATTENUATION':'',fa.instanced_drawing?'#define INSTANCED_DRAWING '+fa.instanced_drawing:'','#ifdef INSTANCED_DRAWING','attribute float instance_index;',-1==Sa.indexOf('modelMatrix')?'uniform mat4 _modelMatrix[INSTANCED_DRAWING];':'attribute mat4 modelMatrix;',-1==Sa.indexOf('modelViewMatrix')?'uniform mat4 _modelViewMatrix[INSTANCED_DRAWING];':'attribute mat4 modelViewMatrix;',-1==Sa.indexOf('normalMatrix')?'uniform mat3 _normalMatrix[INSTANCED_DRAWING];':'attribute mat3 normalMatrix;','#else','uniform mat4 modelMatrix;','uniform mat4 modelViewMatrix;','uniform mat3 normalMatrix;','#endif','uniform mat4 projectionMatrix;','uniform mat4 viewMatrix;','uniform vec3 cameraPosition;','attribute vec3 position;','attribute vec3 normal;','attribute vec2 uv;','attribute vec2 uv2;','#ifdef USE_COLOR','attribute vec3 color;','#endif','#ifdef USE_MORPHTARGETS','attribute vec3 morphTarget0;','attribute vec3 morphTarget1;','attribute vec3 morphTarget2;','attribute vec3 morphTarget3;','#ifdef USE_MORPHNORMALS','attribute vec3 morphNormal0;','attribute vec3 morphNormal1;','attribute vec3 morphNormal2;','attribute vec3 morphNormal3;','#else','attribute vec3 morphTarget4;','attribute vec3 morphTarget5;','attribute vec3 morphTarget6;','attribute vec3 morphTarget7;','#endif','#endif','#ifdef USE_SKINNING','attribute vec4 skinIndex;','attribute vec4 skinWeight;','#endif',''].join('\n'),Ca=['precision '+ut+' float;',fa.bumpMap||fa.normalMap?'#extension GL_OES_standard_derivatives : enable':'',wa,'#define MAX_DIR_LIGHTS '+fa.maxDirLights,'#define MAX_POINT_LIGHTS '+fa.maxPointLights,'#define MAX_SPOT_LIGHTS '+fa.maxSpotLights,'#define MAX_HEMI_LIGHTS '+fa.maxHemiLights,'#define MAX_SHADOWS '+fa.maxShadows,fa.alphaTest?'#define ALPHATEST '+fa.alphaTest:'',bt.gammaInput?'#define GAMMA_INPUT':'',bt.gammaOutput?'#define GAMMA_OUTPUT':'',bt.physicallyBasedShading?'#define PHYSICALLY_BASED_SHADING':'',fa.useFog&&fa.fog?'#define USE_FOG':'',fa.useFog&&fa.fogExp?'#define FOG_EXP2':'',fa.map?'#define USE_MAP':'',fa.envMap?'#define USE_ENVMAP':'',fa.lightMap?'#define USE_LIGHTMAP':'',fa.bumpMap?'#define USE_BUMPMAP':'','#define BASE_COLOR '+(fa.base_color&&'vec3('+fa.base_color+')'||'vec3(1.0)'),fa.displacementMap?'#define USE_DISPLACEMENTMAP':'',fa.computerNormalFromDisplacement?'#define COMPUTE_NORMAL_FROM_DISPLACEMENT':'',fa.waveTexture?'#define USE_WAVE_TEXTURE':'',fa.mirrorTexture?'#define USE_MIRROR_TEXTURE':'',fa.uniTexture?'#define USE_UNI_TEXTURE'+(use_MatrixRain?MMD_SA.matrix_rain.full_color?'\n#define USE_MATRIX_RAIN_COLOR':'\n#define USE_MATRIX_RAIN_GREEN':''):'',fa.normalMap?'#define USE_NORMALMAP':'',fa.specularMap?'#define USE_SPECULARMAP':'',fa.vertexColors?'#define USE_COLOR':'',fa.metal?'#define METAL':'',fa.perPixel?'#define PHONG_PER_PIXEL':'',fa.wrapAround?'#define WRAP_AROUND':'',fa.doubleSided?'#define DOUBLE_SIDED':'',fa.flipSided?'#define FLIP_SIDED':'',fa.shadowMapEnabled?'#define USE_SHADOWMAP':'',fa.shadowMapEnabled?'#define '+Aa:'',fa.shadowMapDebug?'#define SHADOWMAP_DEBUG':'',fa.shadowMapCascade?'#define SHADOWMAP_CASCADE':'',fa.shadowMapAlpha?'#define SHADOWMAP_ALPHA':'','uniform mat4 viewMatrix;','uniform vec3 cameraPosition;',''].join('\n');self.MMD_SA&&MMD_SA.use_webgl2&&(Ea=MMD_SA.webgl2_vshader_prefix_convert(Ea),Ca=MMD_SA.webgl2_vshader_prefix_convert(Ca),ia=MMD_SA.webgl2_vshader_main_convert(ia),oa=MMD_SA.webgl2_fshader_main_convert(oa));var Da=Ke('vertex',We(Ea+ia)),Ra=Ke('fragment',We(Ca+oa));ir.attachShader(_a,Da),ir.attachShader(_a,Ra),ir.linkProgram(_a),ir.getProgramParameter(_a,ir.LINK_STATUS)||(console.error('Could not initialise shader\nVALIDATE_STATUS: '+ir.getProgramParameter(_a,ir.VALIDATE_STATUS)+', gl error ['+ir.getError()+']'),console.error(ir.getProgramInfoLog(_a))),ir.deleteShader(Ra),ir.deleteShader(Da),_a.uniforms={},_a.attributes={};var Pa,La,Ua,Na;for(La in Pa=fa.instanced_drawing?['viewMatrix','projectionMatrix','cameraPosition','morphTargetInfluences'].concat(Ta):['viewMatrix','modelViewMatrix','projectionMatrix','normalMatrix','modelMatrix','cameraPosition','morphTargetInfluences'],fa.useVertexTexture?Pa.push('boneTexture'):Pa.push('boneGlobalMatrices'),sa)Pa.push(La);for(Xe(_a,Pa),Pa=['position','normal','uv','uv2','tangent','color','skinIndex','skinWeight','lineDistance'],fa.instanced_drawing&&(Pa=Pa.concat(Sa)),Na=0;Na<fa.maxMorphTargets;Na++)Pa.push('morphTarget'+Na);for(Na=0;Na<fa.maxMorphNormals;Na++)Pa.push('morphNormal'+Na);for(Ua in la)Pa.push(Ua);return Ye(_a,Pa),_a.id=Tt++,St.push({program:_a,code:xa,usedTimes:1}),bt.info.memory.programs=St.length,_a}function Xe(aa,oa){var ia,sa,la;for(ia=0,sa=oa.length;ia<sa;ia++)la=oa[ia],aa.uniforms[la]=ir.getUniformLocation(aa,la)}function Ye(aa,oa){var ia,sa,la;for(ia=0,sa=oa.length;ia<sa;ia++)la=oa[ia],aa.attributes[la]=ir.getAttribLocation(aa,la)}function qe(aa){for(var oa=aa.split('\n'),ia=0,sa=oa.length;ia<sa;ia++)oa[ia]=ia+1+': '+oa[ia];return oa.join('\n')}function Ke(aa,oa){var ia;return'fragment'===aa?ia=ir.createShader(ir.FRAGMENT_SHADER):'vertex'==aa&&(ia=ir.createShader(ir.VERTEX_SHADER)),ir.shaderSource(ia,oa),ir.compileShader(ia),ir.getShaderParameter(ia,ir.COMPILE_STATUS)?ia:(console.error(ir.getShaderInfoLog(ia)),console.error(qe(oa)),null)}function Qe(aa){return self.MMD_SA&&MMD_SA.use_webgl2||0==(aa&aa-1)}function Ze(aa,oa,ia){ia?(ir.texParameteri(aa,ir.TEXTURE_WRAP_S,it(oa.wrapS)),ir.texParameteri(aa,ir.TEXTURE_WRAP_T,it(oa.wrapT)),ir.texParameteri(aa,ir.TEXTURE_MAG_FILTER,it(oa.magFilter)),ir.texParameteri(aa,ir.TEXTURE_MIN_FILTER,it(oa.minFilter))):(ir.texParameteri(aa,ir.TEXTURE_WRAP_S,ir.CLAMP_TO_EDGE),ir.texParameteri(aa,ir.TEXTURE_WRAP_T,ir.CLAMP_TO_EDGE),ir.texParameteri(aa,ir.TEXTURE_MAG_FILTER,ot(oa.magFilter)),ir.texParameteri(aa,ir.TEXTURE_MIN_FILTER,ot(oa.minFilter))),cr&&oa.type!==THREE.FloatType&&(1<oa.anisotropy||oa.__oldAnisotropy)&&(ir.texParameterf(aa,cr.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(oa.anisotropy,gr)),oa.__oldAnisotropy=oa.anisotropy)}function Je(aa,oa){if(aa.width<=oa&&aa.height<=oa)return aa;var ia=Math.max(aa.width,aa.height),sa=Math.floor(aa.width*oa/ia),la=Math.floor(aa.height*oa/ia),da=document.createElement('canvas');da.width=sa,da.height=la;var fa=da.getContext('2d');return fa.drawImage(aa,0,0,aa.width,aa.height,0,0,sa,la),da}function $e(aa,oa){if(6===aa.image.length)if(aa.needsUpdate){aa.image.__webglTextureCube||(aa.image.__webglTextureCube=ir.createTexture(),bt.info.memory.textures++),ir.activeTexture(ir.TEXTURE0+oa),ir.bindTexture(ir.TEXTURE_CUBE_MAP,aa.image.__webglTextureCube),ir.pixelStorei(ir.UNPACK_FLIP_Y_WEBGL,aa.flipY);for(var ia=aa instanceof THREE.CompressedTexture,sa=[],la=0;6>la;la++)sa[la]=bt.autoScaleCubemaps&&!ia?Je(aa.image[la],hr):aa.image[la];var da=sa[0],fa=Qe(da.width)&&Qe(da.height),ha=it(aa.format),ga=it(aa.type),ya=MMD_SA.webgl2_RGBA_internal(ir,ha,ga);Ze(ir.TEXTURE_CUBE_MAP,aa,fa);for(var la=0;6>la;la++)if(ia)for(var xa=sa[la].mipmaps,ba=0,Sa=xa.length,_a;ba<Sa;ba++)_a=xa[ba],ir.compressedTexImage2D(ir.TEXTURE_CUBE_MAP_POSITIVE_X+la,ba,ha,_a.width,_a.height,0,_a.data);else ir.texImage2D(ir.TEXTURE_CUBE_MAP_POSITIVE_X+la,0,ya,ha,ga,sa[la]);aa.generateMipmaps&&fa&&ir.generateMipmap(ir.TEXTURE_CUBE_MAP),aa.needsUpdate=!1,aa.onUpdate&&aa.onUpdate()}else ir.activeTexture(ir.TEXTURE0+oa),ir.bindTexture(ir.TEXTURE_CUBE_MAP,aa.image.__webglTextureCube)}function et(aa,oa){ir.activeTexture(ir.TEXTURE0+oa),ir.bindTexture(ir.TEXTURE_CUBE_MAP,aa.__webglTexture)}function tt(aa,oa,ia){ir.bindFramebuffer(ir.FRAMEBUFFER,aa),ir.framebufferTexture2D(ir.FRAMEBUFFER,ir.COLOR_ATTACHMENT0,ia,oa.__webglTexture,0)}function rt(aa,oa){ir.bindRenderbuffer(ir.RENDERBUFFER,aa),oa.depthBuffer?console.log('renderTarget.depthBuffer'):console.log('!renderTarget.depthBuffer'),oa.depthBuffer&&!oa.stencilBuffer?(oa._use_multisample?ir.renderbufferStorageMultisample(ir.RENDERBUFFER,oa._use_multisample,ir.DEPTH_COMPONENT16,oa.width,oa.height):ir.renderbufferStorage(ir.RENDERBUFFER,ir.DEPTH_COMPONENT16,oa.width,oa.height),ir.framebufferRenderbuffer(ir.FRAMEBUFFER,ir.DEPTH_ATTACHMENT,ir.RENDERBUFFER,aa)):oa.depthBuffer&&oa.stencilBuffer?(oa._use_multisample?ir.renderbufferStorageMultisample(ir.RENDERBUFFER,oa._use_multisample,ir.DEPTH24_STENCIL8,oa.width,oa.height):ir.renderbufferStorage(ir.RENDERBUFFER,ir.DEPTH_STENCIL,oa.width,oa.height),ir.framebufferRenderbuffer(ir.FRAMEBUFFER,ir.DEPTH_STENCIL_ATTACHMENT,ir.RENDERBUFFER,aa)):oa._use_multisample?(console.log('FIXME: We don\'t support !depth !stencil'),ir.renderbufferStorageMultisample(ir.RENDERBUFFER,oa._use_multisample,ir.RGBA8,oa.width,oa.height)):ir.renderbufferStorage(ir.RENDERBUFFER,ir.RGBA4,oa.width,oa.height)}function at(aa){aa instanceof THREE.WebGLRenderTargetCube?(ir.bindTexture(ir.TEXTURE_CUBE_MAP,aa.__webglTexture),ir.generateMipmap(ir.TEXTURE_CUBE_MAP),ir.bindTexture(ir.TEXTURE_CUBE_MAP,null)):(ir.bindTexture(ir.TEXTURE_2D,aa.__webglTexture),ir.generateMipmap(ir.TEXTURE_2D),ir.bindTexture(ir.TEXTURE_2D,null))}function ot(aa){return aa===THREE.NearestFilter||aa===THREE.NearestMipMapNearestFilter||aa===THREE.NearestMipMapLinearFilter?ir.NEAREST:ir.LINEAR}function it(aa){if(aa===THREE.RepeatWrapping)return ir.REPEAT;if(aa===THREE.ClampToEdgeWrapping)return ir.CLAMP_TO_EDGE;if(aa===THREE.MirroredRepeatWrapping)return ir.MIRRORED_REPEAT;if(aa===THREE.NearestFilter)return ir.NEAREST;if(aa===THREE.NearestMipMapNearestFilter)return ir.NEAREST_MIPMAP_NEAREST;if(aa===THREE.NearestMipMapLinearFilter)return ir.NEAREST_MIPMAP_LINEAR;if(aa===THREE.LinearFilter)return ir.LINEAR;if(aa===THREE.LinearMipMapNearestFilter)return ir.LINEAR_MIPMAP_NEAREST;if(aa===THREE.LinearMipMapLinearFilter)return ir.LINEAR_MIPMAP_LINEAR;if(aa===THREE.UnsignedByteType)return ir.UNSIGNED_BYTE;if(aa===THREE.UnsignedShort4444Type)return ir.UNSIGNED_SHORT_4_4_4_4;if(aa===THREE.UnsignedShort5551Type)return ir.UNSIGNED_SHORT_5_5_5_1;if(aa===THREE.UnsignedShort565Type)return ir.UNSIGNED_SHORT_5_6_5;if(aa===THREE.ByteType)return ir.BYTE;if(aa===THREE.ShortType)return ir.SHORT;if(aa===THREE.UnsignedShortType)return ir.UNSIGNED_SHORT;if(aa===THREE.IntType)return ir.INT;if(aa===THREE.UnsignedIntType)return ir.UNSIGNED_INT;if(aa===THREE.FloatType)return ir.FLOAT;if(aa===THREE.AlphaFormat)return ir.ALPHA;if(aa===THREE.RGBFormat)return ir.RGB;if(aa===THREE.RGBAFormat)return ir.RGBA;if(aa===THREE.LuminanceFormat)return ir.LUMINANCE;if(aa===THREE.LuminanceAlphaFormat)return ir.LUMINANCE_ALPHA;if(aa===THREE.AddEquation)return ir.FUNC_ADD;if(aa===THREE.SubtractEquation)return ir.FUNC_SUBTRACT;if(aa===THREE.ReverseSubtractEquation)return ir.FUNC_REVERSE_SUBTRACT;if(aa===THREE.ZeroFactor)return ir.ZERO;if(aa===THREE.OneFactor)return ir.ONE;if(aa===THREE.SrcColorFactor)return ir.SRC_COLOR;if(aa===THREE.OneMinusSrcColorFactor)return ir.ONE_MINUS_SRC_COLOR;if(aa===THREE.SrcAlphaFactor)return ir.SRC_ALPHA;if(aa===THREE.OneMinusSrcAlphaFactor)return ir.ONE_MINUS_SRC_ALPHA;if(aa===THREE.DstAlphaFactor)return ir.DST_ALPHA;if(aa===THREE.OneMinusDstAlphaFactor)return ir.ONE_MINUS_DST_ALPHA;if(aa===THREE.DstColorFactor)return ir.DST_COLOR;if(aa===THREE.OneMinusDstColorFactor)return ir.ONE_MINUS_DST_COLOR;if(aa===THREE.SrcAlphaSaturateFactor)return ir.SRC_ALPHA_SATURATE;if(void 0!==pr){if(aa===THREE.RGB_S3TC_DXT1_Format)return pr.COMPRESSED_RGB_S3TC_DXT1_EXT;if(aa===THREE.RGBA_S3TC_DXT1_Format)return pr.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(aa===THREE.RGBA_S3TC_DXT3_Format)return pr.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(aa===THREE.RGBA_S3TC_DXT5_Format)return pr.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}function nt(aa){if(_r&&aa&&aa.useVertexTexture)return 1024;var oa=ir.getParameter(ir.MAX_VERTEX_UNIFORM_VECTORS),ia=Math.floor((oa-20)/4),sa=ia;return void 0!==aa&&aa instanceof THREE.SkinnedMesh&&(sa=Math.min(aa.bones.length,sa),sa<aa.bones.length&&console.warn('WebGLRenderer: too many bones - '+aa.bones.length+', this GPU supports just '+sa+' (try OpenGL instead of ANGLE)')),sa}function st(aa){var oa,ia,sa,la,da,fa,ha;for(la=da=fa=ha=0,oa=0,ia=aa.length;oa<ia;oa++)sa=aa[oa],sa.onlyShadow||(sa instanceof THREE.DirectionalLight&&la++,sa instanceof THREE.PointLight&&da++,sa instanceof THREE.SpotLight&&fa++,sa instanceof THREE.HemisphereLight&&ha++);return{directional:la,point:da,spot:fa,hemi:ha}}function lt(aa){var la=0,oa,ia,sa;for(oa=0,ia=aa.length;oa<ia;oa++)sa=aa[oa],sa.castShadow&&(sa instanceof THREE.SpotLight&&la++,sa instanceof THREE.DirectionalLight&&!sa.shadowCascade&&la++);return la}_=_||{},_.canvas&&(_.canvas=document.getElementById(_.canvas));var mt=_.canvas===void 0?document.createElement('canvas'):_.canvas,ut=_.precision===void 0?'highp':_.precision,ft=!(_.alpha!==void 0)||_.alpha,ht=!(_.premultipliedAlpha!==void 0)||_.premultipliedAlpha,gt=_.antialias!==void 0&&_.antialias,yt=!(_.stencil!==void 0)||_.stencil,_t=_.preserveDrawingBuffer!==void 0&&_.preserveDrawingBuffer,xt=new THREE.Color(_.clearColor||0),vt=_.clearAlpha||0;this.domElement=mt,this.context=null,this.devicePixelRatio=_.devicePixelRatio===void 0?window.devicePixelRatio===void 0?1:window.devicePixelRatio:_.devicePixelRatio,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.autoUpdateObjects=!0,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyBasedShading=!1,this.shadowMapEnabled=!1,this.shadowMapAutoUpdate=!0,this.shadowMapType=THREE.PCFShadowMap,this.shadowMapCullFace=THREE.CullFaceFront,this.shadowMapDebug=!1,this.shadowMapCascade=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.renderPluginsPre=[],this.renderPluginsPost=[],this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var bt=this,St=[],Tt=0,Mt=null,At=null,wt=-1,Et=null,Ct=null,Dt=0,Rt=0,Pt=-1,Lt=-1,Ut=-1,Nt=-1,Ft=-1,zt=-1,Vt=-1,It=-1,Ot=null,Bt=null,kt=null,Gt=null,Ht=0,Wt=0,jt=0,Xt=0,Yt=0,Kt=0,Qt={},Zt=new THREE.Frustum,Jt=new THREE.Matrix4,$t=new THREE.Matrix4,er=new THREE.Vector3,rr=new THREE.Vector3,ar=!0,or={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},ir,nr,sr,lr,dr,cr,pr;(function(){try{var aa={alpha:ft,premultipliedAlpha:ht,antialias:gt,stencil:yt,preserveDrawingBuffer:_t};if(self.MMD_SA_options&&MMD_SA_options.WebXR&&MMD_SA_options.WebXR.AR&&MMD_SA.WebXR.can_AR&&(console.log('Use XR-compatible WebGL context'),aa.xrCompatible=!0),self.MMD_SA&&(ir=mt.getContext('webgl2',aa)),ir?(console.log('Use WebGL2'),MMD_SA.use_webgl2=!0):ir=mt.getContext('webgl',aa)||mt.getContext('experimental-webgl',aa),null===ir)throw'Error creating WebGL context.'}catch(oa){console.error(oa)}self.MMD_SA&&MMD_SA.use_webgl2?(nr=!0,console.log('Use VAO'),lr=!0,dr=!0):(lr=ir.getExtension('OES_texture_float'),dr=ir.getExtension('OES_standard_derivatives')),cr=ir.getExtension('EXT_texture_filter_anisotropic')||ir.getExtension('MOZ_EXT_texture_filter_anisotropic')||ir.getExtension('WEBKIT_EXT_texture_filter_anisotropic'),pr=ir.getExtension('WEBGL_compressed_texture_s3tc')||ir.getExtension('MOZ_WEBGL_compressed_texture_s3tc')||ir.getExtension('WEBKIT_WEBGL_compressed_texture_s3tc'),lr||console.log('THREE.WebGLRenderer: Float textures not supported.'),dr||console.log('THREE.WebGLRenderer: Standard derivatives not supported.'),cr||console.log('THREE.WebGLRenderer: Anisotropic texture filtering not supported.'),pr||console.log('THREE.WebGLRenderer: S3TC compressed textures not supported.'),ir.getShaderPrecisionFormat===void 0&&(ir.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),self.MMD_SA&&(MMD_SA.WebGL_initialized=!0),window.dispatchEvent(new CustomEvent('WebGL_initialized'))})(),function(){ir.clearColor(0,0,0,1),ir.clearDepth(1),ir.clearStencil(0),ir.enable(ir.DEPTH_TEST),ir.depthFunc(ir.LEQUAL),ir.frontFace(ir.CCW),ir.cullFace(ir.BACK),ir.enable(ir.CULL_FACE),ir.enable(ir.BLEND),ir.blendEquation(ir.FUNC_ADD),ir.blendFunc(ir.SRC_ALPHA,ir.ONE_MINUS_SRC_ALPHA),ir.clearColor(xt.r,xt.g,xt.b,vt)}(),this.context=ir;var mr=ir.getParameter(ir.MAX_TEXTURE_IMAGE_UNITS),ur=ir.getParameter(ir.MAX_VERTEX_TEXTURE_IMAGE_UNITS),fr=ir.getParameter(ir.MAX_TEXTURE_SIZE),hr=ir.getParameter(ir.MAX_CUBE_MAP_TEXTURE_SIZE),gr=cr?ir.getParameter(cr.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,yr=0<ur,_r=yr&&lr,xr=pr?ir.getParameter(ir.COMPRESSED_TEXTURE_FORMATS):[],vr=ir.getShaderPrecisionFormat(ir.VERTEX_SHADER,ir.HIGH_FLOAT),Sr=ir.getShaderPrecisionFormat(ir.VERTEX_SHADER,ir.MEDIUM_FLOAT),Tr=ir.getShaderPrecisionFormat(ir.VERTEX_SHADER,ir.LOW_FLOAT),Mr=ir.getShaderPrecisionFormat(ir.FRAGMENT_SHADER,ir.HIGH_FLOAT),Ar=ir.getShaderPrecisionFormat(ir.FRAGMENT_SHADER,ir.MEDIUM_FLOAT),wr=ir.getShaderPrecisionFormat(ir.FRAGMENT_SHADER,ir.LOW_FLOAT),Er=ir.getShaderPrecisionFormat(ir.VERTEX_SHADER,ir.HIGH_INT),Cr=ir.getShaderPrecisionFormat(ir.VERTEX_SHADER,ir.MEDIUM_INT),Dr=ir.getShaderPrecisionFormat(ir.VERTEX_SHADER,ir.LOW_INT),Rr=ir.getShaderPrecisionFormat(ir.FRAGMENT_SHADER,ir.HIGH_INT),Pr=ir.getShaderPrecisionFormat(ir.FRAGMENT_SHADER,ir.MEDIUM_INT),Lr=ir.getShaderPrecisionFormat(ir.FRAGMENT_SHADER,ir.LOW_INT),Ur=0<vr.precision&&0<Mr.precision,Nr=0<Sr.precision&&0<Ar.precision;'highp'!==ut||Ur||(Nr?ut='mediump':ut='lowp'),'mediump'!==ut||Nr||(ut='lowp'),this.getContext=function(){return ir},this.supportsVertexTextures=function(){return yr},this.supportsFloatTextures=function(){return lr},this.supportsStandardDerivatives=function(){return dr},this.supportsCompressedTextureS3TC=function(){return pr},this.getMaxAnisotropy=function(){return gr},this.getPrecision=function(){return ut},this.setSize=function(aa,oa,ia){mt.width=aa*this.devicePixelRatio,mt.height=oa*this.devicePixelRatio,1!==this.devicePixelRatio&&!1!==ia&&(mt.style.width=aa+'px',mt.style.height=oa+'px'),this.setViewport(0,0,mt.width,mt.height)},this.setViewport=function(aa,oa,ia,sa){Ht=aa===void 0?0:aa,Wt=oa===void 0?0:oa,jt=ia===void 0?mt.width:ia,Xt=sa===void 0?mt.height:sa,ir.viewport(Ht,Wt,jt,Xt)},this.getViewportX=function(){return Ht},this.getViewportY=function(){return Wt},this.getViewportWidth=function(){return jt},this.getViewportHeight=function(){return Xt},this.setScissor=function(aa,oa,ia,sa){ir.scissor(aa,oa,ia,sa)},this.enableScissorTest=function(aa){aa?ir.enable(ir.SCISSOR_TEST):ir.disable(ir.SCISSOR_TEST)},this.setClearColor=function(aa,oa){xt.set(aa),vt=oa===void 0?1:oa,ir.clearColor(xt.r,xt.g,xt.b,vt)},this.getClearColor=function(){return xt},this.getClearAlpha=function(){return vt},this.clear=function(aa,oa,ia){var sa=0;(aa===void 0||aa)&&(sa|=ir.COLOR_BUFFER_BIT),(oa===void 0||oa)&&(sa|=ir.DEPTH_BUFFER_BIT),(ia===void 0||ia)&&(sa|=ir.STENCIL_BUFFER_BIT),ir.clear(sa)},this.clearColor=function(){ir.clear(ir.COLOR_BUFFER_BIT)},this.clearTarget=function(aa,oa,ia,sa){this.setRenderTarget(aa),this.clear(oa,ia,sa)},this.addPostPlugin=function(aa){aa.init(this),this.renderPluginsPost.push(aa)},this.addPrePlugin=function(aa){aa.init(this),this.renderPluginsPre.push(aa)},this.updateShadowMap=function(aa,oa){Mt=null,Ut=-1,Vt=-1,It=-1,Et=-1,wt=-1,ar=!0,Pt=-1,Lt=-1,this.shadowMapPlugin.update(aa,oa)};var Fr=function(aa){var oa=aa.target;oa.removeEventListener('dispose',Fr),Or(oa),bt.info.memory.geometries--},zr=function(aa){var oa=aa.target;oa.removeEventListener('dispose',zr),Br(oa),bt.info.memory.textures--},Vr=function(aa){var oa=aa.target;oa.removeEventListener('dispose',Vr),kr(oa),bt.info.memory.textures--},Ir=function(aa){var oa=aa.target;oa.removeEventListener('dispose',Ir),Gr(oa)},Or=function(aa){if(aa.__webglInit=void 0,void 0!==aa.__webglVertexBuffer&&ir.deleteBuffer(aa.__webglVertexBuffer),void 0!==aa.__webglNormalBuffer&&ir.deleteBuffer(aa.__webglNormalBuffer),void 0!==aa.__webglTangentBuffer&&ir.deleteBuffer(aa.__webglTangentBuffer),void 0!==aa.__webglColorBuffer&&ir.deleteBuffer(aa.__webglColorBuffer),void 0!==aa.__webglUVBuffer&&ir.deleteBuffer(aa.__webglUVBuffer),void 0!==aa.__webglUV2Buffer&&ir.deleteBuffer(aa.__webglUV2Buffer),void 0!==aa.__webglSkinIndicesBuffer&&ir.deleteBuffer(aa.__webglSkinIndicesBuffer),void 0!==aa.__webglSkinWeightsBuffer&&ir.deleteBuffer(aa.__webglSkinWeightsBuffer),void 0!==aa.__webglFaceBuffer&&ir.deleteBuffer(aa.__webglFaceBuffer),void 0!==aa.__webglLineBuffer&&ir.deleteBuffer(aa.__webglLineBuffer),void 0!==aa.__webglLineDistanceBuffer&&ir.deleteBuffer(aa.__webglLineDistanceBuffer),void 0!==aa.geometryGroups)for(var oa in aa.geometryGroups){var ia=aa.geometryGroups[oa];if(void 0!==ia.numMorphTargets)for(var sa=0,la=ia.numMorphTargets;sa<la;sa++)ir.deleteBuffer(ia.__webglMorphTargetsBuffers[sa]);if(void 0!==ia.numMorphNormals)for(var sa=0,la=ia.numMorphNormals;sa<la;sa++)ir.deleteBuffer(ia.__webglMorphNormalsBuffers[sa]);E(ia)}E(aa)},Br=function(aa){if(aa.image&&aa.image.__webglTextureCube)ir.deleteTexture(aa.image.__webglTextureCube);else{if(!aa.__webglInit)return;aa.__webglInit=!1,ir.deleteTexture(aa.__webglTexture)}},kr=function(aa){if(aa&&aa.__webglTexture)if(ir.deleteTexture(aa.__webglTexture),aa instanceof THREE.WebGLRenderTargetCube)for(var oa=0;6>oa;oa++)ir.deleteFramebuffer(aa.__webglFramebuffer[oa]),ir.deleteRenderbuffer(aa.__webglRenderbuffer[oa]);else ir.deleteFramebuffer(aa.__webglFramebuffer),aa.__webglRenderbuffer&&ir.deleteRenderbuffer(aa.__webglRenderbuffer),aa.__webglMSAAFramebuffer&&ir.deleteFramebuffer(aa.__webglMSAAFramebuffer),aa.__webglMSAAColorbuffer&&ir.deleteRenderbuffer(aa.__webglMSAAColorbuffer),aa.__webglMSAADepthbuffer&&ir.deleteRenderbuffer(aa.__webglMSAADepthbuffer)},Gr=function(aa){var oa=aa.program;if(void 0!==oa){aa.program=void 0;var da=!1,ia,sa,la;for(ia=0,sa=St.length;ia<sa;ia++)if(la=St[ia],la.program===oa){la.usedTimes--,0===la.usedTimes&&(da=!0);break}if(!0==da){var fa=[];for(ia=0,sa=St.length;ia<sa;ia++)la=St[ia],la.program!==oa&&fa.push(la);St=fa,ir.deleteProgram(oa),bt.info.memory.programs--}}};this.renderBufferImmediate=function(aa,oa,ia){if(aa.hasPositions&&!aa.__webglVertexBuffer&&(aa.__webglVertexBuffer=ir.createBuffer()),aa.hasNormals&&!aa.__webglNormalBuffer&&(aa.__webglNormalBuffer=ir.createBuffer()),aa.hasUvs&&!aa.__webglUvBuffer&&(aa.__webglUvBuffer=ir.createBuffer()),aa.hasColors&&!aa.__webglColorBuffer&&(aa.__webglColorBuffer=ir.createBuffer()),aa.hasPositions&&(ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglVertexBuffer),ir.bufferData(ir.ARRAY_BUFFER,aa.positionArray,ir.DYNAMIC_DRAW),ir.enableVertexAttribArray(oa.attributes.position),ir.vertexAttribPointer(oa.attributes.position,3,ir.FLOAT,!1,0,0)),aa.hasNormals){if(ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglNormalBuffer),ia.shading===THREE.FlatShading){var wa=3*aa.count,sa,la,da,fa,ha,ga,ya,_a,xa,ba,Sa,Ta,Ma,Aa;for(Aa=0;Aa<wa;Aa+=9)Ma=aa.normalArray,fa=Ma[Aa],ya=Ma[Aa+1],ba=Ma[Aa+2],ha=Ma[Aa+3],_a=Ma[Aa+4],Sa=Ma[Aa+5],ga=Ma[Aa+6],xa=Ma[Aa+7],Ta=Ma[Aa+8],sa=(fa+ha+ga)/3,la=(ya+_a+xa)/3,da=(ba+Sa+Ta)/3,Ma[Aa]=sa,Ma[Aa+1]=la,Ma[Aa+2]=da,Ma[Aa+3]=sa,Ma[Aa+4]=la,Ma[Aa+5]=da,Ma[Aa+6]=sa,Ma[Aa+7]=la,Ma[Aa+8]=da}ir.bufferData(ir.ARRAY_BUFFER,aa.normalArray,ir.DYNAMIC_DRAW),ir.enableVertexAttribArray(oa.attributes.normal),ir.vertexAttribPointer(oa.attributes.normal,3,ir.FLOAT,!1,0,0)}aa.hasUvs&&ia.map&&(ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglUvBuffer),ir.bufferData(ir.ARRAY_BUFFER,aa.uvArray,ir.DYNAMIC_DRAW),ir.enableVertexAttribArray(oa.attributes.uv),ir.vertexAttribPointer(oa.attributes.uv,2,ir.FLOAT,!1,0,0)),aa.hasColors&&ia.vertexColors!==THREE.NoColors&&(ir.bindBuffer(ir.ARRAY_BUFFER,aa.__webglColorBuffer),ir.bufferData(ir.ARRAY_BUFFER,aa.colorArray,ir.DYNAMIC_DRAW),ir.enableVertexAttribArray(oa.attributes.color),ir.vertexAttribPointer(oa.attributes.color,3,ir.FLOAT,!1,0,0)),ir.drawArrays(ir.TRIANGLES,0,aa.count),aa.count=0},this.renderBufferDirect=function(aa,oa,ia,sa,la,da){if(!1!==sa.visible){var fa,ha,ba,Sa,Ta,Ma,Aa;fa=Me(aa,oa,ia,sa,da),ha=fa.attributes,ba=la.attributes;var wa=!1,Ea=sa.wireframe?1:0,Ca=16777215*la.id+2*fa.id+Ea;if(Ca!==Et&&(Et=Ca,wa=!0),wa&&K(),da instanceof THREE.Mesh){var Da=ba.index;if(Da){var Ra=la.offsets;1<Ra.length&&(wa=!0);for(var Pa=0,La=Ra.length,Ua;Pa<La;Pa++){if(Ua=Ra[Pa].index,wa){for(Ta in ba)'index'!==Ta&&(Ma=ha[Ta],Sa=ba[Ta],Aa=Sa.itemSize,0<=Ma&&(ir.bindBuffer(ir.ARRAY_BUFFER,Sa.buffer),Y(Ma),ir.vertexAttribPointer(Ma,Aa,ir.FLOAT,!1,0,4*(Ua*Aa))));ir.bindBuffer(ir.ELEMENT_ARRAY_BUFFER,Da.buffer)}ir.drawElements(ir.TRIANGLES,Ra[Pa].count,ir.UNSIGNED_SHORT,2*Ra[Pa].start),bt.info.render.calls++,bt.info.render.vertices+=Ra[Pa].count,bt.info.render.faces+=Ra[Pa].count/3}}else{if(wa)for(Ta in ba)'index'!==Ta&&(Ma=ha[Ta],Sa=ba[Ta],Aa=Sa.itemSize,0<=Ma&&(ir.bindBuffer(ir.ARRAY_BUFFER,Sa.buffer),Y(Ma),ir.vertexAttribPointer(Ma,Aa,ir.FLOAT,!1,0,0)));var Na=la.attributes.position;ir.drawArrays(ir.TRIANGLES,0,Na.numItems/3),bt.info.render.calls++,bt.info.render.vertices+=Na.numItems/3,bt.info.render.faces+=Na.numItems/3/3}}else if(da instanceof THREE.ParticleSystem){if(wa){for(Ta in ba)Ma=ha[Ta],Sa=ba[Ta],Aa=Sa.itemSize,0<=Ma&&(ir.bindBuffer(ir.ARRAY_BUFFER,Sa.buffer),Y(Ma),ir.vertexAttribPointer(Ma,Aa,ir.FLOAT,!1,0,0));var Na=ba.position;ir.drawArrays(ir.POINTS,0,Na.numItems/3),bt.info.render.calls++,bt.info.render.points+=Na.numItems/3}}else if(da instanceof THREE.Line&&wa){for(Ta in ba)Ma=ha[Ta],Sa=ba[Ta],Aa=Sa.itemSize,0<=Ma&&(ir.bindBuffer(ir.ARRAY_BUFFER,Sa.buffer),Y(Ma),ir.vertexAttribPointer(Ma,Aa,ir.FLOAT,!1,0,0));ke(sa.linewidth);var Na=ba.position;ir.drawArrays(ir.LINE_STRIP,0,Na.numItems/3),bt.info.render.calls++,bt.info.render.points+=Na.numItems}}};var Hr,qr=!1;this.renderBuffer=function(aa,oa,ia,sa,la,da){function fa(){da instanceof THREE.Mesh?(sa.wireframe?(ke(sa.wireframeLinewidth),Ma&&ir.bindBuffer(ir.ELEMENT_ARRAY_BUFFER,la.__webglLineBuffer),ir.drawElements(ir.LINES,la.__webglLineCount,ir.UNSIGNED_SHORT,0)):(Ma&&ir.bindBuffer(ir.ELEMENT_ARRAY_BUFFER,la.__webglFaceBuffer),Da?ir.drawElementsInstanced(ir.TRIANGLES,la.__webglFaceCount,ir.UNSIGNED_SHORT,0,Da):ir.drawElements(ir.TRIANGLES,la.__webglFaceCount,ir.UNSIGNED_SHORT,0)),bt.info.render.calls++,bt.info.render.vertices+=la.__webglFaceCount,bt.info.render.faces+=la.__webglFaceCount/3):da instanceof THREE.Line?(_a=da.type===THREE.LineStrip?ir.LINE_STRIP:ir.LINES,ke(sa.linewidth),ir.drawArrays(_a,0,la.__webglLineCount),bt.info.render.calls++):da instanceof THREE.ParticleSystem?(ir.drawArrays(ir.POINTS,0,la.__webglParticleCount),bt.info.render.calls++,bt.info.render.points+=la.__webglParticleCount):da instanceof THREE.Ribbon&&(ir.drawArrays(ir.TRIANGLE_STRIP,0,la.__webglVertexCount),bt.info.render.calls++)}if(!1!==sa.visible){var ha,ga,_a,ba,Sa,Ta;ha=Me(aa,oa,ia,sa,da),ga=ha.attributes;var Ma=!1,Aa=sa.wireframe?1:0,wa=16777215*la.id+2*ha.id+Aa;wa!==Et&&(Et=wa,Ma=!0),Ma&&K();var Ea,Ca;if(qr=Ma,Ma&&(Ca=!0,nr&&(Ea=la._vao,Ea&&(Hr=la._vao[wa],Hr?Ma=!1:Hr=la._vao[wa]={vao:ir.createVertexArray(),morph_state:{},material_hidden:{}},ir.bindVertexArray(Hr.vao)))),!sa.morphTargets&&0<=ga.position?Ma&&(ir.bindBuffer(ir.ARRAY_BUFFER,la.__webglVertexBuffer),Y(ga.position),ir.vertexAttribPointer(ga.position,3,ir.FLOAT,!1,0,0)):da.morphTargetBase&&Q(sa,la,da,Ma),Ma){if(la.__webglCustomAttributesList)for(Sa=0,Ta=la.__webglCustomAttributesList.length;Sa<Ta;Sa++)ba=la.__webglCustomAttributesList[Sa],0<=ga[ba.buffer.belongsToAttribute]&&(ir.bindBuffer(ir.ARRAY_BUFFER,ba.buffer),Y(ga[ba.buffer.belongsToAttribute]),ir.vertexAttribPointer(ga[ba.buffer.belongsToAttribute],ba.size,ir.FLOAT,!1,0,0));0<=ga.color&&(ir.bindBuffer(ir.ARRAY_BUFFER,la.__webglColorBuffer),Y(ga.color),ir.vertexAttribPointer(ga.color,3,ir.FLOAT,!1,0,0)),0<=ga.normal&&(ir.bindBuffer(ir.ARRAY_BUFFER,la.__webglNormalBuffer),Y(ga.normal),ir.vertexAttribPointer(ga.normal,3,ir.FLOAT,!1,0,0)),0<=ga.tangent&&(ir.bindBuffer(ir.ARRAY_BUFFER,la.__webglTangentBuffer),Y(ga.tangent),ir.vertexAttribPointer(ga.tangent,4,ir.FLOAT,!1,0,0)),0<=ga.uv&&(ir.bindBuffer(ir.ARRAY_BUFFER,la.__webglUVBuffer),Y(ga.uv),ir.vertexAttribPointer(ga.uv,2,ir.FLOAT,!1,0,0)),0<=ga.uv2&&(ir.bindBuffer(ir.ARRAY_BUFFER,la.__webglUV2Buffer),Y(ga.uv2),ir.vertexAttribPointer(ga.uv2,2,ir.FLOAT,!1,0,0)),sa.skinning&&0<=ga.skinIndex&&0<=ga.skinWeight&&(ir.bindBuffer(ir.ARRAY_BUFFER,la.__webglSkinIndicesBuffer),Y(ga.skinIndex),ir.vertexAttribPointer(ga.skinIndex,4,ir.FLOAT,!1,0,0),ir.bindBuffer(ir.ARRAY_BUFFER,la.__webglSkinWeightsBuffer),Y(ga.skinWeight),ir.vertexAttribPointer(ga.skinWeight,4,ir.FLOAT,!1,0,0)),0<=ga.lineDistance&&(ir.bindBuffer(ir.ARRAY_BUFFER,la.__webglLineDistanceBuffer),Y(ga.lineDistance),ir.vertexAttribPointer(ga.lineDistance,1,ir.FLOAT,!1,0,0))}var Da=!1;if(sr&&da.instanced_drawing){Da=!0;for(let Pa=Zr+Jr,La;Pa!==$r;Pa+=Jr)if(La=Qr[Pa],La.render){let za=ta||La.opaque||La.transparent;if(za&&za.visible){if(!za.program)break;let Va=16777215*La.buffer.id+2*za.program.id+(za.wireframe?1:0);Da=Va!==Et||za.id!==wt;break}}if(Ca||!la.__instanced||la.__instanced._instances.length||(Ca=!0),Ca&&!la.__instanced&&(la.__instanced=new Kr(ha,da.instanced_drawing)),la.__instanced._instances.push({instance_index:[la.__instanced._instances.length],modelViewMatrix:da._modelViewMatrix.elements,modelMatrix:da.matrixWorld.elements,normalMatrix:da._normalMatrix.elements}),Da||la.__instanced._instances.length>=la.__instanced.instance_max)Da=la.__instanced._instances.length,la.__instanced.update(ha),Ma=!0;else return}var Ra;for(Ta=sa.passes||1,Hr&&sa.passes&&(0>=sa.opacity?Hr.material_hidden[sa.id]=!0:Hr.material_hidden[sa.id]&&(Hr.material_hidden[sa.id]=!1,Ma=qr)),Sa=0;Sa<Ta;Sa++)Ra=!1,sa.preRenderPass&&(Ra=sa.preRenderPass(bt,Sa)),Ra||fa(),sa.postRenderPass&&sa.postRenderPass(bt,Sa)}};var Kr=function(){function aa(la,da){this.attributes={instance_index:{type:'float'},modelViewMatrix:{type:'mat4'},modelMatrix:{type:'mat4'},normalMatrix:{type:'mat3'}},sa.call(this,la),this.buffer={},this.instance_max=da,this._instances=[],oa.call(this)}function oa(){for(var la in this.delete(),this.attributes){const da=this.attributes[la].type;let fa='float'==da?1:parseInt(da.charAt(3));fa*=fa;const ha=new Float32Array(this.instance_max*fa);this.buffer[la]=ha;const ga=this.attributes_location[la];if(null!=ga){const Sa=ir.createBuffer();this.attributes[la].buffer=Sa,ir.bindBuffer(ir.ARRAY_BUFFER,Sa),ir.bufferData(ir.ARRAY_BUFFER,ha.byteLength,ir.DYNAMIC_DRAW),ia(ga,fa)}}}function ia(la,da){const fa=Math.sqrt(da);for(let ga=0;ga<fa;++ga){const ya=la+ga;Y(ya);const _a=4*(ga*fa);ir.vertexAttribPointer(ya,fa,ir.FLOAT,!1,4*da,_a),ir.vertexAttribDivisor(ya,1)}}function sa(la){if(this.program==la)return!1;for(let da in this.program=la,this.attributes_location={},this.uniforms_location={},this.attributes){let fa=la.attributes[da];this.attributes_location[da]=null==fa||-1==fa?null:fa,fa=la.uniforms['_'+da],this.uniforms_location['_'+da]=null==fa||-1==fa?null:fa}return!0}return aa.prototype.delete=function(){for(var la in this.attributes)null!=this.attributes[la].buffer&&ir.deleteBuffer(this.attributes[la].buffer)},aa.prototype.update=function(la){var da=sa.call(this,la),fa=!Hr||da;for(var ha in this.attributes){const ga=this.attributes[ha].type;let ya='float'==ga?1:parseInt(ga.charAt(3));ya*=ya;const _a=this.buffer[ha];this._instances.forEach(function(ba,Sa){const Ta=ba[ha],Ma=Sa*ya;for(var Aa=0;Aa<ya;Aa++)_a[Ma+Aa]=Ta[Aa]});const xa=this.attributes_location[ha];if(null==xa){const ba=ir.getUniformLocation(la,'_'+ha);null!=ba&&(16==ya?ir.uniformMatrix4fv(ba,!1,_a):ir.uniformMatrix3fv(ba,!1,_a))}else{const ba=this.attributes[ha].buffer;ir.bindBuffer(ir.ARRAY_BUFFER,ba),ir.bufferSubData(ir.ARRAY_BUFFER,0,_a),fa&&ia(xa,ya)}}this._instances=[]},aa}();this.render=function(aa,oa,ia,sa){var ya=aa.__lights,_a=aa.fog,la,da,fa,ha,ga;wt=-1,ar=!0,aa._RAF_timestamp_&&aa._RAF_timestamp_==RAF_timestamp||(aa._RAF_timestamp_&&(aa._RAF_timestamp_=RAF_timestamp),!0===aa.autoUpdate&&aa.updateMatrixWorld()),void 0===oa.parent&&oa.updateMatrixWorld(),oa.matrixWorldInverse.getInverse(oa.matrixWorld),Jt.multiplyMatrices(oa.projectionMatrix,oa.matrixWorldInverse),Zt.setFromMatrix(Jt),this.autoUpdateObjects&&this.initWebGLObjects(aa),oe(this.renderPluginsPre,aa,oa),bt.info.render.calls=0,bt.info.render.vertices=0,bt.info.render.faces=0,bt.info.render.points=0,this.setRenderTarget(ia),(this.autoClear||sa)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),ga=aa.__webglObjects;var xa={};for(la=0,da=ga.length;la<da;la++)if(fa=ga[la],ha=fa.object,fa.id=la,fa.render=!1,ha.visible){let Ca=xa;if(null!=ha._model_index){let Da=fa.transparent||fa.opaque;if(Da)if(Da._render_once)Da._render_once=null;else if(0>=Da.opacity)continue;Ca=MMD_SA_options.model_para_obj_all[ha._model_index].material_para,Ca=Ca&&Ca[ha.material.materials[fa._material_index].name]||{}}(ha instanceof THREE.Mesh||ha instanceof THREE.ParticleSystem)&&ha.frustumCulled&&!Zt.intersectsObject(ha)||(Ve(ha,oa),le(fa),fa.render=!0,!0===this.sortObjects&&(null!=Ca.renderDepth||null!==ha.renderDepth?fa.z=Ca.renderDepth||ha.renderDepth:(er.getPositionFromMatrix(ha.matrixWorld),er.applyProjection(Jt),fa.z=er.z)))}var ba=ga,Sa=ga;for(this.sortObjects&&(aa.overrideMaterial?ga.sort(J):(ba=[],Sa=[],ga.forEach(function(Ca){Ca.render&&(Ca.opaque?ba:Sa).push(Ca)}),ba.sort(Z),Sa.sort(J))),ga=aa.__webglObjectsImmediate,(la=0,da=ga.length);la<da;la++)fa=ga[la],ha=fa.object,ha.visible&&(Ve(ha,oa),se(fa));if(aa.overrideMaterial){var Ta=aa.overrideMaterial;this.setBlending(Ta.blending,Ta.blendEquation,Ta.blendSrc,Ta.blendDst),this.setDepthTest(Ta.depthTest),this.setDepthWrite(Ta.depthWrite),Ge(Ta.polygonOffset,Ta.polygonOffsetFactor,Ta.polygonOffsetUnits),ie(aa.__webglObjects,!1,'',oa,ya,_a,!0,Ta),ne(aa.__webglObjectsImmediate,'',oa,ya,_a,!1,Ta)}else{var Ta=null;this.setBlending(THREE.NoBlending),ie(ba,!0,'opaque',oa,ya,_a,!1,Ta),ne(aa.__webglObjectsImmediate,'opaque',oa,ya,_a,!1,Ta);var Ma=!(self.MMD_SA&&MMD_SA._depth_render_mode_);ie(Sa,!1,'transparent',oa,ya,_a,Ma,Ta),ne(aa.__webglObjectsImmediate,'transparent',oa,ya,_a,Ma,Ta)}if(oe(this.renderPluginsPost,aa,oa),ia&&ia._use_multisample){ir.bindFramebuffer(ir.READ_FRAMEBUFFER,ia.__webglMSAAFramebuffer),ir.bindFramebuffer(ir.DRAW_FRAMEBUFFER,ia.__webglFramebuffer);var Aa=ia.width,wa=ia.height,Ea=ir.COLOR_BUFFER_BIT;ir.blitFramebuffer(0,0,Aa,wa,0,0,Aa,wa,Ea,ir.NEAREST)}ia&&ia.generateMipmaps&&ia.minFilter!==THREE.NearestFilter&&ia.minFilter!==THREE.LinearFilter&&at(ia),this.setDepthTest(!0),this.setDepthWrite(!0)};var Qr,Zr,Jr,$r,ta;this.renderImmediateObject=function(aa,oa,ia,sa,la){var da=Me(aa,oa,ia,sa,la);Et=-1,bt.setMaterialFaces(sa),la.immediateRenderCallback?la.immediateRenderCallback(da,ir,Zt):la.render(function(fa){bt.renderBufferImmediate(fa,da,sa)})};this.initWebGLObjects=function(aa){for(aa.__webglObjects||(aa.__webglObjects=[],aa.__webglObjectsImmediate=[],aa.__webglSprites=[],aa.__webglFlares=[]);aa.__objectsAdded.length;)ue(aa.__objectsAdded[0],aa),aa.__objectsAdded.splice(0,1);for(;aa.__objectsRemoved.length;)xe(aa.__objectsRemoved[0],aa),aa.__objectsRemoved.splice(0,1);for(var oa=0,ia=aa.__webglObjects.length,sa;oa<ia;oa++)sa=aa.__webglObjects[oa].object,void 0===sa.__webglInit&&(void 0!==sa.__webglActive&&xe(sa,aa),ue(sa,aa)),ge(sa)};this.initMaterial=function(aa,oa,ia,sa){aa.addEventListener('dispose',Ir);var la,ha,ga,ya,_a,xa,ba;aa instanceof THREE.MeshDepthMaterial?ba='depth':aa instanceof THREE.MeshNormalMaterial?ba='normal':aa instanceof THREE.MeshBasicMaterial?ba='basic':aa instanceof THREE.MeshLambertMaterial?ba='lambert':aa instanceof THREE.MeshPhongMaterial?ba='phong':aa instanceof THREE.LineBasicMaterial?ba='basic':aa instanceof THREE.LineDashedMaterial?ba='dashed':aa instanceof THREE.ParticleBasicMaterial&&(ba='particle_basic'),ba&&Te(aa,THREE.ShaderLib[ba]),ya=st(oa),xa=lt(oa),_a=nt(sa),ga={map:!!aa.map,envMap:!!aa.envMap,lightMap:!!aa.lightMap,bumpMap:!!aa.bumpMap,base_color:aa.base_color,displacementMap:!!aa.displacementMap,computerNormalFromDisplacement:!!aa.uDisplacementCustomUVScale,waveTexture:null!=aa.waveBaseSpeed,mirrorTexture:null!=aa.mirrorTextureIndex,uniTexture:!!(use_MatrixRain&&(aa.uniTexture||(null!=sa._model_index||aa instanceof THREE.MeshBasicMaterial||aa instanceof THREE.MeshLambertMaterial||aa instanceof THREE.MeshPhongMaterial)&&(aa.uniTexture={state:use_MatrixRain?1:2}))),normalMap:!!aa.normalMap,specularMap:!!aa.specularMap,vertexColors:aa.vertexColors,fog:ia,useFog:aa.fog,fogExp:ia instanceof THREE.FogExp2,sizeAttenuation:aa.sizeAttenuation,skinning:aa.skinning,maxBones:_a,useVertexTexture:_r&&sa&&sa.useVertexTexture,boneTextureWidth:sa&&sa.boneTextureWidth,boneTextureHeight:sa&&sa.boneTextureHeight,morphTargets:aa.morphTargets,morphNormals:aa.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:ya.directional,maxPointLights:ya.point,maxSpotLights:ya.spot,maxHemiLights:ya.hemi,maxShadows:xa,shadowMapEnabled:this.shadowMapEnabled&&sa.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,shadowMapAlpha:sa.receiveShadowAlpha,alphaTest:aa.alphaTest,metal:aa.metal,perPixel:aa.perPixel,wrapAround:aa.wrapAround,doubleSided:aa.side===THREE.DoubleSide,flipSided:aa.side===THREE.BackSide,instanced_drawing:sr&&sa.instanced_drawing},aa.program=je(ba,aa.fragmentShader,aa.vertexShader,aa.uniforms,aa.attributes,aa.defines,ga);var Sa=aa.program.attributes;if(aa.morphTargets){aa.numSupportedMorphTargets=0;var Ma='morphTarget',Ta;for(ha=0;ha<this.maxMorphTargets;ha++)Ta=Ma+ha,0<=Sa[Ta]&&aa.numSupportedMorphTargets++}if(aa.morphNormals){aa.numSupportedMorphNormals=0;var Ma='morphNormal',Ta;for(ha=0;ha<this.maxMorphNormals;ha++)Ta=Ma+ha,0<=Sa[Ta]&&aa.numSupportedMorphNormals++}for(la in aa.uniformsList=[],aa.uniforms)self.MMD_SA&&'depth_render_mode'==la&&MMD_SA._depth_render_uniform_list.push({name:aa.name||'',uniform:aa.uniforms.depth_render_mode}),aa.uniformsList.push([aa.uniforms[la],la])};this.setFaceCulling=function(aa,oa){aa===THREE.CullFaceNone?ir.disable(ir.CULL_FACE):(oa===THREE.FrontFaceDirectionCW?ir.frontFace(ir.CW):ir.frontFace(ir.CCW),aa===THREE.CullFaceBack?ir.cullFace(ir.BACK):aa===THREE.CullFaceFront?ir.cullFace(ir.FRONT):ir.cullFace(ir.FRONT_AND_BACK),ir.enable(ir.CULL_FACE))},this.setMaterialFaces=function(aa){var oa=aa.side===THREE.DoubleSide,ia=aa.side===THREE.BackSide;Pt!==oa&&(oa?ir.disable(ir.CULL_FACE):ir.enable(ir.CULL_FACE),Pt=oa),Lt!==ia&&(ia?ir.frontFace(ir.CW):ir.frontFace(ir.CCW),Lt=ia)},this.setDepthTest=function(aa){Vt!==aa&&(aa?ir.enable(ir.DEPTH_TEST):ir.disable(ir.DEPTH_TEST),Vt=aa)},this.setDepthWrite=function(aa){It!==aa&&(ir.depthMask(aa),It=aa)};this.setBlending=function(aa,oa,ia,sa){aa!==Ut&&(aa===THREE.NoBlending?ir.disable(ir.BLEND):aa===THREE.AdditiveBlending?(ir.enable(ir.BLEND),ir.blendEquation(ir.FUNC_ADD),ir.blendFunc(ir.SRC_ALPHA,ir.ONE)):aa===THREE.SubtractiveBlending?(ir.enable(ir.BLEND),ir.blendEquation(ir.FUNC_ADD),ir.blendFunc(ir.ZERO,ir.ONE_MINUS_SRC_COLOR)):aa===THREE.MultiplyBlending?(ir.enable(ir.BLEND),ir.blendEquation(ir.FUNC_ADD),ir.blendFunc(ir.ZERO,ir.SRC_COLOR)):aa===THREE.CustomBlending?ir.enable(ir.BLEND):(ir.enable(ir.BLEND),ir.blendEquation(ir.FUNC_ADD),ir.blendFuncSeparate(ir.SRC_ALPHA,ir.ONE_MINUS_SRC_ALPHA,ir.ONE,ir.ONE_MINUS_SRC_ALPHA)),Ut=aa),aa===THREE.CustomBlending?(oa!==Nt&&(ir.blendEquation(it(oa)),Nt=oa),(ia!==Ft||sa!==zt)&&(ir.blendFunc(it(ia),it(sa)),Ft=ia,zt=sa)):(Nt=null,Ft=null,zt=null)};var ra=document.createElement('canvas');ra.width=ra.height=1,this.setTexture=function(aa,oa){if(aa.needsUpdate){aa.__webglInit||(aa.__webglInit=!0,aa.addEventListener('dispose',zr),aa.__webglTexture=ir.createTexture(),bt.info.memory.textures++),ir.activeTexture(ir.TEXTURE0+oa),ir.bindTexture(ir.TEXTURE_2D,aa.__webglTexture),ir.pixelStorei(ir.UNPACK_FLIP_Y_WEBGL,aa.flipY),ir.pixelStorei(ir.UNPACK_PREMULTIPLY_ALPHA_WEBGL,aa.premultiplyAlpha),ir.pixelStorei(ir.UNPACK_ALIGNMENT,aa.unpackAlignment);var ia=aa.image,sa=Qe(ia.width)&&Qe(ia.height),la=it(aa.format),da=it(aa.type),fa=MMD_SA.webgl2_RGBA_internal(ir,la,da);Ze(ir.TEXTURE_2D,aa,sa);var ga=aa.mipmaps,ha;if(aa instanceof THREE.DataTexture){if(0<ga.length&&sa){for(var ya=0,_a=ga.length;ya<_a;ya++)ha=ga[ya],ir.texImage2D(ir.TEXTURE_2D,ya,fa,ha.width,ha.height,0,la,da,ha.data);aa.generateMipmaps=!1}else ir.texImage2D(ir.TEXTURE_2D,0,fa,ia.width,ia.height,0,la,da,ia.data);}else if(aa instanceof THREE.CompressedTexture)for(var ya=0,_a=ga.length;ya<_a;ya++)ha=ga[ya],ir.compressedTexImage2D(ir.TEXTURE_2D,ya,la,ha.width,ha.height,0,ha.data);else if(0<ga.length&&sa){for(var ya=0,_a=ga.length;ya<_a;ya++)ha=ga[ya],ir.texImage2D(ir.TEXTURE_2D,ya,fa,la,da,ha);aa.generateMipmaps=!1}else{var xa='IMG'!=ia.tagName||ia.src&&ia.complete?ia:ra;ir.texImage2D(ir.TEXTURE_2D,0,fa,la,da,xa)}aa.generateMipmaps&&sa&&ir.generateMipmap(ir.TEXTURE_2D),aa.needsUpdate=!1,aa.onUpdate&&aa.onUpdate()}else ir.activeTexture(ir.TEXTURE0+oa),ir.bindTexture(ir.TEXTURE_2D,aa.__webglTexture)};this.setRenderTarget=function(aa){var oa=aa instanceof THREE.WebGLRenderTargetCube;if(aa&&!aa.__webglFramebuffer){aa.depthBuffer===void 0&&(aa.depthBuffer=!0),aa.stencilBuffer===void 0&&(aa.stencilBuffer=!0),aa.addEventListener('dispose',Vr),aa.__webglTexture=ir.createTexture(),bt.info.memory.textures++;var ia=Qe(aa.width)&&Qe(aa.height),sa=it(aa.format),la=it(aa.type),da=MMD_SA.webgl2_RGBA_internal(ir,sa,la);if(oa){aa.__webglFramebuffer=[],aa.__webglRenderbuffer=[],ir.bindTexture(ir.TEXTURE_CUBE_MAP,aa.__webglTexture),Ze(ir.TEXTURE_CUBE_MAP,aa,ia);for(var fa=0;6>fa;fa++)aa.__webglFramebuffer[fa]=ir.createFramebuffer(),aa.__webglRenderbuffer[fa]=ir.createRenderbuffer(),ir.texImage2D(ir.TEXTURE_CUBE_MAP_POSITIVE_X+fa,0,da,aa.width,aa.height,0,sa,la,null),tt(aa.__webglFramebuffer[fa],aa,ir.TEXTURE_CUBE_MAP_POSITIVE_X+fa),rt(aa.__webglRenderbuffer[fa],aa)}else{if(aa.__webglFramebuffer=ir.createFramebuffer(),aa._use_multisample){aa.__webglMSAAFramebuffer=ir.createFramebuffer(),aa.__webglMSAAColorbuffer=ir.createRenderbuffer(),ir.bindFramebuffer(ir.FRAMEBUFFER,aa.__webglMSAAFramebuffer);var ha=ir.RGBA8;ir.bindRenderbuffer(ir.RENDERBUFFER,aa.__webglMSAAColorbuffer),ir.renderbufferStorageMultisample(ir.RENDERBUFFER,aa._use_multisample,ha,aa.width,aa.height),ir.framebufferRenderbuffer(ir.FRAMEBUFFER,ir.COLOR_ATTACHMENT0,ir.RENDERBUFFER,aa.__webglMSAAColorbuffer),aa.depthBuffer&&(aa.__webglMSAADepthbuffer=ir.createRenderbuffer(),rt(aa.__webglMSAADepthbuffer,aa)),ir.bindFramebuffer(ir.FRAMEBUFFER,null)}if(ir.bindTexture(ir.TEXTURE_2D,aa.__webglTexture),Ze(ir.TEXTURE_2D,aa,ia),ir.texImage2D(ir.TEXTURE_2D,0,da,aa.width,aa.height,0,sa,la,null),tt(aa.__webglFramebuffer,aa,ir.TEXTURE_2D),!aa._use_multisample)if(aa.__webglRenderbuffer=aa.shareDepthFrom?aa.shareDepthFrom.__webglRenderbuffer:ir.createRenderbuffer(),aa.shareDepthFrom)aa.depthBuffer&&!aa.stencilBuffer?ir.framebufferRenderbuffer(ir.FRAMEBUFFER,ir.DEPTH_ATTACHMENT,ir.RENDERBUFFER,aa.__webglRenderbuffer):aa.depthBuffer&&aa.stencilBuffer&&ir.framebufferRenderbuffer(ir.FRAMEBUFFER,ir.DEPTH_STENCIL_ATTACHMENT,ir.RENDERBUFFER,aa.__webglRenderbuffer);else{var ga=aa._use_multisample;aa._use_multisample=null,rt(aa.__webglRenderbuffer,aa),aa._use_multisample=ga}}oa?ir.bindTexture(ir.TEXTURE_CUBE_MAP,null):ir.bindTexture(ir.TEXTURE_2D,null),ir.bindRenderbuffer(ir.RENDERBUFFER,null),ir.bindFramebuffer(ir.FRAMEBUFFER,null)}var ya,_a,xa,ba,Sa;aa?(ya=oa?aa.__webglFramebuffer[aa.activeCubeFace]:aa._use_multisample?aa.__webglMSAAFramebuffer:aa.__webglFramebuffer,_a=aa.width,xa=aa.height,ba=0,Sa=0):(ya=this.device_framebuffer,_a=jt,xa=Xt,ba=Ht,Sa=Wt),ya!==At&&(ir.bindFramebuffer(ir.FRAMEBUFFER,ya),ir.viewport(ba,Sa,_a,xa),At=ya),Yt=_a,Kt=xa};THREE.ShadowMapPlugin&&(this.shadowMapPlugin=new THREE.ShadowMapPlugin,this.addPrePlugin(this.shadowMapPlugin)),this.addPostPlugin(new THREE.SpritePlugin),THREE.LensFlarePlugin&&this.addPostPlugin(new THREE.LensFlarePlugin)},Object.defineProperty(THREE.WebGLRenderer.prototype,'device_framebuffer',{get:function(){return this._device_framebuffer||null},set:function(_){let S=this._device_framebuffer||null;if(_!=S){this._device_framebuffer=_;let T=this.getContext();T.bindFramebuffer(T.FRAMEBUFFER,_)}}}),THREE.WebGLRenderTarget=function(_,S,T){this.width=_,this.height=S,T=T||{},this.wrapS=T.wrapS===void 0?THREE.ClampToEdgeWrapping:T.wrapS,this.wrapT=T.wrapT===void 0?THREE.ClampToEdgeWrapping:T.wrapT,this.magFilter=T.magFilter===void 0?THREE.LinearFilter:T.magFilter,this.minFilter=T.minFilter===void 0?THREE.LinearMipMapLinearFilter:T.minFilter,this.anisotropy=T.anisotropy===void 0?1:T.anisotropy,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.format=T.format===void 0?THREE.RGBAFormat:T.format,this.type=T.type===void 0?THREE.UnsignedByteType:T.type,this.depthBuffer=!(T.depthBuffer!==void 0)||T.depthBuffer,this.stencilBuffer=!(T.stencilBuffer!==void 0)||T.stencilBuffer,this.generateMipmaps=!0,this.shareDepthFrom=null},THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,clone:function(){var _=new THREE.WebGLRenderTarget(this.width,this.height);return _.wrapS=this.wrapS,_.wrapT=this.wrapT,_.magFilter=this.magFilter,_.minFilter=this.minFilter,_.anisotropy=this.anisotropy,_.offset.copy(this.offset),_.repeat.copy(this.repeat),_.format=this.format,_.type=this.type,_.depthBuffer=this.depthBuffer,_.stencilBuffer=this.stencilBuffer,_.generateMipmaps=this.generateMipmaps,_.shareDepthFrom=this.shareDepthFrom,_},dispose:function(){this.dispatchEvent({type:'dispose'})}},THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube=function(_,S,T){THREE.WebGLRenderTarget.call(this,_,S,T),this.activeCubeFace=0},THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype),THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(_){this.positionWorld.copy(_.positionWorld),this.positionScreen.copy(_.positionScreen)},THREE.RenderableFace3=function(){this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.centroidModel=new THREE.Vector3,this.normalModel=new THREE.Vector3,this.normalModelView=new THREE.Vector3,this.vertexNormalsLength=0,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.color=null,this.material=null,this.uvs=[[]],this.z=null},THREE.RenderableFace4=function(){this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.v4=new THREE.RenderableVertex,this.centroidModel=new THREE.Vector3,this.normalModel=new THREE.Vector3,this.normalModelView=new THREE.Vector3,this.vertexNormalsLength=0,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.color=null,this.material=null,this.uvs=[[]],this.z=null},THREE.RenderableObject=function(){this.object=null,this.z=null},THREE.RenderableParticle=function(){this.object=null,this.x=null,this.y=null,this.z=null,this.rotation=null,this.scale=new THREE.Vector2,this.material=null},THREE.RenderableLine=function(){this.z=null,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null},THREE.GeometryUtils={merge:function(_,S,T){var E=_.vertices.length,C=_.faceVertexUvs[0].length,D=S instanceof THREE.Mesh?S.geometry:S,R=_.vertices,P=D.vertices,L=_.faces,U=D.faces,N=_.faceVertexUvs[0],F=D.faceVertexUvs[0],M,A;T===void 0&&(T=0),S instanceof THREE.Mesh&&(S.matrixAutoUpdate&&S.updateMatrix(),M=S.matrix,A=new THREE.Matrix3().getNormalMatrix(M));for(var V=0,I=P.length;V<I;V++){var O=P[V],B=O.clone();M&&B.applyMatrix4(M),R.push(B)}for(V=0,I=U.length;V<I;V++){var G=U[V],Y=G.vertexNormals,K=G.vertexColors,H,W,X;G instanceof THREE.Face3?H=new THREE.Face3(G.a+E,G.b+E,G.c+E):G instanceof THREE.Face4&&(H=new THREE.Face4(G.a+E,G.b+E,G.c+E,G.d+E)),H.normal.copy(G.normal),A&&H.normal.applyMatrix3(A).normalize();for(var Q=0,Z=Y.length;Q<Z;Q++)W=Y[Q].clone(),A&&W.applyMatrix3(A).normalize(),H.vertexNormals.push(W);H.color.copy(G.color);for(var Q=0,Z=K.length;Q<Z;Q++)X=K[Q],H.vertexColors.push(X.clone());H.materialIndex=G.materialIndex+T,H.centroid.copy(G.centroid),M&&H.centroid.applyMatrix4(M),L.push(H)}for(V=0,I=F.length;V<I;V++){for(var J=F[V],ee=[],Q=0,Z=J.length;Q<Z;Q++)ee.push(new THREE.Vector2(J[Q].x,J[Q].y));N.push(ee)}},removeMaterials:function(_,S){for(var T={},M=0,A=S.length;M<A;M++)T[S[M]]=!0;for(var C=[],M=0,A=_.faces.length,E;M<A;M++)E=_.faces[M],E.materialIndex in T||C.push(E);_.faces=C},randomPointInTriangle:function(_,S,T){var C=new THREE.Vector3,D=THREE.GeometryUtils.__v1,M,A,E;return M=THREE.GeometryUtils.random(),A=THREE.GeometryUtils.random(),1<M+A&&(M=1-M,A=1-A),E=1-M-A,C.copy(_),C.multiplyScalar(M),D.copy(S),D.multiplyScalar(A),C.add(D),D.copy(T),D.multiplyScalar(E),C.add(D),C},randomPointInFace:function(_,S,T){var M,A,E,C;if(_ instanceof THREE.Face3)return M=S.vertices[_.a],A=S.vertices[_.b],E=S.vertices[_.c],THREE.GeometryUtils.randomPointInTriangle(M,A,E);if(_ instanceof THREE.Face4){M=S.vertices[_.a],A=S.vertices[_.b],E=S.vertices[_.c],C=S.vertices[_.d];var D,R;T?_._area1&&_._area2?(D=_._area1,R=_._area2):(D=THREE.GeometryUtils.triangleArea(M,A,C),R=THREE.GeometryUtils.triangleArea(A,E,C),_._area1=D,_._area2=R):(D=THREE.GeometryUtils.triangleArea(M,A,C),R=THREE.GeometryUtils.triangleArea(A,E,C));var P=THREE.GeometryUtils.random()*(D+R);return P<D?THREE.GeometryUtils.randomPointInTriangle(M,A,C):THREE.GeometryUtils.randomPointInTriangle(A,E,C)}},randomPointsInGeometry:function(_,S){function T(G){function H(W,X){if(X<W)return W;var Y=W+Math.floor((X-W)/2);return P[Y]>G?H(W,Y-1):P[Y]<G?H(Y+1,X):Y}return H(0,P.length-1)}var E=_.faces,C=_.vertices,D=E.length,R=0,P=[],M,A,L,U,N,F;for(A=0;A<D;A++)M=E[A],M instanceof THREE.Face3?(L=C[M.a],U=C[M.b],N=C[M.c],M._area=THREE.GeometryUtils.triangleArea(L,U,N)):M instanceof THREE.Face4&&(L=C[M.a],U=C[M.b],N=C[M.c],F=C[M.d],M._area1=THREE.GeometryUtils.triangleArea(L,U,F),M._area2=THREE.GeometryUtils.triangleArea(U,N,F),M._area=M._area1+M._area2),R+=M._area,P[A]=R;var O=[],V,I,B={};for(A=0;A<S;A++)V=THREE.GeometryUtils.random()*R,I=T(V),O[A]=THREE.GeometryUtils.randomPointInFace(E[I],_,!0),B[I]?B[I]+=1:B[I]=1;return O},triangleArea:function(_,S,T){var M=THREE.GeometryUtils.__v1,A=THREE.GeometryUtils.__v2;return M.subVectors(S,_),A.subVectors(T,_),M.cross(A),0.5*M.length()},center:function(_){_.computeBoundingBox();var S=_.boundingBox,T=new THREE.Vector3;return T.addVectors(S.min,S.max),T.multiplyScalar(-0.5),_.applyMatrix(new THREE.Matrix4().makeTranslation(T.x,T.y,T.z)),_.computeBoundingBox(),T},normalizeUVs:function(_){for(var S=_.faceVertexUvs[0],T=0,M=S.length,A;T<M;T++){A=S[T];for(var E=0,C=A.length;E<C;E++)1!==A[E].x&&(A[E].x-=Math.floor(A[E].x)),1!==A[E].y&&(A[E].y-=Math.floor(A[E].y))}},triangulateQuads:function(_){var S,T,M,A,E=[],C=[],D=[];for(S=0,T=_.faceUvs.length;S<T;S++)C[S]=[];for(S=0,T=_.faceVertexUvs.length;S<T;S++)D[S]=[];for(S=0,T=_.faces.length;S<T;S++){var R=_.faces[S];if(R instanceof THREE.Face4){var P=R.a,L=R.b,U=R.c,N=R.d,F=new THREE.Face3,V=new THREE.Face3;for(F.color.copy(R.color),V.color.copy(R.color),F.materialIndex=R.materialIndex,V.materialIndex=R.materialIndex,F.a=P,F.b=L,F.c=N,V.a=L,V.b=U,V.c=N,4===R.vertexColors.length&&(F.vertexColors[0]=R.vertexColors[0].clone(),F.vertexColors[1]=R.vertexColors[1].clone(),F.vertexColors[2]=R.vertexColors[3].clone(),V.vertexColors[0]=R.vertexColors[1].clone(),V.vertexColors[1]=R.vertexColors[2].clone(),V.vertexColors[2]=R.vertexColors[3].clone()),E.push(F,V),(M=0,A=_.faceVertexUvs.length);M<A;M++)if(_.faceVertexUvs[M].length){var I=_.faceVertexUvs[M][S],O=I[0],B=I[1],G=I[2],H=I[3],W=[O.clone(),B.clone(),H.clone()],X=[B.clone(),G.clone(),H.clone()];D[M].push(W,X)}for(M=0,A=_.faceUvs.length;M<A;M++)if(_.faceUvs[M].length){var Y=_.faceUvs[M][S];C[M].push(Y,Y)}}else{for(E.push(R),M=0,A=_.faceUvs.length;M<A;M++)C[M].push(_.faceUvs[M][S]);for(M=0,A=_.faceVertexUvs.length;M<A;M++)D[M].push(_.faceVertexUvs[M][S])}}_.faces=E,_.faceUvs=C,_.faceVertexUvs=D,_.computeCentroids(),_.computeFaceNormals(),_.computeVertexNormals(),_.hasTangents&&_.computeTangents()},setMaterialIndex:function(_,S,T,M){for(var A=_.faces,C=M||A.length-1,D=T||0;D<=C;D++)A[D].materialIndex=S}},THREE.GeometryUtils.random=THREE.Math.random16,THREE.GeometryUtils.__v1=new THREE.Vector3,THREE.GeometryUtils.__v2=new THREE.Vector3,THREE.ImageUtils={loadTexture:function(_,S,T,M,A){var E=new Image;A&&A.texture_resolution_limit&&(E._texture_resolution_limit=A.texture_resolution_limit);var C=new THREE.Texture(E,S),D=new THREE.ImageLoader;return D.addEventListener('load',function(R){C.image=R.content,C.needsUpdate=!0,T&&T(C)}),D.addEventListener('error',function(R){M&&M(R.message)}),D.load(_,E),C.sourceFile=_,C},loadCompressedTexture:function(_,S,T,M){var A=new THREE.CompressedTexture;A.mapping=S;var E=new XMLHttpRequestZIP;return E.onload=function(){var C=E.response,D=THREE.ImageUtils.parseDDS(C,!0);A.format=D.format,A.mipmaps=D.mipmaps,A.image.width=D.width,A.image.height=D.height,A.generateMipmaps=!1,A.needsUpdate=!0,T&&T(A)},E.onerror=M,E.open('GET',_,!0),E.responseType='arraybuffer',E.send(null),A},loadTextureCube:function(_,S,T,M){var A=[];A.loadCount=0;var E=new THREE.Texture;E.image=A,S!==void 0&&(E.mapping=S),E.flipY=!1;for(var C=0,D=_.length,R;C<D;++C)R=new Image,A[C]=R,R.onload=function(){A.loadCount+=1,6===A.loadCount&&(E.needsUpdate=!0,T&&T(E))},R.onerror=M,/^data:image/.test(_[C])||/^(tga|TGA)/.test(_[C].split('.').pop())||(R.crossOrigin='anonymous'),R.src=_[C];return E},loadCompressedTextureCube:function(_,S,T,M){var A=[];A.loadCount=0;var E=new THREE.CompressedTexture;E.image=A,S!==void 0&&(E.mapping=S),E.flipY=!1,E.generateMipmaps=!1;var C=function(N,F){return function(){var V=N.response,I=THREE.ImageUtils.parseDDS(V,!0);F.format=I.format,F.mipmaps=I.mipmaps,F.width=I.width,F.height=I.height,A.loadCount+=1,6===A.loadCount&&(E.format=I.format,E.needsUpdate=!0,T&&T(E))}};if(_ instanceof Array)for(var D=0,R=_.length,P;D<R;++D){P={},A[D]=P;var L=new XMLHttpRequestZIP;L.onload=C(L,P),L.onerror=M;var U=_[D];L.open('GET',U,!0),L.responseType='arraybuffer',L.send(null)}else{var U=_,L=new XMLHttpRequestZIP;L.onload=function(){var N=L.response,F=THREE.ImageUtils.parseDDS(N,!0);if(F.isCubemap){for(var V=F.mipmaps.length/F.mipmapCount,I=0;I<V;I++){A[I]={mipmaps:[]};for(var O=0;O<F.mipmapCount;O++)A[I].mipmaps.push(F.mipmaps[I*F.mipmapCount+O]),A[I].format=F.format,A[I].width=F.width,A[I].height=F.height}E.format=F.format,E.needsUpdate=!0,T&&T(E)}},L.onerror=M,L.open('GET',U,!0),L.responseType='arraybuffer',L.send(null)}return E},parseDDS:function(_,S){function T(Oe){return Oe.charCodeAt(0)+(Oe.charCodeAt(1)<<8)+(Oe.charCodeAt(2)<<16)+(Oe.charCodeAt(3)<<24)}function M(Oe){return String.fromCharCode(255&Oe,255&Oe>>8,255&Oe>>16,255&Oe>>24)}var A={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},se=T('DXT1'),le=T('DXT3'),pe=T('DXT5'),Ee=new Int32Array(_,0,31);if(Ee[0]!==542327876)return console.error('ImageUtils.parseDDS(): Invalid magic number in DDS header'),A;if(!Ee[20]&4)return console.error('ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code'),A;var Ce,De=Ee[21];switch(De){case se:Ce=8,A.format=THREE.RGB_S3TC_DXT1_Format;break;case le:Ce=16,A.format=THREE.RGBA_S3TC_DXT3_Format;break;case pe:Ce=16,A.format=THREE.RGBA_S3TC_DXT5_Format;break;default:return console.error('ImageUtils.parseDDS(): Unsupported FourCC code: ',M(De)),A;}A.mipmapCount=1,Ee[2]&131072&&!1!==S&&(A.mipmapCount=Math.max(1,Ee[7])),A.isCubemap=!!(Ee[28]&512),A.width=Ee[4],A.height=Ee[3];for(var Re=Ee[1]+4,Pe=A.width,Le=A.height,Ue=A.isCubemap?6:1,Ne=0;Ne<Ue;Ne++){for(var Fe=0;Fe<A.mipmapCount;Fe++){var ze=Math.max(4,Pe)/4*Math.max(4,Le)/4*Ce,Ve=new Uint8Array(_,Re,ze),Ie={data:Ve,width:Pe,height:Le};A.mipmaps.push(Ie),Re+=ze,Pe=Math.max(0.5*Pe,1),Le=Math.max(0.5*Le,1)}Pe=A.width,Le=A.height}return A},getNormalMap:function(_,S){var T=function(ee,oe){return[ee[1]*oe[2]-ee[2]*oe[1],ee[2]*oe[0]-ee[0]*oe[2],ee[0]*oe[1]-ee[1]*oe[0]]},M=function(ee,oe){return[ee[0]-oe[0],ee[1]-oe[1],ee[2]-oe[2]]},A=function(ee){var oe=Math.sqrt(ee[0]*ee[0]+ee[1]*ee[1]+ee[2]*ee[2]);return[ee[0]/oe,ee[1]/oe,ee[2]/oe]};S|=1;var E=_.width,C=_.height,D=document.createElement('canvas');D.width=E,D.height=C;var R=D.getContext('2d');R.drawImage(_,0,0);for(var P=R.getImageData(0,0,E,C).data,L=R.createImageData(E,C),U=L.data,N=0;N<E;N++)for(var F=0;F<C;F++){var V=0>F-1?0:F-1,I=F+1>C-1?C-1:F+1,O=0>N-1?0:N-1,B=N+1>E-1?E-1:N+1,G=[],H=[0,0,P[4*(F*E+N)]/255*S];G.push([-1,0,P[4*(F*E+O)]/255*S]),G.push([-1,-1,P[4*(V*E+O)]/255*S]),G.push([0,-1,P[4*(V*E+N)]/255*S]),G.push([1,-1,P[4*(V*E+B)]/255*S]),G.push([1,0,P[4*(F*E+B)]/255*S]),G.push([1,1,P[4*(I*E+B)]/255*S]),G.push([0,1,P[4*(I*E+N)]/255*S]),G.push([-1,1,P[4*(I*E+O)]/255*S]);for(var W=[],X=G.length,Y=0;Y<X;Y++){var K=G[Y],Q=G[(Y+1)%X];K=M(K,H),Q=M(Q,H),W.push(A(T(K,Q)))}for(var Z=[0,0,0],Y=0;Y<W.length;Y++)Z[0]+=W[Y][0],Z[1]+=W[Y][1],Z[2]+=W[Y][2];Z[0]/=W.length,Z[1]/=W.length,Z[2]/=W.length;var J=4*(F*E+N);U[J]=0|255*((Z[0]+1)/2),U[J+1]=0|255*((Z[1]+1)/2),U[J+2]=0|255*Z[2],U[J+3]=255}return R.putImageData(L,0,0),D},generateDataTexture:function(_,S,T){for(var M=_*S,A=new Uint8Array(3*M),E=Math.floor(255*T.r),C=Math.floor(255*T.g),D=Math.floor(255*T.b),R=0;R<M;R++)A[3*R]=E,A[3*R+1]=C,A[3*R+2]=D;var P=new THREE.DataTexture(A,_,S,THREE.RGBFormat);return P.needsUpdate=!0,P}},THREE.SceneUtils={createMultiMaterialObject:function(_,S){for(var T=new THREE.Object3D,M=0,A=S.length;M<A;M++)T.add(new THREE.Mesh(_,S[M]));return T},detach:function(_,S,T){_.applyMatrix(S.matrixWorld),S.remove(_),T.add(_)},attach:function(_,S,T){var M=new THREE.Matrix4;M.getInverse(T.matrixWorld),_.applyMatrix(M),S.remove(_),T.add(_)}},THREE.FontUtils={faces:{},face:'helvetiker',weight:'normal',style:'normal',size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(_){var S=_.familyName.toLowerCase(),T=this;T.faces[S]=T.faces[S]||{},T.faces[S][_.cssFontWeight]=T.faces[S][_.cssFontWeight]||{},T.faces[S][_.cssFontWeight][_.cssFontStyle]=_;T.faces[S][_.cssFontWeight][_.cssFontStyle]=_;return _},drawText:function(_){var M,E=this.getFace(),C=this.size/E.resolution,D=0,R=(_+'').split(''),P=R.length,L=[];for(M=0;M<P;M++){var U=new THREE.Path,N=this.extractGlyphPoints(R[M],E,C,D,U);D+=N.offset,L.push(N.path)}var F=D/2;return{paths:L,offset:F}},extractGlyphPoints:function(_,S,T,M,A){var E=[],C,D,R,P,L,U,N,F,V,I,O,B,G,H,W,X,Y,K,Q,Z=S.glyphs[_]||S.glyphs['?'];if(Z){if(Z.o)for(P=Z._cachedOutline||(Z._cachedOutline=Z.o.split(' ')),U=P.length,N=T,F=T,C=0;C<U;)switch(L=P[C++],L){case'm':V=P[C++]*N+M,I=P[C++]*F,A.moveTo(V,I);break;case'l':V=P[C++]*N+M,I=P[C++]*F,A.lineTo(V,I);break;case'q':if(O=P[C++]*N+M,B=P[C++]*F,W=P[C++]*N+M,X=P[C++]*F,A.quadraticCurveTo(W,X,O,B),Q=E[E.length-1],Q)for(G=Q.x,H=Q.y,(D=1,R=this.divisions);D<=R;D++)var J=D/R,ee=THREE.Shape.Utils.b2(J,G,W,O),oe=THREE.Shape.Utils.b2(J,H,X,B);break;case'b':if(O=P[C++]*N+M,B=P[C++]*F,W=P[C++]*N+M,X=P[C++]*-F,Y=P[C++]*N+M,K=P[C++]*-F,A.bezierCurveTo(O,B,W,X,Y,K),Q=E[E.length-1],Q)for(G=Q.x,H=Q.y,(D=1,R=this.divisions);D<=R;D++)var J=D/R,ee=THREE.Shape.Utils.b3(J,G,W,Y,O),oe=THREE.Shape.Utils.b3(J,H,X,K,B);}return{offset:Z.ha*T,path:A}}}},THREE.FontUtils.generateShapes=function(_,S){S=S||{};var T=S.size===void 0?100:S.size,M=S.curveSegments===void 0?4:S.curveSegments,A=S.font===void 0?'helvetiker':S.font,E=S.weight===void 0?'normal':S.weight,C=S.style===void 0?'normal':S.style;THREE.FontUtils.size=T,THREE.FontUtils.divisions=M,THREE.FontUtils.face=A,THREE.FontUtils.weight=E,THREE.FontUtils.style=C;for(var D=THREE.FontUtils.drawText(_),R=D.paths,P=[],L=0,U=R.length;L<U;L++)Array.prototype.push.apply(P,R[L].toShapes());return P},function(_){var M=function(E){for(var C=E.length,D=0,R=C-1,P=0;P<C;R=P++)D+=E[R].x*E[P].y-E[P].x*E[R].y;return 0.5*D},A=function(E,C,D,R,P,L){var U,N,F,V,I,O,B,G,H;if(N=E[L[C]].x,F=E[L[C]].y,V=E[L[D]].x,I=E[L[D]].y,O=E[L[R]].x,B=E[L[R]].y,1e-10>(V-N)*(B-F)-(I-F)*(O-N))return!1;var W,X,Y,K,Q,Z,J,ee,oe,ie,ne,se,le,pe,ue;for(W=O-V,X=B-I,Y=N-O,K=F-B,Q=V-N,Z=I-F,U=0;U<P;U++)if(U!==C&&U!==D&&U!==R&&(G=E[L[U]].x,H=E[L[U]].y,J=G-N,ee=H-F,oe=G-V,ie=H-I,ne=G-O,se=H-B,ue=W*ie-X*oe,le=Q*ee-Z*J,pe=Y*se-K*ne,0<=ue&&0<=pe&&0<=le))return!1;return!0};return _.Triangulate=function(E,C){var D=E.length;if(3>D)return null;var R=[],P=[],L=[],U,N,F;if(0<M(E))for(N=0;N<D;N++)P[N]=N;else for(N=0;N<D;N++)P[N]=D-1-N;var V=D,I=2*V;for(N=V-1;2<V;){if(0>=I--)return console.log('Warning, unable to triangulate polygon!'),C?L:R;if(U=N,V<=U&&(U=0),N=U+1,V<=N&&(N=0),F=N+1,V<=F&&(F=0),A(E,U,N,F,V,P)){var O,B,G,H,W;for(O=P[U],B=P[N],G=P[F],R.push([E[O],E[B],E[G]]),L.push([P[U],P[N],P[F]]),(H=N,W=N+1);W<V;H++,W++)P[H]=P[W];V--,I=2*V}}return C?L:R},_.Triangulate.area=M,_}(THREE.FontUtils),self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace},THREE.typeface_js=self._typeface_js,THREE.Curve=function(){},THREE.Curve.prototype.getPointAt=function(_){var S=this.getUtoTmapping(_);return this.getPoint(S)},THREE.Curve.prototype.getPoints=function(_){_||(_=5);var T=[],S;for(S=0;S<=_;S++)T.push(this.getPoint(S/_));return T},THREE.Curve.prototype.getSpacedPoints=function(_){_||(_=5);var T=[],S;for(S=0;S<=_;S++)T.push(this.getPointAt(S/_));return T},THREE.Curve.prototype.getLength=function(){var _=this.getLengths();return _[_.length-1]},THREE.Curve.prototype.getLengths=function(_){if(_||(_=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==_+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var S=[],M=this.getPoint(0),E=0,T,A;for(S.push(0),A=1;A<=_;A++)T=this.getPoint(A/_),E+=T.distanceTo(M),S.push(E),M=T;return this.cacheArcLengths=S,S},THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},THREE.Curve.prototype.getUtoTmapping=function(_,S){var T=this.getLengths(),M=0,A=T.length,E;E=S?S:_*T[A-1];for(var C=0,D=A-1,R;C<=D;)if(M=Math.floor(C+(D-C)/2),R=T[M]-E,0>R){C=M+1;continue}else if(0<R){D=M-1;continue}else{D=M;break}if(M=D,T[M]==E){var P=M/(A-1);return P}var L=T[M],U=T[M+1],F=(E-L)/(U-L),P=(M+F)/(A-1);return P},THREE.Curve.prototype.getTangent=function(_){var S=1e-4,T=_-S,M=_+S;0>T&&(T=0),1<M&&(M=1);var A=this.getPoint(T),E=this.getPoint(M),C=E.clone().sub(A);return C.normalize()},THREE.Curve.prototype.getTangentAt=function(_){var S=this.getUtoTmapping(_);return this.getTangent(S)},THREE.LineCurve=function(_,S){this.v1=_,this.v2=S},THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.LineCurve.prototype.getPoint=function(_){var S=this.v2.clone().sub(this.v1);return S.multiplyScalar(_).add(this.v1),S},THREE.LineCurve.prototype.getPointAt=function(_){return this.getPoint(_)},THREE.LineCurve.prototype.getTangent=function(){var S=this.v2.clone().sub(this.v1);return S.normalize()},THREE.QuadraticBezierCurve=function(_,S,T){this.v0=_,this.v1=S,this.v2=T},THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.QuadraticBezierCurve.prototype.getPoint=function(_){var S,T;return S=THREE.Shape.Utils.b2(_,this.v0.x,this.v1.x,this.v2.x),T=THREE.Shape.Utils.b2(_,this.v0.y,this.v1.y,this.v2.y),new THREE.Vector2(S,T)},THREE.QuadraticBezierCurve.prototype.getTangent=function(_){var S,T;S=THREE.Curve.Utils.tangentQuadraticBezier(_,this.v0.x,this.v1.x,this.v2.x),T=THREE.Curve.Utils.tangentQuadraticBezier(_,this.v0.y,this.v1.y,this.v2.y);var M=new THREE.Vector2(S,T);return M.normalize(),M},THREE.CubicBezierCurve=function(_,S,T,M){this.v0=_,this.v1=S,this.v2=T,this.v3=M},THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.CubicBezierCurve.prototype.getPoint=function(_){var S,T;return S=THREE.Shape.Utils.b3(_,this.v0.x,this.v1.x,this.v2.x,this.v3.x),T=THREE.Shape.Utils.b3(_,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new THREE.Vector2(S,T)},THREE.CubicBezierCurve.prototype.getTangent=function(_){var S,T;S=THREE.Curve.Utils.tangentCubicBezier(_,this.v0.x,this.v1.x,this.v2.x,this.v3.x),T=THREE.Curve.Utils.tangentCubicBezier(_,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var M=new THREE.Vector2(S,T);return M.normalize(),M},THREE.SplineCurve=function(_){this.points=_==void 0?[]:_},THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.SplineCurve.prototype.getPoint=function(_){var S=new THREE.Vector2,T=[],M=this.points,A,E,C;return A=(M.length-1)*_,E=Math.floor(A),C=A-E,T[0]=0==E?E:E-1,T[1]=E,T[2]=E>M.length-2?M.length-1:E+1,T[3]=E>M.length-3?M.length-1:E+2,S.x=THREE.Curve.Utils.interpolate(M[T[0]].x,M[T[1]].x,M[T[2]].x,M[T[3]].x,C),S.y=THREE.Curve.Utils.interpolate(M[T[0]].y,M[T[1]].y,M[T[2]].y,M[T[3]].y,C),S},THREE.EllipseCurve=function(_,S,T,M,A,E,C){this.aX=_,this.aY=S,this.xRadius=T,this.yRadius=M,this.aStartAngle=A,this.aEndAngle=E,this.aClockwise=C},THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype),THREE.EllipseCurve.prototype.getPoint=function(_){var S=this.aEndAngle-this.aStartAngle;this.aClockwise||(_=1-_);var T=this.aStartAngle+_*S,M=this.aX+this.xRadius*Math.cos(T),A=this.aY+this.yRadius*Math.sin(T);return new THREE.Vector2(M,A)},THREE.ArcCurve=function(_,S,T,M,A,E){THREE.EllipseCurve.call(this,_,S,T,T,M,A,E)},THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype),THREE.Curve.Utils={tangentQuadraticBezier:function(_,S,T,M){return 2*(1-_)*(T-S)+2*_*(M-T)},tangentCubicBezier:function(_,S,T,M,A){return-3*S*(1-_)*(1-_)+3*T*(1-_)*(1-_)-6*_*T*(1-_)+6*_*M*(1-_)-3*_*_*M+3*_*_*A},tangentSpline:function(_){return 6*_*_-6*_+(3*_*_-4*_+1)+(-6*_*_+6*_)+(3*_*_-2*_)},interpolate:function(_,S,T,M,A){var E=0.5*(T-_),C=0.5*(M-S),D=A*A;return(2*S-2*T+E+C)*(A*D)+(-3*S+3*T-2*E-C)*D+E*A+S}},THREE.Curve.create=function(_,S){return _.prototype=Object.create(THREE.Curve.prototype),_.prototype.getPoint=S,_},THREE.LineCurve3=THREE.Curve.create(function(_,S){this.v1=_,this.v2=S},function(_){var S=new THREE.Vector3;return S.subVectors(this.v2,this.v1),S.multiplyScalar(_),S.add(this.v1),S}),THREE.QuadraticBezierCurve3=THREE.Curve.create(function(_,S,T){this.v0=_,this.v1=S,this.v2=T},function(_){var S,T,M;return S=THREE.Shape.Utils.b2(_,this.v0.x,this.v1.x,this.v2.x),T=THREE.Shape.Utils.b2(_,this.v0.y,this.v1.y,this.v2.y),M=THREE.Shape.Utils.b2(_,this.v0.z,this.v1.z,this.v2.z),new THREE.Vector3(S,T,M)}),THREE.CubicBezierCurve3=THREE.Curve.create(function(_,S,T,M){this.v0=_,this.v1=S,this.v2=T,this.v3=M},function(_){var S,T,M;return S=THREE.Shape.Utils.b3(_,this.v0.x,this.v1.x,this.v2.x,this.v3.x),T=THREE.Shape.Utils.b3(_,this.v0.y,this.v1.y,this.v2.y,this.v3.y),M=THREE.Shape.Utils.b3(_,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new THREE.Vector3(S,T,M)}),THREE.SplineCurve3=THREE.Curve.create(function(_){this.points=_==void 0?[]:_},function(_){var S=new THREE.Vector3,T=[],M=this.points,A,E,C;A=(M.length-1)*_,E=Math.floor(A),C=A-E,T[0]=0==E?E:E-1,T[1]=E,T[2]=E>M.length-2?M.length-1:E+1,T[3]=E>M.length-3?M.length-1:E+2;var D=M[T[0]],R=M[T[1]],P=M[T[2]],L=M[T[3]];return S.x=THREE.Curve.Utils.interpolate(D.x,R.x,P.x,L.x,C),S.y=THREE.Curve.Utils.interpolate(D.y,R.y,P.y,L.y,C),S.z=THREE.Curve.Utils.interpolate(D.z,R.z,P.z,L.z,C),S}),THREE.ClosedSplineCurve3=THREE.Curve.create(function(_){this.points=_==void 0?[]:_},function(_){var S=new THREE.Vector3,T=[],M=this.points,A,E,C;return A=(M.length-0)*_,E=Math.floor(A),C=A-E,E+=0<E?0:(Math.floor(Math.abs(E)/M.length)+1)*M.length,T[0]=(E-1)%M.length,T[1]=E%M.length,T[2]=(E+1)%M.length,T[3]=(E+2)%M.length,S.x=THREE.Curve.Utils.interpolate(M[T[0]].x,M[T[1]].x,M[T[2]].x,M[T[3]].x,C),S.y=THREE.Curve.Utils.interpolate(M[T[0]].y,M[T[1]].y,M[T[2]].y,M[T[3]].y,C),S.z=THREE.Curve.Utils.interpolate(M[T[0]].z,M[T[1]].z,M[T[2]].z,M[T[3]].z,C),S}),THREE.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype),THREE.CurvePath.prototype.add=function(_){this.curves.push(_)},THREE.CurvePath.prototype.closePath=function(){var _=this.curves[0].getPoint(0),S=this.curves[this.curves.length-1].getPoint(1);_.equals(S)||this.curves.push(new THREE.LineCurve(S,_))},THREE.CurvePath.prototype.getPoint=function(_){for(var S=_*this.getLength(),T=this.getCurveLengths(),M=0,A,E;M<T.length;){if(T[M]>=S){A=T[M]-S,E=this.curves[M];var C=1-A/E.getLength();return E.getPointAt(C)}M++}return null},THREE.CurvePath.prototype.getLength=function(){var _=this.getCurveLengths();return _[_.length-1]},THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var _=[],S=0,M=this.curves.length,T;for(T=0;T<M;T++)S+=this.curves[T].getLength(),_.push(S);return this.cacheLengths=_,_},THREE.CurvePath.prototype.getBoundingBox=function(){var _=this.getPoints(),S,T,M,A,E,C;S=T=Number.NEGATIVE_INFINITY,A=E=Number.POSITIVE_INFINITY;var U=_[0]instanceof THREE.Vector3,D,R,P,L;for(L=U?new THREE.Vector3:new THREE.Vector2,R=0,P=_.length;R<P;R++)D=_[R],D.x>S?S=D.x:D.x<A&&(A=D.x),D.y>T?T=D.y:D.y<E&&(E=D.y),U&&(D.z>M?M=D.z:D.z<C&&(C=D.z)),L.add(D);var N={minX:A,minY:E,maxX:S,maxY:T,centroid:L.divideScalar(P)};return U&&(N.maxZ=M,N.minZ=C),N},THREE.CurvePath.prototype.createPointsGeometry=function(_){var S=this.getPoints(_,!0);return this.createGeometry(S)},THREE.CurvePath.prototype.createSpacedPointsGeometry=function(_){var S=this.getSpacedPoints(_,!0);return this.createGeometry(S)},THREE.CurvePath.prototype.createGeometry=function(_){for(var S=new THREE.Geometry,T=0;T<_.length;T++)S.vertices.push(new THREE.Vector3(_[T].x,_[T].y,_[T].z||0));return S},THREE.CurvePath.prototype.addWrapPath=function(_){this.bends.push(_)},THREE.CurvePath.prototype.getTransformedPoints=function(_,S){var T=this.getPoints(_),M,A;for(S||(S=this.bends),M=0,A=S.length;M<A;M++)T=this.getWrapPoints(T,S[M]);return T},THREE.CurvePath.prototype.getTransformedSpacedPoints=function(_,S){var T=this.getSpacedPoints(_),M,A;for(S||(S=this.bends),M=0,A=S.length;M<A;M++)T=this.getWrapPoints(T,S[M]);return T},THREE.CurvePath.prototype.getWrapPoints=function(_,S){var T=this.getBoundingBox(),M,A,E,C,D,R;for(M=0,A=_.length;M<A;M++){E=_[M],C=E.x,D=E.y,R=C/T.maxX,R=S.getUtoTmapping(R,C);var P=S.getPoint(R),L=S.getNormalVector(R).multiplyScalar(D);E.x=P.x+L.x,E.y=P.y+L.y}return _},THREE.Gyroscope=function(){THREE.Object3D.call(this)},THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype),THREE.Gyroscope.prototype.updateMatrixWorld=function(_){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_)&&(this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.rotationWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.rotationObject,this.scaleObject),this.matrixWorld.makeFromPositionQuaternionScale(this.translationWorld,this.rotationObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,_=!0);for(var S=0,T=this.children.length;S<T;S++)this.children[S].updateMatrixWorld(_)},THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3,THREE.Gyroscope.prototype.translationObject=new THREE.Vector3,THREE.Gyroscope.prototype.rotationWorld=new THREE.Quaternion,THREE.Gyroscope.prototype.rotationObject=new THREE.Quaternion,THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3,THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3,THREE.Path=function(_){THREE.CurvePath.call(this),this.actions=[],_&&this.fromPoints(_)},THREE.Path.prototype=Object.create(THREE.CurvePath.prototype),THREE.PathActions={MOVE_TO:'moveTo',LINE_TO:'lineTo',QUADRATIC_CURVE_TO:'quadraticCurveTo',BEZIER_CURVE_TO:'bezierCurveTo',CSPLINE_THRU:'splineThru',ARC:'arc',ELLIPSE:'ellipse'},THREE.Path.prototype.fromPoints=function(_){this.moveTo(_[0].x,_[0].y);for(var S=1,T=_.length;S<T;S++)this.lineTo(_[S].x,_[S].y)},THREE.Path.prototype.moveTo=function(){var T=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:T})},THREE.Path.prototype.lineTo=function(_,S){var T=Array.prototype.slice.call(arguments),M=this.actions[this.actions.length-1].args,A=M[M.length-2],E=M[M.length-1],C=new THREE.LineCurve(new THREE.Vector2(A,E),new THREE.Vector2(_,S));this.curves.push(C),this.actions.push({action:THREE.PathActions.LINE_TO,args:T})},THREE.Path.prototype.quadraticCurveTo=function(_,S,T,M){var A=Array.prototype.slice.call(arguments),E=this.actions[this.actions.length-1].args,C=E[E.length-2],D=E[E.length-1],R=new THREE.QuadraticBezierCurve(new THREE.Vector2(C,D),new THREE.Vector2(_,S),new THREE.Vector2(T,M));this.curves.push(R),this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:A})},THREE.Path.prototype.bezierCurveTo=function(_,S,T,M,A,E){var C=Array.prototype.slice.call(arguments),D=this.actions[this.actions.length-1].args,R=D[D.length-2],P=D[D.length-1],L=new THREE.CubicBezierCurve(new THREE.Vector2(R,P),new THREE.Vector2(_,S),new THREE.Vector2(T,M),new THREE.Vector2(A,E));this.curves.push(L),this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:C})},THREE.Path.prototype.splineThru=function(_){var S=Array.prototype.slice.call(arguments),T=this.actions[this.actions.length-1].args,M=T[T.length-2],A=T[T.length-1],E=[new THREE.Vector2(M,A)];Array.prototype.push.apply(E,_);var C=new THREE.SplineCurve(E);this.curves.push(C),this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:S})},THREE.Path.prototype.arc=function(_,S,T,M,A,E){var C=this.actions[this.actions.length-1].args,D=C[C.length-2],R=C[C.length-1];this.absarc(_+D,S+R,T,M,A,E)},THREE.Path.prototype.absarc=function(_,S,T,M,A,E){this.absellipse(_,S,T,T,M,A,E)},THREE.Path.prototype.ellipse=function(_,S,T,M,A,E,C){var D=this.actions[this.actions.length-1].args,R=D[D.length-2],P=D[D.length-1];this.absellipse(_+R,S+P,T,M,A,E,C)},THREE.Path.prototype.absellipse=function(_,S,T,M,A,E,C){var D=Array.prototype.slice.call(arguments),R=new THREE.EllipseCurve(_,S,T,M,A,E,C);this.curves.push(R);var P=R.getPoint(C?1:0);D.push(P.x),D.push(P.y),this.actions.push({action:THREE.PathActions.ELLIPSE,args:D})},THREE.Path.prototype.getSpacedPoints=function(_){_||(_=40);for(var T=[],M=0;M<_;M++)T.push(this.getPoint(M/_));return T},THREE.Path.prototype.getPoints=function(_,S){if(this.useSpacedPoints)return console.log('tata'),this.getSpacedPoints(_,S);_=_||12;var T=[],M,A,E,C,D,R,P,L,U,N,F,V,I,O,B,G,H,W;for(M=0,A=this.actions.length;M<A;M++)switch(E=this.actions[M],C=E.action,D=E.args,C){case THREE.PathActions.MOVE_TO:T.push(new THREE.Vector2(D[0],D[1]));break;case THREE.PathActions.LINE_TO:T.push(new THREE.Vector2(D[0],D[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:for(R=D[2],P=D[3],N=D[0],F=D[1],0<T.length?(O=T[T.length-1],V=O.x,I=O.y):(O=this.actions[M-1].args,V=O[O.length-2],I=O[O.length-1]),B=1;B<=_;B++)G=B/_,H=THREE.Shape.Utils.b2(G,V,N,R),W=THREE.Shape.Utils.b2(G,I,F,P),T.push(new THREE.Vector2(H,W));break;case THREE.PathActions.BEZIER_CURVE_TO:for(R=D[4],P=D[5],N=D[0],F=D[1],L=D[2],U=D[3],0<T.length?(O=T[T.length-1],V=O.x,I=O.y):(O=this.actions[M-1].args,V=O[O.length-2],I=O[O.length-1]),B=1;B<=_;B++)G=B/_,H=THREE.Shape.Utils.b3(G,V,N,L,R),W=THREE.Shape.Utils.b3(G,I,F,U,P),T.push(new THREE.Vector2(H,W));break;case THREE.PathActions.CSPLINE_THRU:O=this.actions[M-1].args;var X=new THREE.Vector2(O[O.length-2],O[O.length-1]),Y=[X],K=_*D[0].length;Y=Y.concat(D[0]);var Q=new THREE.SplineCurve(Y);for(B=1;B<=K;B++)T.push(Q.getPointAt(B/K));break;case THREE.PathActions.ARC:var Z=D[0],J=D[1],ee=D[2],oe=D[3],ie=D[4],ne=!!D[5],se=ie-oe,pe=2*_,le;for(B=1;B<=pe;B++)G=B/pe,ne||(G=1-G),le=oe+G*se,H=Z+ee*Math.cos(le),W=J+ee*Math.sin(le),T.push(new THREE.Vector2(H,W));break;case THREE.PathActions.ELLIPSE:var Z=D[0],J=D[1],ue=D[2],fe=D[3],oe=D[4],ie=D[5],ne=!!D[6],se=ie-oe,pe=2*_,le;for(B=1;B<=pe;B++)G=B/pe,ne||(G=1-G),le=oe+G*se,H=Z+ue*Math.cos(le),W=J+fe*Math.sin(le),T.push(new THREE.Vector2(H,W));}var he=T[T.length-1],ge=1e-10;return Math.abs(he.x-T[0].x)<ge&&Math.abs(he.y-T[0].y)<ge&&T.splice(T.length-1,1),S&&T.push(T[0]),T},THREE.Path.prototype.toShapes=function(){var E=[],C=new THREE.Path,_,S,T,M,A;for(_=0,S=this.actions.length;_<S;_++)T=this.actions[_],A=T.args,M=T.action,M==THREE.PathActions.MOVE_TO&&0!=C.actions.length&&(E.push(C),C=new THREE.Path),C[M].apply(C,A);if(0!=C.actions.length&&E.push(C),0==E.length)return[];var P=[],L=!THREE.Shape.Utils.isClockWise(E[0].getPoints()),D,R;if(1==E.length)return D=E[0],R=new THREE.Shape,R.actions=D.actions,R.curves=D.curves,P.push(R),P;if(L)for(R=new THREE.Shape,_=0,S=E.length;_<S;_++)D=E[_],THREE.Shape.Utils.isClockWise(D.getPoints())?(R.actions=D.actions,R.curves=D.curves,P.push(R),R=new THREE.Shape):R.holes.push(D);else{for(_=0,S=E.length;_<S;_++)D=E[_],THREE.Shape.Utils.isClockWise(D.getPoints())?(R&&P.push(R),R=new THREE.Shape,R.actions=D.actions,R.curves=D.curves):R.holes.push(D);P.push(R)}return P},THREE.Shape=function(){THREE.Path.apply(this,arguments),this.holes=[]},THREE.Shape.prototype=Object.create(THREE.Path.prototype),THREE.Shape.prototype.extrude=function(_){var S=new THREE.ExtrudeGeometry(this,_);return S},THREE.Shape.prototype.makeGeometry=function(_){var S=new THREE.ShapeGeometry(this,_);return S},THREE.Shape.prototype.getPointsHoles=function(_){var T=this.holes.length,M=[],S;for(S=0;S<T;S++)M[S]=this.holes[S].getTransformedPoints(_,this.bends);return M},THREE.Shape.prototype.getSpacedPointsHoles=function(_){var T=this.holes.length,M=[],S;for(S=0;S<T;S++)M[S]=this.holes[S].getTransformedSpacedPoints(_,this.bends);return M},THREE.Shape.prototype.extractAllPoints=function(_){return{shape:this.getTransformedPoints(_),holes:this.getPointsHoles(_)}},THREE.Shape.prototype.extractPoints=function(_){return this.useSpacedPoints?this.extractAllSpacedPoints(_):this.extractAllPoints(_)},THREE.Shape.prototype.extractAllSpacedPoints=function(_){return{shape:this.getTransformedSpacedPoints(_),holes:this.getSpacedPointsHoles(_)}},THREE.Shape.Utils={removeHoles:function(_,S){var T=_.concat(),M=T.concat(),A,C,R,P,N,F,V,I,O,B,G,H,W,X,Y,K,Q=[];for(N=0;N<S.length;N++){for(V=S[N],Array.prototype.push.apply(M,V),I=Number.POSITIVE_INFINITY,F=0;F<V.length;F++){G=V[F];var Z=[];for(B=0;B<T.length;B++)H=T[B],O=G.distanceToSquared(H),Z.push(O),O<I&&(I=O,R=F,P=B)}A=0<=P-1?P-1:T.length-1,C=0<=R-1?R-1:V.length-1;var J=[V[R],T[P],T[A]],ee=THREE.FontUtils.Triangulate.area(J),oe=[V[R],V[C],T[P]],ie=THREE.FontUtils.Triangulate.area(oe),le=P,pe=R;P+=1,R+=-1,0>P&&(P+=T.length),P%=T.length,0>R&&(R+=V.length),R%=V.length,A=0<=P-1?P-1:T.length-1,C=0<=R-1?R-1:V.length-1,J=[V[R],T[P],T[A]];var ue=THREE.FontUtils.Triangulate.area(J);oe=[V[R],V[C],T[P]];var fe=THREE.FontUtils.Triangulate.area(oe);ee+ie>ue+fe&&(P=le,R=pe,0>P&&(P+=T.length),P%=T.length,0>R&&(R+=V.length),R%=V.length,A=0<=P-1?P-1:T.length-1,C=0<=R-1?R-1:V.length-1),W=T.slice(0,P),X=T.slice(P),Y=V.slice(R),K=V.slice(0,R);var he=[V[R],T[P],T[A]],ge=[V[R],V[C],T[P]];Q.push(he),Q.push(ge),T=W.concat(Y).concat(K).concat(X)}return{shape:T,isolatedPts:Q,allpoints:M}},triangulateShape:function(_,S){var T=THREE.Shape.Utils.removeHoles(_,S),M=T.shape,A=T.allpoints,E=T.isolatedPts,C=THREE.FontUtils.Triangulate(M,!1),D,R,P,L,U,N,F={};for(D=0,R=A.length;D<R;D++)U=A[D].x+':'+A[D].y,void 0!==F[U]&&console.log('Duplicate point',U),F[U]=D;for(D=0,R=C.length;D<R;D++)for(L=C[D],P=0;3>P;P++)U=L[P].x+':'+L[P].y,N=F[U],void 0!=N&&(L[P]=N);for(D=0,R=E.length;D<R;D++)for(L=E[D],P=0;3>P;P++)U=L[P].x+':'+L[P].y,N=F[U],void 0!==N&&(L[P]=N);return C.concat(E)},isClockWise:function(_){return 0>THREE.FontUtils.Triangulate.area(_)},b2p0:function(_,S){var T=1-_;return T*T*S},b2p1:function(_,S){return 2*(1-_)*_*S},b2p2:function(_,S){return _*_*S},b2:function(_,S,T,M){return this.b2p0(_,S)+this.b2p1(_,T)+this.b2p2(_,M)},b3p0:function(_,S){var T=1-_;return T*T*T*S},b3p1:function(_,S){var T=1-_;return 3*T*T*_*S},b3p2:function(_,S){return 3*(1-_)*_*_*S},b3p3:function(_,S){return _*_*_*S},b3:function(_,S,T,M,A){return this.b3p0(_,S)+this.b3p1(_,T)+this.b3p2(_,M)+this.b3p3(_,A)}},THREE.AnimationHandler=function(){var _=[],S={},T={};T.update=function(E){for(var C=0;C<_.length;C++)_[C].update(E)},T.addToUpdate=function(E){-1===_.indexOf(E)&&_.push(E)},T.removeFromUpdate=function(E){var C=_.indexOf(E);-1!==C&&_.splice(C,1)},T.add=function(E){void 0!==S[E.name]&&console.log('THREE.AnimationHandler.add: Warning! '+E.name+' already exists in library. Overwriting.'),S[E.name]=E,A(E)},T.get=function(E){if('string'==typeof E)return S[E]?S[E]:(console.log('THREE.AnimationHandler.get: Couldn\'t find animation '+E),null)},T.parse=function(E){var C=[];if(E instanceof THREE.SkinnedMesh)for(var D=0;D<E.bones.length;D++)C.push(E.bones[D]);else M(E,C);return C};var M=function(E,C){C.push(E);for(var D=0;D<E.children.length;D++)M(E.children[D],C)},A=function(E){if(!0!==E.initialized){for(var C=0;C<E.hierarchy.length;C++){for(var D=0;D<E.hierarchy[C].keys.length;D++)if(0>E.hierarchy[C].keys[D].time&&(E.hierarchy[C].keys[D].time=0),void 0!==E.hierarchy[C].keys[D].rot&&!(E.hierarchy[C].keys[D].rot instanceof THREE.Quaternion)){var R=E.hierarchy[C].keys[D].rot;E.hierarchy[C].keys[D].rot=new THREE.Quaternion(R[0],R[1],R[2],R[3])}if(E.hierarchy[C].keys.length&&void 0!==E.hierarchy[C].keys[0].morphTargets){for(var P={},D=0;D<E.hierarchy[C].keys.length;D++)for(var L=0,U;L<E.hierarchy[C].keys[D].morphTargets.length;L++)U=E.hierarchy[C].keys[D].morphTargets[L],P[U]=-1;E.hierarchy[C].usedMorphTargets=P;for(var D=0,N;D<E.hierarchy[C].keys.length;D++){for(var U in N={},P){for(var L=0;L<E.hierarchy[C].keys[D].morphTargets.length;L++)if(E.hierarchy[C].keys[D].morphTargets[L]===U){N[U]=E.hierarchy[C].keys[D].morphTargetsInfluences[L];break}L===E.hierarchy[C].keys[D].morphTargets.length&&(N[U]=0)}E.hierarchy[C].keys[D].morphTargetsInfluences=N}}for(var D=1;D<E.hierarchy[C].keys.length;D++)E.hierarchy[C].keys[D].time===E.hierarchy[C].keys[D-1].time&&(E.hierarchy[C].keys.splice(D,1),D--);for(var D=0;D<E.hierarchy[C].keys.length;D++)E.hierarchy[C].keys[D].index=D}var F=parseInt(E.length*E.fps,10);E.JIT={},E.JIT.hierarchy=[];for(var C=0;C<E.hierarchy.length;C++)E.JIT.hierarchy.push(Array(F));E.initialized=!0}};return T.LINEAR=0,T.CATMULLROM=1,T.CATMULLROM_FORWARD=2,T}(),THREE.Animation=function(_,S,T){this.root=_,this.data=THREE.AnimationHandler.get(S),this.hierarchy=THREE.AnimationHandler.parse(_),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.isPaused=!0,this.loop=!0,this.interpolationType=T===void 0?THREE.AnimationHandler.LINEAR:T,this.points=[],this.target=new THREE.Vector3},THREE.Animation.prototype.play=function(_,S){if(!1===this.isPlaying){this.isPlaying=!0,this.loop=!(_!==void 0)||_,this.currentTime=S===void 0?0:S;var M=this.hierarchy.length,T,A;for(T=0;T<M;T++){A=this.hierarchy[T],this.interpolationType!==THREE.AnimationHandler.CATMULLROM_FORWARD&&(A.useQuaternion=!0),A.matrixAutoUpdate=!0,A.animationCache===void 0&&(A.animationCache={},A.animationCache.prevKey={pos:0,rot:0,scl:0},A.animationCache.nextKey={pos:0,rot:0,scl:0},A.animationCache.originalMatrix=A instanceof THREE.Bone?A.skinMatrix:A.matrix);var E=A.animationCache.prevKey,C=A.animationCache.nextKey;E.pos=this.data.hierarchy[T].keys[0],E.rot=this.data.hierarchy[T].keys[0],E.scl=this.data.hierarchy[T].keys[0],C.pos=this.getNextKeyWith('pos',T,1),C.rot=this.getNextKeyWith('rot',T,1),C.scl=this.getNextKeyWith('scl',T,1)}this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.Animation.prototype.pause=function(){!0===this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.Animation.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,THREE.AnimationHandler.removeFromUpdate(this)},THREE.Animation.prototype.update=function(_){if(!1!==this.isPlaying){var S=['pos','rot','scl'],N=this.data.JIT.hierarchy,T,M,A,E,C,D,R,P,L,U,F,V,I,O,B;this.currentTime+=_*this.timeScale,V=this.currentTime,F=this.currentTime%=this.data.length,U=parseInt(Math.min(F*this.data.fps,this.data.length*this.data.fps),10);for(var G=0,H=this.hierarchy.length;G<H;G++){P=this.hierarchy[G],L=P.animationCache;for(var W=0;3>W;W++){if(T=S[W],D=L.prevKey[T],R=L.nextKey[T],R.time<=V){if(!(F<V))do D=R,R=this.getNextKeyWith(T,G,R.index+1);while(R.time<F);else if(this.loop)for(D=this.data.hierarchy[G].keys[0],R=this.getNextKeyWith(T,G,1);R.time<F;)D=R,R=this.getNextKeyWith(T,G,R.index+1);else return void this.stop();L.prevKey[T]=D,L.nextKey[T]=R}P.matrixAutoUpdate=!0,P.matrixWorldNeedsUpdate=!0,M=(F-D.time)/(R.time-D.time),E=D[T],C=R[T],(0>M||1<M)&&(console.log('THREE.Animation.update: Warning! Scale out of bounds:'+M+' on bone '+G),M=0>M?0:1),'pos'===T?(A=P.position,this.interpolationType===THREE.AnimationHandler.LINEAR?(A.x=E[0]+(C[0]-E[0])*M,A.y=E[1]+(C[1]-E[1])*M,A.z=E[2]+(C[2]-E[2])*M):(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)&&(this.points[0]=this.getPrevKeyWith('pos',G,D.index-1).pos,this.points[1]=E,this.points[2]=C,this.points[3]=this.getNextKeyWith('pos',G,R.index+1).pos,M=0.33*M+0.33,I=this.interpolateCatmullRom(this.points,M),A.x=I[0],A.y=I[1],A.z=I[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(O=this.interpolateCatmullRom(this.points,1.01*M),this.target.set(O[0],O[1],O[2]),this.target.sub(A),this.target.y=0,this.target.normalize(),B=Math.atan2(this.target.x,this.target.z),P.rotation.set(0,B,0)))):'rot'===T?THREE.Quaternion.slerp(E,C,P.quaternion,M):'scl'==T&&(A=P.scale,A.x=E[0]+(C[0]-E[0])*M,A.y=E[1]+(C[1]-E[1])*M,A.z=E[2]+(C[2]-E[2])*M)}}}},THREE.Animation.prototype.interpolateCatmullRom=function(_,S){var T=[],M=[],A,E,C,D,R,P,L,U,N;return A=(_.length-1)*S,E=Math.floor(A),C=A-E,T[0]=0===E?E:E-1,T[1]=E,T[2]=E>_.length-2?E:E+1,T[3]=E>_.length-3?E:E+2,P=_[T[0]],L=_[T[1]],U=_[T[2]],N=_[T[3]],D=C*C,R=C*D,M[0]=this.interpolate(P[0],L[0],U[0],N[0],C,D,R),M[1]=this.interpolate(P[1],L[1],U[1],N[1],C,D,R),M[2]=this.interpolate(P[2],L[2],U[2],N[2],C,D,R),M},THREE.Animation.prototype.interpolate=function(_,S,T,M,A,E,C){var D=0.5*(T-_),R=0.5*(M-S);return(2*(S-T)+D+R)*C+(-3*(S-T)-2*D-R)*E+D*A+S},THREE.Animation.prototype.getNextKeyWith=function(_,S,T){var M=this.data.hierarchy[S].keys;for(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?T=T<M.length-1?T:M.length-1:T%=M.length;T<M.length;T++)if(M[T][_]!==void 0)return M[T];return this.data.hierarchy[S].keys[0]},THREE.Animation.prototype.getPrevKeyWith=function(_,S,T){var M=this.data.hierarchy[S].keys;for(T=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<T?T:0:0<=T?T:T+M.length;0<=T;T--)if(M[T][_]!==void 0)return M[T];return this.data.hierarchy[S].keys[M.length-1]},THREE.KeyFrameAnimation=function(_,S,T){this.root=_,this.data=THREE.AnimationHandler.get(S),this.hierarchy=THREE.AnimationHandler.parse(_),this.currentTime=0,this.timeScale=1e-3,this.isPlaying=!1,this.isPaused=!0,this.loop=!0,this.JITCompile=!(T!==void 0)||T;for(var M=0,A=this.hierarchy.length;M<A;M++){var E=this.data.hierarchy[M].keys,C=this.data.hierarchy[M].sids,D=this.hierarchy[M];if(E.length&&C){for(var R=0;R<C.length;R++){var P=C[R],L=this.getNextKeyWith(P,M,0);L&&L.apply(P)}D.matrixAutoUpdate=!1,this.data.hierarchy[M].node.updateMatrix(),D.matrixWorldNeedsUpdate=!0}}},THREE.KeyFrameAnimation.prototype.play=function(_,S){if(!this.isPlaying){this.isPlaying=!0,this.loop=!(_!==void 0)||_,this.currentTime=S===void 0?0:S,this.startTimeMs=S,this.startTime=1e7,this.endTime=-this.startTime;var M=this.hierarchy.length,T,A,E;for(T=0;T<M;T++){A=this.hierarchy[T],E=this.data.hierarchy[T],A.useQuaternion=!0,E.animationCache===void 0&&(E.animationCache={},E.animationCache.prevKey=null,E.animationCache.nextKey=null,E.animationCache.originalMatrix=A instanceof THREE.Bone?A.skinMatrix:A.matrix);var C=this.data.hierarchy[T].keys;C.length&&(E.animationCache.prevKey=C[0],E.animationCache.nextKey=C[1],this.startTime=Math.min(C[0].time,this.startTime),this.endTime=Math.max(C[C.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.KeyFrameAnimation.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,THREE.AnimationHandler.removeFromUpdate(this);for(var _=0;_<this.data.hierarchy.length;_++){var S=this.hierarchy[_],T=this.data.hierarchy[_];if(T.animationCache!==void 0){var M=T.animationCache.originalMatrix;S instanceof THREE.Bone?(M.copy(S.skinMatrix),S.skinMatrix=M):(M.copy(S.matrix),S.matrix=M),delete T.animationCache}}},THREE.KeyFrameAnimation.prototype.update=function(_){if(this.isPlaying){var C=this.data.JIT.hierarchy,S,T,M,A,E,D,R,P;if(this.currentTime+=_*this.timeScale,R=this.currentTime,D=this.currentTime%=this.data.length,D<this.startTimeMs&&(D=this.currentTime=this.startTimeMs+D),E=parseInt(Math.min(D*this.data.fps,this.data.length*this.data.fps),10),P=D<R,P&&!this.loop){for(var L=0,U=this.hierarchy.length;L<U;L++){var N=this.data.hierarchy[L].keys,F=this.data.hierarchy[L].sids,V=N.length-1,I=this.hierarchy[L];if(N.length){for(var O=0;O<F.length;O++){var B=F[O],G=this.getPrevKeyWith(B,L,V);G&&G.apply(B)}this.data.hierarchy[L].node.updateMatrix(),I.matrixWorldNeedsUpdate=!0}}return void this.stop()}if(!(D<this.startTime)){for(var L=0,U=this.hierarchy.length;L<U;L++){M=this.hierarchy[L],A=this.data.hierarchy[L];var N=A.keys,H=A.animationCache;if(this.JITCompile&&void 0!==C[L][E])M instanceof THREE.Bone?(M.skinMatrix=C[L][E],M.matrixWorldNeedsUpdate=!1):(M.matrix=C[L][E],M.matrixWorldNeedsUpdate=!0);else if(N.length){if(this.JITCompile&&H&&(M instanceof THREE.Bone?M.skinMatrix=H.originalMatrix:M.matrix=H.originalMatrix),S=H.prevKey,T=H.nextKey,S&&T){if(T.time<=R){if(P&&this.loop)for(S=N[0],T=N[1];T.time<D;)S=T,T=N[S.index+1];else if(!P)for(var W=N.length-1;T.time<D&&T.index!==W;)S=T,T=N[S.index+1];H.prevKey=S,H.nextKey=T}T.time>=D?S.interpolate(T,D):S.interpolate(T,T.time)}this.data.hierarchy[L].node.updateMatrix(),M.matrixWorldNeedsUpdate=!0}}if(this.JITCompile&&void 0===C[0][E]){this.hierarchy[0].updateMatrixWorld(!0);for(var L=0;L<this.hierarchy.length;L++)C[L][E]=this.hierarchy[L]instanceof THREE.Bone?this.hierarchy[L].skinMatrix.clone():this.hierarchy[L].matrix.clone()}}}},THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(_,S,T){var M=this.data.hierarchy[S].keys;for(T%=M.length;T<M.length;T++)if(M[T].hasTarget(_))return M[T];return M[0]},THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(_,S,T){var M=this.data.hierarchy[S].keys;for(T=0<=T?T:T+M.length;0<=T;T--)if(M[T].hasTarget(_))return M[T];return M[M.length-1]},THREE.CubeCamera=function(_,S,T){THREE.Object3D.call(this);var M=90,A=1,E=new THREE.PerspectiveCamera(M,A,_,S);E.up.set(0,-1,0),E.lookAt(new THREE.Vector3(1,0,0)),this.add(E);var C=new THREE.PerspectiveCamera(M,A,_,S);C.up.set(0,-1,0),C.lookAt(new THREE.Vector3(-1,0,0)),this.add(C);var D=new THREE.PerspectiveCamera(M,A,_,S);D.up.set(0,0,1),D.lookAt(new THREE.Vector3(0,1,0)),this.add(D);var R=new THREE.PerspectiveCamera(M,A,_,S);R.up.set(0,0,-1),R.lookAt(new THREE.Vector3(0,-1,0)),this.add(R);var P=new THREE.PerspectiveCamera(M,A,_,S);P.up.set(0,-1,0),P.lookAt(new THREE.Vector3(0,0,1)),this.add(P);var L=new THREE.PerspectiveCamera(M,A,_,S);L.up.set(0,-1,0),L.lookAt(new THREE.Vector3(0,0,-1)),this.add(L),this.renderTarget=new THREE.WebGLRenderTargetCube(T,T,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter}),this.updateCubeMap=function(U,N){var F=this.renderTarget,V=F.generateMipmaps;F.generateMipmaps=!1,F.activeCubeFace=0,U.render(N,E,F),F.activeCubeFace=1,U.render(N,C,F),F.activeCubeFace=2,U.render(N,D,F),F.activeCubeFace=3,U.render(N,R,F),F.activeCubeFace=4,U.render(N,P,F),F.generateMipmaps=V,F.activeCubeFace=5,U.render(N,L,F)}},THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype),THREE.CombinedCamera=function(_,S,T,M,A,E,C){THREE.Camera.call(this),this.fov=T,this.left=-_/2,this.right=_/2,this.top=S/2,this.bottom=-S/2,this.cameraO=new THREE.OrthographicCamera(_/-2,_/2,S/2,S/-2,E,C),this.cameraP=new THREE.PerspectiveCamera(T,_/S,M,A),this.zoom=1,this.toPerspective()},THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype),THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near,this.far=this.cameraP.far,this.cameraP.fov=this.fov/this.zoom,this.cameraP.updateProjectionMatrix(),this.projectionMatrix=this.cameraP.projectionMatrix,this.inPerspectiveMode=!0,this.inOrthographicMode=!1},THREE.CombinedCamera.prototype.toOrthographic=function(){var _=this.fov,S=this.cameraP.aspect,T=this.cameraP.near,M=this.cameraP.far,E=Math.tan(_/2)*((T+M)/2),C=2*E,R=C*S/2;E/=this.zoom,R/=this.zoom,this.cameraO.left=-R,this.cameraO.right=R,this.cameraO.top=E,this.cameraO.bottom=-E,this.cameraO.updateProjectionMatrix(),this.near=this.cameraO.near,this.far=this.cameraO.far,this.projectionMatrix=this.cameraO.projectionMatrix,this.inPerspectiveMode=!1,this.inOrthographicMode=!0},THREE.CombinedCamera.prototype.setSize=function(_,S){this.cameraP.aspect=_/S,this.left=-_/2,this.right=_/2,this.top=S/2,this.bottom=-S/2},THREE.CombinedCamera.prototype.setFov=function(_){this.fov=_,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())},THREE.CombinedCamera.prototype.setLens=function(_,S){void 0===S&&(S=24);var T=2*THREE.Math.radToDeg(Math.atan(S/(2*_)));return this.setFov(T),T},THREE.CombinedCamera.prototype.setZoom=function(_){this.zoom=_,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0,this.rotation.y=Math.PI,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0,this.rotation.y=-Math.PI/2,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0,this.rotation.y=Math.PI/2,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CircleGeometry=function(_,S,T,M){THREE.Geometry.call(this),_=_||50,T=T===void 0?0:T,M=M===void 0?2*Math.PI:M,S=S===void 0?8:Math.max(3,S);var E=[],C=new THREE.Vector3,D=new THREE.Vector2(0.5,0.5),A;for(this.vertices.push(C),E.push(D),A=0;A<=S;A++){var R=new THREE.Vector3,P=T+A/S*M;R.x=_*Math.cos(P),R.y=_*Math.sin(P),this.vertices.push(R),E.push(new THREE.Vector2((R.x/_+1)/2,(R.y/_+1)/2))}var L=new THREE.Vector3(0,0,1);for(A=1;A<=S;A++){var U=A,N=A+1;this.faces.push(new THREE.Face3(U,N,0,[L,L,L])),this.faceVertexUvs[0].push([E[A],E[A+1],D])}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3(),_)},THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CubeGeometry=function(_,S,T,M,A,E){function C(U,N,F,V,I,O,B,G){var Y=D.widthSegments,K=D.heightSegments,J=D.vertices.length,H,W,X;'x'===U&&'y'===N||'y'===U&&'x'===N?H='z':'x'===U&&'z'===N||'z'===U&&'x'===N?(H='y',K=D.depthSegments):('z'==U&&'y'==N||'y'==U&&'z'==N)&&(H='x',Y=D.depthSegments);var ee=Y+1,oe=K+1,ie=I/Y,ne=O/K,se=new THREE.Vector3;for(se[H]=0<B?1:-1,X=0;X<oe;X++)for(W=0;W<ee;W++){var le=new THREE.Vector3;le[U]=(W*ie-I/2)*F,le[N]=(X*ne-O/2)*V,le[H]=B,D.vertices.push(le)}for(X=0;X<K;X++)for(W=0;W<Y;W++){var pe=W+ee*X,ue=W+ee*(X+1),fe=W+1+ee*(X+1),he=W+1+ee*X,ge=new THREE.Face4(pe+J,ue+J,fe+J,he+J);ge.normal.copy(se),ge.vertexNormals.push(se.clone(),se.clone(),se.clone(),se.clone()),ge.materialIndex=G,D.faces.push(ge),D.faceVertexUvs[0].push([new THREE.Vector2(W/Y,1-X/K),new THREE.Vector2(W/Y,1-(X+1)/K),new THREE.Vector2((W+1)/Y,1-(X+1)/K),new THREE.Vector2((W+1)/Y,1-X/K)])}}THREE.Geometry.call(this);var D=this;this.width=_,this.height=S,this.depth=T,this.widthSegments=M||1,this.heightSegments=A||1,this.depthSegments=E||1;var R=this.width/2,P=this.height/2,L=this.depth/2;C('z','y',-1,-1,this.depth,this.height,R,0),C('z','y',1,-1,this.depth,this.height,-R,1),C('x','z',1,1,this.width,this.depth,P,2),C('x','z',1,-1,this.width,this.depth,-P,3),C('x','y',1,-1,this.width,this.height,L,4),C('x','y',-1,-1,this.width,this.height,-L,5),this.computeCentroids(),this.mergeVertices()},THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CylinderGeometry=function(_,S,T,M,A,E){THREE.Geometry.call(this),this.radiusTop=_=_===void 0?20:_,this.radiusBottom=S=S===void 0?20:S,this.height=T=T===void 0?100:T,this.radiusSegments=M=M||8,this.heightSegments=A=A||1,this.openEnded=E=E!==void 0&&E;var C=T/2,D,R,P=[],L=[];for(R=0;R<=A;R++){var U=[],N=[],F=R/A,V=F*(S-_)+_;for(D=0;D<=M;D++){var I=D/M,O=new THREE.Vector3;O.x=V*Math.sin(2*(I*Math.PI)),O.y=-F*T+C,O.z=V*Math.cos(2*(I*Math.PI)),this.vertices.push(O),U.push(this.vertices.length-1),N.push(new THREE.Vector2(I,1-F))}P.push(U),L.push(N)}var B=(S-_)/T,G,H;for(D=0;D<M;D++)for(0===_?(G=this.vertices[P[1][D]].clone(),H=this.vertices[P[1][D+1]].clone()):(G=this.vertices[P[0][D]].clone(),H=this.vertices[P[0][D+1]].clone()),G.setY(Math.sqrt(G.x*G.x+G.z*G.z)*B).normalize(),H.setY(Math.sqrt(H.x*H.x+H.z*H.z)*B).normalize(),R=0;R<A;R++){var W=P[R][D],X=P[R+1][D],Y=P[R+1][D+1],K=P[R][D+1],Q=G.clone(),Z=G.clone(),J=H.clone(),ee=H.clone(),oe=L[R][D].clone(),ie=L[R+1][D].clone(),ne=L[R+1][D+1].clone(),se=L[R][D+1].clone();this.faces.push(new THREE.Face4(W,X,Y,K,[Q,Z,J,ee])),this.faceVertexUvs[0].push([oe,ie,ne,se])}if(!1===E&&0<_)for(this.vertices.push(new THREE.Vector3(0,C,0)),D=0;D<M;D++){var W=P[0][D],X=P[0][D+1],Y=this.vertices.length-1,Q=new THREE.Vector3(0,1,0),Z=new THREE.Vector3(0,1,0),J=new THREE.Vector3(0,1,0),oe=L[0][D].clone(),ie=L[0][D+1].clone(),ne=new THREE.Vector2(ie.u,0);this.faces.push(new THREE.Face3(W,X,Y,[Q,Z,J])),this.faceVertexUvs[0].push([oe,ie,ne])}if(!1===E&&0<S)for(this.vertices.push(new THREE.Vector3(0,-C,0)),D=0;D<M;D++){var W=P[R][D+1],X=P[R][D],Y=this.vertices.length-1,Q=new THREE.Vector3(0,-1,0),Z=new THREE.Vector3(0,-1,0),J=new THREE.Vector3(0,-1,0),oe=L[R][D+1].clone(),ie=L[R][D].clone(),ne=new THREE.Vector2(ie.u,1);this.faces.push(new THREE.Face3(W,X,Y,[Q,Z,J])),this.faceVertexUvs[0].push([oe,ie,ne])}this.computeCentroids(),this.computeFaceNormals()},THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry=function(_,S){return'undefined'==typeof _?void(_=[]):void(THREE.Geometry.call(this),_=_ instanceof Array?_:[_],this.shapebb=_[_.length-1].getBoundingBox(),this.addShapeList(_,S),this.computeCentroids(),this.computeFaceNormals())},THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry.prototype.addShapeList=function(_,S){for(var T=_.length,M=0,A;M<T;M++)A=_[M],this.addShape(A,S)},THREE.ExtrudeGeometry.prototype.addShape=function(_,S){function T(je,Xe,Ye){return Xe.clone().multiplyScalar(Ye).add(je)}function M(je,Xe,Ye){return E(je,Xe,Ye)}function A(je,Xe,Ye){var qe=Math.atan2(Xe.y-je.y,Xe.x-je.x),Ke=Math.atan2(Ye.y-je.y,Ye.x-je.x);qe>Ke&&(Ke+=2*Math.PI);var Qe=(qe+Ke)/2,Ze=-Math.cos(Qe),Je=-Math.sin(Qe),$e=new THREE.Vector2(Ze,Je);return $e}function E(je,Xe,Ye){var qe=THREE.ExtrudeGeometry.__v1,Ke=THREE.ExtrudeGeometry.__v2,Qe=THREE.ExtrudeGeometry.__v3,Ze=THREE.ExtrudeGeometry.__v4,Je=THREE.ExtrudeGeometry.__v5,$e=THREE.ExtrudeGeometry.__v6,et,tt,rt,at,ot,it;return(qe.set(je.x-Xe.x,je.y-Xe.y),Ke.set(je.x-Ye.x,je.y-Ye.y),et=qe.normalize(),tt=Ke.normalize(),Qe.set(-et.y,et.x),Ze.set(tt.y,-tt.x),Je.copy(je).add(Qe),$e.copy(je).add(Ze),Je.equals($e))?Ze.clone():(Je.copy(Xe).add(Qe),$e.copy(Ye).add(Ze),rt=et.dot(Ze),at=$e.sub(Je).dot(Ze),ot=at/rt,0>ot)?A(je,Xe,Ye):(it=et.multiplyScalar(ot).add(Je),it.sub(je).clone())}function R(je,Xe){var Ye,qe;for(Ne=je.length;0<=--Ne;){Ye=Ne,qe=Ne-1,0>qe&&(qe=je.length-1);var Ke=0,Qe=G+2*I;for(Ke=0;Ke<Qe;Ke++){var Ze=Ee*Ke,Je=Ee*(Ke+1),$e=Xe+Ye+Ze,et=Xe+qe+Ze,tt=Xe+qe+Je,rt=Xe+Ye+Je;U($e,et,tt,rt,je,Ke,Qe,Ye,qe)}}}function P(je,Xe,Ye){pe.vertices.push(new THREE.Vector3(je,Xe,Ye))}function L(je,Xe,Ye,qe){je+=fe,Xe+=fe,Ye+=fe,pe.faces.push(new THREE.Face3(je,Xe,Ye,null,null,Y));var Ke=qe?Q.generateBottomUV(pe,_,S,je,Xe,Ye):Q.generateTopUV(pe,_,S,je,Xe,Ye);pe.faceVertexUvs[0].push(Ke)}function U(je,Xe,Ye,qe,Ke,Qe,Ze,Je,$e){je+=fe,Xe+=fe,Ye+=fe,qe+=fe,pe.faces.push(new THREE.Face4(je,Xe,Ye,qe,null,null,K));var et=Q.generateSideWallUV(pe,_,Ke,S,je,Xe,Ye,qe,Qe,Ze,Je,$e);pe.faceVertexUvs[0].push(et)}var N=S.amount===void 0?100:S.amount,F=S.bevelThickness===void 0?6:S.bevelThickness,V=S.bevelSize===void 0?F-2:S.bevelSize,I=S.bevelSegments===void 0?3:S.bevelSegments,O=!(S.bevelEnabled!==void 0)||S.bevelEnabled,B=S.curveSegments===void 0?12:S.curveSegments,G=S.steps===void 0?1:S.steps,H=S.extrudePath,W,X=!1,Y=S.material,K=S.extrudeMaterial,Q=S.UVGenerator===void 0?THREE.ExtrudeGeometry.WorldUVGenerator:S.UVGenerator,Z=this.shapebb,J,ee,oe,ie;H&&(W=H.getSpacedPoints(G),X=!0,O=!1,J=S.frames===void 0?new THREE.TubeGeometry.FrenetFrames(H,G,!1):S.frames,ee=new THREE.Vector3,oe=new THREE.Vector3,ie=new THREE.Vector3),O||(I=0,F=0,V=0);var ne,se,le,pe=this,fe=this.vertices.length,he=_.extractPoints(B),ge=he.shape,ye=he.holes,_e=!THREE.Shape.Utils.isClockWise(ge);if(_e){for(ge=ge.reverse(),se=0,le=ye.length;se<le;se++)ne=ye[se],THREE.Shape.Utils.isClockWise(ne)&&(ye[se]=ne.reverse());_e=!1}var xe=THREE.Shape.Utils.triangulateShape(ge,ye),ve=ge;for(se=0,le=ye.length;se<le;se++)ne=ye[se],ge=ge.concat(ne);for(var Ee=ge.length,De=xe.length,Pe=ve.length,Le=180/Math.PI,Ue=[],Ne=0,Fe=ve.length,ze=Fe-1,Ve=Ne+1,Se,Te,Me,Ae,we,Ce;Ne<Fe;Ne++,ze++,Ve++){ze===Fe&&(ze=0),Ve===Fe&&(Ve=0);var Ie=ve[Ne],Oe=ve[ze],Be=ve[Ve];Ue[Ne]=M(ve[Ne],ve[ze],ve[Ve])}var ke=[],He=Ue.concat(),Ge;for(se=0,le=ye.length;se<le;se++){for(ne=ye[se],Ge=[],(Ne=0,Fe=ne.length,ze=Fe-1,Ve=Ne+1);Ne<Fe;Ne++,ze++,Ve++)ze===Fe&&(ze=0),Ve===Fe&&(Ve=0),Ge[Ne]=M(ne[Ne],ne[ze],ne[Ve]);ke.push(Ge),He=He.concat(Ge)}for(Se=0;Se<I;Se++){for(Me=Se/I,Ae=F*(1-Me),Te=V*Math.sin(Me*Math.PI/2),(Ne=0,Fe=ve.length);Ne<Fe;Ne++)we=T(ve[Ne],Ue[Ne],Te),P(we.x,we.y,-Ae);for(se=0,le=ye.length;se<le;se++)for(ne=ye[se],Ge=ke[se],(Ne=0,Fe=ne.length);Ne<Fe;Ne++)we=T(ne[Ne],Ge[Ne],Te),P(we.x,we.y,-Ae)}for(Te=V,Ne=0;Ne<Ee;Ne++)we=O?T(ge[Ne],He[Ne],Te):ge[Ne],X?(oe.copy(J.normals[0]).multiplyScalar(we.x),ee.copy(J.binormals[0]).multiplyScalar(we.y),ie.copy(W[0]).add(oe).add(ee),P(ie.x,ie.y,ie.z)):P(we.x,we.y,0);var We;for(We=1;We<=G;We++)for(Ne=0;Ne<Ee;Ne++)we=O?T(ge[Ne],He[Ne],Te):ge[Ne],X?(oe.copy(J.normals[We]).multiplyScalar(we.x),ee.copy(J.binormals[We]).multiplyScalar(we.y),ie.copy(W[We]).add(oe).add(ee),P(ie.x,ie.y,ie.z)):P(we.x,we.y,N/G*We);for(Se=I-1;0<=Se;Se--){for(Me=Se/I,Ae=F*(1-Me),Te=V*Math.sin(Me*Math.PI/2),(Ne=0,Fe=ve.length);Ne<Fe;Ne++)we=T(ve[Ne],Ue[Ne],Te),P(we.x,we.y,N+Ae);for(se=0,le=ye.length;se<le;se++)for(ne=ye[se],Ge=ke[se],(Ne=0,Fe=ne.length);Ne<Fe;Ne++)we=T(ne[Ne],Ge[Ne],Te),X?P(we.x,we.y+W[G-1].y,W[G-1].x+Ae):P(we.x,we.y,N+Ae)}(function(){if(O){var je=0,Xe=Ee*je;for(Ne=0;Ne<De;Ne++)Ce=xe[Ne],L(Ce[2]+Xe,Ce[1]+Xe,Ce[0]+Xe,!0);for(je=G+2*I,Xe=Ee*je,Ne=0;Ne<De;Ne++)Ce=xe[Ne],L(Ce[0]+Xe,Ce[1]+Xe,Ce[2]+Xe,!1)}else{for(Ne=0;Ne<De;Ne++)Ce=xe[Ne],L(Ce[2],Ce[1],Ce[0],!0);for(Ne=0;Ne<De;Ne++)Ce=xe[Ne],L(Ce[0]+Ee*G,Ce[1]+Ee*G,Ce[2]+Ee*G,!1)}})(),function(){var je=0;for(R(ve,je),je+=ve.length,(se=0,le=ye.length);se<le;se++)ne=ye[se],R(ne,je),je+=ne.length}()},THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(_,S,T,M,A,E){var C=_.vertices[M].x,D=_.vertices[M].y,R=_.vertices[A].x,P=_.vertices[A].y,L=_.vertices[E].x,U=_.vertices[E].y;return[new THREE.Vector2(C,D),new THREE.Vector2(R,P),new THREE.Vector2(L,U)]},generateBottomUV:function(_,S,T,M,A,E){return this.generateTopUV(_,S,T,M,A,E)},generateSideWallUV:function(_,S,T,M,A,E,C,D){var N=_.vertices[A].x,F=_.vertices[A].y,V=_.vertices[A].z,I=_.vertices[E].x,O=_.vertices[E].y,B=_.vertices[E].z,G=_.vertices[C].x,H=_.vertices[C].y,W=_.vertices[C].z,X=_.vertices[D].x,Y=_.vertices[D].y,K=_.vertices[D].z;return 0.01>Math.abs(F-O)?[new THREE.Vector2(N,1-V),new THREE.Vector2(I,1-B),new THREE.Vector2(G,1-W),new THREE.Vector2(X,1-K)]:[new THREE.Vector2(F,1-V),new THREE.Vector2(O,1-B),new THREE.Vector2(H,1-W),new THREE.Vector2(Y,1-K)]}},THREE.ExtrudeGeometry.__v1=new THREE.Vector2,THREE.ExtrudeGeometry.__v2=new THREE.Vector2,THREE.ExtrudeGeometry.__v3=new THREE.Vector2,THREE.ExtrudeGeometry.__v4=new THREE.Vector2,THREE.ExtrudeGeometry.__v5=new THREE.Vector2,THREE.ExtrudeGeometry.__v6=new THREE.Vector2,THREE.ShapeGeometry=function(_,S){THREE.Geometry.call(this),!1==_ instanceof Array&&(_=[_]),this.shapebb=_[_.length-1].getBoundingBox(),this.addShapeList(_,S),this.computeCentroids(),this.computeFaceNormals()},THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ShapeGeometry.prototype.addShapeList=function(_,S){for(var T=0,M=_.length;T<M;T++)this.addShape(_[T],S);return this},THREE.ShapeGeometry.prototype.addShape=function(_,S){S===void 0&&(S={});var T=S.curveSegments===void 0?12:S.curveSegments,M=S.material,A=S.UVGenerator===void 0?THREE.ExtrudeGeometry.WorldUVGenerator:S.UVGenerator,E=this.shapebb,C,D,R,L=this.vertices.length,U=_.extractPoints(T),N=U.shape,F=U.holes,V=!THREE.Shape.Utils.isClockWise(N);if(V){for(N=N.reverse(),C=0,D=F.length;C<D;C++)R=F[C],THREE.Shape.Utils.isClockWise(R)&&(F[C]=R.reverse());V=!1}var I=THREE.Shape.Utils.triangulateShape(N,F),O=N;for(C=0,D=F.length;C<D;C++)R=F[C],N=N.concat(R);var G=N.length,B,H,W=I.length,Y=O.length;for(C=0;C<G;C++)B=N[C],this.vertices.push(new THREE.Vector3(B.x,B.y,0));for(C=0;C<W;C++){H=I[C];var K=H[0]+L,Q=H[1]+L,Z=H[2]+L;this.faces.push(new THREE.Face3(K,Q,Z,null,null,M)),this.faceVertexUvs[0].push(A.generateBottomUV(this,_,S,K,Q,Z))}},THREE.LatheGeometry=function(_,S,T,M){THREE.Geometry.call(this),S=S||12,T=T||0,M=M||2*Math.PI;for(var A=1/(_.length-1),E=1/S,C=0,D=S;C<=D;C++)for(var R=T+C*E*M,P=Math.cos(R),L=Math.sin(R),U=0,N=_.length;U<N;U++){var F=_[U],V=new THREE.Vector3;V.x=P*F.x-L*F.y,V.y=L*F.x+P*F.y,V.z=F.z,this.vertices.push(V)}for(var I=_.length,C=0,D=S;C<D;C++)for(var U=0,N=_.length-1;U<N;U++){var O=U+I*C,P=O+1+I;this.faces.push(new THREE.Face4(O,O+I,P,O+1));var W=C*E,X=U*A,Y=W+E,K=X+A;this.faceVertexUvs[0].push([new THREE.Vector2(W,X),new THREE.Vector2(Y,X),new THREE.Vector2(Y,K),new THREE.Vector2(W,K)])}this.mergeVertices(),this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PlaneGeometry=function(_,S,T,M){THREE.Geometry.call(this),this.width=_,this.height=S,this.widthSegments=T||1,this.heightSegments=M||1;var A,E,R=this.widthSegments,P=this.heightSegments,L=R+1,N=this.width/R,F=this.height/P,V=new THREE.Vector3(0,0,1);for(E=0;E<P+1;E++)for(A=0;A<L;A++){var I=A*N-_/2,O=E*F-S/2;this.vertices.push(new THREE.Vector3(I,-O,0))}for(E=0;E<P;E++)for(A=0;A<R;A++){var B=A+L*E,G=A+L*(E+1),H=A+1+L*(E+1),W=A+1+L*E,X=new THREE.Face4(B,G,H,W);X.normal.copy(V),X.vertexNormals.push(V.clone(),V.clone(),V.clone(),V.clone()),this.faces.push(X),this.faceVertexUvs[0].push([new THREE.Vector2(A/R,1-E/P),new THREE.Vector2(A/R,1-(E+1)/P),new THREE.Vector2((A+1)/R,1-(E+1)/P),new THREE.Vector2((A+1)/R,1-E/P)])}this.computeCentroids()},THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.RingGeometry=function(_,S,T,M,A,E){THREE.Geometry.call(this),_=_||0,S=S||50,A=A===void 0?0:A,E=E===void 0?2*Math.PI:E,T=T===void 0?8:Math.max(3,T),M=M===void 0?8:Math.max(1,M);var R=[],P=_,L=(S-_)/M,C,D;for(C=0;C<=M;C++){for(D=0;D<=T;D++){var U=new THREE.Vector3,N=A+D/T*E;U.x=P*Math.cos(N),U.y=P*Math.sin(N),this.vertices.push(U),R.push(new THREE.Vector2(D/T,1-C/M))}P+=L}var F=new THREE.Vector3(0,0,1);for(let V=0;V<M;V++){const I=V*(T+1);for(let O=0;O<T;O++){const B=O+I,G=B,H=B+T+1,W=B+T+2,X=B+1;this.faces.push(new THREE.Face3(G,H,X,[F,F,F])),this.faceVertexUvs[0].push([R[G],R[H],R[X]]),this.faces.push(new THREE.Face3(H,W,X,[F,F,F])),this.faceVertexUvs[0].push([R[H],R[W],R[X]])}}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3(),P)},THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.SphereGeometry=function(_,S,T,M,A,E,C){THREE.Geometry.call(this),this.radius=_=_||50,this.widthSegments=S=Math.max(3,Math.floor(S)||8),this.heightSegments=T=Math.max(2,Math.floor(T)||6),this.phiStart=M=M===void 0?0:M,this.phiLength=A=A===void 0?2*Math.PI:A,this.thetaStart=E=E===void 0?0:E,this.thetaLength=C=C===void 0?Math.PI:C;var P=[],L=[],D,R;for(R=0;R<=T;R++){var U=[],N=[];for(D=0;D<=S;D++){var F=D/S,V=R/T,I=new THREE.Vector3;I.x=-_*Math.cos(M+F*A)*Math.sin(E+V*C),I.y=_*Math.cos(E+V*C),I.z=_*Math.sin(M+F*A)*Math.sin(E+V*C),this.vertices.push(I),U.push(this.vertices.length-1),N.push(new THREE.Vector2(F,1-V))}P.push(U),L.push(N)}for(R=0;R<this.heightSegments;R++)for(D=0;D<this.widthSegments;D++){var O=P[R][D+1],B=P[R][D],G=P[R+1][D],H=P[R+1][D+1],W=this.vertices[O].clone().normalize(),X=this.vertices[B].clone().normalize(),Y=this.vertices[G].clone().normalize(),K=this.vertices[H].clone().normalize(),Q=L[R][D+1].clone(),Z=L[R][D].clone(),J=L[R+1][D].clone(),ee=L[R+1][D+1].clone();Math.abs(this.vertices[O].y)===this.radius?(this.faces.push(new THREE.Face3(O,G,H,[W,Y,K])),this.faceVertexUvs[0].push([Q,J,ee])):Math.abs(this.vertices[G].y)===this.radius?(this.faces.push(new THREE.Face3(O,B,G,[W,X,Y])),this.faceVertexUvs[0].push([Q,Z,J])):(this.faces.push(new THREE.Face4(O,B,G,H,[W,X,Y,K])),this.faceVertexUvs[0].push([Q,Z,J,ee]))}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3(),_)},THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TextGeometry=function(_,S){S=S||{};var T=THREE.FontUtils.generateShapes(_,S);S.amount=S.height===void 0?50:S.height,S.bevelThickness===void 0&&(S.bevelThickness=10),S.bevelSize===void 0&&(S.bevelSize=8),S.bevelEnabled===void 0&&(S.bevelEnabled=!1),THREE.ExtrudeGeometry.call(this,T,S)},THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype),THREE.TorusGeometry=function(_,S,T,M,A){THREE.Geometry.call(this);this;this.radius=_||100,this.tube=S||40,this.radialSegments=T||8,this.tubularSegments=M||6,this.arc=A||2*Math.PI;for(var C=new THREE.Vector3,D=[],R=[],P=0;P<=this.radialSegments;P++)for(var L=0;L<=this.tubularSegments;L++){var U=L/this.tubularSegments*this.arc,N=2*(P/this.radialSegments*Math.PI);C.x=this.radius*Math.cos(U),C.y=this.radius*Math.sin(U);var F=new THREE.Vector3;F.x=(this.radius+this.tube*Math.cos(N))*Math.cos(U),F.y=(this.radius+this.tube*Math.cos(N))*Math.sin(U),F.z=this.tube*Math.sin(N),this.vertices.push(F),D.push(new THREE.Vector2(L/this.tubularSegments,P/this.radialSegments)),R.push(F.clone().sub(C).normalize())}for(var P=1;P<=this.radialSegments;P++)for(var L=1;L<=this.tubularSegments;L++){var V=(this.tubularSegments+1)*P+L-1,I=(this.tubularSegments+1)*(P-1)+L-1,O=(this.tubularSegments+1)*(P-1)+L,B=(this.tubularSegments+1)*P+L,G=new THREE.Face4(V,I,O,B,[R[V],R[I],R[O],R[B]]);G.normal.add(R[V]),G.normal.add(R[I]),G.normal.add(R[O]),G.normal.add(R[B]),G.normal.normalize(),this.faces.push(G),this.faceVertexUvs[0].push([D[V].clone(),D[I].clone(),D[O].clone(),D[B].clone()])}this.computeCentroids()},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusKnotGeometry=function(_,S,T,M,A,E,C){function D(se,le,pe){return P.vertices.push(new THREE.Vector3(se,le,pe))-1}function R(se,le,pe,ue,fe,he){var ge=Math.cos(se),ye=Math.cos(le),_e=Math.sin(se),xe=pe/ue*se,ve=Math.cos(xe),Me=0.5*(he*fe*Math.sin(xe));return new THREE.Vector3(0.5*(fe*(2+ve))*ge,0.5*(fe*(2+ve)*_e),Me)}THREE.Geometry.call(this);var P=this;this.radius=_||100,this.tube=S||40,this.radialSegments=T||64,this.tubularSegments=M||8,this.p=A||2,this.q=E||3,this.heightScale=C||1,this.grid=Array(this.radialSegments);for(var L=new THREE.Vector3,U=new THREE.Vector3,N=new THREE.Vector3,F=0;F<this.radialSegments;++F){this.grid[F]=Array(this.tubularSegments);for(var V=0;V<this.tubularSegments;++V){var I=2*(F/this.radialSegments)*this.p*Math.PI,O=2*(V/this.tubularSegments)*Math.PI,B=R(I,O,this.q,this.p,this.radius,this.heightScale),G=R(I+0.01,O,this.q,this.p,this.radius,this.heightScale),H,W;L.subVectors(G,B),U.addVectors(G,B),N.crossVectors(L,U),U.crossVectors(N,L),N.normalize(),U.normalize(),H=-this.tube*Math.cos(O),W=this.tube*Math.sin(O),B.x+=H*U.x+W*N.x,B.y+=H*U.y+W*N.y,B.z+=H*U.z+W*N.z,this.grid[F][V]=D(B.x,B.y,B.z)}}for(var F=0;F<this.radialSegments;++F)for(var V=0;V<this.tubularSegments;++V){var X=(F+1)%this.radialSegments,Y=(V+1)%this.tubularSegments,K=this.grid[F][V],Q=this.grid[X][V],Z=this.grid[X][Y],J=this.grid[F][Y],ee=new THREE.Vector2(F/this.radialSegments,V/this.tubularSegments),oe=new THREE.Vector2((F+1)/this.radialSegments,V/this.tubularSegments),ie=new THREE.Vector2((F+1)/this.radialSegments,(V+1)/this.tubularSegments),ne=new THREE.Vector2(F/this.radialSegments,(V+1)/this.tubularSegments);this.faces.push(new THREE.Face4(K,Q,Z,J)),this.faceVertexUvs[0].push([ee,oe,ie,ne])}this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry=function(_,S,T,M,A,E){function C(xe,ve,Se){return D.vertices.push(new THREE.Vector3(xe,ve,Se))-1}THREE.Geometry.call(this),this.path=_,this.segments=S||64,this.radius=T||1,this.radiusSegments=M||8,this.closed=A||!1,E&&(this.debug=new THREE.Object3D),this.grid=[];var D=this,U=this.segments+1,K=new THREE.Vector3,R,P,L,G,H,W,X,Y,Q,Z,J,ee,oe,ie,ne,se,le,pe,ue,fe,he=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed),ge=he.tangents,ye=he.normals,_e=he.binormals;for(this.tangents=ge,this.normals=ye,this.binormals=_e,Q=0;Q<U;Q++)for(this.grid[Q]=[],G=Q/(U-1),Y=_.getPointAt(G),R=ge[Q],P=ye[Q],L=_e[Q],this.debug&&(this.debug.add(new THREE.ArrowHelper(R,Y,T,255)),this.debug.add(new THREE.ArrowHelper(P,Y,T,16711680)),this.debug.add(new THREE.ArrowHelper(L,Y,T,65280))),Z=0;Z<this.radiusSegments;Z++)H=2*(Z/this.radiusSegments)*Math.PI,W=-this.radius*Math.cos(H),X=this.radius*Math.sin(H),K.copy(Y),K.x+=W*P.x+X*L.x,K.y+=W*P.y+X*L.y,K.z+=W*P.z+X*L.z,this.grid[Q][Z]=C(K.x,K.y,K.z);for(Q=0;Q<this.segments;Q++)for(Z=0;Z<this.radiusSegments;Z++)J=this.closed?(Q+1)%this.segments:Q+1,ee=(Z+1)%this.radiusSegments,oe=this.grid[Q][Z],ie=this.grid[J][Z],ne=this.grid[J][ee],se=this.grid[Q][ee],le=new THREE.Vector2(Q/this.segments,Z/this.radiusSegments),pe=new THREE.Vector2((Q+1)/this.segments,Z/this.radiusSegments),ue=new THREE.Vector2((Q+1)/this.segments,(Z+1)/this.radiusSegments),fe=new THREE.Vector2(Q/this.segments,(Z+1)/this.radiusSegments),this.faces.push(new THREE.Face4(oe,ie,ne,se)),this.faceVertexUvs[0].push([le,pe,ue,fe]);this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry.FrenetFrames=function(_,S,T){function E(){L[0]=new THREE.Vector3,U[0]=new THREE.Vector3,B=Number.MAX_VALUE,G=Math.abs(P[0].x),H=Math.abs(P[0].y),W=Math.abs(P[0].z),G<=B&&(B=G,D.set(1,0,0)),H<=B&&(B=H,D.set(0,1,0)),W<=B&&D.set(0,0,1),N.crossVectors(P[0],D).normalize(),L[0].crossVectors(P[0],N),U[0].crossVectors(P[0],L[0])}var C=new THREE.Vector3,D=new THREE.Vector3,R=new THREE.Vector3,P=[],L=[],U=[],N=new THREE.Vector3,F=new THREE.Matrix4,V=S+1,O=1e-4,I,B,G,H,W,X,Y;for(this.tangents=P,this.normals=L,this.binormals=U,X=0;X<V;X++)Y=X/(V-1),P[X]=_.getTangentAt(Y),P[X].normalize();for(E(),X=1;X<V;X++)L[X]=L[X-1].clone(),U[X]=U[X-1].clone(),N.crossVectors(P[X-1],P[X]),N.length()>O&&(N.normalize(),I=Math.acos(P[X-1].dot(P[X])),L[X].applyMatrix4(F.makeRotationAxis(N,I))),U[X].crossVectors(P[X],L[X]);if(T)for(I=Math.acos(L[0].dot(L[V-1])),I/=V-1,0<P[0].dot(N.crossVectors(L[0],L[V-1]))&&(I=-I),X=1;X<V;X++)L[X].applyMatrix4(F.makeRotationAxis(P[X],I*X)),U[X].crossVectors(P[X],L[X])},THREE.PolyhedronGeometry=function(_,S,T,M){function A(Z){var J=Z.normalize().clone();J.index=L.vertices.push(J)-1;var ee=D(Z)/2/Math.PI+0.5,oe=R(Z)/Math.PI+0.5;return J.uv=new THREE.Vector2(ee,1-oe),J}function E(Z,J,ee){var oe=new THREE.Face3(Z.index,J.index,ee.index,[Z.clone(),J.clone(),ee.clone()]);oe.centroid.add(Z).add(J).add(ee).divideScalar(3),oe.normal.copy(oe.centroid).normalize(),L.faces.push(oe);var ie=D(oe.centroid);L.faceVertexUvs[0].push([P(Z.uv,Z,ie),P(J.uv,J,ie),P(ee.uv,ee,ie)])}function C(Z,J){for(var ee=Math.pow(2,J),oe=Math.pow(4,J),ie=A(L.vertices[Z.a]),ne=A(L.vertices[Z.b]),se=A(L.vertices[Z.c]),le=[],pe=0;pe<=ee;pe++){le[pe]=[];for(var ue=A(ie.clone().lerp(se,pe/ee)),fe=A(ne.clone().lerp(se,pe/ee)),he=ee-pe,ge=0;ge<=he;ge++)le[pe][ge]=0==ge&&pe==ee?ue:A(ue.clone().lerp(fe,ge/he))}for(var pe=0;pe<ee;pe++)for(var ge=0,ye;ge<2*(ee-pe)-1;ge++)ye=Math.floor(ge/2),0==ge%2?E(le[pe][ye+1],le[pe+1][ye],le[pe][ye]):E(le[pe][ye+1],le[pe+1][ye+1],le[pe+1][ye])}function D(Z){return Math.atan2(Z.z,-Z.x)}function R(Z){return Math.atan2(-Z.y,Math.sqrt(Z.x*Z.x+Z.z*Z.z))}function P(Z,J,ee){return 0>ee&&1===Z.x&&(Z=new THREE.Vector2(Z.x-1,Z.y)),0===J.x&&0===J.z&&(Z=new THREE.Vector2(ee/2/Math.PI+0.5,Z.y)),Z.clone()}THREE.Geometry.call(this),T=T||1,M=M||0;for(var L=this,U=0,N=_.length;U<N;U++)A(new THREE.Vector3(_[U][0],_[U][1],_[U][2]));for(var V=this.vertices,I=[],U=0,N=S.length;U<N;U++){var O=V[S[U][0]],B=V[S[U][1]],G=V[S[U][2]];I[U]=new THREE.Face3(O.index,B.index,G.index,[O.clone(),B.clone(),G.clone()])}for(var U=0,N=I.length;U<N;U++)C(I[U],M);for(var U=0,N=this.faceVertexUvs[0].length;U<N;U++){var H=this.faceVertexUvs[0][U],W=H[0].x,X=H[1].x,Y=H[2].x,K=Math.max(W,Math.max(X,Y)),Q=Math.min(W,Math.min(X,Y));0.9<K&&0.1>Q&&(0.2>W&&(H[0].x+=1),0.2>X&&(H[1].x+=1),0.2>Y&&(H[2].x+=1))}this.mergeVertices();for(var U=0,N=this.vertices.length;U<N;U++)this.vertices[U].multiplyScalar(T);this.computeCentroids(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3(),T)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.IcosahedronGeometry=function(_,S){this.radius=_,this.detail=S;var T=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[[-1,T,0],[1,T,0],[-1,-T,0],[1,-T,0],[0,-1,T],[0,1,T],[0,-1,-T],[0,1,-T],[T,0,-1],[T,0,1],[-T,0,-1],[-T,0,1]],[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]],_,S)},THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.OctahedronGeometry=function(_,S){THREE.PolyhedronGeometry.call(this,[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]],_,S)},THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TetrahedronGeometry=function(_,S){THREE.PolyhedronGeometry.call(this,[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],[[2,1,0],[0,3,2],[1,3,0],[2,3,1]],_,S)},THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ParametricGeometry=function(_,S,T,M){THREE.Geometry.call(this);var A=this.vertices,E=this.faces,C=this.faceVertexUvs[0];M=M!==void 0&&M;var D,P,L,U,N,V=S+1;for(D=0;D<=T;D++)for(N=D/T,P=0;P<=S;P++)U=P/S,L=_(U,N),A.push(L);var I,O,B,G,H,W,X,Y;for(D=0;D<T;D++)for(P=0;P<S;P++)I=D*V+P,O=D*V+P+1,B=(D+1)*V+P,G=(D+1)*V+P+1,H=new THREE.Vector2(P/S,D/T),W=new THREE.Vector2((P+1)/S,D/T),X=new THREE.Vector2(P/S,(D+1)/T),Y=new THREE.Vector2((P+1)/S,(D+1)/T),M?(E.push(new THREE.Face3(I,O,B)),E.push(new THREE.Face3(O,G,B)),C.push([H,W,X]),C.push([W,Y,X])):(E.push(new THREE.Face4(I,O,G,B)),C.push([H,W,Y,X]));this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ConvexGeometry=function(_){function S(F){var V=_[F].clone(),I=V.length();V.x+=I*E(),V.y+=I*E(),V.z+=I*E();for(var O=[],B=0,G;B<D.length;)if(G=D[B],T(G,V)){for(var H=0;3>H;H++){for(var W=[G[H],G[(H+1)%3]],X=!0,Y=0;Y<O.length;Y++)if(A(O[Y],W)){O[Y]=O[O.length-1],O.pop(),X=!1;break}X&&O.push(W)}D[B]=D[D.length-1],D.pop()}else B++;for(var Y=0;Y<O.length;Y++)D.push([O[Y][0],O[Y][1],F])}function T(F,V){var I=_[F[0]],O=_[F[1]],B=_[F[2]],G=M(I,O,B),H=G.dot(I);return G.dot(V)>=H}function M(F,V,I){var O=new THREE.Vector3,B=new THREE.Vector3;return O.subVectors(I,V),B.subVectors(F,V),O.cross(B),O.normalize(),O}function A(F,V){return F[0]===V[1]&&F[1]===V[0]}function E(){return 1e-6*(2*(Math.random()-0.5))}function C(F){var V=F.length();return new THREE.Vector2(F.x/V,F.y/V)}THREE.Geometry.call(this);for(var D=[[0,1,2],[0,2,1]],R=3;R<_.length;R++)S(R);for(var P=0,L=Array(_.length),R=0,U;R<D.length;R++){U=D[R];for(var N=0;3>N;N++)void 0===L[U[N]]&&(L[U[N]]=P++,this.vertices.push(_[U[N]])),U[N]=L[U[N]]}for(var R=0;R<D.length;R++)this.faces.push(new THREE.Face3(D[R][0],D[R][1],D[R][2]));for(var R=0,U;R<this.faces.length;R++)U=this.faces[R],this.faceVertexUvs[0].push([C(this.vertices[U.a]),C(this.vertices[U.b]),C(this.vertices[U.c])]);this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.ConvexGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this),this.render=function(){}},THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype),THREE.MorphBlendMesh=function(_,S){THREE.Mesh.call(this,_,S),this.animationsMap={},this.animationsList=[];var T=this.geometry.morphTargets.length,M='__default';this.createAnimation(M,0,T-1,T/1),this.setAnimationWeight(M,1)},THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphBlendMesh.prototype.createAnimation=function(_,S,T,M){var A={startFrame:S,endFrame:T,length:T-S+1,fps:M,duration:(T-S)/M,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[_]=A,this.animationsList.push(A)},THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(_){for(var S=/([a-z]+)(\d+)/,M={},A=this.geometry,E=0,C=A.morphTargets.length,T;E<C;E++){var D=A.morphTargets[E],R=D.name.match(S);if(R&&1<R.length){var P=R[1],L=R[2];M[P]||(M[P]={start:Infinity,end:-Infinity});var U=M[P];E<U.start&&(U.start=E),E>U.end&&(U.end=E),T||(T=P)}}for(var P in M){var U=M[P];this.createAnimation(P,U.start,U.end,_)}this.firstAnimation=T},THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(_){var S=this.animationsMap[_];S&&(S.direction=1,S.directionBackwards=!1)},THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(_){var S=this.animationsMap[_];S&&(S.direction=-1,S.directionBackwards=!0)},THREE.MorphBlendMesh.prototype.setAnimationFPS=function(_,S){var T=this.animationsMap[_];T&&(T.fps=S,T.duration=(T.end-T.start)/T.fps)},THREE.MorphBlendMesh.prototype.setAnimationDuration=function(_,S){var T=this.animationsMap[_];T&&(T.duration=S,T.fps=(T.end-T.start)/T.duration)},THREE.MorphBlendMesh.prototype.setAnimationWeight=function(_,S){var T=this.animationsMap[_];T&&(T.weight=S)},THREE.MorphBlendMesh.prototype.setAnimationTime=function(_,S){var T=this.animationsMap[_];T&&(T.time=S)},THREE.MorphBlendMesh.prototype.getAnimationTime=function(_){var S=0,T=this.animationsMap[_];return T&&(S=T.time),S},THREE.MorphBlendMesh.prototype.getAnimationDuration=function(_){var S=-1,T=this.animationsMap[_];return T&&(S=T.duration),S},THREE.MorphBlendMesh.prototype.playAnimation=function(_){var S=this.animationsMap[_];S&&(S.time=0,S.active=!0)},THREE.MorphBlendMesh.prototype.stopAnimation=function(_){var S=this.animationsMap[_];S&&(S.active=!1)},THREE.MorphBlendMesh.prototype.update=function(_){for(var S=0,T=this.animationsList.length,M;S<T;S++)if(M=this.animationsList[S],M.active){var A=M.duration/M.length;M.time+=M.direction*_,M.mirroredLoop?(M.time>M.duration||0>M.time)&&(M.direction*=-1,M.time>M.duration&&(M.time=M.duration,M.directionBackwards=!0),0>M.time&&(M.time=0,M.directionBackwards=!1)):(M.time%=M.duration,0>M.time&&(M.time+=M.duration));var E=M.startFrame+THREE.Math.clamp(Math.floor(M.time/A),0,M.length-1),C=M.weight;E!==M.currentFrame&&(this.morphTargetInfluences[M.lastFrame]=0,this.morphTargetInfluences[M.currentFrame]=1*C,this.morphTargetInfluences[E]=0,M.lastFrame=M.currentFrame,M.currentFrame=E);var D=M.time%A/A;M.directionBackwards&&(D=1-D),this.morphTargetInfluences[M.currentFrame]=D*C,this.morphTargetInfluences[M.lastFrame]=(1-D)*C}},THREE.SpritePlugin=function(){function _(C,D){var R=T.createProgram(),P=T.createShader(T.FRAGMENT_SHADER),L=T.createShader(T.VERTEX_SHADER),U='precision '+D+' float;\n';return self.MMD_SA&&MMD_SA.use_webgl2?(T.shaderSource(P,MMD_SA.webgl2_fshader_prefix_convert(U)+MMD_SA.webgl2_fshader_main_convert(C.fragmentShader)),T.shaderSource(L,MMD_SA.webgl2_vshader_prefix_convert(U)+MMD_SA.webgl2_vshader_main_convert(C.vertexShader))):(T.shaderSource(P,U+C.fragmentShader),T.shaderSource(L,U+C.vertexShader)),T.compileShader(P),T.compileShader(L),T.getShaderParameter(P,T.COMPILE_STATUS)||console.error(T.getShaderInfoLog(P)),T.getShaderParameter(L,T.COMPILE_STATUS)||console.error(T.getShaderInfoLog(P)),T.attachShader(R,P),T.attachShader(R,L),T.linkProgram(R),R}function S(C,D){return C.z===D.z?D.id-C.id:D.z-C.z}var E={},T,M,A;this.init=function(C){T=C.context,M=C,A=C.getPrecision(),E.vertices=new Float32Array(16),E.faces=new Uint16Array(6);var D=0;E.vertices[D++]=-1,E.vertices[D++]=-1,E.vertices[D++]=0,E.vertices[D++]=0,E.vertices[D++]=1,E.vertices[D++]=-1,E.vertices[D++]=1,E.vertices[D++]=0,E.vertices[D++]=1,E.vertices[D++]=1,E.vertices[D++]=1,E.vertices[D++]=1,E.vertices[D++]=-1,E.vertices[D++]=1,E.vertices[D++]=0,E.vertices[D++]=1,D=0,E.faces[D++]=0,E.faces[D++]=1,E.faces[D++]=2,E.faces[D++]=0,E.faces[D++]=2,E.faces[D++]=3,E.vertexBuffer=T.createBuffer(),E.elementBuffer=T.createBuffer(),T.bindBuffer(T.ARRAY_BUFFER,E.vertexBuffer),T.bufferData(T.ARRAY_BUFFER,E.vertices,T.STATIC_DRAW),T.bindBuffer(T.ELEMENT_ARRAY_BUFFER,E.elementBuffer),T.bufferData(T.ELEMENT_ARRAY_BUFFER,E.faces,T.STATIC_DRAW),E.program=_(THREE.ShaderSprite.sprite,A),E.attributes={},E.uniforms={},E.attributes.position=T.getAttribLocation(E.program,'position'),E.attributes.uv=T.getAttribLocation(E.program,'uv'),E.uniforms.uvOffset=T.getUniformLocation(E.program,'uvOffset'),E.uniforms.uvScale=T.getUniformLocation(E.program,'uvScale'),E.uniforms.rotation=T.getUniformLocation(E.program,'rotation'),E.uniforms.scale=T.getUniformLocation(E.program,'scale'),E.uniforms.alignment=T.getUniformLocation(E.program,'alignment'),E.uniforms.color=T.getUniformLocation(E.program,'color'),E.uniforms.map=T.getUniformLocation(E.program,'map'),E.uniforms.opacity=T.getUniformLocation(E.program,'opacity'),E.uniforms.useScreenCoordinates=T.getUniformLocation(E.program,'useScreenCoordinates'),E.uniforms.sizeAttenuation=T.getUniformLocation(E.program,'sizeAttenuation'),E.uniforms.screenPosition=T.getUniformLocation(E.program,'screenPosition'),E.uniforms.modelViewMatrix=T.getUniformLocation(E.program,'modelViewMatrix'),E.uniforms.projectionMatrix=T.getUniformLocation(E.program,'projectionMatrix'),E.uniforms.fogType=T.getUniformLocation(E.program,'fogType'),E.uniforms.fogDensity=T.getUniformLocation(E.program,'fogDensity'),E.uniforms.fogNear=T.getUniformLocation(E.program,'fogNear'),E.uniforms.fogFar=T.getUniformLocation(E.program,'fogFar'),E.uniforms.fogColor=T.getUniformLocation(E.program,'fogColor'),E.uniforms.alphaTest=T.getUniformLocation(E.program,'alphaTest'),E.uniforms.depth_render_mode=T.getUniformLocation(E.program,'depth_render_mode')},this.render=function(C,D,R,P){var L=C.__webglSprites,U=L.length;if(U){var N=E.attributes,F=E.uniforms,I=0.5*R,O=0.5*P;T.useProgram(E.program),T.enableVertexAttribArray(N.position),T.enableVertexAttribArray(N.uv),T.disable(T.CULL_FACE),T.enable(T.BLEND),T.bindBuffer(T.ARRAY_BUFFER,E.vertexBuffer),T.vertexAttribPointer(N.position,2,T.FLOAT,!1,16,0),T.vertexAttribPointer(N.uv,2,T.FLOAT,!1,16,8),T.bindBuffer(T.ELEMENT_ARRAY_BUFFER,E.elementBuffer),T.uniformMatrix4fv(F.projectionMatrix,!1,D.projectionMatrix.elements),T.activeTexture(T.TEXTURE0),T.uniform1i(F.map,0),self.MMD_SA&&T.uniform1i(F.depth_render_mode,MMD_SA._depth_render_mode_);var B=0,G=0,H=C.fog;H?(T.uniform3f(F.fogColor,H.color.r,H.color.g,H.color.b),H instanceof THREE.Fog?(T.uniform1f(F.fogNear,H.near),T.uniform1f(F.fogFar,H.far),T.uniform1i(F.fogType,1),B=1,G=1):H instanceof THREE.FogExp2&&(T.uniform1f(F.fogDensity,H.density),T.uniform1i(F.fogType,2),B=2,G=2)):(T.uniform1i(F.fogType,0),B=0,G=0);var J=[],W,X,Y,Q,Z;for(W=0;W<U;W++)X=L[W],Y=X.material,!X.visible||0===Y.opacity||(Y.useScreenCoordinates?X.z=-X.position.z:(X._modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,X.matrixWorld),X.z=-X._modelViewMatrix.elements[14]));for(L.sort(S),W=0;W<U;W++)X=L[W],Y=X.material,X.visible&&0!==Y.opacity&&Y.map&&Y.map.image&&Y.map.image.width&&(T.uniform1f(F.alphaTest,Y.alphaTest),!0===Y.useScreenCoordinates?(T.uniform1i(F.useScreenCoordinates,1),T.uniform3f(F.screenPosition,(X.position.x*M.devicePixelRatio-I)/I,(O-X.position.y*M.devicePixelRatio)/O,Math.max(0,Math.min(1,X.position.z))),J[0]=M.devicePixelRatio,J[1]=M.devicePixelRatio):(T.uniform1i(F.useScreenCoordinates,0),T.uniform1i(F.sizeAttenuation,Y.sizeAttenuation?1:0),T.uniformMatrix4fv(F.modelViewMatrix,!1,X._modelViewMatrix.elements),J[0]=1,J[1]=1),Z=C.fog&&Y.fog?G:0,B!==Z&&(T.uniform1i(F.fogType,Z),B=Z),Q=1/(Y.scaleByViewport?P:1),J[0]*=Q*(P/R)*X.scale.x,J[1]*=Q*X.scale.y,T.uniform2f(F.uvScale,Y.uvScale.x,Y.uvScale.y),T.uniform2f(F.uvOffset,Y.uvOffset.x,Y.uvOffset.y),T.uniform2f(F.alignment,Y.alignment.x,Y.alignment.y),T.uniform1f(F.opacity,Y.opacity),T.uniform3f(F.color,Y.color.r,Y.color.g,Y.color.b),T.uniform1f(F.rotation,X.rotation),T.uniform2fv(F.scale,J),M.setBlending(Y.blending,Y.blendEquation,Y.blendSrc,Y.blendDst),M.setDepthTest(Y.depthTest),M.setDepthWrite(Y.depthWrite),M.setTexture(Y.map,0),T.drawElements(T.TRIANGLES,6,T.UNSIGNED_SHORT,0));T.enable(T.CULL_FACE)}}},THREE.ShaderSprite={sprite:{vertexShader:['uniform int useScreenCoordinates;','uniform int sizeAttenuation;','uniform vec3 screenPosition;','uniform mat4 modelViewMatrix;','uniform mat4 projectionMatrix;','uniform float rotation;','uniform vec2 scale;','uniform vec2 alignment;','uniform vec2 uvOffset;','uniform vec2 uvScale;','attribute vec2 position;','attribute vec2 uv;','varying vec2 vUV;','void main() {','vUV = uvOffset + uv * uvScale;','vec2 alignedPosition = position + alignment;','vec2 rotatedPosition;','rotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;','rotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;','vec4 finalPosition;','if( useScreenCoordinates != 0 ) {','finalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );','} else {','finalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );','finalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );','}','gl_Position = finalPosition;','}'].join('\n'),fragmentShader:['uniform vec3 color;','uniform sampler2D map;','uniform float opacity;','uniform int fogType;','uniform vec3 fogColor;','uniform float fogDensity;','uniform float fogNear;','uniform float fogFar;','uniform float alphaTest;','varying vec2 vUV;','#define SKIP_SAO_DEPTH',THREE.ShaderChunk.AT_depth_render_mode_pars_fragment,'void main() {',THREE.ShaderChunk.AT_depth_render_mode_fragment,'vec4 texture = texture2D( map, vUV );','if ( texture.a < alphaTest ) discard;','gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );','if ( fogType > 0 ) {','float depth = gl_FragCoord.z / gl_FragCoord.w;','float fogFactor = 0.0;','if ( fogType == 1 ) {','fogFactor = smoothstep( fogNear, fogFar, depth );','} else {','const float LOG2 = 1.442695;','float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );','fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );','}','gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );','}','}'].join('\n')}},THREE.AxisHelper=function(_){_=_||1;var S=new THREE.Geometry;S.vertices.push(new THREE.Vector3,new THREE.Vector3(_,0,0),new THREE.Vector3,new THREE.Vector3(0,_,0),new THREE.Vector3,new THREE.Vector3(0,0,_)),S.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775));var T=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,S,T,THREE.LinePieces)},THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype),function(_){function S(){this.header=null,this.offset=0,this.use_rle=!1,this.use_pal=!1,this.use_rgb=!1,this.use_grey=!1}S.TYPE_NO_DATA=0,S.TYPE_INDEXED=1,S.TYPE_RGB=2,S.TYPE_GREY=3,S.TYPE_RLE_INDEXED=9,S.TYPE_RLE_RGB=10,S.TYPE_RLE_GREY=11,S.ORIGIN_MASK=48,S.ORIGIN_SHIFT=4,S.ORIGIN_BL=0,S.ORIGIN_BR=1,S.ORIGIN_UL=2,S.ORIGIN_UR=3,S.prototype.open=function(M,A,E){var D=this,C;C=new XMLHttpRequestZIP,C.open('GET',M,!0),C.responseType='arraybuffer',C.onload=function(){D.load(new Uint8Array(C.response)),A&&A.call(D)},C.onerror=function(){E&&E.call(D)},C.send(null)},S.prototype.load=function(M){if(19>M.length)throw new Error('Targa::load() - Not enough data to contain header.');if(this.offset=0,this.header={id_length:M[this.offset++],colormap_type:M[this.offset++],image_type:M[this.offset++],colormap_index:M[this.offset++]|M[this.offset++]<<8,colormap_length:M[this.offset++]|M[this.offset++]<<8,colormap_size:M[this.offset++],origin:[M[this.offset++]|M[this.offset++]<<8,M[this.offset++]|M[this.offset++]<<8],width:M[this.offset++]|M[this.offset++]<<8,height:M[this.offset++]|M[this.offset++]<<8,pixel_size:M[this.offset++],flags:M[this.offset++]},this.checkHeader(),this.header.id_length+this.offset>M.length)throw new Error('Targa::load() - No data ?');switch(this.offset+=this.header.id_length,this.header.image_type){case S.TYPE_RLE_INDEXED:this.use_rle=!0;case S.TYPE_INDEXED:this.use_pal=!0;break;case S.TYPE_RLE_RGB:this.use_rle=!0;case S.TYPE_RGB:this.use_rgb=!0;break;case S.TYPE_RLE_GREY:this.use_rle=!0;case S.TYPE_GREY:this.use_grey=!0;}this.parse(M)},S.prototype.checkHeader=function(){switch(this.header.image_type){case S.TYPE_INDEXED:case S.TYPE_RLE_INDEXED:if(256<this.header.colormap_length||24!==this.header.colormap_size||1!==this.header.colormap_type)throw new Error('Targa::checkHeader() - Invalid type colormap data for indexed type');break;case S.TYPE_RGB:case S.TYPE_GREY:case S.TYPE_RLE_RGB:case S.TYPE_RLE_GREY:if(this.header.colormap_type)throw new Error('Targa::checkHeader() - Invalid type colormap data for colormap type');break;case S.TYPE_NO_DATA:throw new Error('Targa::checkHeader() - No data on this TGA file');default:throw new Error('Targa::checkHeader() - Invalid type \''+this.header.image_type+'\'');}if(0>=this.header.width||0>=this.header.height)throw new Error('Targa::checkHeader() - Invalid image size');if(8!==this.header.pixel_size&&16!==this.header.pixel_size&&24!==this.header.pixel_size&&32!==this.header.pixel_size)throw new Error('Targa::checkHeader() - Invalid pixel size \''+this.header.pixel_size+'\'')},S.prototype.parse=function(M){var A,E,C,D,R;if(A=this.header,E=15&A.flags,D=A.pixel_size>>3,R=A.width*A.height*D,this.use_pal&&(this.palettes=M.subarray(this.offset,this.offset+=A.colormap_length*D)),this.use_rle){C=new Uint8Array(R);for(var N=0,F=new Uint8Array(D),P,L,U;N<R;)if(P=M[this.offset++],L=(127&P)+1,128&P){for(U=0;U<D;++U)F[U]=M[this.offset++];for(U=0;U<L;++U)C.set(F,N+U*D);N+=D*L}else{for(L*=D,U=0;U<L;++U)C[N+U]=M[this.offset++];N+=L}}else C=M.subarray(this.offset,this.offset+=this.use_pal?A.width*A.height:R);this.image=C},S.prototype.getImageData=function(M){var A=this.header.width,E=this.header.height,C,D,R,P,L,U,N,F;switch(F=M||document&&document.createElement('canvas').getContext('2d').createImageData(A,E)||{width:A,height:E,data:new Uint8Array(4*(A*E))},(this.header.flags&S.ORIGIN_MASK)>>S.ORIGIN_SHIFT){default:case S.ORIGIN_UL:C=0,R=1,U=A,D=0,P=1,L=E;break;case S.ORIGIN_BL:C=0,R=1,U=A,D=E-1,P=-1,L=-1;break;case S.ORIGIN_UR:C=A-1,R=-1,U=-1,D=0,P=1,L=E;break;case S.ORIGIN_BR:C=A-1,R=-1,U=-1,D=E-1,P=-1,L=-1;}return N='getImageData'+(this.use_grey?'Grey':'')+this.header.pixel_size+'bits',this[N](F.data,D,P,L,C,R,U),F},S.prototype.getCanvas=function(){var M=document.createElement('canvas'),A=M.getContext('2d'),E=A.createImageData(this.header.width,this.header.height);return M.width=this.header.width,M.height=this.header.height,A.putImageData(this.getImageData(E),0,0),M},S.prototype.getDataURL=function(M){return this.getCanvas().toDataURL(M||'image/png')},S.prototype.getImageData8bits=function(M,A,E,C,D,R,P){var L=this.image,U=this.palettes,N=this.header.width,F=this.header.height,V,I=0,O,B;for(B=A;B!==C;B+=E)for(O=D;O!==P;O+=R,I++)V=L[I],M[4*(O+N*B)+3]=255,M[4*(O+N*B)+2]=U[3*V+0],M[4*(O+N*B)+1]=U[3*V+1],M[4*(O+N*B)+0]=U[3*V+2];return M},S.prototype.getImageData16bits=function(M,A,E,C,D,R,P){var L=this.image,U=this.header.width,N=this.header.height,F,V=0,I,O;for(O=A;O!==C;O+=E)for(I=D;I!==P;I+=R,V+=2)F=L[V+0]+(L[V+1]<<8),M[4*(I+U*O)+0]=(31744&F)>>7,M[4*(I+U*O)+1]=(992&F)>>2,M[4*(I+U*O)+2]=(31&F)>>3,M[4*(I+U*O)+3]=32768&F?0:255;return M},S.prototype.getImageData24bits=function(M,A,E,C,D,R,P){var L=this.image,U=this.header.width,N=this.header.height,F=0,V,I;for(I=A;I!==C;I+=E)for(V=D;V!==P;V+=R,F+=3)M[4*(V+U*I)+3]=255,M[4*(V+U*I)+2]=L[F+0],M[4*(V+U*I)+1]=L[F+1],M[4*(V+U*I)+0]=L[F+2];return M},S.prototype.getImageData32bits=function(M,A,E,C,D,R,P){var L=this.image,U=this.header.width,N=this.header.height,F=0,V,I;for(I=A;I!==C;I+=E)for(V=D;V!==P;V+=R,F+=4)M[4*(V+U*I)+2]=L[F+0],M[4*(V+U*I)+1]=L[F+1],M[4*(V+U*I)+0]=L[F+2],M[4*(V+U*I)+3]=L[F+3];return M},S.prototype.getImageDataGrey8bits=function(M,A,E,C,D,R,P){var L=this.image,U=this.header.width,N=this.header.height,F,V=0,I,O;for(O=A;O!==C;O+=E)for(I=D;I!==P;I+=R,V++)F=L[V],M[4*(I+U*O)+0]=F,M[4*(I+U*O)+1]=F,M[4*(I+U*O)+2]=F,M[4*(I+U*O)+3]=255;return M},S.prototype.getImageDataGrey16bits=function(M,A,E,C,D,R,P){var L=this.image,U=this.header.width,N=this.header.height,F=0,V,I;for(I=A;I!==C;I+=E)for(V=D;V!==P;V+=R,F+=2)M[4*(V+U*I)+0]=L[F+0],M[4*(V+U*I)+1]=L[F+0],M[4*(V+U*I)+2]=L[F+0],M[4*(V+U*I)+3]=L[F+1];return M},'undefined'!=typeof _&&(_.TGA=S)}(THREE),function(_,S,T){'use strict';function M(F,V,I){var O=F.runtimeStyle&&F.runtimeStyle[V],G=F.style,B;return!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(I)&&/^-?\d/.test(I)&&(B=G.left,O&&(F.runtimeStyle.left=F.currentStyle.left),G.left='fontSize'===V?'1em':I||0,I=G.pixelLeft+'px',G.left=B,O&&(F.runtimeStyle.left=O)),/^(thin|medium|thick)$/i.test(I)?I:Math.round(parseFloat(I))+'px'}function A(F){return parseInt(F,10)}function E(F,V,I,O){if(F=(F||'').split(','),F=F[O||0]||F[0]||'auto',F=P.Util.trimText(F).split(' '),'backgroundSize'===I&&(!F[0]||F[0].match(/cover|contain|auto/)));else{if(F[0]=-1===F[0].indexOf('%')?M(V,I+'X',F[0]):F[0],F[1]===T){if('backgroundSize'===I)return F[1]='auto',F;F[1]=F[0]}F[1]=-1===F[1].indexOf('%')?M(V,I+'Y',F[1]):F[1]}return F}function C(F,V,I,O,B,G){var H=P.Util.getCSS(V,F,B),W,X,Y,K;if(1===H.length&&(K=H[0],H=[],H[0]=K,H[1]=K),-1!==H[0].toString().indexOf('%'))Y=parseFloat(H[0])/100,X=I.width*Y,'backgroundSize'!==F&&(X-=(G||O).width*Y);else if('backgroundSize'!==F)X=parseInt(H[0],10);else if('auto'===H[0])X=O.width;else if(/contain|cover/.test(H[0])){var Q=P.Util.resizeBounds(O.width,O.height,I.width,I.height,H[0]);X=Q.width,W=Q.height}else X=parseInt(H[0],10);return'auto'===H[1]?W=X/O.width*O.height:-1===H[1].toString().indexOf('%')?W=parseInt(H[1],10):(Y=parseFloat(H[1])/100,W=I.height*Y,'backgroundSize'!==F&&(W-=(G||O).height*Y)),[X,W]}function D(F,V){var I=[];return{storage:I,width:F,height:V,clip:function(){I.push({type:'function',name:'clip',arguments:arguments})},translate:function(){I.push({type:'function',name:'translate',arguments:arguments})},fill:function(){I.push({type:'function',name:'fill',arguments:arguments})},save:function(){I.push({type:'function',name:'save',arguments:arguments})},restore:function(){I.push({type:'function',name:'restore',arguments:arguments})},fillRect:function(){I.push({type:'function',name:'fillRect',arguments:arguments})},createPattern:function(){I.push({type:'function',name:'createPattern',arguments:arguments})},drawShape:function(){var O=[];return I.push({type:'function',name:'drawShape',arguments:O}),{moveTo:function(){O.push({name:'moveTo',arguments:arguments})},lineTo:function(){O.push({name:'lineTo',arguments:arguments})},arcTo:function(){O.push({name:'arcTo',arguments:arguments})},bezierCurveTo:function(){O.push({name:'bezierCurveTo',arguments:arguments})},quadraticCurveTo:function(){O.push({name:'quadraticCurveTo',arguments:arguments})}}},drawImage:function(){I.push({type:'function',name:'drawImage',arguments:arguments})},fillText:function(){I.push({type:'function',name:'fillText',arguments:arguments})},setVariable:function(O,B){return I.push({type:'variable',name:O,arguments:B}),B}}}function R(F){return{zindex:F,children:[]}}var P={},L,U;P.Util={},P.Util.log=function(F){P.logging&&_.console&&_.console.log&&_.console.log(F)},P.Util.trimText=function(F){return function(V){return F?F.apply(V):((V||'')+'').replace(/^\s+|\s+$/g,'')}}(String.prototype.trim),P.Util.asFloat=function(F){return parseFloat(F)},function(){var F=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,V=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g;P.Util.parseTextShadows=function(I){if(!I||'none'===I)return[];for(var O=I.match(F),B=[],G=0,H;O&&G<O.length;G++)H=O[G].match(V),B.push({color:H[0],offsetX:H[1]?H[1].replace('px',''):0,offsetY:H[2]?H[2].replace('px',''):0,blur:H[3]?H[3].replace('px',''):0});return B}}(),P.Util.parseBackgroundImage=function(F){var W=[],Y=0,K=0,J=function(){I&&('"'===O.substr(0,1)&&(O=O.substr(1,O.length-2)),O&&Z.push(O),'-'===I.substr(0,1)&&0<(G=I.indexOf('-',1)+1)&&(B=I.substr(0,G),I=I.substr(G)),W.push({prefix:B,method:I.toLowerCase(),value:H,args:Z})),Z=[],I=B=O=H=''},I,O,B,G,H,X,Q,Z;J();for(var ee=0,oe=F.length;ee<oe;ee++)if(X=F[ee],!(0==Y&&-1<' \r\n\t'.indexOf(X))){switch(X){case'"':Q?Q==X&&(Q=null):Q=X;break;case'(':if(Q)break;else if(0==Y){Y=1,H+=X;continue}else K++;break;case')':if(Q)break;else if(1==Y)if(0==K){Y=0,H+=X,J();continue}else K--;break;case',':if(Q)break;else if(0==Y){J();continue}else if(1==Y&&0==K&&!I.match(/^url$/i)){Z.push(O),O='',H+=X;continue}}H+=X,0==Y?I+=X:O+=X}return J(),W},P.Util.Bounds=function(F){var I={},V;return F.getBoundingClientRect&&(V=F.getBoundingClientRect(),I.top=V.top,I.bottom=V.bottom||V.top+V.height,I.left=V.left,I.width=F.offsetWidth,I.height=F.offsetHeight),I},P.Util.OffsetBounds=function(F){var V=F.offsetParent?P.Util.OffsetBounds(F.offsetParent):{top:0,left:0};return{top:F.offsetTop+V.top,bottom:F.offsetTop+F.offsetHeight+V.top,left:F.offsetLeft+V.left,width:F.offsetWidth,height:F.offsetHeight}},P.Util.getCSS=function(F,V,I){L!==F&&(U=S.defaultView.getComputedStyle(F,null));var O=U[V];if(/^background(Size|Position)$/.test(V))return E(O,F,V,I);if(/border(Top|Bottom)(Left|Right)Radius/.test(V)){var B=O.split(' ');return 1>=B.length&&(B[1]=B[0]),B.map(A)}return O},P.Util.resizeBounds=function(F,V,I,O,B){var H=F/V,W,X;return B&&'auto'!==B?I/O<H^'contain'===B?(X=O,W=O*H):(W=I,X=I/H):(W=I,X=O),{width:W,height:X}},P.Util.BackgroundPosition=function(F,V,I,O,B){var G=C('backgroundPosition',F,V,I,O,B);return{left:G[0],top:G[1]}},P.Util.BackgroundSize=function(F,V,I,O){var B=C('backgroundSize',F,V,I,O);return{width:B[0],height:B[1]}},P.Util.Extend=function(F,V){for(var I in F)F.hasOwnProperty(I)&&(V[I]=F[I]);return V},P.Util.Children=function(F){var V;try{V=F.nodeName&&'IFRAME'===F.nodeName.toUpperCase()?F.contentDocument||F.contentWindow.document:function(I){var O=[];return null!==I&&function(B,G){var H=B.length,W=0;if('number'==typeof G.length)for(var X=G.length;W<X;W++)B[H++]=G[W];else for(;G[W]!==T;)B[H++]=G[W++];return B.length=H,B}(O,I),O}(F.childNodes)}catch(I){P.Util.log('html2canvas.Util.Children failed with exception: '+I.message),V=[]}return V},P.Util.isTransparent=function(F){return'transparent'===F||'rgba(0, 0, 0, 0)'===F},P.Util.Font=function(){var F={};return function(V,I,O){if(F[V+'-'+I]!==T)return F[V+'-'+I];var B=O.createElement('div'),G=O.createElement('img'),H=O.createElement('span'),W='Hidden Text',X,Y,K;return B.style.visibility='hidden',B.style.fontFamily=V,B.style.fontSize=I,B.style.margin=0,B.style.padding=0,O.body.appendChild(B),G.src='data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=',G.width=1,G.height=1,G.style.margin=0,G.style.padding=0,G.style.verticalAlign='baseline',H.style.fontFamily=V,H.style.fontSize=I,H.style.margin=0,H.style.padding=0,H.appendChild(O.createTextNode(W)),B.appendChild(H),B.appendChild(G),X=G.offsetTop-H.offsetTop+1,B.removeChild(H),B.appendChild(O.createTextNode(W)),B.style.lineHeight='normal',G.style.verticalAlign='super',Y=G.offsetTop-B.offsetTop+1,K={baseline:X,lineWidth:1,middle:Y},F[V+'-'+I]=K,O.body.removeChild(B),K}}(),function(){function F(B){return function(G){try{B.addColorStop(G.stop,G.color)}catch(H){V.log(['failed to add color stop: ',H,'; tried to add: ',G])}}}var V=P.Util,I={};P.Generate=I;var O=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/];I.parseGradient=function(B,G){var X=O.length,H,W,Y,K,Q,Z,J,ee,oe,ie,ne,se;for(W=0;W<X&&(Y=B.match(O[W]),!Y);W+=1);if(Y)switch(Y[1]){case'-webkit-linear-gradient':case'-o-linear-gradient':if(H={type:'linear',x0:null,y0:null,x1:null,y1:null,colorStops:[]},Q=Y[2].match(/\w+/g),Q)for(Z=Q.length,W=0;W<Z;W+=1)switch(Q[W]){case'top':H.y0=0,H.y1=G.height;break;case'right':H.x0=G.width,H.x1=0;break;case'bottom':H.y0=G.height,H.y1=0;break;case'left':H.x0=0,H.x1=G.width;}if(null===H.x0&&null===H.x1&&(H.x0=H.x1=G.width/2),null===H.y0&&null===H.y1&&(H.y0=H.y1=G.height/2),Q=Y[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g),Q)for(Z=Q.length,J=1/Math.max(Z-1,1),W=0;W<Z;W+=1)ee=Q[W].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),ee[2]?(K=parseFloat(ee[2]),K/='%'===ee[3]?100:G.width):K=W*J,H.colorStops.push({color:ee[1],stop:K});break;case'-webkit-gradient':if(H={type:'radial'===Y[2]?'circle':Y[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]},Q=Y[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/),Q&&(H.x0=Q[1]*G.width/100,H.y0=Q[2]*G.height/100,H.x1=Q[3]*G.width/100,H.y1=Q[4]*G.height/100),Q=Y[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g),Q)for(Z=Q.length,W=0;W<Z;W+=1)ee=Q[W].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),K=parseFloat(ee[2]),'from'===ee[1]&&(K=0),'to'===ee[1]&&(K=1),H.colorStops.push({color:ee[3],stop:K});break;case'-moz-linear-gradient':if(H={type:'linear',x0:0,y0:0,x1:0,y1:0,colorStops:[]},Q=Y[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),Q&&(H.x0=Q[1]*G.width/100,H.y0=Q[2]*G.height/100,H.x1=G.width-H.x0,H.y1=G.height-H.y0),Q=Y[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g),Q)for(Z=Q.length,J=1/Math.max(Z-1,1),W=0;W<Z;W+=1)ee=Q[W].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/),ee[2]?(K=parseFloat(ee[2]),ee[3]&&(K/=100)):K=W*J,H.colorStops.push({color:ee[1],stop:K});break;case'-webkit-radial-gradient':case'-moz-radial-gradient':case'-o-radial-gradient':if(H={type:'circle',x0:0,y0:0,x1:G.width,y1:G.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]},Q=Y[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),Q&&(H.cx=Q[1]*G.width/100,H.cy=Q[2]*G.height/100),Q=Y[3].match(/\w+/),ee=Y[4].match(/[a-z\-]*/),Q&&ee)switch(ee[0]){case'farthest-corner':case'cover':case'':oe=Math.sqrt(Math.pow(H.cx,2)+Math.pow(H.cy,2)),ie=Math.sqrt(Math.pow(H.cx,2)+Math.pow(H.y1-H.cy,2)),ne=Math.sqrt(Math.pow(H.x1-H.cx,2)+Math.pow(H.y1-H.cy,2)),se=Math.sqrt(Math.pow(H.x1-H.cx,2)+Math.pow(H.cy,2)),H.rx=H.ry=Math.max(oe,ie,ne,se);break;case'closest-corner':oe=Math.sqrt(Math.pow(H.cx,2)+Math.pow(H.cy,2)),ie=Math.sqrt(Math.pow(H.cx,2)+Math.pow(H.y1-H.cy,2)),ne=Math.sqrt(Math.pow(H.x1-H.cx,2)+Math.pow(H.y1-H.cy,2)),se=Math.sqrt(Math.pow(H.x1-H.cx,2)+Math.pow(H.cy,2)),H.rx=H.ry=Math.min(oe,ie,ne,se);break;case'farthest-side':'circle'===Q[0]?H.rx=H.ry=Math.max(H.cx,H.cy,H.x1-H.cx,H.y1-H.cy):(H.type=Q[0],H.rx=Math.max(H.cx,H.x1-H.cx),H.ry=Math.max(H.cy,H.y1-H.cy));break;case'closest-side':case'contain':'circle'===Q[0]?H.rx=H.ry=Math.min(H.cx,H.cy,H.x1-H.cx,H.y1-H.cy):(H.type=Q[0],H.rx=Math.min(H.cx,H.x1-H.cx),H.ry=Math.min(H.cy,H.y1-H.cy));}if(Q=Y[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g),Q)for(Z=Q.length,J=1/Math.max(Z-1,1),W=0;W<Z;W+=1)ee=Q[W].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),ee[2]?(K=parseFloat(ee[2]),K/='%'===ee[3]?100:G.width):K=W*J,H.colorStops.push({color:ee[1],stop:K});}return H},I.Gradient=function(B,G){if(0!==G.width&&0!==G.height){var H=S.createElement('canvas'),W=H.getContext('2d'),X,Y;if(H.width=G.width,H.height=G.height,X=P.Generate.parseGradient(B,G),X)switch(X.type){case'linear':Y=W.createLinearGradient(X.x0,X.y0,X.x1,X.y1),X.colorStops.forEach(F(Y)),W.fillStyle=Y,W.fillRect(0,0,G.width,G.height);break;case'circle':Y=W.createRadialGradient(X.cx,X.cy,0,X.cx,X.cy,X.rx),X.colorStops.forEach(F(Y)),W.fillStyle=Y,W.fillRect(0,0,G.width,G.height);break;case'ellipse':var K=S.createElement('canvas'),Q=K.getContext('2d'),Z=Math.max(X.rx,X.ry),J=2*Z;K.width=K.height=J,Y=Q.createRadialGradient(X.rx,X.ry,0,X.rx,X.ry,Z),X.colorStops.forEach(F(Y)),Q.fillStyle=Y,Q.fillRect(0,0,J,J),W.fillStyle=X.colorStops[X.colorStops.length-1].color,W.fillRect(0,0,H.width,H.height),W.drawImage(K,X.cx-X.rx,X.cy-X.ry,2*X.rx,2*X.ry);}return H}},I.ListAlpha=function(B){var G='',H;do H=B%26,G=String.fromCharCode(H+64)+G,B/=26;while(26<26*B);return G},I.ListRoman=function(B){var G=['M','CM','D','CD','C','XC','L','XL','X','IX','V','IV','I'],H=[1000,900,500,400,100,90,50,40,10,9,5,4,1],W='',Y=G.length,X;if(0>=B||4e3<=B)return B;for(X=0;X<Y;X+=1)for(;B>=H[X];)B-=H[X],W+=G[X];return W}}(),P.Parse=function(F,V){function I(){return Math.max(Math.max(Ze.body.scrollWidth,Ze.documentElement.scrollWidth),Math.max(Ze.body.offsetWidth,Ze.documentElement.offsetWidth),Math.max(Ze.body.clientWidth,Ze.documentElement.clientWidth))}function O(){return Math.max(Math.max(Ze.body.scrollHeight,Ze.documentElement.scrollHeight),Math.max(Ze.body.offsetHeight,Ze.documentElement.offsetHeight),Math.max(Ze.body.clientHeight,Ze.documentElement.clientHeight))}function B(st,lt){var dt=parseInt(rt(st,lt),10);return isNaN(dt)?0:dt}function G(st,lt,dt,ct,mt,ut){'transparent'!==ut&&(st.setVariable('fillStyle',ut),st.fillRect(lt,dt,ct,mt),Qe+=1)}function H(st,lt,dt){if(0<st.length)return lt+dt.toUpperCase()}function W(st,lt){return'lowercase'===lt?st.toLowerCase():'capitalize'===lt?st.replace(/(^|\s|:|-|\(|\))([a-z])/g,H):'uppercase'===lt?st.toUpperCase():st}function X(st){return /^(normal|none|0px)$/.test(st)}function Y(st,lt,dt,ct){null!==st&&0<Je.trimText(st).length&&(ct.fillText(st,lt,dt),Qe+=1)}function K(st,lt,dt,ct){var ut=rt(lt,'fontWeight'),ft=rt(lt,'fontFamily'),ht=rt(lt,'fontSize'),gt=Je.parseTextShadows(rt(lt,'textShadow'));switch(parseInt(ut,10)){case 401:ut='bold';break;case 400:ut='normal';}if(st.setVariable('fillStyle',ct),st.setVariable('font',[rt(lt,'fontStyle'),rt(lt,'fontVariant'),ut,ht,ft].join(' ')),st.setVariable('textAlign','left'),gt.length&&(st.setVariable('shadowColor',gt[0].color),st.setVariable('shadowOffsetX',gt[0].offsetX),st.setVariable('shadowOffsetY',gt[0].offsetY),st.setVariable('shadowBlur',gt[0].blur)),'none'!==dt)return Je.Font(ft,ht,Ze)}function Q(st,lt,dt,ct,mt){'underline'===lt?G(st,dt.left,Math.round(dt.top+ct.baseline+ct.lineWidth),dt.width,1,mt):'overline'===lt?G(st,dt.left,Math.round(dt.top),dt.width,1,mt):'line-through'===lt?G(st,dt.left,Math.ceil(dt.top+ct.middle+ct.lineWidth),dt.width,1,mt):void 0}function Z(st,lt,dt,ct,mt){var ut;if($e.rangeBounds&&!mt)('none'!==dt||0!==Je.trimText(lt).length)&&(ut=J(lt,st.node,st.textOffset)),st.textOffset+=lt.length;else if(st.node&&'string'==typeof st.node.nodeValue){var ft=ct?st.node.splitText(lt.length):null;ut=ee(st.node,mt),st.node=ft}return ut}function J(st,lt,dt){var ct=Ze.createRange();return ct.setStart(lt,dt),ct.setEnd(lt,dt+st.length),ct.getBoundingClientRect()}function ee(st,lt){var dt=st.parentNode,ct=Ze.createElement('wrapper'),mt=st.cloneNode(!0);ct.appendChild(st.cloneNode(!0)),dt.replaceChild(ct,st);var ut=lt?Je.OffsetBounds(ct):Je.Bounds(ct);return dt.replaceChild(mt,ct),ut}function oe(st,lt,dt){var ct=dt.ctx,mt=rt(st,'color'),ut=rt(st,'textDecoration'),ft=rt(st,'textAlign'),yt={node:lt,textOffset:0},ht,gt;0<Je.trimText(lt.nodeValue).length&&(lt.nodeValue=W(lt.nodeValue,rt(st,'textTransform')),ft=ft.replace(['-webkit-auto'],['auto']),gt=!V.letterRendering&&/^(left|right|justify|auto)$/.test(ft)&&X(rt(st,'letterSpacing'))?lt.nodeValue.split(/(\b| )/):lt.nodeValue.split(''),ht=K(ct,st,ut,mt),V.chinese&&gt.forEach(function(_t,xt){/.*[\u4E00-\u9FA5].*$/.test(_t)&&(_t=_t.split(''),_t.unshift(xt,1),gt.splice.apply(gt,_t))}),gt.forEach(function(_t,xt){var vt=Z(yt,_t,ut,xt<gt.length-1,dt.transform.matrix);vt&&(Y(_t,vt.left,vt.bottom,ct),Q(ct,ut,vt,ht,mt))}))}function ie(st,lt){var dt=Ze.createElement('boundelement'),ct,mt;return dt.style.display='inline',ct=st.style.listStyleType,st.style.listStyleType='none',dt.appendChild(Ze.createTextNode(lt)),st.insertBefore(dt,st.firstChild),mt=Je.Bounds(dt),st.removeChild(dt),st.style.listStyleType=ct,mt}function ne(st){var lt=-1,dt=1,ct=st.parentNode.childNodes;if(st.parentNode){for(;ct[++lt]!==st;)1===ct[lt].nodeType&&dt++;return dt}return-1}function se(st,lt){var dt=ne(st),ct;return'decimal'===lt?ct=dt:'decimal-leading-zero'===lt?ct=1===dt.toString().length?dt='0'+dt.toString():dt.toString():'upper-roman'===lt?ct=P.Generate.ListRoman(dt):'lower-roman'===lt?ct=P.Generate.ListRoman(dt).toLowerCase():'lower-alpha'===lt?ct=P.Generate.ListAlpha(dt).toLowerCase():'upper-alpha'===lt?ct=P.Generate.ListAlpha(dt):void 0,ct+'. '}function le(st,lt,dt){var ut=lt.ctx,ft=rt(st,'listStyleType'),ct,mt,ht;if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(ft)){if(mt=se(st,ft),ht=ie(st,mt),K(ut,st,'none',rt(st,'color')),'inside'===rt(st,'listStylePosition'))ut.setVariable('textAlign','left'),ct=dt.left;else return;Y(mt,ct,ht.bottom,ut)}}function pe(st){var lt=F[st];return lt&&!0===lt.succeeded&&lt.img}function ue(st,lt){var dt=Math.max(st.left,lt.left),ct=Math.max(st.top,lt.top),mt=Math.min(st.left+st.width,lt.left+lt.width),ut=Math.min(st.top+st.height,lt.top+lt.height);return{left:dt,top:ct,width:mt-dt,height:ut-ct}}function fe(st,lt,dt){var mt='static'!==lt.cssPosition,ut=mt?rt(st,'zIndex'):'auto',ft=rt(st,'opacity'),ht='none'!==rt(st,'cssFloat'),ct;lt.zIndex=ct=R(ut),ct.isPositioned=mt,ct.isFloated=ht,ct.opacity=ft,ct.ownStacking='auto'!==ut||1>ft,dt&&dt.zIndex.children.push(lt)}function he(st,lt,dt,ct,mt){var ut=B(lt,'paddingLeft'),ft=B(lt,'paddingTop'),ht=B(lt,'paddingRight'),gt=B(lt,'paddingBottom');Ce(st,dt,0,0,dt.width,dt.height,ct.left+ut+mt[3].width,ct.top+ft+mt[0].width,ct.width-(mt[1].width+mt[3].width+ut+ht),ct.height-(mt[0].width+mt[2].width+ft+gt))}function ge(st){return['Top','Right','Bottom','Left'].map(function(lt){return{width:B(st,'border'+lt+'Width'),color:rt(st,'border'+lt+'Color')}})}function ye(st){return['TopLeft','TopRight','BottomRight','BottomLeft'].map(function(lt){return rt(st,'border'+lt+'Radius')})}function _e(st,lt,dt,ct){var mt=function(ut,ft,ht){return{x:ut.x+(ft.x-ut.x)*ht,y:ut.y+(ft.y-ut.y)*ht}};return{start:st,startControl:lt,endControl:dt,end:ct,subdivide:function(ut){var ft=mt(st,lt,ut),ht=mt(lt,dt,ut),gt=mt(dt,ct,ut),yt=mt(ft,ht,ut),_t=mt(ht,gt,ut),xt=mt(yt,_t,ut);return[_e(st,ft,yt,xt),_e(xt,_t,gt,ct)]},curveTo:function(ut){ut.push(['bezierCurve',lt.x,lt.y,dt.x,dt.y,ct.x,ct.y])},curveToReversed:function(ut){ut.push(['bezierCurve',dt.x,dt.y,lt.x,lt.y,st.x,st.y])}}}function xe(st,lt,dt,ct,mt,ut,ft){0<lt[0]||0<lt[1]?(st.push(['line',ct[0].start.x,ct[0].start.y]),ct[0].curveTo(st),ct[1].curveTo(st)):st.push(['line',ut,ft]),(0<dt[0]||0<dt[1])&&st.push(['line',mt[0].start.x,mt[0].start.y])}function ve(st,lt,dt,ct,mt,ut,ft){var ht=[];return 0<lt[0]||0<lt[1]?(ht.push(['line',ct[1].start.x,ct[1].start.y]),ct[1].curveTo(ht)):ht.push(['line',st.c1[0],st.c1[1]]),0<dt[0]||0<dt[1]?(ht.push(['line',ut[0].start.x,ut[0].start.y]),ut[0].curveTo(ht),ht.push(['line',ft[0].end.x,ft[0].end.y]),ft[0].curveToReversed(ht)):(ht.push(['line',st.c2[0],st.c2[1]]),ht.push(['line',st.c3[0],st.c3[1]])),0<lt[0]||0<lt[1]?(ht.push(['line',mt[1].end.x,mt[1].end.y]),mt[1].curveToReversed(ht)):ht.push(['line',st.c4[0],st.c4[1]]),ht}function Se(st,lt,dt){var ct=st.left,mt=st.top,ut=st.width,ft=st.height,ht=lt[0][0],gt=lt[0][1],yt=lt[1][0],_t=lt[1][1],xt=lt[2][0],vt=lt[2][1],bt=lt[3][0],St=lt[3][1],Tt=ut-yt,Mt=ft-vt,At=ut-xt,wt=ft-St;return{topLeftOuter:it(ct,mt,ht,gt).topLeft.subdivide(0.5),topLeftInner:it(ct+dt[3].width,mt+dt[0].width,Math.max(0,ht-dt[3].width),Math.max(0,gt-dt[0].width)).topLeft.subdivide(0.5),topRightOuter:it(ct+Tt,mt,yt,_t).topRight.subdivide(0.5),topRightInner:it(ct+Math.min(Tt,ut+dt[3].width),mt+dt[0].width,Tt>ut+dt[3].width?0:yt-dt[3].width,_t-dt[0].width).topRight.subdivide(0.5),bottomRightOuter:it(ct+At,mt+Mt,xt,vt).bottomRight.subdivide(0.5),bottomRightInner:it(ct+Math.min(At,ut+dt[3].width),mt+Math.min(Mt,ft+dt[0].width),Math.max(0,xt-dt[1].width),Math.max(0,vt-dt[2].width)).bottomRight.subdivide(0.5),bottomLeftOuter:it(ct,mt+wt,bt,St).bottomLeft.subdivide(0.5),bottomLeftInner:it(ct+dt[3].width,mt+wt,Math.max(0,bt-dt[3].width),Math.max(0,St-dt[2].width)).bottomLeft.subdivide(0.5)}}function Te(st,lt,dt,ct,mt){var ut=rt(st,'backgroundClip'),ft=[];switch(ut){case'content-box':case'padding-box':xe(ft,ct[0],ct[1],lt.topLeftInner,lt.topRightInner,mt.left+dt[3].width,mt.top+dt[0].width),xe(ft,ct[1],ct[2],lt.topRightInner,lt.bottomRightInner,mt.left+mt.width-dt[1].width,mt.top+dt[0].width),xe(ft,ct[2],ct[3],lt.bottomRightInner,lt.bottomLeftInner,mt.left+mt.width-dt[1].width,mt.top+mt.height-dt[2].width),xe(ft,ct[3],ct[0],lt.bottomLeftInner,lt.topLeftInner,mt.left+dt[3].width,mt.top+mt.height-dt[2].width);break;default:xe(ft,ct[0],ct[1],lt.topLeftOuter,lt.topRightOuter,mt.left,mt.top),xe(ft,ct[1],ct[2],lt.topRightOuter,lt.bottomRightOuter,mt.left+mt.width,mt.top),xe(ft,ct[2],ct[3],lt.bottomRightOuter,lt.bottomLeftOuter,mt.left+mt.width,mt.top+mt.height),xe(ft,ct[3],ct[0],lt.bottomLeftOuter,lt.topLeftOuter,mt.left,mt.top+mt.height);}return ft}function Me(st,lt,dt){var ct=lt.left,mt=lt.top,ut=lt.width,ft=lt.height,bt=ye(st),St=Se(lt,bt,dt),Tt={clip:Te(st,St,dt,bt,lt),borders:[]},ht,gt,yt,_t,xt,vt;for(ht=0;4>ht;ht++)0<dt[ht].width&&(gt=ct,yt=mt,_t=ut,xt=ft-dt[2].width,0===ht?(xt=dt[0].width,vt=ve({c1:[gt,yt],c2:[gt+_t,yt],c3:[gt+_t-dt[1].width,yt+xt],c4:[gt+dt[3].width,yt+xt]},bt[0],bt[1],St.topLeftOuter,St.topLeftInner,St.topRightOuter,St.topRightInner)):1===ht?(gt=ct+ut-dt[1].width,_t=dt[1].width,vt=ve({c1:[gt+_t,yt],c2:[gt+_t,yt+xt+dt[2].width],c3:[gt,yt+xt],c4:[gt,yt+dt[0].width]},bt[1],bt[2],St.topRightOuter,St.topRightInner,St.bottomRightOuter,St.bottomRightInner)):2===ht?(yt=yt+ft-dt[2].width,xt=dt[2].width,vt=ve({c1:[gt+_t,yt+xt],c2:[gt,yt+xt],c3:[gt+dt[3].width,yt],c4:[gt+_t-dt[3].width,yt]},bt[2],bt[3],St.bottomRightOuter,St.bottomRightInner,St.bottomLeftOuter,St.bottomLeftInner)):3===ht?(_t=dt[3].width,vt=ve({c1:[gt,yt+xt+dt[2].width],c2:[gt,yt],c3:[gt+_t,yt+dt[0].width],c4:[gt+_t,yt+xt]},bt[3],bt[0],St.bottomLeftOuter,St.bottomLeftInner,St.topLeftOuter,St.topLeftInner)):void 0,Tt.borders.push({args:vt,color:dt[ht].color}));return Tt}function Ae(st,lt){var dt=st.drawShape();return lt.forEach(function(ct,mt){dt[0===mt?'moveTo':ct[0]+'To'].apply(null,ct.slice(1))}),dt}function we(st,lt,dt){'transparent'!==dt&&(st.setVariable('fillStyle',dt),Ae(st,lt),st.fill(),Qe+=1)}function Ee(st,lt,dt){var ct=Ze.createElement('valuewrap'),ut,ft;['lineHeight','textAlign','fontFamily','color','fontSize','paddingLeft','paddingTop','width','height','border','borderLeftWidth','borderTopWidth'].forEach(function(ht){try{ct.style[ht]=rt(st,ht)}catch(gt){Je.log('html2canvas: Parse: Exception caught in renderFormValue: '+gt.message)}}),ct.style.borderColor='black',ct.style.borderStyle='solid',ct.style.display='block',ct.style.position='absolute',(/^(submit|reset|button|text|password)$/.test(st.type)||'SELECT'===st.nodeName)&&(ct.style.lineHeight=rt(st,'height')),ct.style.top=lt.top+'px',ct.style.left=lt.left+'px',ut='SELECT'===st.nodeName?(st.options[st.selectedIndex]||0).text:st.value,ut||(ut=st.placeholder),ft=Ze.createTextNode(ut),ct.appendChild(ft),tt.appendChild(ct),oe(st,ft,dt),tt.removeChild(ct)}function Ce(st){st.drawImage.apply(st,Array.prototype.slice.call(arguments,1)),Qe+=1}function De(st,lt){var dt=_.getComputedStyle(st,lt);if(dt&&dt.content&&'none'!==dt.content&&'-moz-alt-content'!==dt.content&&'none'!==dt.display){var ct=dt.content+'',mt=ct.substr(0,1);mt===ct.substr(ct.length-1)&&mt.match(/'|"/)&&(ct=ct.substr(1,ct.length-2));var ut='url'===ct.substr(0,3),ft=S.createElement(ut?'img':'span');return ft.className=at+'-before '+at+'-after',Object.keys(dt).filter(Re).forEach(function(ht){try{ft.style[ht]=dt[ht]}catch(gt){Je.log(['Tried to assign readonly property ',ht,'Error:',gt])}}),ut?ft.src=Je.parseBackgroundImage(ct)[0].args[0]:ft.innerHTML=ct,ft}}function Re(st){return isNaN(_.parseInt(st,10))}function Pe(st,lt){var dt=De(st,':before'),ct=De(st,':after');(dt||ct)&&(dt&&(st.className+=' '+at+'-before',st.parentNode.insertBefore(dt,st),Xe(dt,lt,!0),st.parentNode.removeChild(dt),st.className=st.className.replace(at+'-before','').trim()),ct&&(st.className+=' '+at+'-after',st.appendChild(ct),Xe(ct,lt,!0),st.removeChild(ct),st.className=st.className.replace(at+'-after','').trim()))}function Le(st,lt,dt,ct){var mt=Math.round(ct.left+dt.left),ut=Math.round(ct.top+dt.top);st.createPattern(lt),st.translate(mt,ut),st.fill(),st.translate(-mt,-ut)}function Ue(st,lt,dt,ct,mt,ut,ft,ht){var gt=[];gt.push(['line',Math.round(mt),Math.round(ut)]),gt.push(['line',Math.round(mt+ft),Math.round(ut)]),gt.push(['line',Math.round(mt+ft),Math.round(ht+ut)]),gt.push(['line',Math.round(mt),Math.round(ht+ut)]),Ae(st,gt),st.save(),st.clip(),Le(st,lt,dt,ct),st.restore()}function Ne(st,lt,dt){G(st,lt.left,lt.top,lt.width,lt.height,dt)}function Fe(st,lt,dt,ct,mt){var ut=Je.BackgroundSize(st,lt,ct,mt),ft=Je.BackgroundPosition(st,lt,ct,mt,ut),ht=rt(st,'backgroundRepeat').split(',').map(Je.trimText);switch(ct=Ve(ct,ut),ht=ht[mt]||ht[0],ht){case'repeat-x':Ue(dt,ct,ft,lt,lt.left,lt.top+ft.top,99999,ct.height);break;case'repeat-y':Ue(dt,ct,ft,lt,lt.left+ft.left,lt.top,ct.width,99999);break;case'no-repeat':Ue(dt,ct,ft,lt,lt.left+ft.left,lt.top+ft.top,ct.width,ct.height);break;default:Le(dt,ct,ft,{top:lt.top,left:lt.left,width:ct.width,height:ct.height});}}function ze(st,lt,dt){for(var ct=rt(st,'backgroundImage'),mt=Je.parseBackgroundImage(ct),ft=mt.length,ut;ft--;)if(ct=mt[ft],ct.args&&0!==ct.args.length){var ht='url'===ct.method?ct.args[0]:ct.value;ut=pe(ht),ut?Fe(st,lt,dt,ut,ft):Je.log('html2canvas: Error loading background:',ct)}}function Ve(st,lt){if(st.width===lt.width&&st.height===lt.height)return st;var ct=Ze.createElement('canvas'),dt;return ct.width=lt.width,ct.height=lt.height,dt=ct.getContext('2d'),Ce(dt,st,0,0,st.width,st.height,0,0,lt.width,lt.height),ct}function Ie(st,lt,dt){return st.setVariable('globalAlpha',rt(lt,'opacity')*(dt?dt.opacity:1))}function Oe(st){return st.replace('px','')}function Be(st){var dt=rt(st,'transform')||rt(st,'-webkit-transform')||rt(st,'-moz-transform')||rt(st,'-ms-transform')||rt(st,'-o-transform'),ct=rt(st,'transform-origin')||rt(st,'-webkit-transform-origin')||rt(st,'-moz-transform-origin')||rt(st,'-ms-transform-origin')||rt(st,'-o-transform-origin')||'0px 0px';ct=ct.split(' ').map(Oe).map(Je.asFloat);var mt;if(dt&&'none'!==dt){var ut=dt.match(nt);if(ut)switch(ut[1]){case'matrix':mt=ut[2].split(',').map(Je.trimText).map(Je.asFloat);}}return{origin:ct,matrix:mt}}function ke(st,lt,dt,ct){var mt=D(lt?dt.width:I(),lt?dt.height:O()),ut={ctx:mt,opacity:Ie(mt,st,lt),cssPosition:rt(st,'position'),borders:ge(st),transform:ct,clip:lt&&lt.clip?Je.Extend({},lt.clip):null};return fe(st,ut,lt),!0===V.useOverflow&&!0===/(hidden|scroll|auto)/.test(rt(st,'overflow'))&&!1===/(BODY)/i.test(st.nodeName)&&(ut.clip=ut.clip?ue(ut.clip,dt):dt),ut}function Ge(st,lt,dt){var ct={left:lt.left+st[3].width,top:lt.top+st[0].width,width:lt.width-(st[1].width+st[3].width),height:lt.height-(st[0].width+st[2].width)};return dt&&(ct=ue(ct,dt)),ct}function He(st,lt){var dt=lt.matrix?Je.OffsetBounds(st):Je.Bounds(st);return lt.origin[0]+=dt.left,lt.origin[1]+=dt.top,dt}function We(st,lt,dt,ct){var mt=Be(st,lt),ut=He(st,mt),ht=ke(st,lt,ut,mt),gt=ht.borders,yt=ht.ctx,_t=Ge(gt,ut,ht.clip),xt=Me(st,ut,gt),vt=et.test(st.nodeName)?'#efefef':rt(st,'backgroundColor'),ft;switch(Ae(yt,xt.clip),yt.save(),yt.clip(),0<_t.height&&0<_t.width&&!ct?(Ne(yt,ut,vt),ze(st,_t,yt)):ct&&(ht.backgroundColor=vt),yt.restore(),xt.borders.forEach(function(bt){we(yt,bt.args,bt.color)}),dt||Pe(st,ht),st.nodeName){case'IMG':(ft=pe(st.getAttribute('src')))?he(yt,st,ft,ut,gt):Je.log('html2canvas: Error loading <img>:'+st.getAttribute('src'));break;case'INPUT':/^(text|url|email|submit|button|reset)$/.test(st.type)&&0<(st.value||st.placeholder||'').length&&Ee(st,ut,ht);break;case'TEXTAREA':0<(st.value||st.placeholder||'').length&&Ee(st,ut,ht);break;case'SELECT':0<(st.options||st.placeholder||'').length&&Ee(st,ut,ht);break;case'LI':le(st,ht,_t);break;case'CANVAS':he(yt,st,st,ut,gt);}return ht}function je(st){return'none'!==rt(st,'display')&&'hidden'!==rt(st,'visibility')&&!st.hasAttribute('data-html2canvas-ignore')}function Xe(st,lt,dt){je(st)&&(lt=We(st,lt,dt,!1)||lt,!et.test(st.nodeName)&&Ye(st,lt,dt))}function Ye(st,lt,dt){Je.Children(st).forEach(function(ct){ct.nodeType===ct.ELEMENT_NODE?Xe(ct,lt,dt):ct.nodeType===ct.TEXT_NODE&&oe(st,ct,lt)})}_.scroll(0,0);var Ke=V.elements===T?S.body:V.elements[0],Qe=0,Ze=Ke.ownerDocument,Je=P.Util,$e=Je.Support(V,Ze),et=new RegExp('('+V.ignoreElements+')'),tt=Ze.body,rt=Je.getCSS,at='___html2canvas___pseudoelement',ot=Ze.createElement('style');ot.innerHTML='.'+at+'-before:before { content: "" !important; display: none !important; }.'+at+'-after:after { content: "" !important; display: none !important; }',tt.appendChild(ot),F=F||{};var it=function(st){return function(lt,dt,ct,mt){var ut=ct*st,ft=mt*st,ht=lt+ct,gt=dt+mt;return{topLeft:_e({x:lt,y:gt},{x:lt,y:gt-ft},{x:ht-ut,y:dt},{x:ht,y:dt}),topRight:_e({x:lt,y:dt},{x:lt+ut,y:dt},{x:ht,y:gt-ft},{x:ht,y:gt}),bottomRight:_e({x:ht,y:dt},{x:ht,y:dt+ft},{x:lt+ut,y:gt},{x:lt,y:gt}),bottomLeft:_e({x:ht,y:gt},{x:ht-ut,y:gt},{x:lt,y:dt+ft},{x:lt,y:dt})}}}(4*((Math.sqrt(2)-1)/3)),nt=/(matrix)\((.+)\)/;return function(){var st=rt(S.documentElement,'backgroundColor'),lt=Je.isTransparent(st)&&Ke===S.body,dt=We(Ke,null,!1,lt);return Ye(Ke,dt),lt&&(st=dt.backgroundColor),tt.removeChild(ot),{backgroundColor:st,stack:dt}}()},P.Preload=function(F){function V(ge){ue.href=ge,ue.href=ue.href;var ye=ue.protocol+ue.host;return ye===Z}function I(){J.log('html2canvas: start: images: '+Q.numLoaded+' / '+Q.numTotal+' (failed: '+Q.numFailed+')'),!Q.firstRun&&Q.numLoaded>=Q.numTotal&&(J.log('Finished loading images: # '+Q.numTotal+' (failed: '+Q.numFailed+')'),'function'==typeof F.complete&&F.complete(Q))}function O(ge,ye,_e){var ve=F.proxy,xe,Se;ue.href=ge,ge=ue.href,xe='html2canvas_'+ie++,_e.callbackname=xe,ve+=-1<ve.indexOf('?')?'&':'?',ve+='url='+encodeURIComponent(ge)+'&callback='+xe,Se=se.createElement('script'),_[xe]=function(Te){'error:'===Te.substring(0,6)?(_e.succeeded=!1,Q.numLoaded++,Q.numFailed++,I()):(K(ye,_e),ye.src=Te),_[xe]=T;try{delete _[xe]}catch(Me){}Se.parentNode.removeChild(Se),Se=null,delete _e.script,delete _e.callbackname},Se.setAttribute('type','text/javascript'),Se.setAttribute('src',ve),_e.script=Se,_.document.body.appendChild(Se)}function B(ge,ye){var _e=_.getComputedStyle(ge,ye),xe=_e.content;'url'===xe.substr(0,3)&&ee.loadImage(P.Util.parseBackgroundImage(xe)[0].args[0]),X(_e.backgroundImage,ge)}function G(ge){B(ge,':before'),B(ge,':after')}function H(ge,ye){var _e=P.Generate.Gradient(ge,ye);_e!==T&&(Q[ge]={img:_e,succeeded:!0},Q.numTotal++,Q.numLoaded++,I())}function W(ge){return ge&&ge.method&&ge.args&&0<ge.args.length}function X(ge,ye){var _e;P.Util.parseBackgroundImage(ge).filter(W).forEach(function(xe){'url'===xe.method?ee.loadImage(xe.args[0]):xe.method.match(/\-?gradient$/)&&(_e===T&&(_e=P.Util.Bounds(ye)),H(xe.value,_e))})}function Y(ge){var ye=!1;try{J.Children(ge).forEach(Y)}catch(_e){}try{ye=ge.nodeType}catch(_e){ye=!1,J.log('html2canvas: failed to access some element\'s nodeType - Exception: '+_e.message)}if(1===ye||ye===T){G(ge);try{X(J.getCSS(ge,'backgroundImage'),ge)}catch(_e){J.log('html2canvas: failed to get background-image - Exception: '+_e.message)}X(ge)}}function K(ge,ye){ge.onload=function(){ye.timer!==T&&_.clearTimeout(ye.timer),Q.numLoaded++,ye.succeeded=!0,ge.onerror=ge.onload=null,I()},ge.onerror=function(){if('anonymous'===ge.crossOrigin&&(_.clearTimeout(ye.timer),F.proxy)){var _e=ge.src;return ge=new Image,ye.img=ge,ge.src=_e,void O(ge.src,ge,ye)}Q.numLoaded++,Q.numFailed++,ye.succeeded=!1,ge.onerror=ge.onload=null,I()}}var Q={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},J=P.Util,ie=0,ne=F.elements[0]||S.body,se=ne.ownerDocument,le=ne.getElementsByTagName('img'),pe=le.length,ue=se.createElement('a'),fe=function(ge){return ge.crossOrigin!==T}(new Image),Z,ee,oe,he;for(ue.href=_.location.href,Z=ue.protocol+ue.host,ee={loadImage:function(ge){var ye,_e;ge&&Q[ge]===T&&(ye=new Image,ge.match(/data:image\/.*;base64,/i)?(ye.src=ge.replace(/url\(['"]{0,}|['"]{0,}\)$/ig,''),_e=Q[ge]={img:ye},Q.numTotal++,K(ye,_e)):V(ge)||!0===F.allowTaint?(_e=Q[ge]={img:ye},Q.numTotal++,K(ye,_e),ye.src=ge):fe&&!F.allowTaint&&F.useCORS?(ye.crossOrigin='anonymous',_e=Q[ge]={img:ye},Q.numTotal++,K(ye,_e),ye.src=ge):F.proxy&&(_e=Q[ge]={img:ye},Q.numTotal++,O(ge,ye,_e)))},cleanupDOM:function(ge){var ye,_e;if(!Q.cleanupDone){for(_e in ge&&'string'==typeof ge?J.log('html2canvas: Cleanup because: '+ge):J.log('html2canvas: Cleanup after timeout: '+F.timeout+' ms.'),Q)if(Q.hasOwnProperty(_e)&&(ye=Q[_e],'object'==typeof ye&&ye.callbackname&&ye.succeeded===T)){_[ye.callbackname]=T;try{delete _[ye.callbackname]}catch(xe){}ye.script&&ye.script.parentNode&&(ye.script.setAttribute('src','about:blank'),ye.script.parentNode.removeChild(ye.script)),Q.numLoaded++,Q.numFailed++,J.log('html2canvas: Cleaned up failed img: \''+_e+'\' Steps: '+Q.numLoaded+' / '+Q.numTotal)}_.stop===T?S.execCommand!==T&&S.execCommand('Stop',!1):_.stop(),S.close!==T&&S.close(),Q.cleanupDone=!0,ge&&'string'==typeof ge||I()}},renderingDone:function(){he&&_.clearTimeout(he)}},0<F.timeout&&(he=_.setTimeout(ee.cleanupDOM,F.timeout)),J.log('html2canvas: Preload starts: finding background-images'),Q.firstRun=!0,Y(ne),J.log('html2canvas: Preload: Finding images'),oe=0;oe<pe;oe+=1)ee.loadImage(le[oe].getAttribute('src'));return Q.firstRun=!1,J.log('html2canvas: Preload: Done.'),Q.numTotal===Q.numLoaded&&I(),ee},P.Renderer=function(F,V){return function(B){var G;if('string'==typeof V.renderer&&P.Renderer[B]!==T)G=P.Renderer[B](V);else if('function'==typeof B)G=B(V);else throw new Error('Unknown renderer');if('function'!=typeof G)throw new Error('Invalid renderer defined');return G}(V.renderer)(F,V,S,function(B){function G(X){Object.keys(X).sort().forEach(function(Y){var K=[],Q=[],Z=[],J=[];X[Y].forEach(function(ee){ee.node.zIndex.isPositioned||1>ee.node.zIndex.opacity?Z.push(ee):ee.node.zIndex.isFloated?Q.push(ee):K.push(ee)}),function ee(oe){oe.forEach(function(ie){J.push(ie),ie.children&&ee(ie.children)})}(K.concat(Q,Z)),J.forEach(function(ee){ee.context?G(ee.context):H.push(ee.node)})})}var H=[],W;return W=function(Y){function K(Z,J,ee){var oe='auto'===J.zIndex.zindex?0:+J.zIndex.zindex,ie=Z,ne=J.zIndex.isPositioned,se=J.zIndex.isFloated,le={node:J},pe=ee;J.zIndex.ownStacking?(ie=le.context={'!':[{node:J,children:[]}]},pe=T):(ne||se)&&(pe=le.children=[]),0==oe&&ee?ee.push(le):(!Z[oe]&&(Z[oe]=[]),Z[oe].push(le)),J.zIndex.children.forEach(function(ue){K(ie,ue,pe)})}var Q={};return K(Q,Y),Q}(B),G(W),H}(F.stack),P)},P.Util.Support=function(F,V){return{rangeBounds:function(){var X=!1,B,G,H,W;return V.createRange&&(B=V.createRange(),B.getBoundingClientRect&&(G=V.createElement('boundtest'),G.style.height='123px',G.style.display='block',V.body.appendChild(G),B.selectNode(G),H=B.getBoundingClientRect(),W=H.height,123===W&&(X=!0),V.body.removeChild(G))),X}(),svgRendering:F.svgRendering&&function(){var B=new Image,G=V.createElement('canvas'),H=G.getContext!==T&&G.getContext('2d');if(!1===H)return!1;G.width=G.height=10,B.src=['data:image/svg+xml,','<svg xmlns=\'http://www.w3.org/2000/svg\' width=\'10\' height=\'10\'>','<foreignObject width=\'10\' height=\'10\'>','<div xmlns=\'http://www.w3.org/1999/xhtml\' style=\'width:10;height:10;\'>','sup','</div>','</foreignObject>','</svg>'].join('');try{H.drawImage(B,0,0),G.toDataURL()}catch(W){return!1}return P.Util.log('html2canvas: Parse: SVG powered rendering available'),!0}()}},THREE.html2canvas=function(F,V){F=F.length?F:[F];var B={logging:!1,elements:F,background:'#fff',proxy:null,timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,ignoreElements:'IFRAME|OBJECT|PARAM',useOverflow:!0,letterRendering:!1,chinese:!1,width:null,height:null,taintTest:!0,renderer:'Canvas'},I,O;return B=P.Util.Extend(V,B),P.logging=B.logging,B.complete=function(G){('function'!=typeof B.onpreloaded||!1!==B.onpreloaded(G))&&(I=P.Parse(G,B),'function'==typeof B.onparsed&&!1===B.onparsed(I)||(O=P.Renderer(I,B),'function'==typeof B.onrendered&&B.onrendered(O)))},_.setTimeout(function(){P.Preload(B)},0),{render:function(G,H){return P.Renderer(G,P.Util.Extend(H,B))},parse:function(G,H){return P.Parse(G,P.Util.Extend(H,B))},preload:function(G){return P.Preload(P.Util.Extend(G,B))},log:P.Util.log}},THREE.html2canvas.log=P.Util.log,THREE.html2canvas.Renderer={Canvas:T},P.Renderer.Canvas=function(F){function V(K,Q){K.beginPath(),Q.forEach(function(Z){K[Z.name].apply(K,Z.arguments)}),K.closePath()}function I(K){if(-1===G.indexOf(K.arguments[0].src)){W.drawImage(K.arguments[0],0,0);try{W.getImageData(0,0,1,1)}catch(Q){return H=B.createElement('canvas'),W=H.getContext('2d'),!1}G.push(K.arguments[0].src)}return!0}function O(K,Q){switch(Q.type){case'variable':K[Q.name]=Q.arguments;break;case'function':switch(Q.name){case'createPattern':if(0<Q.arguments[0].width&&0<Q.arguments[0].height)try{K.fillStyle=K.createPattern(Q.arguments[0],'repeat')}catch(Z){X.log('html2canvas: Renderer: Error creating pattern',Z.message)}break;case'drawShape':V(K,Q.arguments);break;case'drawImage':0<Q.arguments[8]&&0<Q.arguments[7]&&(!F.taintTest||F.taintTest&&I(Q))&&K.drawImage.apply(K,Q.arguments);break;default:K[Q.name].apply(K,Q.arguments);}}}F=F||{};var B=S,G=[],H=S.createElement('canvas'),W=H.getContext('2d'),X=P.Util,Y=F.canvas||B.createElement('canvas');return function(K,Q,Z,J,ee){var oe=Y.getContext('2d'),le=K.stack,ie,ne,se;return Y.width=Y.style.width=Q.width||le.ctx.width,Y.height=Y.style.height=Q.height||le.ctx.height,se=oe.fillStyle,oe.fillStyle=X.isTransparent(le.backgroundColor)&&Q.background!==T?Q.background:K.backgroundColor,oe.fillRect(0,0,Y.width,Y.height),oe.fillStyle=se,J.forEach(function(pe){oe.textBaseline='bottom',oe.save(),pe.transform.matrix&&(oe.translate(pe.transform.origin[0],pe.transform.origin[1]),oe.transform.apply(oe,pe.transform.matrix),oe.translate(-pe.transform.origin[0],-pe.transform.origin[1])),pe.clip&&(oe.beginPath(),oe.rect(pe.clip.left,pe.clip.top,pe.clip.width,pe.clip.height),oe.clip()),pe.ctx.storage&&pe.ctx.storage.forEach(function(ue){O(oe,ue)}),oe.restore()}),X.log('html2canvas: Renderer: Canvas renderer done - returning canvas obj'),1===Q.elements.length&&'object'==typeof Q.elements[0]&&'BODY'!==Q.elements[0].nodeName?(ne=ee.Util.Bounds(Q.elements[0]),ie=Z.createElement('canvas'),ie.width=Math.ceil(ne.width),ie.height=Math.ceil(ne.height),oe=ie.getContext('2d'),oe.drawImage(Y,ne.left,ne.top,ne.width,ne.height,0,0,ne.width,ne.height),Y=null,ie):Y}}}(window,document),function(){var _={VERSION:'0.9_20141123',IS_BETA:!0,ALIAS:'WIP_MinorSnow'};_.AudioUnit=function(S){this._status=this.createStatus(),this._status.id=S,Object.defineProperties(this,{isAudioUnit:{enumerable:!0,get:function(){return this._status.isAudioUnit}},id:{enumerable:!0,get:function(){return this._status.id}},connection:{enumerable:!0,get:function(){var T=Object.create(this._status.connection);return T}}})},_.AudioUnit.prototype.createStatus=function(){return new _.AudioUnit.Status},_.AudioUnit.prototype.connect=function(S,T,M,A){if(null!=S.id||null!=A){var E=null;null==S.id?null!=A&&(E=A):E=S.id,E+='['+(null==T?'0':T)+':'+(null==M?'0':M)+']',this._status.connection.push(E)}},_.AudioUnit.prototype.disconnect=function(S,T,M){if(null!=S.id||null!=M){var A=-1,E='';null==S.id?null!=M&&(E=M):E=S.id,E+='['+(null==T?'0':T);for(var C=0;C<this._status.connection.length;C++)if(this._status.connection[C].substring(0,E.length)===E){A=C;break}0<=A&&this._status.connection.splice(A,1)}},_.AudioUnit.Status=function(){this.className='snd.AudioUnit',this.isAudioUnit=!0,this.id='',this.connection=[],this.channelCount=2,this.channelCountMode='max',this.channelInterpretation='discrete'},_.Source=function(){_.AudioUnit.apply(this,arguments),this._gain=_.AUDIO_CONTEXT.createGain(),Object.defineProperties(this,{isSource:{get:function(){return this._status.isSource}},volumeParam:{get:function(){var T=this.gain.gain;return null==T.id&&(T.id=this.id+'.gain'),T}},volume:{get:function(){return this._gain.gain.value},set:function(T){this._gain.gain.value=T,this._status.volume=T}},status:{get:function(){return this._status.status}}})},_.Source.prototype=Object.create(_.AudioUnit.prototype),_.Source.prototype.constructor=_.Source,_.Source.CLASS_NAME='snd.Source',_.Source.prototype.connect=function(S,T,M){_.AudioUnit.prototype.connect.apply(this,arguments),S.isAudioUnit||null!=S.getConnector?this._gain.connect(S.getConnector(),T,M):this._gain.connect(S,T,M)},_.Source.prototype.disconnect=function(S){_.AudioUnit.prototype.disconnect.apply(this,arguments),S.isAudioUnit||null!=S.getConnector?this._gain.disconnect(S.getConnector()):this._gain.disconnect(S)},_.Source.prototype.getConnector=function(){return this._gain},_.Source.prototype.createStatus=function(){return new _.Source.Status},_.Source.Status=function(){_.AudioUnit.Status.apply(this,arguments),this.status=_.status.NONE,this.volume=1,this.isSource=!0,this.className=_.Source.CLASS_NAME},_.MediaElementAudioSource=function(S,T){_.Source.apply(this,arguments),this.id=S,Object.defineProperties(this,{element:{get:function(){return this._element},set:function(M){var A=this;this._source=_.AUDIO_CONTEXT.createMediaElementSource(M),this._source.connect(this._gain),this._element=M,null!=this._element.id&&(this._status.element=this._element.id),this._element.onplay=function(){A._status.status=_.status.STARTED},this._element.onpause=function(){A._status.status=_.status.PAUSED},this._element.onended=function(){A._status.status=_.status.PAUSED},this._element.oncanplay=function(){A.status==_.status.NONE&&(A._status.status=_.status.READY)}}},src:{get:function(){return this._element.src},set:function(M){this._element.src=M}}}),null!=T&&(this.element=T)},_.MediaElementAudioSource.prototype=Object.create(_.Source.prototype),_.MediaElementAudioSource.prototype.constructor=_.MediaElementAudioSource,_.MediaElementAudioSource.CLASS_NAME='snd.MediaElementAudioSource',_.MediaElementAudioSource.prototype.createStatus=function(){return new _.MediaElementAudioSource.Status},_.MediaElementAudioSource.Status=function(){_.Source.Status.apply(this,arguments),this.className=_.MediaElementAudioSource.CLASS_NAME,this.status=_.status.NONE,this.element=''},_.MediaElementAudioSource.Status.prototype=Object.create(_.Source.Status.prototype),_.MediaElementAudioSource.Status.prototype.constructor=_.MediaElementAudioSource.Status,_.AudioMaster=function(){this.unitList={},this._gain=_.AUDIO_CONTEXT.createGain(),this._gain.channelCount=_.MAX_CHANNEL_COUNT,this._gain.connect(_.AUDIO_CONTEXT.destination),this.id=_.AudioMaster.ID},_.AudioMaster.ID='snd.MASTER',_.AudioMaster.prototype.connectAudioUnit=function(S,T){if(null==S&&null==T.id)throw'key == null && audioUnit.id == null';null==S?null==this.unitList[T.id]&&(this.unitList[T.id]=T,T.connect(this._gain,_.AudioMaster.ID)):(this.unitList[S]=T,T.connect(this._gain,_.AudioMaster.ID))},_.AudioMaster.prototype.disconnectAudioUnit=function(S){var T=this.unitList[S];T.getConnector().disconnect(this._gain),delete this.unitList[S]},_.AudioMaster.prototype.getConnector=function(){return this._gain},_._AUDIO_CONTEXT=null,_._MASTER=null,_.init=function(){null==_._AUDIO_CONTEXT&&('AudioContext'in window?_._AUDIO_CONTEXT=new AudioContext:'webkitAudioContext'in window&&(_._AUDIO_CONTEXT=new webkitAudioContext),_._AUDIO_CONTEXT.destination.channelCount=_._AUDIO_CONTEXT.destination.maxChannelCount),Object.defineProperties(_,{MAX_CHANNEL_COUNT:{writable:!1,value:_._AUDIO_CONTEXT.destination.maxChannelCount},status:{value:function(){var S={};return Object.defineProperties(S,{NONE:{value:'none',writable:!1},READY:{value:'ready',writable:!1},STARTED:{value:'started',writable:!1},PAUSED:{value:'paused',writable:!1},STOPPED:{value:'ended',writable:!1}}),S}(),writable:!1},AUDIO_CONTEXT:{get:function(){return _._AUDIO_CONTEXT}},MASTER:{get:function(){return _._MASTER}}}),_._MASTER=new _.AudioMaster,_.SOUND_ENVIRONMENT=new _.SoundEnvironment},_.three={version:0.1,beta:!0},_.PosDir=function(){this._pos={x:0,y:0,z:0},this._dir={x:0,y:0,z:0},this._up={x:0,y:0,z:0},Object.defineProperties(this,{pos:{get:function(){var S=this,T={};return Object.defineProperties(T,{x:{get:function(){return S._pos.x},set:function(M){S._pos.x=M}},y:{get:function(){return S._pos.y},set:function(M){S._pos.y=M}},z:{get:function(){return S._pos.z},set:function(M){S._pos.z=M}}}),T}},dir:{get:function(){var S=this,T={};return Object.defineProperties(T,{x:{get:function(){return S._dir.x},set:function(M){S._dir.x=M}},y:{get:function(){return S._dir.y},set:function(M){S._dir.y=M}},z:{get:function(){return S._dir.z},set:function(M){S._dir.z=M}}}),T}},up:{get:function(){var S=this,T={};return Object.defineProperties(T,{x:{get:function(){return S._up.x},set:function(M){S._up.x=M}},y:{get:function(){return S._up.y},set:function(M){S._up.y=M}},z:{get:function(){return S._up.z},set:function(M){S._up.z=M}}}),T}}})},_.PosDir.prototype.setPosition=function(S,T,M){this.pos.x=S,this.pos.y=T,this.pos.z=M},_.PosDir.prototype.setOrientation=function(S,T,M,A,E,C){this.dir.x=S,this.dir.y=T,this.dir.z=M,this.up.x=A,this.up.y=E,this.up.z=C},_.Listener=function(S){_.PosDir.apply(this,arguments),this.listener=S,null!=S&&this.listener.setOrientation(this.dir.x,this.dir.y,this.dir.z,this.up.x,this.up.y,this.up.z)},_.Listener.prototype=Object.create(_.PosDir.prototype),_.Listener.prototype.constructor=_.Listener,_.Listener.prototype.setListener=function(S){this.listener=S,this.setPosition(this.pos.x,this.pos.y,this.pos.z),this.setOrientation(this.dir.x,this.dir.y,this.dir.z,this.up.x,this.up.y,this.up.z)},_.Listener.prototype.resetListener=function(){this.setListener(null)},_.Listener.prototype.setPosition=function(S,T,M){_.PosDir.prototype.setPosition.call(this,S,T,M),null!=this.listener&&this.listener.setPosition(_.SOUND_ENVIRONMENT.unit*this.pos.x,_.SOUND_ENVIRONMENT.unit*this.pos.y,_.SOUND_ENVIRONMENT.unit*this.pos.z)},_.Listener.prototype.setOrientation=function(S,T,M,A,E,C){_.PosDir.prototype.setOrientation.call(this,S,T,M,A,E,C),null!=this.listener&&this.listener.setOrientation(this.dir.x,this.dir.y,this.dir.z,this.up.x,this.up.y,this.up.z)},_.SoundEnvironment=function(){this.now=0,this.listener=_.AUDIO_CONTEXT.listener,this.listeners={},this.soundNodes={},this.unit=0.1,this.cameras={},this.attaches={},this.linkMap={}},_.SoundEnvironment.DEFAULT_BUFFER_MAX=1800,_.SoundEnvironment.prototype.addListener=function(S,T){this.listeners[S]=new _.PosDirTime(T,1)},_.SoundEnvironment.prototype.removeListener=function(S){null!=this.soundNodes[S]&&delete this.soundNodes[S]},_.SoundEnvironment.prototype.addSoundNode=function(S,T){this.soundNodes[S]=new _.PosDirTime(T)},_.SoundEnvironment.prototype.removeSoundNode=function(S){null!=this.soundNodes[S]&&delete this.soundNodes[S]},_.SoundEnvironment.prototype.update=function(S){if(this.now>S)throw new _.SoundEnvironment.UpdateError(this,'time < this.now (time: '+S+', this.now: '+this.now);for(var T in this.listeners)this.listeners[T].update(S);for(var T in this.soundNodes)this.soundNodes[T].update(S)},_.SoundEnvironment.UpdateError=function(S,T){this._this=S,this.message=T},_.PosDirTime=function(S,T){this.data=S,this.history=[],this.bufferMax=T},_.PosDirTime.prototype.update=function(S){0==this.history.length&&this.history.push({time:0,posture:Object.create(this.data)}),this.history.length>this.bufferMax&&this.history.splice(0,1),this.history.push({time:S,posture:Object.create(this.data)})},_.PosDirTime.prototype.getPosture=function(S){var T=this.search(S);if(null==T)return null;if(T.left==T.right)return this.history[T.left];var M=this.history[M],A=this.history[A],E=(S-M.time)/(A.time-M.time);return _.PosDir.interpolation(M,A,E)},_.PosDirTime.prototype.search=function(S){if(0>=this.history.length)return null;if(1==this.history.length)return{left:0,right:0};if(this.history[this.history.length-1].time<S)return{left:this.history.length-1,right:this.history.legnth-1};if(this.history[0].time>S)return{left:0,right:0};for(var T=0,M=this.history.length-1,A=Math.floor(M/2);;)if(A=Math.floor((S-this.history[T].time)*(M-T)/(this.history[M].time-this.history[T].time))+T,this.history[A].time<S){if(this.history[A+1]>S)return{left:A,right:A+1};T=A+1}else if(this.history[A].time>S){if(this.history[A-1].time<S)return{left:A-1,right:A};M=A-1}else return{left:A,right:A}},_.SoundNode=function(){_.AudioUnit.apply(this,arguments),_.PosDir.apply(this,arguments),this.gain=_.AUDIO_CONTEXT.createGain(),this.pannerNode=_.AUDIO_CONTEXT.createPanner(),this.gain.connect(this.pannerNode)},_.SoundNode.prototype=Object.create(_.AudioUnit.prototype),_.SoundNode.prototype.constructor=_.SoundNode,_.SoundNode.prototype.connect=function(S){_.AudioUnit.prototype.connect.apply(this,arguments),S.isAudioUnit?this.pannerNode.connect(S.getConnector()):this.pannerNode.connect(S)},_.SoundNode.prototype.disconnect=function(S){_.AudioUnit.prototype.disconnect.apply(this,arguments),S.isAudioUnit?this.pannerNode.disconnect(S.getConnector()):this.pannerNode.disconnect(S)},_.SoundNode.prototype.getConnector=function(){return this.gain},_.SoundNode.prototype.setPosition=function(S,T,M){_.PosDir.prototype.setPosition.call(this,S,T,M),this.pannerNode.setPosition(_.SOUND_ENVIRONMENT.unit*this.pos.x,_.SOUND_ENVIRONMENT.unit*this.pos.y,_.SOUND_ENVIRONMENT.unit*this.pos.z)},_.SoundNode.prototype.setDir=function(S,T,M){_.PosDir.prototype.setDir.call(this,S,T,M),this.pannerNode.setOrientation(this.dir.x,this.dir.y,this.dir.z)},_.SoundNode.prototype.setUp=function(S,T,M){_.PosDir.prototype.setUp.call(this,S,T,M)},_.SoundNode.prototype.setOrientation=function(S,T,M,A,E,C){_.PosDir.prototype.setOrientation.call(this,S,T,M,A,E,C),this.pannerNode.setOrientation(this.dir.x,this.dir.y,this.dir.z)},_.BufferSoundNode=function(S,T){_.SoundNode.apply(this,arguments),this.source=null==T?new _.BufferSource(S+'_src'):T,this.source.connect(this)},_.BufferSoundNode.prototype=Object.create(_.SoundNode.prototype),_.BufferSoundNode.prototype.constructor=_.BufferSoundNode,_.BufferSoundNode.prototype.setAudioBuffer=function(S){this.source.setAudioBuffer(S)},_.three.update=function(S){if(null==_.SOUND_ENVIRONMENT.cameras[S.id])return void console.log('mainCamera('+S.toString()+') is not added.');if(null==_.SOUND_ENVIRONMENT.cameras[S.id].listener.listener){for(var M in _.SOUND_ENVIRONMENT.cameras)_.SOUND_ENVIRONMENT.cameras[M].listener.resetListener();_.SOUND_ENVIRONMENT.cameras[S.id].listener.setListener(_.AUDIO_CONTEXT.listener)}for(var M in _.SOUND_ENVIRONMENT.cameras){var A=_.SOUND_ENVIRONMENT.cameras[M].camera,E=_.SOUND_ENVIRONMENT.cameras[M].listener;_.three.link(A,E)}for(var M in _.SOUND_ENVIRONMENT.attaches)for(var C=_.SOUND_ENVIRONMENT.attaches[M].object,D=0,R;D<_.SOUND_ENVIRONMENT.attaches[M].sources.length;D++)R=_.SOUND_ENVIRONMENT.attaches[M].sources[D],_.three.link(C,R)},_.three.addCamera=function(S){var T=S.id;if(null!=_.SOUND_ENVIRONMENT.cameras[T])return void console.warn('snd.SOUND_ENVIRONMENT already has camera('+S.toString()+').');var M=new _.Listener(null);_.SOUND_ENVIRONMENT.cameras[T]={camera:S,listener:M},_.SOUND_ENVIRONMENT.addListener(M)},_.three.removeCamera=function(S){null!=_.SOUND_ENVIRONMENT.cameras[S.id]&&(_.SOUND_ENVIRONMENT.removeListener(_.SOUND_ENVIRONMENT.cameras[S.id].listener),delete _.SOUND_ENVIRONMENT.cameras[S.id])},_.three.attach=function(S,T){var M=S.id;null==_.SOUND_ENVIRONMENT.attaches[M]&&(_.SOUND_ENVIRONMENT.attaches[M]={object:S,sources:[]}),_.SOUND_ENVIRONMENT.attaches[M].sources.push(T),_.SOUND_ENVIRONMENT.linkMap[T.id]=M},_.three.detach=function(S){var T=S.id;if(null!=_.SOUND_ENVIRONMENT.linkMap[T]){var M=_.SOUND_ENVIRONMENT.linkMap[T],A=_.SOUND_ENVIRONMENT.attaches[M].sources.indexOf(S);0<=A&&_.SOUND_ENVIRONMENT.attaches[M].sources.splice(A,1),delete _.SOUND_ENVIRONMENT.linkMap[T]}},_.three.link=function(S,T){if(!isNaN(S.position.x)&&!isNaN(S.position.y)&&!isNaN(S.position.z)&&!isNaN(S.quaternion.x)&&!isNaN(S.quaternion.y)&&!isNaN(S.quaternion.z)&&!isNaN(S.quaternion.w)){var M=new THREE.Matrix4;M.copy(S.matrixWorld);var A=new THREE.Matrix4;A.copy(M),A.elements[12]=0,A.elements[13]=0,A.elements[14]=0;var E=new THREE.Vector3(M.elements[12],M.elements[13],M.elements[14]),C=new THREE.Vector3(-M.elements[8],-M.elements[9],-M.elements[10]),D=new THREE.Vector3;D.copy(S.up),D.applyMatrix4(A),T.setPosition(E.x,E.y,E.z),T.setOrientation(C.x,C.y,C.z,D.x,D.y,D.z)}},THREE.snd=_}(),!function(window,$){function checkRenderingContext(){var _=document.createElement('canvas');return window.WebGLRenderingContext&&(_.getContext('webgl')||_.getContext('experimental-webgl'))}function getReferent(_){var S=tmp_root.find(_);if($.makeArray(rootObj.find(_),S),S.length){if(1<S.length){var T=[];return $.each(S,function(){T.push(getObj(this))}),T}return getObj(S[0])}}function getObj(_){return _&&_.nodeType&&(_=THREE_obj[_.getAttribute('three')]),_}function replaceObj(_,S){_.userData.clone&&(_.userData.clone.length=0,_.userData.original=null),S.userData=$.extend(_.userData,S.userData),THREE_obj[THREE_obj.indexOf(_)]=S}function removeObj(_,S){$.each($.merge([_],_.getElementsByTagName('*')),function(T){var M=getObj(this);0==T&&M instanceof THREE.Object3D&&!(M instanceof THREE.Scene)&&M.parent.remove(M),M&&M.userData&&!S&&(THREE_obj[this.getAttribute('three')]=M.userData.dom=null)})}function getHash(_){return _?JSON.parse('{'+$.trim(_).replace(/([^\s;]+)?\s*:/g,'"$1":').replace(/:\s*([^;]+);+/g,':"$1",').replace(/\s+/g,' ').replace(/:"(true|false)",/g,':$1,').replace(/:"(-?(\d+\.\d+|\d+))",/g,':$1,').replace(/\:"\{([^\:\}]*)\}"/g,(S,T)=>':{'+decodeURIComponent(T)+'}').slice(0,-1)+'}'):{}}function getArr(_){if(_){var S=$.trim(_).split(' ');return $.each(S,function(T,M){/^-?(\d*\.\d+|\d+)$/.test(M)&&(S[T]=parseFloat(M))})}return 0===_?[0]:[]}function urlToExtension(_){return!/^\.[^\/^\.]/.test(_)&&_.split('.').pop().split('?')[0].toLowerCase()}function getHtmlObj(_){return /^html /.test(_)?$(_):importFrame.contents().find(_)}function hasRenderObj(_){return _.__renderable=_.__camera&&_.__camera.userData.scene}function cssMethod(_,S){return function(T){return T&&(T instanceof jThree||T.nodeType)?this.css(_,T):this.css(_,Array.isArray(T)||T===void 0||S?T:1<arguments.length?arguments:/^qua/.test(_)?[T,T,T,T]:[T,T,T])}}function objToLocal(_,S,T){if(T&&(T instanceof jThree||T.nodeType)){var M=getObj(T instanceof jThree?T[0]:T);if(/(position|lookAt)/.test(S)){var A=new THREE.Vector3;if(T=styleAdmin(M,'position'),/(X|Y|Z)/.test(S)){var E=S.slice(-1).toLowerCase();A[E]=T[E];var C=_.parent.worldToLocal(M.parent.localToWorld(A));T=C[E]}else{A.set(T[0],T[1],T[2]);var C=_.parent.worldToLocal(M.parent.localToWorld(A));T=[C.x,C.y,C.z]}}else T=styleAdmin(M,S)}return T}function styleAdmin(_,S,T){if(T=objToLocal(_,S,T),!jThree.styleHooks[S]&&/^mtl/.test(S)){var M=S.charAt(3).toLowerCase()+S.slice(4),A=_.material[M];'number'==typeof A||'boolean'==typeof A||'string'==typeof A?function(){var E=M;jThree.styleHooks[S]={get:function(C){return C.material[E]},set:function(C,D){C.material[E]=D}}}():A instanceof THREE.Color?function(){var E=M;jThree.styleHooks[S]={get:function(C){var D=C.material[E],R=[255*D.r,255*D.g,255*D.b];return R.color=!0,R},set:function(C,D){C.material[E].set(D)}}}():/(map|Map)$/.test(S)||A instanceof THREE.Texture?function(){var E=M;jThree.styleHooks[S]={get:function(C){return C.material[E]&&C.material[E][E+'Selector']},set:function(C,D){var R=getReferent(D);C.material[E]=R,C.material[E][E+'Selector']=D,R.needsUpdate=!0}}}():(A instanceof THREE.Vector3||A instanceof THREE.Vector2)&&function(){var E=M;jThree.styleHooks[S]={get:function(C){var D=C.material[E];return 2===arguments.length?[D.x,D.y]:[D.x,D.y,D.z]},set:function(C,D){C.material[E].set(D[0],D[1],D[2])}}}()}return void 0===T?jThree.styleHooks[S].get(_):void jThree.styleHooks[S].set(_,T)}function checkText(_){return _ instanceof jThree||_.nodeType?_:'string'==typeof _?$(parseGOML(_)):($.each(_,function(S,T){'string'==typeof T&&(_[S]=$(parseGOML(T)))}),_)}function addToScene(_,S){if(_=getObj(_),'#document-fragment'===S.nodeName)$(S).children().each(function(){var M=getObj(this);M instanceof THREE.Object3D&&!(M instanceof THREE.Scene)&&_.add(M)});else{var T=getObj(S);T instanceof THREE.Object3D&&!(T instanceof THREE.Scene)&&_.add(T)}return S}function animate(_,S,T){if(_){var A=function(E){return!1===T.start(_,S,T)?void E():void(M=new AnimateObj(_,S,T,E,T.queue),_.userData.__animate.unshift(M),animationFrame(M.update),S=_=M=T=null)},M;_.userData.__animate=_.userData.__animate||[],!1===T.queue?A(function(){}):$(_.userData.dom).queue(A,T.queue)}}function optionNormalize(_){if(void 0===_.queue&&(_.queue='fx'),void 0===_.start&&(_.start=function(){}),'string'==typeof _.duration)switch(_.duration){case'slow':_.duration=600;break;case'fast':_.duration=200;break;default:_.duration=400;}return _}function genFx(_,S,T,M,A){'function'==typeof M&&(A=M,M=void 0);var E={duration:T||400,easing:M,complete:A},C={};return'slideDown'===S?E.start=function(D,R,P){return!D.visible&&void(R.scale=jThree.styleHooks.scale.get(D),D.scale.set(0,0,0),jThree.styleHooks.display.set(D,!0),D.traverse(function(L){if(L!==D){var U=jThree.styleHooks.position.get(L);L.position.set(0,0,0),animate(L,{position:U},optionNormalize({queue:!1,duration:P.duration,easing:P.easing}))}}))}:'slideUp'===S?E.start=function(D,R,P){if(!D.visible)return!1;var L=P.complete,U=jThree.styleHooks.scale.get(D);C.scale=[0,0,0],P.complete=function(){jThree.styleHooks.display.set(D,!1),jThree.styleHooks.scale.set(D,U),L&&L.call(this)},D.traverse(function(N){if(N!==D){var F=jThree.styleHooks.position.get(N);animate(N,{position:[0,0,0]},optionNormalize({queue:!1,duration:P.duration,easing:P.easing,complete:function(){jThree.styleHooks.position.set(N,F)}}))}})}:'fadeOut'===S?E.start=function(D,R,P){if(!D.visible)return!1;var L=P.complete,U=jThree.styleHooks.opacity.get(D);C.opacity=0,P.complete=function(){jThree.styleHooks.display.set(D,!1),jThree.styleHooks.opacity.set(D,U),L&&L.call(this)}}:'fadeIn'===S?E.start=function(D,R){return!D.visible&&void(R.opacity=jThree.styleHooks.opacity.get(D),jThree.styleHooks.opacity.set(D,0),jThree.styleHooks.display.set(D,!0))}:'hide'===S?E.start=function(D,R,P){if(!D.visible)return!1;var L=P.complete,U=jThree.styleHooks.opacity.get(D),N=jThree.styleHooks.scale.get(D);C.opacity=0,C.scale=[0,0,0],P.complete=function(){jThree.styleHooks.display.set(D,!1),jThree.styleHooks.scale.set(D,N),jThree.styleHooks.opacity.set(D,U),L&&L.call(this)},D.traverse(function(F){if(F!==D){var V=jThree.styleHooks.position.get(F);animate(F,{position:[0,0,0]},optionNormalize({queue:!1,duration:P.duration,easing:P.easing,complete:function(){jThree.styleHooks.position.set(F,V)}}))}})}:'show'===S?E.start=function(D,R,P){return!D.visible&&void(R.opacity=jThree.styleHooks.opacity.get(D),jThree.styleHooks.opacity.set(D,0),R.scale=jThree.styleHooks.scale.get(D),D.scale.set(0,0,0),jThree.styleHooks.display.set(D,!0),D.traverse(function(L){if(L!==D){var U=jThree.styleHooks.position.get(L);L.position.set(0,0,0),animate(L,{position:U},optionNormalize({queue:!1,duration:P.duration,easing:P.easing}))}}))}:void 0,_ instanceof jThree?_.animate(C,E):animate(getObj(_),C,optionNormalize(E))}function canvasEvent(_){var S=_.data.renderer;S.__renderable&&(S=projector.pickingRay(pickingVector.set(2*(_.offsetX===void 0?_.originalEvent.layerX:_.offsetX)/S.domElement.clientWidth-1,-2*(_.offsetY===void 0?_.originalEvent.layerY:_.offsetY)/S.domElement.clientHeight+1),S.__camera).intersectObjects(pickingObj(S),!1)[0],S&&($.each(_,function(T,M){eventReg.test(T)||(S[T]=M)}),$(S.object.userData.dom||S.object.parent.userData.dom).trigger($.Event('DOMMouseScroll'===_.type?'mousewheel':_.type,S))))}function pickingObj(_){var S=[];return $.each(_.__camera.userData.scene.__webglObjects,function(){this.render&&S.push(this.object)}),S}var jThree=function(_,S){return new jThree.fn.init(_,S)},dom_state=!1,dom_wait=[],goml_state=!1,goml_wait=[],src_state=!1,src_wait=[],rootObj;(function(){function _(S){function T(){if(! --M&&(goml_state=!0,goml_wait.forEach(function(E){E(jThree)}),M=T=goml_wait=null,MMD_SA_options.MMD_disabled)){var A=jThree;MMD_SA.fn.x_object_init(),MMD_SA._tray_updatable=!0,System._browser.update_tray(),jThree.Trackball&&(jThree.trackball=jThree.Trackball),A.trackball(),returnBoolean('MMDTrackballCamera')||MMD_SA._trackball_camera.stop(),MMD_SA.MMD_started=!0,A.MMD.play(!0),DEBUG_show('(MMD started)',2),MMD_SA.use_webgl2&&DEBUG_show('Use WebGL2',2)}}if(!dom_state&&(dom_state=!0,!!checkRenderingContext())){rootObj=$('<iframe style=\'display:none;\'/>').appendTo('body').contents();var M=$('[type=\'text/goml\']').length;$('[type=\'text/goml\']').each(function(){var A=this.getAttribute('src'),E;if(self.MMD_SA&&!A){if(E='<goml>\n\t<head>\n'+(MMD_SA.GOML_import?'<import>\n'+MMD_SA.GOML_import+'</import>\n':'')+MMD_SA.GOML_head,!MMD_SA_options.MMD_disabled){E+='<model id="mikuPmx0" src="'+(/^(\w+\:|\/)/.test(MMD_SA_options.model_path)?toFileProtocol(MMD_SA_options.model_path):MMD_SA_options.model_path)+'" onLoad="(self.MMD_SA||parent.MMD_SA).fn.setupUI()" />\n',MMD_SA_options.model_path_extra.forEach(function(L,U){E+='<model id="mikuPmx'+(U+1)+'" src="'+toFileProtocol(L)+'" onLoad="(self.MMD_SA||parent.MMD_SA).fn.setupUI()" />\n'});for(var C=0,D=MMD_SA_options.motion.length,R;C<D;C++)R=MMD_SA_options.motion[C],R.path&&(E+='<motion id="vmd'+C+'" src="'+toFileProtocol(/^(\w+\:|\/)/.test(R.path)?R.path:System.Gadget.path+'/'+R.path)+'" onLoad="(self.MMD_SA||parent.MMD_SA).fn.setupUI()" />\n')}E+='\t\t<rdr id="MMD_renderer" param="canvas:SL;antialias:true;clearAlpha:0;preserveDrawingBuffer:true; stencil:false;" frame="MMD_SA" />\n\t</head>\n\t<body>\n\t\t<scene id="MMD_scene">\n',E+='\t\t\t<light id="MMD_AmbLight" type="Amb"'+(MMD_SA_options.ambient_light_color?' param="'+MMD_SA_options.ambient_light_color+'"':'')+' />\n\t\t\t<light id="MMD_DirLight" type="Dir" param="'+MMD_SA_options.light_color+'" style="position:'+MMD_SA_options.light_position.join(' ')+';" />\n',E+=MMD_SA.GOML_scene,MMD_SA_options.MMD_disabled||(E+='<mmd model="#mikuPmx0" onLoad="(self.MMD_SA||parent.MMD_SA).fn.setupUI()" />\n',MMD_SA_options.model_path_extra.forEach(function(L,U){E+='<mmd model="#mikuPmx'+(U+1)+'" onLoad="(self.MMD_SA||parent.MMD_SA).fn.setupUI()" />\n'}));for(var C=0,D=MMD_SA_options.x_object.length,P;C<D;C++)P=MMD_SA_options.x_object[C],P.path&&(E+='\t\t\t<obj id="x_object'+C+'" model="'+(/^(\w+\:|\/)/.test(P.path)?toFileProtocol(P.path):P.path)+'" style="'+(P.style||'')+'" onLoad="(self.MMD_SA||parent.MMD_SA).fn.setupUI()" />\n');E+='\t\t\t<camera id="MMD_camera" '+(MMD_SA_options.camera_param?'param="'+('string'==typeof MMD_SA_options.camera_param?MMD_SA_options.camera_param:MMD_SA_options.camera_param.join(' '))+'" ':'')+'style="position:'+MMD_SA_options.camera_position.join(' ')+'; lookAt:'+(MMD_SA_options.camera_position[0]+' '+MMD_SA_options.camera_position[1])+' 0;" />\n\t\t</scene>\n\t</body>\n</goml>'}jThree.goml(A?A:E||this.innerHTML,T)}),$.each(dom_wait,function(A,E){jThree.goml(E[0],E[1],E[2])}),self.MMD_SA&&(S&&document.removeEventListener('DOMContentLoaded',_,!1),S&&window.removeEventListener('load',_,!1),MMD_SA.jThree_ready=null),_=dom_wait=null}}self.MMD_SA?MMD_SA.jThree_ready=function(){window.dispatchEvent(new CustomEvent('jThree_ready')),_(),window.dispatchEvent(new CustomEvent('GOML_ready'))}:'complete'===document.readyState?_():(document.addEventListener('DOMContentLoaded',_,!1),window.addEventListener('load',_,!1))})(),jThree.goml=function(){var _=[];return function(S,T,M,A){if(!checkRenderingContext())return void(M&&M(jThree));if(!1===M&&(A=!1),!dom_state)dom_wait.push([S,T,A]);else if(/<.+?>/.test(S))_.length?_.push([S,T,A]):(parseGOML(S,A),src_state?T&&T(jThree):T&&src_wait.push(T));else{function C(){for(var D=0,R=_.length,P;D<R;D++)if(P=_[D],/<.+?>/.test(P[0]))parseGOML(P[0],P[2]),src_state?P[1]&&P[1](jThree):P[1]&&src_wait.push(P[1]);else{_=_.slice(D);break}C=E=null}var E=[S,T,A];_.push(E),$.ajax({url:S,async:!0,dataType:'text',success:function(D){E[0]=D,_[0]!==E||C()},error:function(){_[0]===E?(_.shift(),C()):_.splice(_.indexOf(E),1)}})}}}(),$.extend(jThree,$),jThree.fn=jThree.prototype=new $,jThree.fn.extend({jThree:'2.1.2',constructor:jThree,init:function(_,S,T){if(!_)return this;if('string'==typeof _)_=/<.+?>/.test(_)?parseGOML(_):S?rootObj.find(S).find(_):rootObj.find(_);else if(_.userData)_=_.userData.dom;else if(_===document)_=rootObj;else if('function'==typeof _)return checkRenderingContext()?(!1===S&&(T=!1),void(!1===T?goml_state?_(jThree):goml_wait.push(_):src_state?_(jThree):src_wait.push(_))):void(S&&S(jThree));$.makeArray(_,this)}}),jThree.fn.init.prototype=jThree.fn,$.support.webgl=checkRenderingContext(),jThree.modelHooks={},jThree.motionHooks={},jThree.geoHooks={},jThree.mtlHooks={};var THREE_obj=[],tmp_root=$(),importFrame,importStates='none';jThree.fn.contents=function(){return'IMPORT'===this[0].tagName?importFrame.contents():this};var parseGOML=function(){function getDom(){return this.userData.dom}function setObj(_,S){_.setAttribute('three',THREE_obj.length),THREE_obj.push(S),S instanceof THREE.Object3D?S.userData.dom=_:(S.userData={},S.userData.dom=_,S instanceof THREE.Material?S.userData.clone=[]:!(S instanceof THREE.Geometry)&&(S.dom=getDom)),$.each(Object.assign({},_.attributes),function(T,M){_.getAttribute(M.name);prop[M.name]&&M.value&&prop[M.name].call(_,M.value)}),S instanceof THREE.Object3D&&_.getAttribute('jstyle')&&$.each(getHash(_.getAttribute('jstyle')),function(T,M){var A=styleAdmin(S,T);'number'==typeof A?M=isNaN(+M)?M:+M:Array.isArray(A)&&(A.color?/ /.test(M)&&(M=getArr(M)):(M=getArr(M),1===M.length&&(M[1]=M[2]=M[0]))),styleAdmin(S,T,M)}),_=S=null}function addCamera(){$.each(this.userData.renderer,function(){animationFrame(this),this.__resize()})}function removeCamera(){$.each(this.userData.renderer,function(){animationFrame(this,!1)})}function newCloneNode(_){var S=this.cloneNode(void 0===_||_);return parseGOML(S),S}function srcLoaded(){--loadLength||(setTimeout(function(){src_state=!0,src_wait.forEach(function(_){_(jThree)}),src_wait.length=0},0),$.event.remove(this,'load',srcLoaded),$.event.remove(this,'error',srcErrored))}function srcErrored(){srcLoaded.call(this)}var tag_name='IMPORT MMD MODEL MOTION SCENE CAMERA TXR MTL GEO LIGHT OBJ PTS SPRITE MESH RDR'.split(' '),loadLength=0;return THREE.Object3D.prototype.dom=THREE.Material.prototype.dom=THREE.Geometry.prototype.dom=getDom,jThree.extend({getCamera:function(_){var S=getObj(_).__camera;return S&&S.userData.dom},getScene:function(_){var S=getObj(_).__camera;return S&&S.userData.scene&&S.userData.scene.userData.dom},getCanvas:function(_){return getObj(_).domElement}}),function(goml,srcWaiting){var waitRdr={},obj3D=[],html='string'==typeof goml&&/<\/import>/.test(goml)?goml.match(/<import(.|\n|\r)*?import>/)[0].replace(/^(.+)?>/,'').replace(/<\/import>$/,''):'',jq=$('string'==typeof goml?goml.replace(html,'').replace(/^<\?(.+)?\?>/,'').replace(/^[\n\r\s\t]*/,'').replace(/(head|body)>/g,'j$1>').replace(/ style=/g,' jstyle='):goml),isRoot='GOML'===jq[0].tagName,tmp_list={},tmp,that,obj;$.each(tag_name,function(_,S){tmp_list[S]=[]}),jq.add(jq.find('*')).each(function(){this.cloneNode=newCloneNode,-1===tag_name.indexOf(this.tagName)||(tmp_list[this.tagName].push(this),(!1!==srcWaiting&&isRoot&&this.hasAttribute('src')||this.hasAttribute('model')||this.hasAttribute('motion')||this.hasAttribute('html')||this.hasAttribute('video')||this.hasAttribute('canvas')||'IMPORT'===this.tagName)&&(loadLength++,$.event.add(this,'load',srcLoaded),$.event.add(this,'error',srcErrored)))}),isRoot&&(rootObj.find('head').append(jq.find('jhead').children()),rootObj.find('body').append(jq.find('jbody').children())),tmp_root=tmp_root.add(jq),$.each(tmp_list.IMPORT,function(){importFrame||(tmp=getHash(this.getAttribute('param')),importFrame=$('<iframe frameborder="0" style="border: none;position: fixed; top: 110%;" />').appendTo('body').width(tmp.width||1e3).height(tmp.height||1e3)),importStates='loading';var _=this,S=importFrame.one('load',function(){importStates='success',$.event.trigger('load',void 0,_),_=null}).contents()[0];this.hasAttribute('href')?importFrame[0].src=this.getAttribute('href'):(this.innerText=html,S.open(),S.write(html),S.close())}),$.each(tmp_list.MODEL.concat(tmp_list.MOTION),function(){setObj(this,{})}),$.each(tmp_list.MMD,function(){setObj(this,new THREE.Object3D)}),Array.prototype.push.apply(obj3D,tmp_list.MMD),$.each(tmp_list.SCENE,function(){setObj(this,new THREE.Scene)}),self.MMD_SA&&!MMD_SA.scene&&(MMD_SA.scene=THREE_obj[THREE_obj.length-1],MMD_SA.scene._RAF_timestamp_=-1,MMD_SA_options.fog&&(MMD_SA_options.fog.linear?MMD_SA.scene.fog=new THREE.Fog(MMD_SA_options.fog.color||0,MMD_SA_options.fog.near||void 0,MMD_SA_options.fog.far||void 0):MMD_SA.scene.fog=new THREE.FogExp2(MMD_SA_options.fog.color||0,null==MMD_SA_options.fog.density?5e-3:MMD_SA_options.fog.density))),$.each(tmp_list.CAMERA,function(){that=this,tmp=that.getAttribute('param'),tmp=/:/.test(tmp)?getHash(tmp):getArr(tmp),self.MMD_SA&&MMD_SA_options.use_JSARToolKit?(obj=new THREE.PerspectiveCamera(49,MMD_SA_options.width/MMD_SA_options.height,0.1,1e4),obj.matrixAutoUpdate=!1,obj.setJsArMatrix(MMD_SA.AR_obj.param),MMD_SA.AR_obj.camera_position=new THREE.Vector3(MMD_SA_options.camera_position[0],MMD_SA_options.camera_position[1],MMD_SA_options.camera_position[2]),obj.matrix.identity(),obj.matrix.setPosition(MMD_SA.AR_obj.camera_position)):'Ort'===that.getAttribute('type')?0<tmp.length?obj=new THREE.OrthographicCamera(tmp[0],tmp[1],tmp[2],tmp[3],tmp[4],tmp[5]):(tmp.width&&(tmp.right=tmp.width/2,tmp.left=-tmp.width/2),tmp.height&&(tmp.top=tmp.height/2,tmp.bottom=-tmp.height/2),obj=new THREE.OrthographicCamera(tmp.left,tmp.right,tmp.top,tmp.bottom,tmp.near,tmp.far),obj.userData.__width=tmp.right,obj.userData.__height=tmp.top):0<tmp.length?obj=new THREE.PerspectiveCamera(tmp[0],tmp[1],tmp[2],tmp[3]):obj=new THREE.PerspectiveCamera(tmp.fov,tmp.aspect,tmp.near,tmp.far),setObj(that,obj),obj.userData.renderer=[],obj.addEventListener('added',addCamera),obj.addEventListener('removed',removeCamera),self.MMD_SA&&MMD_SA.camera_list.push(obj)}),Array.prototype.push.apply(obj3D,tmp_list.CAMERA),$.each(tmp_list.TXR,function(){tmp=getHash(this.getAttribute('param')),this.hasAttribute('src')?(obj=THREE.ImageUtils.loadTexture(this.getAttribute('src')),this.removeAttribute('src')):this.hasAttribute('video')?(obj=new THREE.Texture(document.createElement('video')),obj.generateMipmaps=!1):this.hasAttribute('html')||this.hasAttribute('canvas')?(obj=new THREE.Texture(document.createElement('canvas')),obj.image.width=1,obj.image.height=1,obj.generateMipmaps=!1,obj.minFilter=obj.magFilter):this.hasAttribute('camera')&&(obj=new THREE.WebGLRenderTarget(tmp.width||1024,tmp.height||1024),tmp.rdr=tmp.rdr||'rdr',waitRdr[tmp.rdr]=waitRdr[tmp.rdr]||[],waitRdr[tmp.rdr].push(obj),delete tmp.camera,delete tmp.rdr),tmp.repeat&&(tmp.repeat='number'==typeof tmp.repeat?[tmp.repeat,tmp.repeat]:eval('['+tmp.repeat.split(/\s+/)+']'),obj.repeat.set(tmp.repeat[0],tmp.repeat[1])),tmp.offset&&('number'==typeof tmp.offset&&(tmp.offset=[tmp.offset,tmp.offset]),obj.offset.set(tmp.offset[0],tmp.offset[1])),void 0===tmp.wrap?tmp.repeat&&(obj.wrapS=obj.wrapT=1e3):('number'==typeof tmp.wrap&&(tmp.wrap=[tmp.wrap,tmp.wrap]),obj.wrapS=tmp.wrap[0]+1e3,obj.wrapT=tmp.wrap[1]+1e3),delete tmp.repeat,delete tmp.offset,delete tmp.wrap,delete tmp.height,delete tmp.width,$.extend(obj,tmp),setObj(this,obj)});var _mirror=[];return $.each(tmp_list.MTL,function(){if(that=this,tmp=getHash(that.getAttribute('param')),tmp.map&&(tmp.map=getReferent(tmp.map)),tmp.lightMap&&(tmp.lightMap=getReferent(tmp.lightMap)),tmp.specularMap&&(tmp.specularMap=getReferent(tmp.specularMap)),tmp.displacementMap&&(tmp.displacementMap=getReferent(tmp.displacementMap)),tmp.normalMap&&(tmp.normalMap=getReferent(tmp.normalMap)),null!=tmp.waveBaseSpeed&&(tmp.waveNoiseTexture=getReferent('#waveNoiseTexture')),tmp.bumpMap?tmp.bumpMap=getReferent(tmp.bumpMap):tmp.bumpScale&&tmp.map&&(tmp.bumpMap=tmp.map),tmp.AT_process&&(MMD_SA_options[tmp.AT_process](this,tmp),delete tmp.AT_process),$.each(tmp,function(_,S){'string'==typeof S&&/ /.test(S)&&(tmp[_]=getArr(S))}),that.getAttribute('type')&&'Mirror'==that.getAttribute('type'))setObj(that,new THREE.MirrorMaterial(tmp)),_mirror.push(MMD_SA._THREE_mirror[MMD_SA._THREE_mirror.length-1]);else{let _=new THREE[(that.getAttribute('type')||'')+'Material'](tmp);'uniTexture'in tmp&&(_.uniTexture=tmp.uniTexture),setObj(that,_)}}),$.each(tmp_list.GEO,function(){if(this.getAttribute('type'))tmp=getArr(this.getAttribute('param')),obj=new THREE[this.getAttribute('type')+'Geometry'](tmp[0],tmp[1],tmp[2],tmp[3],tmp[4],tmp[5],tmp[6]);else if(this.getAttribute('src'))obj=new THREE.Geometry;else{obj=new THREE.Geometry;for(var _=+this.getAttribute('param');_;_--)obj.vertices.push(new THREE.Vector3)}setObj(this,obj)}),$.each(tmp_list.LIGHT,function(){if(tmp=getArr(this.getAttribute('param')),setObj(this,new THREE[light_type[this.getAttribute('type')]](tmp[0],tmp[1],tmp[2],tmp[3],tmp[4])),self.MMD_SA){var _=THREE_obj[THREE_obj.length-1];MMD_SA.light_list.push({obj:_}),2==MMD_SA.light_list.length&&Object.defineProperty(MMD_SA.light_list[1],'pos',{get:function(){var S=new THREE.Vector3;return function(){return S.fromArray(MMD_SA_options.light_position)}}(),set:function(){}})}}),Array.prototype.push.apply(obj3D,tmp_list.LIGHT),$.each(tmp_list.OBJ,function(){setObj(this,new THREE.Object3D)}),Array.prototype.push.apply(obj3D,tmp_list.OBJ),$.each(tmp_list.SPRITE,function(){setObj(this,new THREE.Sprite(new THREE.Material()))}),Array.prototype.push.apply(obj3D,tmp_list.SPRITE),$.each(tmp_list.MESH,function(){let _=new THREE.Mesh(new THREE.Geometry(),new THREE.Material()),S=this.getAttribute('instanced_drawing');S,setObj(this,_)}),Array.prototype.push.apply(obj3D,tmp_list.MESH),$.each(obj3D,function(){this.parentNode.tagName&&'GOML'!==this.parentNode.tagName&&getObj(this.parentNode).add(getObj(this))}),$.each(tmp_list.RDR,function(){tmp=getHash(this.getAttribute('param')),void 0===tmp.clearAlpha&&(tmp.clearAlpha=1),obj=new THREE.WebGLRenderer(tmp),obj.__renderTarget=[],this.getAttribute('camera')||this.setAttribute('camera','camera:first'),this.getAttribute('frame')||this.setAttribute('frame','body'),jThree.MMD&&obj.renderPluginsPre.unshift(jThree.MMD._simulate),setObj(this,obj),obj.__updateFn=[]}),self.MMD_SA&&!MMD_SA.renderer&&(MMD_SA.renderer=jThree('#MMD_renderer').three(0),MMD_SA.renderer&&(MMD_SA.renderer.shadowMapEnabled=!0,MMD_SA.renderer.shadowMapType=THREE.PCFSoftShadowMap,_mirror.forEach(function(_){_.renderer=jThree(_._renderer_id).three(0),jThree(_._mesh_id).three(0).add(_)}))),$.each(waitRdr,function(_){obj=getReferent(_),obj.__renderTarget=obj.__renderTarget.concat(this),$.each(this,function(){prop.invisible.call(this,this.userData.dom.getAttribute('invisible'))}),obj.__resize()}),tmp=that=obj=waitRdr=srcWaiting=null,tmp_root=tmp_root.not(jq),$.each(tmp_list,function(_){tmp_list[_].length=0}),isRoot?(loadLength?src_state=!1:(src_state=!0,src_wait.forEach(function(_){_(jThree)}),src_wait.length=0),rootObj):jq}}();THREE.PerspectiveCamera.prototype.resize=function(_,S){this.aspect=_/S,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype.resize=function(_,S){var T=this.userData;T.__width&&T.__height||(T.__width?(T=T.__width*S/_,this.top=T,this.bottom=-T):T.__height?(T=T.__height*_/S,this.right=T,this.left=-T):(T=50*S/_,this.top=T,this.bottom=-T,T=T*_/S,this.right=T,this.left=-T),this.updateProjectionMatrix())};var prop={src:function(_){var S=getObj(this);if(!(S instanceof THREE.Texture)){var M=urlToExtension(_),A=this.tagName.toLowerCase();if(jThree[A+'Hooks'][M]){this.setAttribute('type',M);var E=this;jThree[A+'Hooks'][M].call(this,_,function(C){C instanceof THREE.Geometry||C instanceof THREE.Material?replaceObj(getObj(E),C):(getObj(E)._srcObj=C,self.MMD_SA&&E.id&&(MMD_SA._j3_obj_by_id[E.id]=C)),E.setAttribute('loadStates','success'),$.event.trigger('load',void 0,E),E=null},function(){E.setAttribute('loadStates','error'),$.event.trigger('error',void 0,E),E=null}),this.setAttribute('loadStates','loading')}else this.setAttribute('loadStates','error'),$.event.trigger('error',void 0,this)}else if(S.sourceFile=_,delete S.image.crossOrigin,/^(tga|TGA)/.test(_.split('.').pop())){var T=new THREE.TGA;T.open(_,function(){S.image.src=T.getDataURL(),S.needsUpdate=!0,T=null})}else /^data:image/.test(_)||(S.image.crossOrigin='anonymous'),S.image.src=_},html:function(_){if(!/^html /.test(_)&&'success'!=importStates){var S=this;return void importFrame.one('load',function(){prop.html.call(S,_),S=_=null})}var T=getHtmlObj(_)[0],M=getObj(this);M._htmlReset&&M._htmlReset(),M._htmlReset=function(){jThree.update(M._htmlUpdate,!1),T=M=null},M._htmlUpdate=function(){THREE.html2canvas(T,{onrendered:function(A){M&&(M.image=A,M.needsUpdate=!0)}})},THREE.html2canvas(T,{onrendered:function(A){M.image=A,M.needsUpdate=!0,$.event.trigger('load',void 0,M.dom())}}),jThree.update(M._htmlUpdate,'true'===this.getAttribute('animation'))},video:function(_){function S(){D.needsUpdate=!0}function T(){D.image.width=C.videoWidth,D.image.height=C.videoHeight,jThree.update(S)}function M(){jThree.update(S,!1)}if(!/^html /.test(_)&&'success'!=importStates){var A=this;return void importFrame.one('load',function(){prop.video.call(A,_),A=_=null})}var E=getHtmlObj(_),C=E[0];C.crossOrigin='anonymous';var D=getObj(this);D.image=C,D._videoReset&&D._videoReset(),E.on('play',T).on('ended pause error',M),C.paused||C.ended||T(),D._videoReset=function(){E.off('play',T).off('ended pause error',M),jThree.update(S,!1),E=C=D=S=null},$.event.trigger('load',void 0,this)},canvas:function(_){if(!/^html /.test(_)&&'success'!=importStates){var S=this;return void importFrame.one('load',function(){prop.canvas.call(S,_),S=_=null})}var T=getObj(this);T._canvasReset&&T._canvasReset(),T._canvasReset=function(){jThree.update(T._canvasUpdate,!1),T=null},T._canvasUpdate=function(){T.needsUpdate=!0},T.image=getHtmlObj(_)[0],T.needsUpdate=!0,jThree.update(T._canvasUpdate,'true'===this.getAttribute('animation')),$.event.trigger('load',void 0,this)},audio:function(){var _=0;return function(S){if(window.AudioContext||window.webkitAudioContext){if(!/^html /.test(S)&&'success'!=importStates){var T=this;return void importFrame.one('load',function(){prop.audio.call(T,S),T=S=null})}var M=getHtmlObj(S),A=getObj(this),E=getReferent(jThree('rdr').attr('camera')||'camera');THREE.snd._AUDIO_CONTEXT||THREE.snd.init(),A._sndReset&&A._sndReset();var C=[];A._sndReset=function(){C.forEach(function(D){THREE.snd.MASTER.disconnectAudioUnit(D.id),THREE.snd.three.detach(D)}),C=null},THREE.snd.SOUND_ENVIRONMENT.cameras[E.id]||function(){var D=E;THREE.snd.three.addCamera(D),jThree.update(function(){THREE.snd.three.update(D)})}(),M.each(function(){this.crossOrigin='anonymous';var D=_++,R=new THREE.snd.BufferSoundNode(D,new THREE.snd.MediaElementAudioSource(D+.5,this));C.push(R),THREE.snd.MASTER.connectAudioUnit(R.id,R),THREE.snd.three.attach(A,R)})}}}(),animation:function(_){var S=getObj(this),T=S._htmlUpdate?S._htmlUpdate:!!S._canvasUpdate&&S._canvasUpdate;T&&jThree.update(T,'true'===_||!0===_)},invisible:function(_){_=getReferent(_),getObj(this).__invisible=!_||Array.isArray(_)?_:[_]},geo:function(){var _={};return function(S){var T=this,M=urlToExtension(S);if(jThree.geoHooks[M])var A=_[S]=_[S]||parseGOML('<geo src="'+S+'" />');else{var A=tmp_root.find(S);A.length||(A=rootObj.find(S))}if(A.attr('src')){function L(){var N=getObj(T),F=N.parent;if(N.geometry.dom()||N.geometry.dispose(),N.geometry=getObj(this),F){var V=N.userData.scene;if(V)for(var I=V.__webglObjects,O=I.length-1;0<=O;O--)I[O].object===N&&I.splice(O,1);F.remove(N),delete N.__webglActive,delete N.__webglInit,F.add(N)}$.event.trigger('load',void 0,T),U()}function U(N){$.event.remove(A,'load',L),$.event.remove(A,'error',U),N&&$.event.trigger('error',void 0,T),L=U=A=T=null}switch(A.attr('loadStates')){case'loading':A.load(L),A.error(U);break;case'success':L.call(A[0]);break;default:$.event.trigger('error',void 0,this);}}else{var E=getObj(this),C=E.parent;if(E.geometry.dom()||E.geometry.dispose(),E.geometry=getObj(A[0]),C){var D=E.userData.scene;if(D)for(var R=D.__webglObjects,P=R.length-1;0<=P;P--)R[P].object===E&&R.splice(P,1);C.remove(E),delete E.__webglActive,delete E.__webglInit,C.add(E)}}}}(),mtl:function(){var _={};return function(S){var T=this,M=urlToExtension(S);if(jThree.mtlHooks[M])var A=_[S]=_[S]||parseGOML('<mtl src="'+S+'" />');else{var A=tmp_root.find(S);A.length||(A=rootObj.find(S))}if(A.attr('src')){function C(){var R=getObj(T);R.material.dispose(),R.material=getObj(this).clone(),R instanceof THREE.Sprite&&(R.material.useScreenCoordinates=!1,R.material.scaleByViewport=!1),$.each(R.material,function(){this instanceof THREE.Texture&&(this.needsUpdate=!0)}),$.event.trigger('load',void 0,T),D()}function D(R){$.event.remove(A,'load',C),$.event.remove(A,'error',D),R&&$.event.trigger('error',void 0,T),C=D=A=T=null}switch(A.attr('loadStates')){case'loading':A.load(C),A.error(D);break;case'success':C.call(A[0]);break;default:$.event.trigger('error',void 0,this);}}else{var E=getObj(this);E.material.dispose(),E.material=getObj(A[0]).clone(),E instanceof THREE.Sprite&&(E.material.useScreenCoordinates=!1,E.material.scaleByViewport=!1),$.each(E.material,function(){this instanceof THREE.Texture&&(this.needsUpdate=!0)})}}}(),model:function(){var _={},S={};return function(T){function M(R){var P=getObj(E),L=getObj(this)._srcObj;if('MMD'!==E.tagName)L=L.clone(),P._modelObj&&P.remove(P._modelObj),P._modelObj=L,getObj(E).add(L),$.event.trigger('load',void 0,E),E=P=null;else{var U=E.getAttribute('motion'),N;if(U){var F=urlToExtension(U);jThree.motionHooks[F]?N=S[U]=S[U]||parseGOML('<motion src="'+U+'" />'):(N=tmp_root.find(U),!N.length&&(N=rootObj.find(U))),self.MMD_SA&&/^\#/.test(U)&&(N._id=U.replace(/^\#/,''))}jThree.mmdHook.call(E,L,N,function(V){P._modelObj&&P.remove(P._modelObj),P._modelObj=V,getObj(E).add(V),$.event.trigger('load',void 0,E),E=P=null})}R&&($.event.remove(this,'load',M),$.event.remove(this,'error',A))}function A(){$.event.remove(this,'load',M),$.event.remove(this,'error',A),$.event.trigger('error',void 0,E),E=null}var E=this,C=urlToExtension(T);if(jThree.modelHooks[C])var D=_[T]=_[T]||parseGOML('<model src="'+T+'" />');else{var D=tmp_root.find(T);D.length||(D=rootObj.find(T))}switch(D.attr('loadStates')){case'loading':D.load(M),D.error(A);break;case'success':M.call(D[0]);break;default:$.event.trigger('error',void 0,this);}}}(),motion:function(){var _={};return function(S){if('MMD'!==this.tagName){var T=urlToExtension(S);if(jThree.motionHooks[T])var M=_[S]=_[S]||parseGOML('<motion src="'+S+'" />');else{var M=tmp_root.find(S);M.length||(M=rootObj.find(S))}jThree.otherMmdHook.call(this,M)}}}(),frame:function(_){if('MMD_SA'==_){var S=getObj(this);return animationFrame(S),void function(){var E=S,C=jThree(S),M,A,D;MMD_SA._renderer=S,D=function(R,P){M=R||MMD_SA_options.width,A=P||MMD_SA_options.height,E.setSize(M,A),E.__camera&&E.__camera.resize(M,A),E.__renderTarget.forEach(function(L){L.__camera&&L.__camera.resize(M,A)})},C.resize(D).resize(),E.__resize=D}()}var S=getObj(this),T=$(_)[0];S.frameElement?T.insertBefore(S.frameElement[0],T.firstChild):(S.frameElement=$('<div style="position:relative;margin:0;padding:0;height:100%;"><iframe name="jthreeIframe" frameborder="0" scrolling="no" style="position:absolute;top:0;left:0;width: 100%; height: 100%; margin: 0; padding: 0; vertical-align: bottom;" /></div>'),T.insertBefore(S.frameElement[0],T.firstChild),S.domElement.style.position='relative',S.frameElement.append(S.domElement),S.frameWindow=jthreeIframe,S.frameElement.find('iframe').attr('name',''),animationFrame(S),function(){function M(){A=C.domElement.parentNode.clientWidth,E=C.domElement.parentNode.clientHeight,C.setSize(A,E),C.__camera&&C.__camera.resize(A,E),C.__renderTarget.forEach(function(R){R.__camera&&R.__camera.resize(A,E)})}var C=S,D=jThree(S),A,E;D.resize(M).resize(),$(S.frameWindow).resize(function(){D.resize()}),C.__resize=M}())},camera:function(_){var S=getReferent(_),T=getObj(this),M=T.__camera;if(T.__camera=S,!(T instanceof THREE.WebGLRenderTarget)){var A=$(T.domElement);if(M){var E=M.userData.renderer;E.splice(E.indexOf(T),1),animationFrame(T,!1);var C=M.userData.scene;if(C){var D=C.userData._events;D&&$.each(D,function(R){A.off('mousewheel'===R?'DOMMouseScroll mousewheel':R,canvasEvent)})}}if(S){animationFrame(T),S.userData.renderer.push(T),T.__resize&&T.__resize();var C=S.userData.scene;if(C){var D=C.userData._events;D&&$.each(D,function(R){A.on('mousewheel'===R?'DOMMouseScroll mousewheel':R,canvasEvent)})}}A=null}},rendering:function(_){animationFrame(getObj(this),'true'===_||!0===_)},fog:function(_){_=getArr(_),getObj(this).fog=new THREE[2===_.length?'FogExp2':'Fog'](_[0],_[1],_[2])}},light_type={};$.each(THREE,function(_){/.+?Light$/.test(_)&&(light_type[_.slice(0,3)]=_)}),jThree.three=function(_){return getObj(_)},jThree.fn.three=function(_){return _===void 0?$.map(this,function(S){return getObj(S)}):getObj(this.get(_))};var animationFrame=function(){var _=[],S=[],E=0,C=[],T,M,A,D,R;return self.animationFrame_RAF=function(P){for(D=P-E,E=P,T=S.length;T;)S[--T](D,P);for(T=_.length;T;){for(R=_[--T],(M=R.__updateFn.length)&&(A=R.userData.dom);M;)R.__updateFn[--M].call(A,D,P);for(M=R.__renderTarget.length;M;)A=R.__renderTarget[--M],A.__invisible&&A.__invisible.forEach(function(L){jThree.styleHooks.display.get(L)&&(C.push(L),jThree.styleHooks.display.set(L,!1))}),R.render(A.__camera.userData.scene,A.__camera,A),C.forEach(function(L){jThree.styleHooks.display.set(L,!0)}),C.length=0;self.MMD_SA&&MMD_SA.render(R)||R.render(R.__camera.userData.scene,R.__camera)}},self.Animate_RAF?(self.EV_animate_full=animationFrame_RAF,animationFrame_RAF(0)):function(P){requestAnimationFrame(arguments.callee),animationFrame_RAF(P)}(0),function(P,L){if('function'==typeof P){var U=S.indexOf(P);!1===L?-1!==U&&S.splice(U,1):-1===U&&S.unshift(P)}else{var U=_.indexOf(P);!1===L?(hasRenderObj(P),-1!==U&&_.splice(U,1)):-1===U&&hasRenderObj(P)&&_.unshift(P)}}}();jThree.fn.update=function(_,S){return this.each(function(){jThree.update(this,_,S)})},jThree.update=function(_,S,T){if(!S||!0===S)animationFrame(_,S);else if(!1===T){var M;_=getObj(_),_.__updateFn&&-1!==(M=_.__updateFn.indexOf(S))&&_.__updateFn.splice(M,1)}else _=getObj(_),_.__updateFn&&-1===_.__updateFn.indexOf(S)&&_.__updateFn.unshift(S)},jThree.fn.attr=jThree.fn.prop=function(_,S){if('string'==typeof _){if(S===void 0)return this[0].getAttribute(_);this.each(function(M){var A=this.getAttribute(_),E='function'==typeof S?S.call(this,M):S;/^data-/.test(_)?jThree.dataHooks[_.slice(5)]&&jThree.dataHooks[_.slice(5)].call(this,E):prop[_]&&prop[_].call(this,E),this.setAttribute(_,E),jThree.event.trigger($.Event('attrChange',{attrName:_,oldValue:A,newValue:E}),void 0,this)})}else if('object'==typeof _){var T=this;$.each(_,function(M,A){T.attr(M,A)})}return this},jThree.fn.add=function(_,S){var T='string'==typeof _?jThree(_,S):$.makeArray(_&&_.nodeType?[_]:_),M=$.merge(this.get(),T);return this.pushStack($.unique(M))};var axis_symbol=['x','y','z'],style_menu=['position','scale','up'];jThree.styleHooks={},$.each(axis_symbol,function(_,S){var T='lookAt'+S.toUpperCase();jThree.styleHooks[T]={get:function(M){return M._lookAt[S]},set:function(M,A){var E=M._lookAt;E[S]=A,M.lookAt(E)}},jThree.fn[T]=cssMethod(T,!0),T='translate'+S.toUpperCase(),jThree.styleHooks[T]={get:function(){return 0},set:function(M,A){M['translate'+S.toUpperCase()](A)}},jThree.fn[T]=cssMethod(T,!0),T='rotate'+S.toUpperCase(),jThree.styleHooks[T]={get:function(M){return M.rotate[S]},set:function(M,A){M.useQuaternion&&(M.useQuaternion=!1),M.rotate[S]=A}},jThree.fn[T]=cssMethod(T,!0),$.each(style_menu,function(M,A){T=A+S.toUpperCase(),jThree.styleHooks[T]={get:function(E){return E[A][S]},set:function(E,C){E[A][S]=C}},jThree.fn[T]=cssMethod(T,!0)})}),axis_symbol.push('w'),$.each(axis_symbol,function(_,S){var T='quaternion'+S.toUpperCase();jThree.styleHooks[T]={get:function(M){return M.quaternion[S]},set:function(M,A){M.useQuaternion||(M.useQuaternion=!0),M.quaternion[S]=A}},jThree.fn[T]=cssMethod(T,!0),T='qtAxisAngle'+S.toUpperCase(),jThree.styleHooks[T]={get:function(M){return M.qtAxisAngle[S]},set:function(){var M=new THREE.Vector3;return function(A,E){A.useQuaternion||(A.useQuaternion=!0),A.qtAxisAngle[S]=E,A.quaternion.setFromAxisAngle(M.copy(A.qtAxisAngle).normalize(),A.qtAxisAngle.w)}}()},jThree.fn[T]=cssMethod(T,!0)}),jThree.styleHooks.lookAt={get:function(_){var S=_._lookAt;return[S.x,S.y,S.z]},set:function(_,S){var T=_._lookAt;T.set(S[0],S[1],S[2]),_.lookAt(T)}},jThree.fn.lookAt=cssMethod('lookAt'),jThree.styleHooks.translate={get:function(){return[0,0,0]},set:function(){var _=new THREE.Vector3;return function(S,T){S.position.add(_.set(T[0],T[1],T[2]).applyEuler(S.rotation,S.eulerOrder))}}()},jThree.fn.translate=cssMethod('translate'),jThree.styleHooks.rotate={get:function(_){var S=_.rotate;return[S.x,S.y,S.z]},set:function(_,S){_.useQuaternion&&(_.useQuaternion=!1),_.rotate.set(S[0],S[1],S[2])}},jThree.fn.rotate=cssMethod('rotate'),jThree.styleHooks.quaternion={get:function(_){var S=_.quaternion;return[S.x,S.y,S.z,S.w]},set:function(_,S){_.useQuaternion||(_.useQuaternion=!0),_.quaternion.set(S[0],S[1],S[2],S[3])}},jThree.fn.quaternion=cssMethod('quaternion'),jThree.styleHooks.qtAxisAngle={get:function(_){var S=_.qtAxisAngle;return[S.x,S.y,S.z,S.w]},set:function(){var _=new THREE.Vector3;return function(S,T){S.useQuaternion||(S.useQuaternion=!0),S.qtAxisAngle.set(T[0],T[1],T[2],T[3]),S.quaternion.setFromAxisAngle(_.copy(S.qtAxisAngle).normalize(),S.qtAxisAngle.w)}}()},jThree.fn.qtAxisAngle=cssMethod('qtAxisAngle'),$.each(style_menu,function(_,S){jThree.styleHooks[S]={get:function(T){var M=T[S];return[M.x,M.y,M.z]},set:function(T,M){T[S].set(M[0],M[1],M[2])}},jThree.fn[S]=cssMethod(S)}),$.extend(jThree.styleHooks,{axis:{get:function(_){return _.userData.__axis?_.userData.__axis.geometry.vertices[1].x:0},set:function(_,S){var T=_.userData.__axis;T&&_.remove(T),S&&(T=new THREE.AxisHelper(S),_.userData.__axis=T,_.add(T))}},display:{get:function(_){return!1!==_.userData.__display},set:function(_,S){S===void 0?S=!1===_.userData.__display||!1===_.parent.visible?!1:!0:_.userData.__display=S=!!S,S?_.traverse(function(T){return!(T instanceof THREE.Bone)&&void(T.visible=!1===T.userData.__display||T.parent&&!1===T.parent.visible?!1:!0)}):_.traverse(function(T){return!(T instanceof THREE.Bone)&&void(T.visible=!1)})}},opacity:{get:function(_){return _.userData.__opacity===void 0?1:_.userData.__opacity},set:function(_,S){S!==void 0&&(_.userData.__opacity=S),_.traverse(function(T){return T.material?!(T instanceof THREE.Bone)&&void(T.material.opacity=(T.parent&&T.parent.material?T.parent.material.opacity:1)*(T.userData.__opacity===void 0?1:T.userData.__opacity)):void 0})}}}),jThree.fn.extend({css:function(_,S){if('string'==typeof S&&(S=getArr(S),1===S.length&&(S=S[0])),'string'==typeof _){if(void 0===S)return styleAdmin(getObj(this[0]),_);this.each(function(){styleAdmin(getObj(this),_,S)})}else{var T;this.each(function(){T=getObj(this),$.each(_,function(M,A){styleAdmin(T,M,A)})}),T=null}return this}}),axis_symbol=style_menu=null,['intensity','distance','angle','exponent'].forEach(function(_){jThree.styleHooks['light'+_.charAt(0).toUpperCase()+_.slice(1)]={get:function(S){return S[_]},set:function(S,T){S[_]=T}}}),['color','ground','sky'].forEach(function(_){jThree.styleHooks['light'+_.charAt(0).toUpperCase()+_.slice(1)]={get:function(S){var T=S[_],M=[255*T.r,255*T.g,255*T.b];return M.color=!0,M},set:function(S,T){S[_].set(T)}}}),['width','height'].forEach(function(_){jThree.styleHooks['camera'+_.charAt(0).toUpperCase()+_.slice(1)]={get:function(S){return S instanceof THREE.OrthographicCamera?2*S.userData['__'+_]||('width'==_?S.right-S.left:S.top-S.bottom):void 0},set:function(S,T){var M='width'===_?{right:T/2,left:-T/2}:{top:T/2,bottom:-T/2},A=S.right-S.left,E=S.top-S.bottom;S.userData['__'+_]=isNaN(M.right)?M.top:M.right,$.extend(S,M),S.resize(A,E)}}}),['left','right','top','bottom','near','far','fov','aspect'].forEach(function(_){jThree.styleHooks['camera'+_.charAt(0).toUpperCase()+_.slice(1)]={get:function(S){return S instanceof THREE.Camera?S[_]:void 0},set:function(S,T){S[_]=T,S.updateProjectionMatrix()}}}),jThree.fn.extend({append:function(){return this.domManip(checkText(arguments),function(_){this.appendChild(addToScene(this,_))})},prepend:function(){return this.domManip(checkText(arguments),function(_){this.insertBefore(addToScene(this,_),this.firstChild)})},before:function(){return this.domManip(checkText(arguments),function(_){this.parentNode.insertBefore(addToScene(this.parentNode,_),this)})},after:function(){return this.domManip(checkText(arguments),function(_){this.parentNode.insertBefore(addToScene(this.parentNode,_),this.nextSibling)})},empty:function(){for(var S=0,_;null!=(_=this[S]);S++)1===_.nodeType&&($.cleanData($.merge([_],_.getElementsByTagName('*'))),$.each(_.children,function(){removeObj(this,!1)}),_.textContent='');return this},remove:function(_,S){for(var M=_?$.filter(_,this):this,A=0,T;null!=(T=M[A]);A++)S||1!==T.nodeType||$.cleanData($.merge([T],T.getElementsByTagName('*'))),T.parentNode&&(T.parentNode.removeChild(T),removeObj(T,S));return this},replaceWith:function(){var _=$.map(this,function(T){return[T.nextElementSibling||T,T.parentNode]}),S=0;return this.domManip(checkText(arguments),function(T){var M=_[S++],A=_[S++];A&&(A.insertBefore(addToScene(A,T),M),jThree(this).remove())},!0),S?this:this.remove()}}),$.each({appendTo:'append',prependTo:'prepend',insertBefore:'before',insertAfter:'after',replaceAll:'replaceWith'},function(_,S){jThree.fn[_]=function(T){for(var A=[],E=jThree(T),C=E.length-1,D=0,M;D<=C;D++)M=D===C?this:this.clone(!0),jThree(E[D])[S](M),Array.prototype.push.apply(A,M.get());return this.pushStack(A)}}),jThree.fn.extend({wrapAll:function(_){var S;return'function'==typeof _?this.each(function(T){jThree(this).wrapAll(_.call(this,T))}):(this[0]&&(S=jThree(_).eq(0).clone(!0),this[0].parentNode&&S.insertBefore(this[0]),S.map(function(){for(var T=this;T.firstElementChild;)T=T.firstElementChild;return T}).append(this)),this)},wrapInner:function(_){return'function'==typeof _?this.each(function(S){jThree(this).wrapInner(_.call(this,S))}):this.each(function(){var S=jThree(this),T=S.contents().not('text');T.length?T.wrapAll(_):S.append(_)})},wrap:function(_){return this.each(function(S){jThree(this).wrapAll('function'==typeof _?_.call(this,S):_)})},unwrap:function(){return this.parent().each(function(){'body'!==this.nodeName&&jThree(this).replaceWith(jThree(this).children())}).end()}}),jThree._animate=[];var animate_id=0,AnimateObj=function(_,S,T,M,A){var E=!!(0<T.duration)&&T.duration,C=T.easing&&'linear'!==T.easing&&jThree.easing[T.easing],D='return function(delta,elapsed){',R=animate_id++,P=jThree._animate[R]={},L={},N=this,U;S&&(D='var storage=jThree._animate['+R+'],jthree=storage.jthree,data=storage.data,easing=storage.easing;'+D,$.each(S,function(F,V){if(U=styleAdmin(_,F),V=objToLocal(_,F,V),U.color&&(/^#/.test(V)?(4===V.length&&(V=V.replace(/^#(.)(.)(.)/,'#$1$1$2$2$3$3')),V=+('0x'+V.slice(1))):'string'==typeof V&&/ /.test(V)&&(V=getArr(V)),'number'==typeof V&&(V=[255&V>>16,255&V>>8,255&V])),D+='jThree.styleHooks.'+F+'.set(jthree,','number'==typeof U)'string'==typeof V&&(V='+'===V.charAt(0)?U+ +V.slice(2):U-+V.slice(2)),D+=E?/^translate/.test(F)?'delta*'+V/E:(C?'easing(elapsed/'+E+',elapsed,0,1,'+E+')*'+(V-U):'elapsed*'+(V-U)/E)+(0===U?'':'+'+U):V;else{D+='[','string'==typeof V&&(V=getArr(V)),$.each(V,function(O,B){'string'==typeof B&&(B='+'===B.charAt(0)?U[O]+ +B.slice(2):U[O]-+B.slice(2)),E?'translate'===F?D+='delta*'+B/E:(D+=(C?'easing(elapsed/'+E+',elapsed,0,1,'+E+')*'+(B-U[O]):'elapsed*'+(B-U[O])/E)+(0===U[O]?'':'+'+U[O]),C&&(U.easing=C)):D+=B,D+=','}),D=D.replace(/,$/,'')+']',U=[]}L[F]=U,D+=');'})),D+='return '+(T.tween&&E&&C?'easing(elapsed/'+E+',elapsed,0,1,'+E+')':E?'elapsed/'+E:'elapsed')+';};',P.jthree=_,P.data=L,P.easing=C,N.update=function(){var V=N,I=0,O=new Function(D)(),B=T.step,G=B?function(X,Y){B.call(_,O(X,Y))}:function(X,Y){O(X,Y)},H=E,W=H?function(X){0>H-X?(I=H,V.update(0)):H===X&&V.stop()}:function(){};return V.gotoEnd=function(){G(H-I,H),V.stop()},function(X){G(X,I+=X),W(I)}}(),N.dequeue=M,N.queue=A,N.obj=_,N.id=R,N.storage=P,N.complete=T.complete||function(){}};AnimateObj.prototype.stop=function(){this.complete.call(this.storage.jthree.userData.dom),delete jThree._animate[this.id],animationFrame(this.update,!1),this.obj.userData.__animate.splice(this.obj.userData.__animate.indexOf(this),1),this.dequeue()},jThree.fn.extend({animate:function(_,S,T,M){var A={};return'object'==typeof arguments[1]&&(A=arguments[1]),$.each(arguments,function(E,C){return 1===E?('function'==typeof C?A.step=C:'object'!=typeof C&&(A.duration=C,'function'==typeof T?A.complete=T:(A.easing=T,A.complete=M)),!1):void('object'!=typeof C&&(_=!1,'function'==typeof C&&(A.step=C)))}),optionNormalize(A),this.each(function(){animate(getObj(this),_,A)}),this},stop:function(_,S){return this.each(function(){var T=this;$.each(getObj(T).userData.__animate,function(){_&&this.queue&&$.queue(T,this.queue,[]),S?this.gotoEnd():this.stop()})}),this},slideDown:function(_,S,T){return genFx(this,'slideDown',_,S,T)},slideUp:function(_,S,T){return genFx(this,'slideUp',_,S,T)},slideToggle:function(_,S,T){return this.each(function(){genFx(this,getObj(this).visible?'slideUp':'slideDown',_,S,T)}),this},fadeOut:function(_,S,T){return genFx(this,'fadeOut',_,S,T)},fadeIn:function(_,S,T){return genFx(this,'fadeIn',_,S,T)},fadeToggle:function(_,S,T){return this.each(function(){genFx(this,getObj(this).visible?'fadeOut':'fadeIn',_,S,T)}),this},fadeTo:function(_,S,T,M){return'function'==typeof T&&(M=T,T=void 0),this.animate({opacity:S},{easing:T,complete:M,duration:_,start:function(A){A.visible||(A.userData.__opacity=0),A.traverse(function(D){!D.material||D.visible||(D.material.opacity=0)}),jThree.styleHooks.display.set(A,!0)}})},show:function(_,S,T){return _===void 0?this.css('display',!0):genFx(this,'show',_,S,T)},hide:function(_,S,T){return _===void 0?this.css('display',!1):genFx(this,'hide',_,S,T)},toggle:function(_,S,T){return this.each(function(){void 0===_?jThree.styleHooks.display.set(getObj(this),!getObj(this).visible):'boolean'==typeof _?jThree.styleHooks.display.set(getObj(this),_):genFx(this,getObj(this).visible?'hide':'show',_,S,T)}),this}}),jThree.easing=Object.create($.easing);var projector=new THREE.Projector,pickingVector=new THREE.Vector3,eventReg=/^(currentTarget|data|delegateTarget|handleObj|jQuery\d+|target|timeStamp|type)$/;THREE.Scene.prototype.eventChange=function(_,S){var T=this.userData._events=this.userData._events||{},M=this,A=[],E=[];_?($.each(_,function(C){T[C]||(T[C]=[],A.push(C));-1!==T[C].indexOf(S)||T[C].push(S)}),$.each(T,function(C){var D=T[C].indexOf(S);_[C]||-1===D||(1===T[C].length?(delete T[C],E.push(C)):T[C].splice(D,1))})):$.each(T,function(C){var D=T[C].indexOf(S);-1===D||(1===T[C].length?(delete T[C],E.push(C)):T[C].splice(D,1))}),jThree('rdr').three().forEach(function(C){if(C.__camera&&C.__camera.userData.scene===M){var D=$(C.domElement);A.forEach(function(R){D.on('mousewheel'===R?'DOMMouseScroll mousewheel':R,{renderer:C},canvasEvent)}),E.forEach(function(R){D.off('mousewheel'===R?'DOMMouseScroll mousewheel':R,canvasEvent)}),C=D=null}}),T=S=M=_=A=E=null},function(){function _(){var S=$._data(this,'events'),T=jThree.three(this);if('BODY'===this.tagName){var M=jThree('scene').three();$.each(M,function(){this.eventChange(S,T)})}else if(T instanceof THREE.Object3D){var M='SCENE'===this.tagName?T:T.userData.scene;M.eventChange(S,T)}S=T=null}jThree.fn.on=function(){return $.fn.on.apply(this,arguments),this.each(_),this},jThree.fn.off=function(){return $.fn.off.apply(this,arguments),this.each(_),this}}(),jThree.fn.mousewheel=function(_,S){return 0<arguments.length?this.on('mousewheel',null,_,S):this.trigger('mousewheel')},jThree.fn.load=function(_,S,T){if('string'!=typeof _)return $.fn.load.apply(this,arguments);var C=this,D=_.indexOf(' '),M,A,E;return 0<=D&&(M=_.slice(D),_=_.slice(0,D)),'function'==typeof S?(T=S,S=void 0):S&&'object'==typeof S&&(A='POST'),0<C.length&&$.ajax({url:_,type:A,dataType:'text',data:S}).done(function(R){E=arguments,C.empty().append(M?jThree(/<goml/.test(R)?R:'<obj>'+R+'</obj>').find(M):R)}).complete(T&&function(R,P){C.each(T,E||[R.responseText,P,R])}),this},window.jThree=jThree}(window,jQuery);
jThree.MMD=jThree.mmd={_onLoop:!1,_delta:0,_animate:function(d){if(jThree.MMD._delta=d*=1e-3,self.MMD_SA){if(MMD_SA._rendered_once&&!MMD_SA._x_object_displayed_once&&(MMD_SA._x_object_displayed_once=!0,MMD_SA_options.mesh_obj_all.forEach(function(rt){var nt=rt._obj;if(rt.use_child_animation_texture||(nt.scale.x=nt.scale.y=nt.scale.z=rt.scale),MMD_SA_options.Dungeon)return void(rt.visible=nt.visible);if(rt.visible=rt.hidden_on_start&&!nt.visible?!1:0<nt.scale.x,/^\#mikuPmx(\d+)$/.test(rt.id)){var st=MMD_SA_options.model_para_obj_all[RegExp.$1];rt.visible=!(st.hidden_on_start||MMD_SA_options.hidden_on_start)}rt.visible?rt.show(!0):rt.hide(!0)}),MMD_SA_options.use_speech_bubble&&!MMD_SA_options.MMD_disabled)){var _=MMD_SA.SpeechBubble;_._mesh.scale.x=_._mesh.scale.y=_._mesh.scale.z=1,_.visible||jThree("#SpeechBubbleMESH").hide()}MMD_SA_options.model_para_obj_all.forEach(function(rt,nt){rt.scale&&THREE.MMD.getModels()[nt].mesh.scale.set(rt.scale,rt.scale,rt.scale)});var u=MMD_SA_options.mesh_obj_by_id.CircularSpectrumMESH;if(u)if(!(MMD_SA.music_mode||WallpaperEngine_CEF_mode&&MMD_SA.AudioFFT&&MMD_SA.AudioFFT._has_audio))u.hide(),MMD_SA_options.Dungeon&&(u._pos_updated_=void 0);else if(MMD_SA.AudioFFT&&MMD_SA.AudioFFT._fft128){if(!MMD_SA_options.CircularSpectrum_position){var M=MMD_SA.center_view;u._obj.position.set(M[0],M[1]+10,M[2])}MMD_SA_options.Dungeon&&(!u.pos_base&&(u.pos_base=u._obj.position.clone()),!u.rot_base&&(u.rot_base={x:0,y:0,z:0}),!u._pos_updated_&&(MMD_SA_options.Dungeon.character.pos_update(),u._pos_updated_=!0));var g=u._obj.scale;g.x=g.y=g.z=1,u.show();for(var A=MMD_SA.AudioFFT._fft128,S=MMD_SA.AudioFFT._fft_last128,D=0,E=A.length;D<E;D++){var P=A[D],T=S[D]||0;100<P&&(P=100),P<T-10&&(P=T-10),S[D]=P;var u=jThree("#CircularSpectrum"+D+"MESH").three(0);u.material.opacity=MMD_SA_options.CircularSpectrum_opacity||0.8,u.scale.y=0.5+19.5*(P/100)}}MMD_SA._rendered_once=!0}if(self.MMD_SA&&!MMD_SA_options.MMD_disabled){if(MMD_SA._gravity_){var C;if(0>=MMD_SA._gravity_factor)MMD_SA._gravity_factor=null,MMD_SA._gravity_=null,C=MMD_SA.gravity;else{C=[];for(var I=MMD_SA.MMD.motionManager.para_SA.gravity||[0,-1,0],D=0;3>D;D++)C[D]=MMD_SA._gravity_[D]*MMD_SA._gravity_factor+I[D]*(1-MMD_SA._gravity_factor);MMD_SA._gravity_factor-=1/60}THREE.MMD.setGravity(10*(9.8*C[0]),10*(9.8*C[1]),10*(9.8*C[2]))}if(MMD_SA_options.use_JSARToolKit){var U=MMD_SA.AR_obj;if(0<U.startup_countdown)U.startup_countdown-=d,U.canvas.getContext("2d").fillRect(0,0,U.canvas.width,U.canvas.height);else if(MMD_SA.AR_video){var F=MMD_SA_options.AR_para,V=F.marker_base_id,B=[];if(!U._skip_AR_frame){var H;H=SL_webcam.getContext("2d"),H.globalCompositeOperation="copy",H.drawImage(MMD_SA.AR_video,0,0,SL_webcam.width,SL_webcam.height),MMD_SA.matrix_rain&&MMD_SA.matrix_rain._SA_draw(),SL_webcam._WebGL_2D&&SL_webcam._WebGL_2D.draw();var N=U.canvas;H=N.getContext("2d"),H.globalCompositeOperation="copy",H.drawImage(MMD_SA.AR_video,0,0,U.canvas.width,U.canvas.height),N.changed=!0;for(var K=U.markerCount=U.detector.detectMarkerLite(U.raster,128),G=0;G<K;G++){var W=U.detector.getIdMarkerData(G),X=-1,Q=W.packetLength;if(4>=Q){X=0;for(var D=0;D<Q;D++)X=X<<8|W.getPacketData(D)}var Y=U.markers[X];Y||(Y=U.markers[X]={m4:new THREE.Matrix4},Y.transform=new NyARTransMatResult),U.resultMat=Y.transform,U.detector.getTransformMatrix(G,U.resultMat),Y.m4.setJsArMatrix(U.resultMat),X==V?(Y.active_counter=40,U._m4=Y.m4,F._marker_base_transform&&Y.m4.multiply(F._marker_base_transform)):Y.active_counter=20}}F.skip_alternate_AR_frame&&(U._skip_AR_frame=!U._skip_AR_frame),Object.keys(U.markers).forEach(function(rt){var nt=U.markers[rt];nt.active_counter--});var J;if(U._m4&&0>=U.markers[V].active_counter){U._m4=null;for(var Z=F.marker_base_id_spare_list,D=0,E=Z.length,Y;D<E;D++)if(Y=U.markers[Z[D]],Y&&0<Y.active_counter&&Y.m4_to_base){U._m4=Y.m4.clone().multiply(Y.m4_to_base),J=!0;break}}if(U._m4&&!J)for(var Z=F.marker_base_id_spare_list,D=0,E=Z.length,Y;D<E;D++)Y=U.markers[Z[D]],Y&&0<Y.active_counter&&(Y.m4_to_base=U._m4a.getInverse(U._m4b.getInverse(U.TEMP_m4.getInverse(Y.m4).multiply(U._m4))));if(U._m4){var ae=MMD_SA._trackball_camera.object,ie=U._m4,ee,te,oe;ee=ie.decompose(),te=ee[0],oe=U.TEMP_v3.setEulerFromQuaternion(ee[1].normalize());var re=oe.x,ne=oe.y,se=oe.z;te.x=-te.x,te.y=-te.y;var de=U._q1.setFromEuler(U.TEMP_v3.set(re-Math.PI/2,-se,-ne),"YZX");ee[1]=de.normalize(),ee[0].applyQuaternion(ee[1]),ae.matrix.identity(),ae.matrix.makeRotationFromQuaternion(ee[1]),U.camera_position=ee[0],ae.matrix.setPosition(ee[0]),ae.matrixWorldNeedsUpdate=!0;var _e=U.markers[V];_e.position=new THREE.Vector3(0,0,0),_e.rotation=new THREE.Quaternion().setFromEuler(U.TEMP_v3.set(-re+90/180*Math.PI,ne,se)),_e._camera_position=te.clone(),ee&&B.push("camera("+U.markerCount+")"+(J?"(P)":"")+":"+parseInt(te.x)+","+parseInt(te.y)+","+parseInt(te.z)+"/"+parseInt(180*-re/Math.PI+90)+","+parseInt(180*ne/Math.PI)+","+parseInt(180*se/Math.PI)),Object.keys(U.markers).forEach(function(rt){if(rt!=V){var nt=U.markers[rt];if(!(0>=nt.active_counter)){var st=U.TEMP_m4.getInverse(U._m4).multiply(nt.m4).decompose(),lt=st[0];nt.position=new THREE.Vector3(lt.x,-lt.z,-lt.y),nt.rotation=st[1].normalize(),B.push(rt+":"+parseInt(nt.position.x)+","+parseInt(nt.position.y)+","+parseInt(nt.position.z)+"/"+parseInt(180*U.TEMP_v3.setEulerFromQuaternion(nt.rotation).z/Math.PI))}}})}else B.push("(base marker not found)");B=B.concat(MMD_SA._debug_msg),B.length&&(DEBUG_show(B.join("\n")),MMD_SA._debug_msg=[])}else DEBUG_show("(video not available)")}var le=d,me=MMD_SA.MMD,pe=Audio_BPM.vo,fe=pe.motion_by_song_name_mode,ce,ue,he,Me,ge;ce=me.motionManager,ue=!fe&&ce.para_SA.BPM||{},he=ue.BPM||120,Me=pe.BPM_mode?pe._sender.playbackRate:120/he,ge=Me*(ue._playbackRate||1)*MMD_SA.playbackRate,jThree.MMD._delta=d=le*ge;var xe=THREE.MMD.getModels()[0],ye=xe.skin;MMD_SA._motion_time_=ye.time+d;var Ae;if(!MMD_SA._force_motion_shuffle&&MMD_SA.motion_shuffle_started){let rt={return_value:null};ye.time+d>ce.lastFrame_/30?(window.dispatchEvent(new CustomEvent("SA_MMD_model0_onmotionended",{detail:{result:rt}})),!rt.return_value&&ce.para_SA.onended&&ce.para_SA.onended(!0),MMD_SA._freeze_onended?(ye.time=ce.lastFrame_/30-d-1/59/1e3,MMD_SA._freeze_onended=null):Ae=!0):(window.dispatchEvent(new CustomEvent("SA_MMD_model0_onmotionplaying",{detail:{result:rt}})),!rt.return_value&&ce.para_SA.onplaying&&ce.para_SA.onplaying(0))}MMD_SA_options.custom_motion_shuffle&&MMD_SA_options.custom_motion_shuffle();for(var be=[],ve=[],D=0,E=MMD_SA_options.model_para_obj_all.length;D<E;D++)be[D]=!0,ve[D]=!MMD_SA.motion_shuffle_started||MMD_SA_options.model_para_obj_all[D]._motion_name_next;var Se=Math.max(Math.min(ye.time+d-ce.lastFrame_/30,0.1),0);if(MMD_SA._force_motion_shuffle||ve[0]||Se){let rt=!MMD_SA.motion_shuffle_started;if(me.frame_time_ref=0,!Ae){let ut={return_value:null};window.dispatchEvent(new CustomEvent("SA_MMD_model0_onmotionended",{detail:{result:ut}})),!ut.return_value&&ce.para_SA.onended&&ce.para_SA.onended()}let nt=!MMD_SA.motion_shuffle_started,st=ce,lt=!MMD_SA.motion_shuffle_started;MMD_SA.motion_shuffle()&&(lt=!0),MMD_SA_options.onmotionended&&MMD_SA_options.onmotionended(lt);let pt=MMD_SA_options.motion_shuffle||MMD_SA_options._motion_shuffle_list_default?MMD_SA_options.motion_shuffle_list[MMD_SA.motion_shuffle_index]:0,ft=MMD_SA_options.motion[pt];MMD_SA._force_motion_shuffle&&(rt=!0),MMD_SA._force_motion_shuffle=null,le=1/59/1e3;let ct;if(lt){rt=!0,ce=me.motionManager,ue=!fe&&ce.para_SA.BPM||{},he=ue.BPM||120,Me=pe.BPM_mode?pe._sender.playbackRate:120/he,ge=Me*(ue._playbackRate||1)*MMD_SA.playbackRate;let ut=ce.para_SA,ht=st.para_SA;if(ct=!nt&&(ht.motion_blending&&ht.motion_blending.fadeout&&(!ht.motion_blending.fadeout.condition||ht.motion_blending.fadeout.condition(st,ce))&&(!ut.motion_blending||!ut.motion_blending.fadein||!ut.motion_blending.fadein.condition||ut.motion_blending.fadein.condition(st,ce))&&ht.motion_blending.fadeout||ut.motion_blending&&ut.motion_blending.fadein&&(!ut.motion_blending.fadein.condition||ut.motion_blending.fadein.condition(st,ce))&&(!ht.motion_blending||!ht.motion_blending.fadeout||!ht.motion_blending.fadeout.condition||ht.motion_blending.fadeout.condition(st,ce))&&ut.motion_blending.fadein),ct){let gt=Object.create(xe.skin);gt._is_skin=!0,gt._motion_index_MMD_SA_extra=0,gt._is_MMD_SA_custom_animation=gt._is_MMD_SA_animation=gt._MMD_SA_disabled=gt.freeze_onended=!0,xe.skin_MMD_SA_extra[0]=gt;let xt=MMD_SA_options.custom_action[0];xt.blending_options=ct,xt._time_ini=RAF_timestamp,xt._seek_time_=st.para_SA.loop_on_blending&&!st.para_SA.freeze_onended&&Se&&Se+(st.firstFrame_&&st.firstFrame_/30||0)||Math.min(gt.time+d,st.lastFrame_/30-1/59/1e3)}let Mt=xe._MMD_SA_cache_current=xe._MMD_SA_cache[ft.path];xe.skin=Mt.skin,xe.morph=Mt.morph,xe.resetMotion(null==ce.para_SA.initial_physics_reset?MMD_SA._ignore_physics_reset:!ce.para_SA.initial_physics_reset),MMD_SA.reset_skin(0),MMD_SA.reset_morph(0),THREE.MMD.adjustMotionDuration(),MMD_SA_options.model_para_obj.onMotionChange&&MMD_SA_options.model_para_obj.onMotionChange(),Se=0}else{let ut=!1==ce.para_SA.loopback_physics_reset||ce.lastFrame_==ce.lastFrame&&!ce.firstFrame_&&!ce.para_SA.loopback_fading;xe.resetMotion(ut||MMD_SA._ignore_physics_reset)}xe.skin._loop_timestamp=RAF_timestamp,ct||(xe.skin_MMD_SA_extra[0]=xe.morph_MMD_SA_extra[0]=MMD_SA.Animation_dummy);for(var D=1,E=MMD_SA_options.model_para_obj_all.length;D<E;D++)MMD_SA_options.model_para_obj_all[D].mirror_motion_from_first_model&&(ve[D]=!0);ce.para_SA.onstart&&ce.para_SA.onstart(lt),rt&&!ce.para_SA.adjust_center_view_disabled&&MMD_SA.reset_camera(),jThree.MMD._delta=d=le*ge,xe.playMotion(),(Se||ce.firstFrame_)&&xe.seekMotion(Se+(ce.firstFrame_&&ce.firstFrame_/30||0))}else Se=0;for(var D=1,E=MMD_SA_options.model_para_obj_all.length;D<E;D++)if(be[D]){var De=THREE.MMD.getModels()[D];if(De.skin){var ce,ke;ce=ke=MMD_SA.motion[De.skin._motion_index];var we=MMD_SA_options.model_para_obj_all[D],Ee=we.is_OPC&&ce.para_SA.BPM?ce.lastFrame:ce.lastFrame_,Pe=Math.max(Math.min(De.skin.time+d-Ee/30,0.1),0);if(!ve[D]){if(!Pe)continue;!ce.para_SA.is_OPC&&ce.para_SA.onended_NPC&&ce.para_SA.onended_NPC(D)}else Pe=0;var Te=!1,u;if(we._motion_name_next||ve[D]&&we.mirror_motion_from_first_model){ke=me.motionManager,Pe=Se;var Ce=we._motion_name_next||ke.para_SA.multi_model_motion_list&&ke.para_SA.multi_model_motion_list[D-1];we._motion_name_next=null;var Ie=(Ce&&MMD_SA_options.motion_para[Ce]||ke.para_SA)._path,u=De._MMD_SA_cache[Ie];Te=u&&u.skin._motion_index!=De.skin._motion_index}if(!Te){var Re=De.skin.time&&(!1==ce.para_SA.loopback_physics_reset||Ee==ce.lastFrame&&!(we._firstFrame_||ce.firstFrame_)&&!ce.para_SA.loopback_fading);De.resetMotion(Re||MMD_SA._ignore_physics_reset)}else if(De._MMD_SA_cache_current=u,De.skin=u.skin,De.morph=u.morph,ce=MMD_SA.motion[u.skin._motion_index],we.mirror_motion_from_first_model||(ke=ce),De.resetMotion(null==ce.para_SA.initial_physics_reset?MMD_SA._ignore_physics_reset:!ce.para_SA.initial_physics_reset),MMD_SA.reset_skin(D),MMD_SA.reset_morph(D),THREE.MMD.adjustMotionDuration(),we.onMotionChange&&we.onMotionChange(),ce.para_SA.NPC_turns_to_you){var Ue=De.mesh,ze=THREE.MMD.getModels()[0].mesh;MMD_SA.TEMP_v3.set(0,Math.PI/2-Math.atan2(ze.position.z-Ue.position.z,ze.position.x-Ue.position.x),0),Ue.quaternion.setFromEuler(MMD_SA.TEMP_v3)}De.skin._loop_timestamp=RAF_timestamp,ce.para_SA.onstart&&ce.para_SA.onstart(Te),De.playMotion(),(Pe||we._firstFrame_||ke.firstFrame_)&&De.seekMotion(Pe+((we._firstFrame_||ke.firstFrame_)&&(we._firstFrame_||ke.firstFrame_)/30||0)),we._firstFrame_=null}}MMD_SA._ignore_physics_reset=null;var Le=window.performance?performance.now():Date.now();if(me.frame_time_ref){if(ue._playbackRate){var Fe=Le-me.frame_time_ref;if(Fe>=ue._playbackRate_countdown){var Ve=ue._playbackRate_countdown/Fe;ge=Me*(ue._playbackRate*Ve+(1-Ve)),jThree.MMD._delta=d=le*ge,ue._playbackRate=null}else ue._playbackRate_countdown-=Fe}}else if(use_SVG_Clock||pe.BPM_mode){var Oe=ue.beat_frame;if(null!=Oe){var Be=30*(xe.skin.time+d),He=60/he,je=(Be-Oe)/30;if(pe.BPM_mode){var Ne=pe.audio_obj;je-=(Ne.currentTime-Ne.beat_reference)*Me}var Ke,Ge;Ke=Ge=je/He,Ke-=~~Ke,0>Ke&&Ke++,Ke=0.5>Ke?-Ke:1-Ke,Ge=Math.round(Ge+Ke),Ge%2&&(!pe.BPM_mode||ue.match_even_beats_only)&&(0>Ke?(Ke++,Ge++):(Ke--,Ge--));var We="/"+(Ge%2?"odd":"even"),Xe=Ke*He;if(!pe.BPM_mode){Xe/=Me;var qe=new Date().getMilliseconds()/1e3;Xe+=qe,0.5<Xe?Xe-=1:-0.5>Xe&&(Xe+=1),Xe*=Me,Ke=Xe/He}if(Xe/=Me,0.05<Math.abs(Xe)){var Qe=0.5<Math.abs(Ke)?2:1;ue._playbackRate=1+Xe/Qe,ue._playbackRate_countdown=1e3*Qe;var Ye=Math.abs(~~(100*Ke)/100)+"beat"+We;DEBUG_show("BPM sync("+(0<Xe?"+":"-")+Ye+")",2)}else;}}if(me.frame_time_ref=Le,null!=MMD_SA.fadeout_opacity){MMD_SA.fadeout_opacity-=d;let rt=SL_2D_front.getContext("2d");if(0<MMD_SA.fadeout_opacity){let nt,st,lt;nt=MMD_SA.fadeout_canvas.width,st=MMD_SA.fadeout_canvas.height,(SL_2D_front.width!=nt||SL_2D_front.height!=st)&&(lt=!0,SL_2D_front.width=nt,SL_2D_front.height=st),rt.globalCompositeOperation="copy",rt.globalAlpha=MMD_SA.fadeout_opacity,rt.drawImage(MMD_SA.fadeout_canvas,0,0),use_WebGL_2D?("inline"!=SL_2D_front._WebGL_2D.canvas.style.display&&(SL_2D_front._WebGL_2D.canvas.style.display="inline"),SL_2D_front._WebGL_2D.draw(),lt&&(SL_2D_front._WebGL_2D.canvas.style.width=SL.style.width,SL_2D_front._WebGL_2D.canvas.style.height=SL.style.height)):("inline"!=SL_2D_front.style.display&&(SL_2D_front.style.display="inline"),lt&&(SL_2D_front.style.width=SL.style.width,SL_2D_front.style.height=SL.style.height))}else if(MMD_SA.fadeout_opacity=null,rt.globalCompositeOperation="copy",rt.globalAlpha=1,rt.clearRect(0,0,SL_2D_front.width,SL_2D_front.height),SL_2D_front.style.display="none",use_WebGL_2D){let nt=SL_2D_front._WebGL_2D;nt.gl.clear(nt.gl.COLOR_BUFFER_BIT),nt.canvas.style.display="none"}}MMD_SA._playbackRate=ge}if(!is_SA_child_animation&&MMD_SA_options.child_animation_as_texture){for(var Ze=0,D=0,Je,$e;D<SA_child_animation_max;D++)if($e=SA_child_animation[D],$e){var et=document.getElementById("Ichild_animation"+D),tt,ot;if(!et)continue;else if(tt=et.contentWindow,ot=tt.SL,!ot)continue;if(ot._drawn_id&&$e._SL_drawn_id==ot._drawn_id||($e._SL_drawn_id=ot._drawn_id,Je=!0),++Ze>=MMD_SA_options.child_animation_as_texture)break}if(Je){Ze=0;for(var D=0,$e;D<SA_child_animation_max;D++)if($e=SA_child_animation[D],$e){var et=document.getElementById("Ichild_animation"+D),tt,ot;if(!et)continue;else if(tt=et.contentWindow,ot=tt.SL,!ot)continue;var it=jThree("import").contents().find("#j3_childAnimationCanvas"+Ze)[0];it._canvas_ready=!0,it.width=MMD_SA_options.child_animation_width,it.height=MMD_SA_options.child_animation_height;var H=it.getContext("2d");H.globalCompositeOperation="copy",H.globalAlpha=MMD_SA_options.child_animation_opacity;try{H.drawImage(ot._canvas_for_copy||ot,0,0,it.width,it.height),jThree("#ChildAnimation"+Ze+"TXR").three(0).needsUpdate=!0}catch(lt){DEBUG_show(lt.description)}if(++Ze>=MMD_SA_options.child_animation_as_texture)break}}}THREE.MMD.updateMotion(d),jThree.MMD._onLoop&&(THREE.MMD.motionLoop?jThree.MMD.onLoop&&jThree.MMD.onLoop():(THREE.MMD.pauseMotion(),jThree.update(arguments.callee,!1),jThree.MMD.complete&&jThree.MMD.complete()),jThree.MMD._onLoop=!1)},play:function(d){d!==void 0&&(this.loop=d),THREE.MMD.playMotion(d),jThree.update(jThree.MMD._animate)},pause:function(){THREE.MMD.pauseMotion(),jThree.update(jThree.MMD._animate,!1)},reset:function(){THREE.MMD.resetMotion(),jThree.update(jThree.MMD._animate,!1)},setup:function(d){return jThree.extend(jThree.MMD,d),this},sync:function(d,_){jThree.MMD._delay=_||0,jQuery(d).on("play",jThree.MMD.play).on("pause ended",jThree.MMD.pause).on("timeupdate",function(){jThree.MMD.seek(this.currentTime+jThree.MMD._delay)})},_edgeScale:1,onLoop:null,onStop:null,_camera:!0,get cameraMotion(){return this._camera},set cameraMotion(d){this._camera=d,THREE.MMD.getCameraMotion().forEach(function(_){_[d?"play":"pause"]()})},get edgeScale(){return this._edgeScale},set edgeScale(d){this._edgeScale=d,THREE.MMD.getModels().forEach(function(_){_.mesh.material.materials.forEach(function(u,M){var g=_.pmx.materials[M];0!=(16&g.drawFlags)&&(u.mmdEdgeThick=g.edgeSize*d)})})},_shadowDark:0.7,get shadowDark(){return this._shadowDark},set shadowDark(d){this._shadowDark=d,THREE.MMD.getModels().forEach(function(_){_.mesh.material.materials.forEach(function(u,M){var g=_.pmx.materials[M];0!=(8&g.drawFlags)&&(u.mmdShadowDark=d)})})},_duration:0,get duration(){return this._duration},set duration(d){this._duration=d,THREE.MMD.adjustMotionDuration()},get groundLevel(){return jThree.MMD._ground.getY()},set groundLevel(d){jThree.MMD._ground.setY(d)},toon:["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAABlBMVEX////Nzc1XNMFjAAAAD0lEQVQI12OgNvgPBFQkAPcnP8G6A9XkAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAABlBMVEX////14eF2pXIGAAAAD0lEQVQI12OgNvgPBFQkAPcnP8G6A9XkAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAABlBMVEX///+ampo+MvaSAAAAD0lEQVQI12OgNvgPBFQkAPcnP8G6A9XkAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAABlBMVEX////47+sAKyXFAAAAD0lEQVQI12OgNvgPBFQkAPcnP8G6A9XkAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEX/////5t3/6N7/7eX/+fb/9PD//Pv/8Op5dFmOAAAAQklEQVQoz2MYBRQDtjQYgAq4gEAIiEiBCIYiAEjYjaEcBIrLoSA0lMEYDTAooQEGRQgtqAgTEEQD5AgoYQggAFgOAHEkIrrgwCawAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAflBMVEX/7WHDrAPErQT/7mT/7mn66Fj86VvizTLJswz/8of/8Hf/73L+7F7NtxLLtQ7/7mb///z//ez//OL/+9vs2ELk0Db//vX/+L7/723o1DzRvBjFrgX/+sz/+Lr/9qzw3Uj/+tL/97b/9Jf/85D/9Z//8X//6DHFrgb/+MD/5AUNrqVlAAAAwklEQVQ4y+XO226DMAwAUG/OutmhgyQQkgYYl162///BmaoV7UPFc9XzYlu2bMNrQrhS16hyRMxVCLlSgWrNmpkPvP8lDogKutb4Qbvajc5b6xpr92071qbvTMNMPfjCdzgVoulJkx2oNW4wtulqYl8YoIkVaq1lOcB8Sy4hjk4SDHTQd+8tcLokR1jxByuO8CKybDP7uLE5y84AyrKMsaqqz4VUMUZp/AjYbcW3+FrM5VbsBJxSen8kpXSCtxVPMfAPmVcPlflaGvEAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAC0lEQVQI12MY5AAAAKAAAfgHMzoAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAC0lEQVQI12MY5AAAAKAAAfgHMzoAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAC0lEQVQI12MY5AAAAKAAAfgHMzoAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAC0lEQVQI12MY5AAAAKAAAfgHMzoAAAAASUVORK5CYII="]},jThree.fn.MMD=jThree.fn.mmd=function(d,_){if("string"==typeof d){if("seek"===d){var u=this.three();u.forEach(function(A){if(A.__mmd)A.__mmd.seekMotion(_);else if(A instanceof THREE.Light){var S=THREE.MMD.getLightMotion();S&&S.seek(_)}}),THREE.MMD.getCameraMotion().forEach(function(A){-1!==u.indexOf(A.persepectiveCamera)&&A.seek(_)})}else if("motion"===d){var M=this.three();THREE.MMD.getCameraMotion().forEach(function(A){-1!==M.indexOf(A.persepectiveCamera)&&A[_?"play":"pause"]()})}}else if("object"==typeof d){var g=this;$.each(d,function(A,S){g.MMD(A,S)})}return this},function(){function d(){oe.splice(this.__mmd,1)[0].dispose()}var Z=1/60,_,u,M,g,A,S,D,E,P,T,C,I,U,F,V,O,B,H,N,K,G,W,X,Q,Y,J,ee;_=function(re,ne){var se=new XMLHttpRequestZIP;se.onload=function(){ne(se),se=null},se.open("GET",re,!0),se.responseType="arraybuffer",se.send()},u=function(){this.count=0,this.callback=null},u.prototype.add=function(re){re&&(this.callback=re,this.count=0),this.count++},u.prototype.del=function(){this.count--,0===this.count&&this.callback&&(this.callback(),this.callback=null)},M=function(re,ne){this.dv=new DataView(re),this.offset=0,this.littleEndian=ne},M.prototype.readInt8=function(){var re=this.offset;return this.offset+=1,this.dv.getInt8(re)},M.prototype.readUint8=function(){var re=this.offset;return this.offset+=1,this.dv.getUint8(re)},M.prototype.readInt16=function(){var re=this.offset;return this.offset+=2,this.dv.getInt16(re,this.littleEndian)},M.prototype.readUint16=function(){var re=this.offset;return this.offset+=2,this.dv.getUint16(re,this.littleEndian)},M.prototype.readInt32=function(){var re=this.offset;return this.offset+=4,this.dv.getInt32(re,this.littleEndian)},M.prototype.readUint32=function(){var re=this.offset;return this.offset+=4,this.dv.getUint32(re,this.littleEndian)},M.prototype.readFloat32=function(){var re=this.offset;return this.offset+=4,this.dv.getFloat32(re,this.littleEndian)},M.prototype.readBytes=function(re){var ne=this.offset;return this.offset+=re,new Uint8Array(this.dv.buffer).subarray(ne,this.offset)},A=function(re){return re[2]*=-1,re},S=function(re,ne){var se;A(re),A(ne),se=re[2],re[2]=ne[2],ne[2]=se},D=function(re){return re[0]*=-1,re[1]*=-1,re},E=function(re,ne){var se;D(re),D(ne),se=re[0],re[0]=ne[0],ne[0]=se,se=re[1],re[1]=ne[1],ne[1]=se},g={MAGIC:"IllegalMagicException",DATA:"IllegalDataException"},function(){var re,ne,se,de,_e,le,me,pe,fe,ce,ue,he,Me,ge,xe,ye,Ae,be,ve,Se,De,ke,we;re=function(Ee){if(M.call(this,Ee,!0),542657872!==this.readUint32())throw g.MAGIC;if(this.version=this.readFloat32(),2!==this.version)throw g.DATA;if(8!==this.readUint8())throw g.DATA;this.encode=this.readUint8(),this.additionalUvCount=this.readUint8(),this.vertexIndexSize=this.readUint8(),this.textureIndexSize=this.readUint8(),this.materialIndexSize=this.readUint8(),this.boneIndexSize=this.readUint8(),this.morphIndexSize=this.readUint8(),this.rigidIndexSize=this.readUint8()},re.prototype=Object.create(M.prototype),re.prototype.constructor=re,re.prototype.readText=function(){var Ee=this.readInt32(),Pe,Te;if(0===Ee)return"";if(Pe=[],0===this.encode)for(Ee/=2;0<Ee--;)Pe.push(this.readUint16());else for(;0<Ee;)Te=this.readUint8(),224==(240&Te)?(Te&=15,Te=Te<<6|63&this.readUint8(),Te=Te<<6|63&this.readUint8(),Ee-=3):192==(224&Te)?(Te&=31,Te=Te<<6|63&this.readUint8(),Ee-=2):Ee--,Pe.push(Te);return String.fromCharCode.apply(void 0,Pe)},re.prototype.readIndex=function(Ee,Pe){var Te;if(1===Ee)Te=Pe?this.readUint8():this.readInt8();else if(2===Ee)Te=Pe?this.readUint16():this.readInt16();else if(4===Ee)Te=this.readInt32();else throw g.DATA;return Te},re.prototype.readVertexIndex=function(){return this.readIndex(this.vertexIndexSize,!0)},re.prototype.readTextureIndex=function(){return this.readIndex(this.textureIndexSize)},re.prototype.readMaterialIndex=function(){return this.readIndex(this.materialIndexSize)},re.prototype.readBoneIndex=function(){return this.readIndex(this.boneIndexSize)},re.prototype.readMorphIndex=function(){return this.readIndex(this.morphIndexSize)},re.prototype.readRigidIndex=function(){return this.readIndex(this.rigidIndexSize)},re.prototype.readVector=function(Ee,Pe){for(var Te=[];0<Ee--;)Te.push(this.readFloat32());return Pe&&(Te=Te.map(Ce=>Ce*MMD_SA._readVector_scale)),Te},ne=function(Ee){this.name=Ee.readText(),this.nameEn=Ee.readText(),this.comment=Ee.readText(),this.commentEn=Ee.readText()},se=function(Ee){function Pe(){var Ce=Ee.readBoneIndex();return 0>Ce&&(Ce=0),Ce}var Te;switch(this.type=Ee.readUint8(),this.type){case 0:this.bones=[Pe()],this.weights=[1],Se++;break;case 1:this.bones=[Pe(),Pe()],Te=Ee.readFloat32(),this.weights=[Te,1-Te],De++;break;case 2:this.bones=[Pe(),Pe(),Pe(),Pe()],this.weights=[Ee.readFloat32(),Ee.readFloat32(),Ee.readFloat32(),Ee.readFloat32()],ke++;break;case 3:this.bones=[Pe(),Pe()],Te=Ee.readFloat32(),this.weights=[Te,1-Te],this.sdefC=Ee.readVector(3),this.sdefR0=Ee.readVector(3),this.sdefR1=Ee.readVector(3),we++;break;default:throw g.DATA;}},de=function(Ee){var Pe;for(this.pos=A(Ee.readVector(3,!0)),this.normal=A(Ee.readVector(3)),this.uv=Ee.readVector(2),this.additionalUvs=[],Pe=Ee.additionalUvCount;0<Pe--;)this.additionalUvs.push(Ee.readVector(4));this.skin=new se(Ee),this.edgeScale=Ee.readFloat32()},_e=function(Ee){this.path=Ee.readText(/\\/g,"/")},le=function(Ee){this.name=Ee.readText(),this.nameEn=Ee.readText(),this.diffuse=Ee.readVector(3),this.alpha=Ee.readFloat32(),this.specular=Ee.readVector(3),this.power=Ee.readFloat32(),this.ambient=Ee.readVector(3),this.drawFlags=Ee.readUint8(),this.edgeColor=Ee.readVector(4),this.edgeSize=Ee.readFloat32(),this.texture=Ee.readTextureIndex(),this.sphereTexture=Ee.readTextureIndex(),this.sphereMode=Ee.readUint8(),this.sharedToon=Ee.readUint8(),this.toonTexture=0===this.sharedToon?Ee.readTextureIndex():Ee.readUint8(),this.memo=Ee.readText(),this.indexCount=Ee.readInt32()},me=function(Ee){this.bone=Ee.readBoneIndex(),1===Ee.readUint8()&&(this.limits=[Ee.readVector(3),Ee.readVector(3)],E(this.limits[0],this.limits[1]))},pe=function(Ee){var Pe;for(this.effector=Ee.readBoneIndex(),this.iteration=Ee.readInt32(),this.control=Ee.readFloat32(),this.links=[],Pe=Ee.readInt32();0<Pe--;)this.links.push(new me(Ee))},fe=function(Ee){this.name=Ee.readText(),this.nameEn=Ee.readText(),this.origin=A(Ee.readVector(3,!0)),this.parent=Ee.readBoneIndex(),this.deformHierachy=Ee.readInt32(),this.flags=Ee.readUint16(),0==(1&this.flags)?Ee.readVector(3):Ee.readBoneIndex(),0!=(768&this.flags)&&(this.additionalTransform=[Ee.readBoneIndex(),Ee.readFloat32()]),0!=(1024&this.flags)&&(this.fixedAxis=A(Ee.readVector(3))),0!=(2048&this.flags)&&(Ee.readVector(3),Ee.readVector(3)),0!=(4096&this.flags)&&(self.MMD_SA&&!1!==MMD_SA.use_afterPhysics&&(MMD_SA.use_afterPhysics=!0),this.afterPhysics=!0),0!=(8192&this.flags)&&(this.externalDeform=Ee.readInt32()),0!=(32&this.flags)&&(this.IK=new pe(Ee))},ce=function(Ee){this.target=Ee.readVertexIndex(),this.offset=A(Ee.readVector(3,!0))},ue=function(Ee){this.target=Ee.readVertexIndex(),this.uv=Ee.readVector(4)},he=function(Ee){this.target=Ee.readBoneIndex(),this.pos=Ee.readVector(3,!0),this.rot=Ee.readVector(4),(this.pos[0]||this.pos[1]||this.pos[2])&&(this.pos_v3=new THREE.Vector3(this.pos[0],this.pos[1],-this.pos[2])),(this.rot[0]||this.rot[1]||this.rot[2])&&(this.rot_q=new THREE.Quaternion(this.rot[0],this.rot[1],this.rot[2],this.rot[3]),this.rot_q=this.rot_q.setFromEuler(MMD_SA.TEMP_v3.setEulerFromQuaternion(this.rot_q).multiply(MMD_SA._v3a.set(-1,-1,1)),"YXZ"))},Me=function(Ee){this.target=Ee.readMaterialIndex(),this.operator=Ee.readUint8(),this.diffuse=Ee.readVector(3),this.alpha=Ee.readFloat32(),this.specular=Ee.readVector(3),this.power=Ee.readFloat32(),this.ambient=Ee.readVector(3),this.edgeColor=Ee.readVector(4),this.edgeSize=Ee.readFloat32(),this.texture=Ee.readVector(4),this.sphereTexture=Ee.readVector(4),this.toonTexture=Ee.readVector(4)},ge=function(Ee){this.target=Ee.readMorphIndex(),this.weight=Ee.readFloat32()},xe=function(Ee,Pe){var Te;if(this.name=Ee.readText(),self.MMD_SA){var Ce=Pe.morph_translate;Ce&&Ce[this.name]&&(this.name=Ce[this.name])}for(this.nameEn=Ee.readText(),this.panel=Ee.readUint8(),this.type=Ee.readUint8(),this.items=[],Te=Ee.readInt32();0<Te--;)if(0===this.type)this.items.push(new ge(Ee));else if(1===this.type)this.items.push(new ce(Ee));else if(2===this.type)this.items.push(new he(Ee));else if(3<=this.type&&7>=this.type)this.items.push(new ue(Ee));else if(8===this.type)this.items.push(new Me(Ee));else throw g.DATA},ye=function(Ee){if(this.type=Ee.readUint8(),0===this.type)this.index=Ee.readBoneIndex();else if(1===this.type)this.index=Ee.readMorphIndex();else throw g.DATA},Ae=function(Ee){var Pe;for(this.name=Ee.readText(),this.nameEn=Ee.readText(),this.special=Ee.readUint8(),this.items=[],Pe=Ee.readInt32();0<Pe--;)this.items.push(new ye(Ee))},be=function(Ee){this.name=Ee.readText(),this.nameEn=Ee.readText(),this.bone=Ee.readBoneIndex(),this.group=Ee.readUint8(),this.mask=Ee.readUint16(),this.shape=Ee.readUint8(),this.size=Ee.readVector(3,!0),this.pos=A(Ee.readVector(3,!0)),this.rot=D(Ee.readVector(3)),this.mass=Ee.readFloat32(),this.posDamping=Ee.readFloat32(),this.rotDamping=Ee.readFloat32(),this.restitution=Ee.readFloat32(),this.friction=Ee.readFloat32(),this.type=Ee.readUint8()},ve=function(Ee){this.name=Ee.readText(),this.nameEn=Ee.readText(),this.type=Ee.readUint8(),this.rigidA=Ee.readRigidIndex(),this.rigidB=Ee.readRigidIndex(),this.pos=A(Ee.readVector(3,!0)),this.rot=D(Ee.readVector(3)),this.posLower=Ee.readVector(3,!0),this.posUpper=Ee.readVector(3,!0),S(this.posLower,this.posUpper),this.rotLower=Ee.readVector(3),this.rotUpper=Ee.readVector(3),E(this.rotLower,this.rotUpper),this.posSpring=Ee.readVector(3,!0),this.rotSpring=Ee.readVector(3)},P=function(){},P.prototype.parse=function(Ee){var Pe,Te,Ce,Ie=this,Ue,ze;if(self.MMD_SA){var Re=decodeURIComponent(this.url_raw.replace(/^.+[\/\\]/,""));if(Ue=MMD_SA_options.model_para_obj_by_filename[Re],this._model_index=this._model_index_default=Ue._model_index,MMD_SA._readVector_scale=(Ue.model_scale||1)*(MMD_SA_options.WebXR?MMD_SA_options.WebXR.model_scale||0.9:1),/\#clone(\d+)\.pmx$/.test(Re)){ze=!0;var Le=Re.replace(/\#clone(\d+)\.pmx$/,".pmx"),Fe=MMD_SA_options.model_para_obj_by_filename[Le],Ve=Fe._clone_parent.pmx,Oe=Object.assign({},this);Object.assign(this,Ve,Oe),this.rigids=this.rigids.map(function(We){return Object.assign({},We)}),this.rigid_index_by_bone=Ve.rigid_index_by_bone}else Pe=new re(Ee),Ue._clone_parent={pmx:this}}if(!ze){for(this.vertices=[],this.indices=[],this.textures=[],this.materials=[],this.bones=[],this.morphs=[],this.frames=[],this.rigids=[],this.joints=[],Se=De=ke=we=0,this.info=new ne(Pe),Te=Pe.readInt32();0<Te--;)this.vertices.push(new de(Pe));for(Te=Pe.readInt32();0<Te--;)this.indices.push(Pe.readVertexIndex());for(Te=Pe.readInt32();0<Te--;)this.textures.push(new _e(Pe));for(Te=Pe.readInt32();0<Te--;)this.materials.push(new le(Pe));for(Te=Pe.readInt32();0<Te--;)this.bones.push(new fe(Pe));let We=self.MMD_SA&&(Ue.make_armIK||MMD_SA_options.make_armIK);if(We){let qe=this.bones.length,Qe=this.bones.length;this.bones.forEach(Je=>Je.deformHierachy*=1.1);let Ye=this.bones.findIndex(Je=>"\u5DE6\u8155"==Je.name)<this.bones.findIndex(Je=>"\u53F3\u8155"==Je.name)?["\u5DE6","\u53F3"]:["\u53F3","\u5DE6"];Ye.forEach(function(Je){let $e=[],ot=Ie.bones.findIndex(it=>it.name==Je+"\u8155"),Ze,et,tt;et=Ie.bones.find(it=>it.name==Je+"\u8155"),tt=Object.assign({},et),tt.name=tt.nameEn=Je+"\u8155+",Ie.bones.push(tt),Ze=768,et.flags|=Ze,et.additionalTransform=[qe,1],$e.unshift(qe),qe++,et=Ie.bones.find(it=>it.name==Je+"\u3072\u3058"),tt=Object.assign({},et),tt.name=tt.nameEn=Je+"\u3072\u3058+",tt.parent=qe-1,Ie.bones.push(tt),Ze=768,et.flags|=Ze,et.additionalTransform=[qe,1],$e.unshift(qe),qe++,et=Ie.bones.find(it=>it.name==Je+"\u624B\u9996"),tt=Object.assign({},et),tt.name=tt.nameEn=Je+"\u624B\u9996+",tt.parent=qe-1,Ie.bones.push(tt),tt=Object.assign({},et),tt.name=tt.nameEn=Je+"\u8155\uFF29\uFF2B",tt.parent=Ie.bones.findIndex(it=>"\u4E0A\u534A\u8EAB2"==it.name),tt.IK={control:57.29578/180*Math.PI,effector:qe,iteration:20,links:$e.map(it=>({bone:it}))},tt.flags|=32,Ie.bones.push(tt),Ze=768,et.flags|=Ze,et.additionalTransform=[qe,1],qe+=2;for(let it=ot;it<Qe;it++)Ie.bones[it].deformHierachy+=0.01})}if(Ue.skin_weight){let qe={},Qe=MMD_SA_options.skin_weight_mod||(MMD_SA_options.Dungeon?0.5:1);Object.keys(Ue.skin_weight).forEach(function(Ye){let Je=Ie.bones.findIndex(Ze=>Ze.name==Ye);0<=Je&&(qe[Je]=Ue.skin_weight[Ye]*Qe)}),this.vertices.forEach(function(Ye){let Je=Ye.skin;if(!(1>=Je.weights.length)){let $e=[],et=Je.weights.length,Ze;for(let tt=0,ot;tt<et;tt++)if(ot=qe[Je.bones[tt]],null!=ot){Ze=!0;let it=Je.weights[tt]*(1-ot),rt=1-Je.weights[tt];for(let nt=0;nt<et;nt++)$e[nt]=($e[nt]||0)+(nt==tt?-it:it*(Je.weights[nt]/rt))}if(Ze)for(let tt=0;tt<et;tt++)Je.weights[tt]+=$e[tt]}})}for(Te=Pe.readInt32();0<Te--;)this.morphs.push(new xe(Pe,Ue));let Xe=this.morphs.find(qe=>"\u307E\u3070\u305F\u304D"==qe.name);if(Xe&&self.MMD_SA&&MMD_SA_options.WebXR){console.log("Use \u307E\u3070\u305F\u304DL/R");let qe=Object.assign({},Xe),Qe=Object.assign({},Xe);qe.name=qe.nameEn="\u307E\u3070\u305F\u304DL",Qe.name=Qe.nameEn="\u307E\u3070\u305F\u304DR";let Ye;1==Xe.type&&(qe.items=Xe.items.filter(Je=>0<Ie.vertices[Je.target].pos[0]),Qe.items=Xe.items.filter(Je=>0>Ie.vertices[Je.target].pos[0]),Ye=!0),Ye&&(this.morphs.push(qe),this.morphs.push(Qe))}for(Te=Pe.readInt32();0<Te--;)this.frames.push(new Ae(Pe));for(Te=Pe.readInt32();0<Te--;)this.rigids.push(new be(Pe));for(Te=Pe.readInt32();0<Te--;)this.joints.push(new ve(Pe));Ue&&Ue.physics_disabled&&(this.rigids=[],this.joints=[],console.log("Physics OFF: model-"+this._model_index)),Ce=this.bones,this.rigids.forEach(function(qe){var Qe;0<=qe.bone&&(Qe=Ce[qe.bone].origin,qe.ofs=[qe.pos[0]-Qe[0],qe.pos[1]-Qe[1],qe.pos[2]-Qe[2]])}),this.rigids.forEach(function(qe,Qe){qe._index=Qe}),this.rigid_index_by_bone={},this.rigids.forEach(function(qe,Qe){Ie.rigid_index_by_bone[qe.bone]=Qe})}if(self.MMD_SA&&Ue.morph_default&&!Ue.morph_default._is_empty)for(var Be in Ue.morph_default)for(var He=0,je=this.morphs.length,Ne;He<je;He++)if(Ne=this.morphs[He],Be==Ne.name){var Ke={};if(0==Ne.type){if(Ne.items.forEach(function(We){2==Ie.morphs[We.target].type&&Ie.morphs[We.target].items.forEach(function(Xe){Ke[Ie.bones[Xe.target].name]=!0})}),!Ke.length)continue;}else if(2==Ne.type)Ne.items.forEach(function(We){Ke[Ie.bones[We.target].name]=!0});else continue;for(var Ge in Ke)Ue.skin_default||(Ue.skin_default={}),Ue.skin_default._is_empty=null,Ue.skin_default[Ge]||(Ue.skin_default[Ge]={pos:{x:0,y:0,z:0}});break}},P.prototype.createMesh=function(Ee,Pe){var Te,Ce,Ie,Ue,ze,Re,Le,Fe,Ve,Oe;if(!this.vertices)return void console.error("not parsed");Te=this,void 0===Ee.shadowDark&&(Ee.shadowDark=0.3),void 0===Ee.edgeScale&&(Ee.edgeScale=1),void 0===Ee.textureAlias&&(Ee.textureAlias={});var Be,He;if(self.MMD_SA){Be=MMD_SA_options.model_para_obj_all[this._model_index];var je=decodeURIComponent(this.url_raw.replace(/^.+[\/\\]/,""));if(/\#clone(\d+)\.pmx$/.test(je)){He=!0;var Ne=je.replace(/\#clone(\d+)\.pmx$/,".pmx"),Ke=MMD_SA_options.model_para_obj_by_filename[Ne];return Ce=Ke._clone_parent.geo,Ie=Ke._clone_parent.materials,this.morphs_index_by_name=Ce.morphs_index_by_name,void Pe(new THREE.SkinnedMesh(Ce,new THREE.MeshFaceMaterial(Ie)))}}Ce=new THREE.Geometry,Ie=[],He||(Be._clone_parent.geo=Ce,Be._clone_parent.materials=Ie),Ue=new u,Ue.add(function(){Pe(new THREE.SkinnedMesh(Ce,new THREE.MeshFaceMaterial(Ie)))}),Re=function(Ye){return new THREE.Vector3(Ye[0],Ye[1],Ye[2])},Le=function(Ye){return new THREE.Vector2(Ye[0],Ye[1])},Fe=function(Ye){var Je=new THREE.Color;return Je.r=Ye[0],Je.g=Ye[1],Je.b=Ye[2],Je},Oe={};var Ge=function(Ye,Je){if(!MMD_SA.use_webgl2&&Je){var Ze=Je._uv_bbox,$e=Ze.max.x-Ze.min.x,et=Ze.max.y-Ze.min.y;if(!(1>=$e&&1>=et)){var tt=Ye.image,ot,it;if(tt.width>tt.height?(ot=1,it=tt.width/tt.height):(ot=tt.height/tt.width,it=1),!($e<1.1*ot&&et<1.1*it)){var tt=Ye.image,rt=tt.width,nt=tt.height;if(0!=(rt&rt-1)||0!=(nt&nt-1)){var st=Math.min(Math.pow(2,Math.round(Math.log2(tt.width))),2048),lt=Math.min(Math.pow(2,Math.round(Math.log2(tt.height))),2048),pt=Ye.image=document.createElement("canvas");pt.width=st,pt.height=lt,pt.getContext("2d").drawImage(tt,0,0,st,lt),console.log(Je.name),console.log([st,lt])}}}}};Ve=function(Ye,Je,Ze,$e){var et,tt,ot,it;for(tt in et=Ye.split(".").pop().toLowerCase(),Ee.textureAlias)if(tt==et){et=Ee.textureAlias[tt],Ye=Ye.slice(0,-tt.length)+et;break}if(Oe.hasOwnProperty(Ye))return Oe[Ye];if(it=function(){Ue.del(),Je&&Je()},Ue.add(),"dds"===et){var rt=self.MMD_SA&&MMD_SA_options.flip_DDS&&!/^data:image/.test(Ye)?Ye.replace(/[^\/\\]+$/,"flipV/$&"):Ye;ot=THREE.ImageUtils.loadCompressedTexture(/^data:image/.test(Ye)?rt:toFileProtocol(Te.texturePath+rt),void 0,function(st){st.hasTransparency=st.format!==THREE.RGB_S3TC_DXT1_Format,st.minFilter=st.magFilter=THREE.LinearFilter,Ue.del()},it)}else{var nt=/^toon\d\d\.bmp$/.test(Ye)?System.Gadget.path+"\\MMD.js\\data\\":Te.texturePath;ot=THREE.ImageUtils.loadTexture(/^data:image/.test(Ye)?Ye:toFileProtocol(nt+Ye),void 0,function(){return function(lt){Ge(lt,Ze),Ue.del()}}(),it,$e)}return ot.flipY=!1,ot.wrapS=ot.wrapT=THREE.RepeatWrapping,Oe[Ye]=ot,ot},this.vertices.forEach(function(Ye){var Je;switch(Ce.vertices.push(Re(Ye.pos)),Je=Ye.skin,Je.type){case 0:Ce.skinWeights.push(new THREE.Vector4(Je.weights[0],0,0,0)),Ce.skinIndices.push(new THREE.Vector4(Je.bones[0],0,0,0));break;case 1:case 3:Ce.skinWeights.push(new THREE.Vector4(Je.weights[0],Je.weights[1],0,0)),Ce.skinIndices.push(new THREE.Vector4(Je.bones[0],Je.bones[1],0,0));break;case 2:Ce.skinWeights.push(new THREE.Vector4(Je.weights[0],Je.weights[1],Je.weights[2],Je.weights[3])),Ce.skinIndices.push(new THREE.Vector4(Je.bones[0],Je.bones[1],Je.bones[2],Je.bones[3]));}}),Ce.MMDmorphs=this.morphs;var We=Ce.morphs_index_by_name=this.morphs_index_by_name={},Xe=Ce.morphs_weight_by_name=this.morphs_weight_by_name={};if(this.morphs.forEach(function(Ye,Je){We[Ye.name]=Je,Xe[Ye.name]=0}),ze=0,Ce.faceVertexUvs[0]=[],this.materials.forEach(function(Ye,Je){var Ze,$e,et,tt,ot,it,rt,nt,st;Ze=new V,Ze.name=Ye.name,Ze._xray_pass=self.MMD_SA&&MMD_SA_options._use_xray&&Be.material_xray_pass&&Be.material_xray_pass.test(Ze.name);var lt=[];Ze._xray_pass&&lt.push({name:"xray_center",value:{type:"v3",value:new THREE.Vector3(999,999,999)}},{name:"xray_radius",value:{type:"f",value:Math.sqrt(3*(MMD_SA_options._xray_radius*MMD_SA_options._xray_radius))}},{name:"xray_opacity",value:{type:"f",value:MMD_SA_options._xray_opacity}});var pt;if(pt=MMD_SA_options.MME.self_overlay,lt.push({name:"self_overlay_opacity",value:{type:"f",value:1}},{name:"self_overlay_brightness",value:{type:"f",value:1}},{name:"self_overlay_color_adjust",value:{type:"v3",value:new THREE.Vector3(1.5,1,1)}}),pt=MMD_SA_options.MME.HDR,lt.push({name:"HDR_opacity",value:{type:"f",value:1}}),pt=MMD_SA_options.MME.serious_shader,lt.push({name:"serious_shader_shadow_opacity",value:{type:"f",value:1}},{name:"OverBright",value:{type:"f",value:1}},{name:"ShadowDarkness",value:{type:"f",value:1}},{name:"ToonPower",value:{type:"f",value:1}},{name:"EyeLightPower",value:{type:"f",value:1}},{name:"serious_shader_mode",value:{type:"i",value:1}}),MMD_SA.MME_shader_inline_switch_mode&&["self_overlay","HDR","serious_shader"].forEach(function(ht){pt=MMD_SA_options.MME[ht],lt.push({name:ht.toUpperCase(),value:{type:"i",value:1}})}),lt.length){var ft={};lt.forEach(function(ht){ft[ht.name]=ht.value}),Ze.uniforms=THREE.UniformsUtils.merge([Ze.uniforms,ft])}var ct=Be.material_para||{};ct=ct[Ze.name]||ct._default_||{},Ze.lights=!0,Ze.skinning=!0,Ze.ambient=Fe(ct.ambient||Ye.ambient),Ze.color=Fe(ct.diffuse||Ye.diffuse),Ze.specular=Fe(ct.specular||Ye.specular),Ze.shininess=Ye.power,Ze.opacity=Ye.alpha,Ze.transparent=null==ct.transparent||ct.transparent,null==ct.side?0!=(1&Ye.drawFlags)&&(Ze.side=THREE.DoubleSide):Ze.side=ct.side,0!=(2&Ye.drawFlags)&&!1!=ct.castShadow?(Ze.castShadow=!0,Ze.shadowMapCullFace=THREE.CullFaceNone):Ze.castShadow=!1,0!=(8&Ye.drawFlags)&&(Ze.mmdShadowDark=Ee.shadowDark),0!=(16&Ye.drawFlags)&&(Ze.mmdEdgeThick=Ye.edgeSize*Ee.edgeScale*(null==Be.edgeScale?1:Be.edgeScale),Ze.mmdEdgeColor=new THREE.Vector4(Ye.edgeColor[0],Ye.edgeColor[1],Ye.edgeColor[2],Ye.edgeColor[3])),0<=Ye.texture&&(Ze.map=Ve(Te.textures[Ye.texture].path,function(){var ht=Ze;return function(){var Mt=ht.map.image=document.createElement("canvas");Mt.width=Mt.height=2;var gt=Mt.getContext("2d");gt.fillStyle="white",gt.fillRect(0,0,2,2),ht.map.needsUpdate=!0}}(),Ze)),ct.normalMap&&!1!==Be.use_normalMap&&(Ze.normalMap=Ve(ct.normalMap,function(){var ht=Ze;return function(){var Mt=ht.map.image=document.createElement("canvas");Mt.width=Mt.height=2;var gt=Mt.getContext("2d");gt.fillStyle="white",gt.fillRect(0,0,2,2),ht.map.needsUpdate=!0}}(),Ze,ct.normalMap_resolution_limit?{texture_resolution_limit:ct.normalMap_resolution_limit}:null),Ze.normalMap.wrapS=Ze.normalMap.wrapT=THREE.RepeatWrapping),tt=null,0===Ye.sharedToon?0<=Ye.toonTexture&&(tt=Te.textures[Ye.toonTexture].path):tt=jThree.MMD.toon[Ye.toonTexture],tt&&(Ze.mmdToonMap=Ve(tt,function(){var ht=Ze;return function(){var Mt=ht.mmdToonMap.image=document.createElement("canvas");Mt.width=Mt.height=2;var gt=Mt.getContext("2d");gt.fillStyle="white",gt.fillRect(0,0,2,2),ht.mmdToonMap.needsUpdate=!0}}())),0<Ye.sphereMode&&0<=Ye.sphereTexture&&(Ze.mmdSphereMode=Ye.sphereMode,Ze.mmdSphereMap=Ve(Te.textures[Ye.sphereTexture].path,function(){var ht=Ze;return function(){var Mt=ht.mmdSphereMap.image=document.createElement("canvas");Mt.width=Mt.height=2;var gt=Mt.getContext("2d");gt.fillStyle="black",gt.fillRect(0,0,2,2),ht.mmdSphereMap.needsUpdate=!0}}())),Ze.setup(),Ie.push(Ze);var ut=Ze._uv_bbox={min:{x:0,y:0},max:{x:1,y:1},face_ini:ze/3,face_end:(ze+Ye.indexCount)/3};for(et=Ye.indexCount/3,Ce._face_index_by_vertex||(Ce._face_index_by_vertex=[]);et--;)tt=Te.indices[ze+2],ot=Te.indices[ze+1],it=Te.indices[ze],$e=new THREE.Face3(tt,ot,it),$e.materialIndex=Je,rt=Te.vertices[tt],nt=Te.vertices[ot],st=Te.vertices[it],[tt,ot,it].forEach(function(ht,Mt){Ce._face_index_by_vertex[ht]||(Ce._face_index_by_vertex[ht]=[]),Ce._face_index_by_vertex[ht].push([Ce.faces.length,Mt])}),Ce.faceVertexUvs[0].push(0<=Ye.texture?[Le(rt.uv),Le(nt.uv),Le(st.uv)]:void 0),0<=Ye.texture&&!MMD_SA.use_webgl2&&Ce.faceVertexUvs[0][ze/3].forEach(function(ht){ht.x<ut.min.x?ut.min.x=ht.x:ht.x>ut.max.x&&(ut.max.x=ht.x),ht.y<ut.min.y?ut.min.y=ht.y:ht.y>ut.max.y&&(ut.max.y=ht.y)}),$e.vertexNormals=[Re(rt.normal),Re(nt.normal),Re(st.normal)],Ce.faces.push($e),ze+=3}),Ce.MMDIKs=[],Ce.bones=[],this.bones.forEach(function(Ye,Je){var Ze,$e;Ye.IK&&(Ye.IK.target=Je,Ce.MMDIKs.push(Ye.IK)),0<=Ye.parent?(Ze=Te.bones[Ye.parent].origin,Ze=[Ye.origin[0]-Ze[0],Ye.origin[1]-Ze[1],Ye.origin[2]-Ze[2]]):Ze=Ye.origin,$e={},$e.parent=Ye.parent,$e.name=Ye.name,$e.pos=Ze,$e.rotq=[0,0,0,1],Ce.bones.push($e)}),Ce.MMDjoints=this.joints,Ce.computeBoundingBox(),Ce.boundingSphere=Ce.boundingBox.getBoundingSphere(),self.MMD_SA&&MMD_SA_options.Dungeon&&!Be.is_object&&!Be.use_default_boundingBox){var qe=Ce.boundingBox.size(),Qe=0.5*(0.5*(qe.x+(qe.z>qe.x?qe.x:qe.z)))*(MMD_SA_options.Dungeon._bb_xz_factor_||1);Ce.boundingBox.min.x=Ce.boundingBox.min.z=-Qe,Ce.boundingBox.max.x=Ce.boundingBox.max.z=Qe,Ce.boundingSphere=Ce.boundingBox.getBoundingSphere(),Ce.boundingSphere.radius*=0.5}console.log("boundingBox/Sphere-"+Te._model_index,Ce.boundingBox,Ce.boundingSphere),Ue.del()},P.prototype.load=function(Ee,Pe){var Te=this;this.url_raw=Ee,this._clone_index=-1,/\#clone(\d+)\.pmx$/.test(Ee)&&(Ee=Ee.replace(/\#clone(\d+)\.pmx$/,".pmx"),this._clone_index=parseInt(RegExp.$1)),_(Ee,function(Ce){Te.url=Ee,Te.texturePath=/\//.test(Ee)?Ee.slice(0,Ee.lastIndexOf("/")+1):"",Te.parse(Ce.response),Pe(Te)})}}(),U=function(re){var ne,se;for(se in ne={},re)re.hasOwnProperty(se)&&(ne[se]=re[se]);return ne},function(){var re,ne,se,de,_e,le,me,pe;re=function(fe){return fe/30},ne=function(fe){fe.sort(function(ce,ue){return ce.time-ue.time})},se=[86,111,99,97,108,111,105,100,32,77,111,116,105,111,110,32,68,97,116,97,32,48,48,48,50],de=function(fe){var ce,ue;for(M.call(this,fe,!0),this.stringMap={},ce=this.readBytes(30),ue=0;ue<se.length;ue++)if(se[ue]!==ce[ue])throw g.MAGIC;this.name=this.readCString(20)},de.prototype=Object.create(M.prototype),de.prototype.constructor=de,de.prototype.readCString=function(fe){var ce,ue,he;for(ce=this.readBytes(fe),ue=0;ue<fe&&0!==ce[ue];ue++);return he=String.fromCharCode.apply(void 0,THREE.MMD.Encoding.SJISToUNICODE(ce.subarray(0,ue))),this.stringMap.hasOwnProperty(he)?he=this.stringMap[he]:this.stringMap[he]=he,he},de.prototype.readVector=function(fe,ce){for(var ue=[];0<fe--;)ue.push(this.readFloat32());return ce&&(ue=ue.map(he=>he*MMD_SA._readVector_scale)),ue},_e=function(fe){this.name=fe.readCString(15),this.time=re(fe.readUint32()),this.pos=A(fe.readVector(3)),this.rot=D(fe.readVector(4)),this.interp=fe.readBytes(64).subarray(0,16)},le=function(fe){this.name=fe.readCString(15),this.time=re(fe.readUint32()),this.weight=fe.readFloat32()},me=function(fe){this.time=re(fe.readUint32()),this.distance=-fe.readFloat32(),this.target=A(fe.readVector(3)),this.rot=D(fe.readVector(3)),this.rot[0]*=-1,this.rot[1]*=-1,this.rot[2]*=-1,this.interp=fe.readBytes(24),this.fov=fe.readUint32(),this.ortho=fe.readInt8()},pe=function(fe){this.time=re(fe.readUint32()),this.color=fe.readVector(3),this.dir=A(fe.readVector(3))},T=function(){},T.prototype.parse=function(fe){var ce,ue;for(ce=new de(fe),this.timeMax=0,this.boneKeys=[],this.morphKeys=[],this.cameraKeys=[],this.lightKeys=[],ue=ce.readUint32();0<ue--;)this.boneKeys.push(new _e(ce));for(ne(this.boneKeys),ue=this.boneKeys.length,0<ue&&(this.timeMax=Math.max(this.timeMax,this.boneKeys[ue-1].time)),ue=ce.readUint32();0<ue--;)this.morphKeys.push(new le(ce));if(ne(this.morphKeys),ue=this.morphKeys.length,0<ue&&(this.timeMax=Math.max(this.timeMax,this.morphKeys[ue-1].time)),this.boneKeys.length||this.morphKeys.length)return void delete ce.stringMap;for(ue=ce.readUint32();0<ue--;)this.cameraKeys.push(new me(ce));for(ne(this.cameraKeys),ue=this.cameraKeys.length,0<ue&&(this.timeMax=Math.max(this.timeMax,this.cameraKeys[ue-1].time)),ue=ce.readUint32();0<ue--;)this.lightKeys.push(new pe(ce));ne(this.lightKeys),ue=this.lightKeys.length,0<ue&&(this.timeMax=Math.max(this.timeMax,this.lightKeys[ue-1].time)),delete ce.stringMap},T.prototype.load=function(fe,ce){self.MMD_SA&&(MMD_SA.vmd_by_filename[decodeURIComponent(fe.replace(/^.+[\/\\]/,"").replace(/\.vmd$/i,""))]=this);var ue=this;_(fe,function(he){ue.url=fe,ue.parse(he.response),ce(ue)})},T.prototype.generateSkinAnimation=function(fe,ce){var ue=self.MMD_SA&&MMD_SA_options.model_para_obj_all[fe._model_index],he=self.MMD_SA&&MMD_SA_options.motion_para[decodeURIComponent(this.url.replace(/^.+[\/\\]/,"").replace(/\.vmd$/i,""))],Me=he&&he.adjustment_per_model&&(he.adjustment_per_model[ue._filename]||he.adjustment_per_model[ue._filename_cleaned]||he.adjustment_per_model._default_);Me=Me&&Me.skin_default||{};var ge=1<MMD_SA_options.model_para_obj_all.length&&he&&(he.model_index_list||he.model_name_RegExp),xe=this,ye,Ae,be;if(ye=this.boneKeys,0===ye.length)return null;var ve=new RegExp("("+toRegExp(["\u8DB3\uFF29\uFF2B","\u3064\u307E\u5148\uFF29\uFF2B"],"|")+")$"),Se=this.timeMax;return he&&he.freeze_onended&&(he.duration=9999,he.random_range_disabled=!0),Ae=he&&he.duration||this.timeMax,be=[],fe.bones.forEach(function(De){if(ce&&!ce.test(De.name))return void be.push({keys:[]});var ke=ue.skin_default[De.name],we=self.MMD_SA&&(Me[De.name]||ke);if(we&&(we.motion_filter&&!we.motion_filter.test(decodeURIComponent(xe.url))||we.model_filter&&!we.model_filter.test(ue._filename))&&(we=null),we){var Ee;ge&&"\u5168\u3066\u306E\u89AA"==De.name&&(!ke||we!=ke)&&we.pos_add?(Ee=we.pos_add_absolute=we.pos_add,delete we.pos_add):Ee=we.pos_add_absolute||ke&&ke.pos_add_absolute,Ee&&(we=Object.assign({},we),we.pos_add=we.pos_add?{x:we.pos_add.x+Ee.x,y:we.pos_add.y+Ee.y,z:we.pos_add.z+Ee.z}:Ee),we.rot_scale&&"number"==typeof we.rot_scale&&(we.rot_scale={x:we.rot_scale,y:we.rot_scale,z:we.rot_scale})}var Pe,Te;Pe=[];var Ce=1<MMD_SA_options.model_para_obj_all.length,Ie=(ue.model_scale||1)*(MMD_SA_options.WebXR?MMD_SA_options.WebXR.model_scale||0.9:1);if(ye.forEach(function(Ue){if(De.name===Ue.name&&((Ce&&we||1!=Ie)&&(Ue=Object.assign({},Ue),Ue.rot=Ue.rot.slice(),Ue.pos=Ue.pos.map(je=>je*Ie)),Te=Ue,Pe.push(Ue),we)){if(we.rot_slerp){we.rot_slerp._frame_=Math.round(30*Ue.time);var ze=MMD_SA.TEMP_q.set(Ue.rot[0],Ue.rot[1],Ue.rot[2],Ue.rot[3]).toAxisAngle();Ue.rot=MMD_SA.TEMP_q.setFromAxisAngle(ze[0],ze[1]*we.rot_slerp).toArray()}if(we.rot_axis){we.rot_axis._frame_=Math.round(30*Ue.time);var Re=new THREE.Vector3,Le;we.rot_axis.x&&(Re.set(1,0,0),Le=we.rot_axis.x),MMD_SA._q1.set(Ue.rot[0],Ue.rot[1],Ue.rot[2],Ue.rot[3]),Re.applyQuaternion(MMD_SA._q1),Ue.rot=MMD_SA.TEMP_q.setFromAxisAngle(Re,Le*Math.PI/180).multiply(MMD_SA._q1).toArray()}if(we.rot_scale&&(we.rot_scale._frame_=Math.round(30*Ue.time),Ue.rot=MMD_SA.TEMP_q.setFromEuler(MMD_SA.TEMP_v3.setEulerFromQuaternion(MMD_SA._q1.set(Ue.rot[0],Ue.rot[1],Ue.rot[2],Ue.rot[3]),"YXZ").multiply(we.rot_scale),"YXZ").toArray()),we.rot_add){we.rot_add._frame_=Math.round(30*Ue.time);var Fe=we.rot_add;Ue.rot=MMD_SA.TEMP_q.set(Ue.rot[0],Ue.rot[1],Ue.rot[2],Ue.rot[3]).multiply(MMD_SA._q1.setFromEuler(MMD_SA.TEMP_v3.set(-Fe.x,Fe.y,-Fe.z).multiplyScalar(Math.PI/180),"YXZ")).toArray()}if(we.pos_scale){we.pos_scale._frame_=Math.round(30*Ue.time);var Ve=we.pos_scale;if(Ve.auto_adjust){var Oe=THREE.MMD.getModels()[fe._model_index].mesh.bones_by_name;if(Oe.){var Be=ue._ref_length=ue._ref_length||{},He=Be[Ue.name];He||(He=Be[Ue.name]=fe.bones[Oe.._index].origin[1]-(-1!=Ue.name.indexOf("\u8DB3\uFF29\uFF2B")&&Oe.?fe.bones[Oe.._index].origin[1]:0)),Ue.pos[1]*=(He/Ve.auto_adjust.ref_length-1)*(Ve.auto_adjust.scale||1)+1}}else Ue.pos[0]*=Ve.x,Ue.pos[1]*=Ve.y,Ue.pos[2]*=Ve.z}if(we.pos_add){we.pos_add._frame_=Math.round(30*Ue.time);var Ve=we.pos_add;Ue.pos[0]+=Ve.x,Ue.pos[1]+=Ve.y,Ue.pos[2]+=-Ve.z}}}),self.MMD_SA){let Ue=we&&(we.pos_add||ke&&ke.pos_add||{x:0,y:0,z:0}),ze=we&&(we.rot_add||ke&&ke.rot_add||{x:0,y:0,z:0}),Re=["x","y","z"];if(we&&(we.keys||!Pe.length&&(we.pos||we.rot||we.pos_add||we.rot_add))){let Le=we.keys?we.keys:[{pos:we.pos,rot:we.rot,time:we.time,interp:we.interp}];Pe=[],Le.forEach(function(Fe){var Ve=Fe.pos,Oe=Fe.rot;Pe.push({name:De.name,time:Fe.time||0,pos:(Ve?[Ve.x,Ve.y,-Ve.z]:[0,0,0]).map((Be,He)=>Be+Ue[Re[He]]*(2==He?-1:1)),rot:MMD_SA.TEMP_q.setFromEuler(MMD_SA.TEMP_v3.fromArray((Oe?[-Oe.x,Oe.y,-Oe.z]:[0,0,0]).map((Be,He)=>Be*Math.PI/180+ze[Re[He]]*(1==He?1:-1))),"YXZ").toArray(),interp:new Uint8Array(Fe.interp||[20,20,20,20,20,20,20,20,107,107,107,107,107,107,107,107])})}),Te=Pe[Pe.length-1]}we&&we.keys_mod&&we.keys_mod.forEach(function(Le){var Fe=Pe.find(function(Be){return Math.round(30*Be.time)==Le.frame});if(Fe){var Ve=Le.pos,Oe=Le.rot;Ve&&(Fe.pos=[Ve.x,Ve.y,-Ve.z].map((Be,He)=>Be+Ue[Re[He]]*(2==He?-1:1))),Oe&&(Fe.rot=MMD_SA.TEMP_q.setFromEuler(MMD_SA.TEMP_v3.fromArray([-Oe.x,Oe.y,-Oe.z].map((Be,He)=>Be*Math.PI/180+ze[Re[He]]*(1==He?1:-1))),"YXZ").toArray()),Le.interp&&(Fe.interp=new Uint8Array(Le.interp))}}),Te&&(1<Pe.length||Te.time<Ae)&&/guitar|g_head|g_bridge|f_board|\u8155\uFF29\uFF2B/.test(De.name)&&(xe.use_armIK=!0)}if(Te&&Te.time<Ae&&(Te=U(Te),Te.time=Ae,Pe.push(Te)),(!he||!he.IK_disabled||he.IK_disabled._IK_name_list)&&ve.test(De.name)){let Ue;if(1>=Pe.length)Ue=!0;else if(2==Pe.length){let ze=Pe[Pe.length-1],Re=ze.pos,Le=ze.rot;0==Re[0]&&0==Re[1]&&0==Re[2]&&0==Le[0]&&0==Le[1]&&0==Le[2]&&(Ue=!0)}if(Ue){let ze=decodeURIComponent(xe.url.replace(/^.+[\/\\]/,"").replace(/\.vmd$/i,""));he=MMD_SA_options.motion_para[ze]=MMD_SA_options.motion_para[ze]||{},he.IK_disabled=he.IK_disabled||{test:function(Re){return-1!=this._IK_name_list.indexOf(Re)},_IK_name_list:[]},he.IK_disabled._IK_name_list.push(De.name)}}be.push({keys:Pe})}),he&&he.IK_disabled&&he.IK_disabled._IK_name_list&&(he.IK_disabled._IK_name_list=he.IK_disabled._IK_name_list.filter(function(De){return-1==De.indexOf("\u3064\u307E\u5148\uFF29\uFF2B")||-1!=he.IK_disabled._IK_name_list.indexOf(De.charAt(0)+"\u8DB3\uFF29\uFF2B")}),0==he.IK_disabled._IK_name_list.length?delete he.IK_disabled:console.log("IK disabled auto:",decodeURIComponent(xe.url.replace(/^.+[\/\\]/,"").replace(/\.vmd$/i,"")))),{_timeMax:Se,duration:Ae,targets:be}},T.prototype.generateMorphAnimation=function(fe,ce){var ue=self.MMD_SA&&MMD_SA_options.model_para_obj_all[fe._model_index],he,Me,ge;if(he=this.morphKeys,0===he.length&&(!self.MMD_SA||ue.morph_default._is_empty))return null;Me=this.timeMax,ge=[];var xe=self.MMD_SA&&ue.morph_filter,ye=this,Ae=[],be=self.MMD_SA&&MMD_SA_options.motion_para[decodeURIComponent(this.url.replace(/^.+[\/\\]/,"").replace(/\.vmd$/i,""))],ve=be&&be.adjustment_per_model&&(be.adjustment_per_model[ue._filename]||be.adjustment_per_model[ue._filename_cleaned]||be.adjustment_per_model._default_);ve=ve&&ve.morph_default||{},Me=be&&be.duration||Me;var Se=[];return MMD_SA_options.auto_blink&&(Se[fe.morphs_index_by_name.]=!0),fe.morphs.forEach(function(De,ke){if(0==De.type&&(!ce||ce.test(De.name))&&(!xe||xe.test(De.name))){var we=self.MMD_SA&&(ve[De.name]||ue.morph_default[De.name]);we&&we.motion_filter&&!we.motion_filter.test(decodeURIComponent(ye.url))&&(we=null);var Ee;if(Se[ke]||we&&(!we.weight_scale||we.weight||we.keys))Ee=!0;else for(var Pe=0,Te=he.length,Ce;Pe<Te;Pe++)if(Ce=he[Pe],De.name===Ce.name&&0<Ce.weight){Ee=!0;break}Ee&&De.items.forEach(function(Ie){Se[Ie.target]=!0})}}),fe.morphs.forEach(function(De,ke){if((!ce||ce.test(De.name))&&(!xe||xe.test(De.name))){var Pe=0,Te=self.MMD_SA&&(ve[De.name]||ue.morph_default[De.name]),we,Ee;we=[];var Ce=1<MMD_SA_options.model_para_obj_all.length;if(he.forEach(function(Ie){De.name===Ie.name&&(Ce&&(Ie=Object.assign({},Ie)),Ee=Ie,we.push(Ie),Ie.morph_type=De.type,Ie.morph_index=ke,Te&&Te.weight_scale&&(Ie.weight*=Te.weight_scale),Pe=Math.max(Pe,Ie.weight))}),(!Pe||Te&&Te.keys)&&(we=[],Ee=void 0,Te&&(!Te.weight_scale||Te.weight||Te.keys)?(Te.keys?Te.keys.forEach(function(Ie){we.push({name:De.name,weight:Ie.weight,time:Ie.time,morph_type:De.type,morph_index:ke})}):we.push({name:De.name,weight:0===Te.weight?0:Te.weight||1,time:Te.time||0,morph_type:De.type,morph_index:ke}),Ee=we[we.length-1]):Se[ke]&&(we.push({name:De.name,weight:0,time:0,morph_type:De.type,morph_index:ke}),Ee=we[we.length-1])),!Ee)return;Ee.time<Me&&(Ee=U(Ee),Ee.time=Me,we.push(Ee)),1==De.type?ge.push({keys:we}):Ae.push({keys:we})}}),ge=ge.concat(Ae),0===ge.length,{duration:Me,targets:ge}},T.prototype.generateCameraAnimation=function(){var fe,ce,ue,he;return(fe=this.cameraKeys,0===fe.length)?null:(ce=this.timeMax,ue=[],fe.forEach(function(Me){he=Me,ue.push(Me)}),he&&he.time<ce&&(he=U(he),he.time=ce,ue.push(he)),{duration:ce,keys:ue})},T.prototype.generateLightAnimation=function(){var fe,ce,ue,he;return(fe=this.lightKeys,0===fe.length)?null:(ce=this.timeMax,ue=[],fe.forEach(function(Me){he=Me,ue.push(Me)}),he&&he.time<ce&&(he=U(he),he.time=ce,ue.push(he)),{duration:ce,keys:ue})}}(),F={uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,THREE.UniformsLib.uniTexture,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)},MMDShadow:{type:"f",value:0},mmdToonMap:{type:"t",value:null},mmdSphereMap:{type:"t",value:null},mmdEdgeThick:{type:"f",value:0},mmdEdgeColor:{type:"v4",value:new THREE.Vector4(0,0,0,1)},mmdShadowDark:{type:"f",value:0}}]),vertexShader:"#define MMD\n#define PHONG\nvarying vec3 vViewPosition;varying vec3 vNormal;\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;uniform vec4 offsetRepeat;\n#endif\n#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif\n#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvarying vec3 vReflect;uniform float refractionRatio;uniform bool useRefract;\n#endif\n#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];uniform float pointLightDistance[ MAX_POINT_LIGHTS ];varying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n"+THREE.ShaderChunk.uniTexture_pars_vertex+"\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined(USE_XRAY_PASS)\nvarying vec3 vWorldPosition;\n#endif\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif\n#ifdef USE_SKINNING\n#ifdef BONE_TEXTURE\nuniform sampler2D boneTexture;mat4 getBoneMatrix( const in float i ) {float j = i * 4.0;float x = mod( j, N_BONE_PIXEL_X );float y = floor( j / N_BONE_PIXEL_X );const float dx = 1.0 / N_BONE_PIXEL_X;const float dy = 1.0 / N_BONE_PIXEL_Y;y = dy * ( y + 0.5 );vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );mat4 bone = mat4( v1, v2, v3, v4 );return bone;}\n#else\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];mat4 getBoneMatrix( const in float i ) {mat4 bone = boneGlobalMatrices[ int(i) ];return bone;}\n#endif\n#endif\n#ifdef USE_SHADOWMAP\nvarying vec3 normal_untransformed;varying vec4 vShadowCoord[ MAX_SHADOWS ];uniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif\n#ifdef MMD\nuniform float mmdEdgeThick;\n#endif\n#ifdef MMD_SPHEREMAP\nvarying vec2 vUvSphere;\n#endif\nvoid main() {\n#ifdef USE_SKINNING\nmat4 skinMatrix;\n#ifdef MMD\nskinMatrix  = skinWeight.x * getBoneMatrix( skinIndex.x );if ( skinWeight.y > 0.0 ) {skinMatrix += skinWeight.y * getBoneMatrix( skinIndex.y );if ( skinWeight.z > 0.0 ) {skinMatrix += skinWeight.z * getBoneMatrix( skinIndex.z );skinMatrix += skinWeight.w * getBoneMatrix( skinIndex.w );}}\n#else\nskinMatrix =skinWeight.x * getBoneMatrix( skinIndex.x ) +skinWeight.y * getBoneMatrix( skinIndex.y );\n#endif\n#endif\nvec3 objectNormal = normal;\n#ifdef USE_MORPHNORMALS\n"+function(){let re="";for(let ne=0;4>ne;ne++)re+="objectNormal += ( morphNormal"+ne+" - normal ) * morphTargetInfluences[ "+ne+" ];\n";return re}()+"#endif\n#ifdef USE_SKINNING\nobjectNormal.xyz = ( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\n#ifdef USE_SHADOWMAP\n  normal_untransformed = normalize(mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal);\n#endif\nvNormal = normalize( normalMatrix * objectNormal );vec3 objectPosition = position;\n#ifdef USE_MORPHTARGETS\n"+function(){let re="";for(let ne=0;8>ne;ne++)re+="objectPosition += ( morphTarget"+ne+" - position ) * morphTargetInfluences[ "+ne+" ];\n";return re}()+"#endif\n#ifdef USE_UNI_TEXTURE\n  vec3 uniTexture_pos = objectPosition;\n#endif\n#ifdef USE_SKINNING\nobjectPosition.xyz = ( skinMatrix * vec4( objectPosition, 1.0 ) ).xyz;\n#endif\nvec4 mvPosition = modelViewMatrix * vec4( objectPosition, 1.0 );gl_Position = projectionMatrix * mvPosition;\n#ifdef MMD\nif (mmdEdgeThick > 0.0) {\n#ifdef USE_XRAY_PASS\nvWorldPosition = (modelMatrix * vec4( objectPosition, 1.0 )).xyz;\n#endif\nvec2 offset;offset.x = vNormal.x * projectionMatrix[0][0] / projectionMatrix[1][1];offset.y = vNormal.y;gl_Position.xy += offset * gl_Position.w * mmdEdgeThick;return;}\n#endif\nvViewPosition = -mvPosition.xyz;\n#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\nvec4 worldPosition = modelMatrix * vec4( objectPosition, 1.0 );\n#endif\n#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;worldNormal = normalize( worldNormal );vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );if ( useRefract ) {vReflect = refract( cameraToVertex, worldNormal, refractionRatio );} else {vReflect = reflect( cameraToVertex, worldNormal );}\n#endif\n#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );vec3 lVector = lPosition.xyz - mvPosition.xyz;float lDistance = 1.0;if ( pointLightDistance[ i ] > 0.0 )lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );vPointLight[ i ] = vec4( lVector, lDistance );}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );vec3 lVector = lPosition.xyz - mvPosition.xyz;float lDistance = 1.0;if ( spotLightDistance[ i ] > 0.0 )lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );vSpotLight[ i ] = vec4( lVector, lDistance );}\n#endif\n#endif\n#ifdef USE_UNI_TEXTURE\n"+["uniTexture_pos = uniTexture_pos - vec3(uniTexture_bs, -uniTexture_bs, uniTexture_bs) * 10.;","uniTexture_MatrixRain_opacity = (uniTexture_MatrixRain_height_limit.x > 0.0) ? clamp((1.0 - (uniTexture_MatrixRain_height_limit.y + uniTexture_bs - position.y) / (uniTexture_bs * 2.0) - uniTexture_MatrixRain_height_limit.x) / (uniTexture_MatrixRain_height_limit.x*0.25), 0.0, 1.0) : 1.0;","uniTexture_vUv = vec2(-length(uniTexture_pos.xz), length(uniTexture_pos.yz)) * 0.1 / uniTexture_scale;","#if !(MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined(USE_XRAY_PASS))","  vWorldPosition = worldPosition.xyz;","#endif"].join("\n")+"\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined(USE_XRAY_PASS)\nvWorldPosition = worldPosition.xyz;\n#endif\n#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;}\n#endif\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif\n#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif\n#ifdef MMD_SPHEREMAP\nvUvSphere = vNormal.xy * 0.5 + 0.5;vUvSphere.y = 1.0 - vUvSphere.y;\n#endif\n#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif\n}",fragmentShader:"#define MMD\nuniform vec3 diffuse;uniform float opacity;uniform vec3 ambient;uniform vec3 emissive;uniform vec3 specular;uniform float shininess;\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif\n#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;uniform sampler2D lightMap;\n#endif\n#ifdef USE_ENVMAP\nuniform float reflectivity;uniform samplerCube envMap;uniform float flipEnvMap;uniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;uniform float refractionRatio;\n#else\nvarying vec3 vReflect;\n#endif\n#endif\n#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;uniform float fogFar;\n#endif\n#endif\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n"+THREE.ShaderChunk.uniTexture_pars_fragment+"\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined(USE_XRAY_PASS)\nvarying vec3 vWorldPosition;\n#endif\n#ifdef USE_XRAY_PASS\nuniform vec3 xray_center;\nuniform float xray_radius;\nuniform float xray_opacity;\n#endif\n"+MMD_SA.MME_shader("HDR").fvar+MMD_SA.MME_shader("self_overlay").fvar+MMD_SA.MME_shader("serious_shader").fvar+"#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;varying vec3 vNormal;\n#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];uniform vec2 shadowMapSize[ MAX_SHADOWS ];uniform float shadowDarkness[ MAX_SHADOWS ];uniform vec3 shadowBias[ MAX_SHADOWS ];uniform vec3 shadowPara[ MAX_SHADOWS ];varying vec3 normal_untransformed;varying vec4 vShadowCoord[ MAX_SHADOWS ];float unpackDepth( const in vec4 rgba_depth ) {const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );float depth = dot( rgba_depth, bit_shift );return depth;}\n#endif\n#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;uniform float bumpScale;vec2 dHdxy_fwd() {vec2 dSTdx = dFdx( vUv );vec2 dSTdy = dFdy( vUv );float Hll = bumpScale * texture2D( bumpMap, vUv ).x;float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;return vec2( dBx, dBy );}vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {vec3 vSigmaX = dFdx( surf_pos );vec3 vSigmaY = dFdy( surf_pos );vec3 vN = surf_norm;vec3 R1 = cross( vSigmaY, vN );vec3 R2 = cross( vN, vSigmaX );float fDet = dot( vSigmaX, R1 );vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );return normalize( abs( fDet ) * surf_norm - vGrad );}\n#endif\n#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;uniform vec2 normalScale;vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {vec3 q0 = dFdx( eye_pos.xyz );vec3 q1 = dFdy( eye_pos.xyz );vec2 st0 = dFdx( vUv.st );vec2 st1 = dFdy( vUv.st );vec3 S = normalize(  q0 * st1.t - q1 * st0.t );vec3 T = normalize( -q0 * st1.s + q1 * st0.s );vec3 N = normalize( surf_norm );vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;mapN.xy = normalScale * mapN.xy;mat3 tsn = mat3( S, T, N );return normalize( tsn * mapN );}\n#endif\n#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif\n#ifdef MMD\nuniform float MMDShadow;uniform float mmdEdgeThick;uniform vec4 mmdEdgeColor;uniform float mmdShadowDark;\n#endif\n#ifdef MMD_TOONMAP\nuniform sampler2D mmdToonMap;\n#endif\n#ifdef MMD_SPHEREMAP\nvarying vec2 vUvSphere;uniform sampler2D mmdSphereMap;\n#endif\n"+THREE.ShaderChunk.AT_depth_render_mode_pars_fragment+"\n"+["vec3 YCbCrtoRGB(float Y, float Cb, float Cr) {","    float R = Y - 0.000982 * Cb + 1.401845 * Cr;","    float G = Y - 0.345117 * Cb - 0.714291 * Cr;","    float B = Y + 1.771019 * Cb - 0.000154 * Cr;","    return vec3( R, G, B );","}"].join("\n")+"\nvoid main() {\n"+THREE.ShaderChunk.AT_depth_render_mode_fragment+"\n#ifdef MMD\nif (mmdEdgeThick > 0.0) {gl_FragColor = mmdEdgeColor;} else {\n#endif\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );vec4 texelColor;\n#ifdef USE_MAP\ntexelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif\n#ifdef MMD_SPHEREMAP\ntexelColor = texture2D( mmdSphereMap, vUvSphere );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\n#if MMD_SPHEREMAP == 1\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz + texelColor.xyz;\n#endif\n#endif\nvec4 ShadowColor;\nfloat Y, Cb, Cr;\nvec3 shadowColor = vec3( 1.0 );\n#ifdef MAX_DIR_LIGHTS\nfloat comp_list[MAX_DIR_LIGHTS];\n#endif\n"+MMD_SA.MME_shader_branch("SERIOUS_SHADER",!0)+"ShadowColor = vec4(gl_FragColor.rgb, 1.0);\n"+MMD_SA.MME_shader_branch("SERIOUS_SHADER",!1)+"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif\nfloat specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );specularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif\nvec3 normal = vNormal;vec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\nvec3 totalDiffuse = vec3( 0.0 );vec3 totalSpecular = vec3( 0.0 );\n#ifdef MMD\nvec3 totalToon = vec3( 0.0 );\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );vec3 lVector = lPosition.xyz + vViewPosition.xyz;float lDistance = 1.0;if ( pointLightDistance[ i ] > 0.0 )lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );lVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );float lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\n#ifdef MMD\n#ifdef MMD_TOONMAP\ntotalToon += (1.0 - totalToon) * texture2D( mmdToonMap, vec2( 0.0, 1.0 - ( 0.5 * dotProduct + 0.5 ) ) ).xyz;\n#else\ntotalToon += (1.0 - totalToon) * vec3( 1.0 );\n#endif\ntotalDiffuse += (1.0 - totalDiffuse) * diffuse * pointLightColor[ i ] * lDistance;\n#else\ntotalDiffuse += (1.0 - totalDiffuse) * diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\n#endif\nvec3 pointHalfVector = normalize( lVector + viewPosition );float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );float pointSpecularWeight = specularStrength * pow( pointDotNormalHalf, shininess );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );totalSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n#else\ntotalSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );vec3 lVector = lPosition.xyz + vViewPosition.xyz;float lDistance = 1.0;if ( spotLightDistance[ i ] > 0.0 )lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );lVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );float lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );if ( spotEffect > spotLightAngleCos[ i ] ) {spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );float dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\n#ifdef MMD\n#ifdef MMD_TOONMAP\ntotalToon += (1.0 - totalToon) * texture2D( mmdToonMap, vec2( 0.0, 1.0 - ( 0.5 * dotProduct + 0.5 ) ) ).xyz;\n#else\ntotalToon += (1.0 - totalToon) * vec3( 1.0 );\n#endif\ntotalDiffuse += (1.0 - totalDiffuse) * diffuse * spotLightColor[ i ] * lDistance * spotEffect;\n#else\ntotalDiffuse += (1.0 - totalDiffuse) * diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\n#endif\nvec3 spotHalfVector = normalize( lVector + viewPosition );float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );float spotSpecularWeight = specularStrength * pow( spotDotNormalHalf, shininess );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );totalSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n#else\ntotalSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\n#endif\n}}\n#endif\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );vec3 dirVector = normalize( lDirection.xyz );float dotProduct = dot( normal, dirVector );\n"+MMD_SA.MME_shader_branch("SERIOUS_SHADER",!0)+"comp_list[i] = dotProduct;\n"+MMD_SA.MME_shader_branch("SERIOUS_SHADER",!1)+"#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\n#ifdef MMD\n#ifdef MMD_TOONMAP\ntotalToon += (1.0 - totalToon) * texture2D( mmdToonMap, vec2( 0.0, 1.0 - ( 0.5 * dotProduct + 0.5 ) ) ).xyz;\n#else\ntotalToon += (1.0 - totalToon) * vec3( 1.0 );\n#endif\ntotalDiffuse += (1.0 - totalDiffuse) * diffuse * directionalLightColor[ i ];\n#else\ntotalDiffuse += (1.0 - totalDiffuse) * diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\n#endif\nvec3 dirHalfVector = normalize( dirVector + viewPosition );float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );float dirSpecularWeight = specularStrength * pow( dirDotNormalHalf, shininess );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );totalSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ntotalSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );vec3 lVector = normalize( lDirection.xyz );float dotProduct = dot( normal, lVector );float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n#ifdef MMD\n#ifdef MMD_TOONMAP\ntotalToon += (1.0 - totalToon) * texture2D( mmdToonMap, vec2( 0.0, 1.0 - hemiDiffuseWeight ) ).xyz;\n#else\ntotalToon += (1.0 - totalToon) * vec3( 1.0 );\n#endif\n#endif\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );totalDiffuse += (1.0 - totalDiffuse) * diffuse * hemiColor;vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;float hemiSpecularWeightSky = specularStrength * pow( hemiDotNormalHalfSky, shininess );vec3 lVectorGround = -lVector;vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;float hemiSpecularWeightGround = specularStrength * pow( hemiDotNormalHalfGround, shininess );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );float specularNormalization = ( shininess + 2.0001 ) / 8.0;vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );totalSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\ntotalSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\n#ifdef MMD\ntotalSpecular = max( totalSpecular, 0.0 );\n#endif\n#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif\n#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, opacity );\n#endif\n#ifdef USE_ENVMAP\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );if ( useRefract ) {reflectVec = refract( cameraToVertex, normal, refractionRatio );} else {reflectVec = reflect( cameraToVertex, normal );}\n#else\nreflectVec = vReflect;\n#endif\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );vec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );} else if ( combine == 2 ) {gl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;} else {gl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );}\n#endif\n#ifdef USE_SHADOWMAP\n#ifdef MMD\nif (mmdShadowDark > 0.0) {\n#endif\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];frustumColors[0] = vec3( 1.0, 0.5, 0.0 );frustumColors[1] = vec3( 0.0, 1.0, 0.8 );frustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;vec3 SP;\n#pragma unroll_loop\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {//LOOP_START\nSP = shadowPara[i];vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );bool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );if ( frustumTest ) {shadowCoord.z += shadowBias[ i ].x * clamp(abs(tan(acos(clamp(dot(directionalLightDirection[ int(SP.y) ], normal_untransformed), -1., 1.)))), shadowBias[ i ].y, shadowBias[ i ].z);\n#ifdef MMD\nfloat darkness = mmdShadowDark;\n#else\nfloat darkness = shadowDarkness[ i ];\n#endif\n#if defined( SHADOWMAP_TYPE_PCF )\nfloat shadow = 0.0;const float shadowDelta = 1.0 / 9.0;float xPixelOffset = 1.0 / shadowMapSize[ i ].x;float yPixelOffset = 1.0 / shadowMapSize[ i ].y;float dx0 = -1.25 * xPixelOffset;float dy0 = -1.25 * yPixelOffset;float dx1 = 1.25 * xPixelOffset;float dy1 = 1.25 * yPixelOffset;fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );if ( fDepth < shadowCoord.z ) shadow += shadowDelta;fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );if ( fDepth < shadowCoord.z ) shadow += shadowDelta;fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );if ( fDepth < shadowCoord.z ) shadow += shadowDelta;fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );if ( fDepth < shadowCoord.z ) shadow += shadowDelta;fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );if ( fDepth < shadowCoord.z ) shadow += shadowDelta;fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );if ( fDepth < shadowCoord.z ) shadow += shadowDelta;fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );if ( fDepth < shadowCoord.z ) shadow += shadowDelta;fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );if ( fDepth < shadowCoord.z ) shadow += shadowDelta;fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );if ( fDepth < shadowCoord.z ) shadow += shadowDelta;shadowColor = shadowColor * vec3( ( 1.0 - darkness * shadow ) );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nfloat shadow = 0.0;float xPixelOffset = 1.0 / shadowMapSize[ i ].x;float yPixelOffset = 1.0 / shadowMapSize[ i ].y;float dx0 = -1.0 * xPixelOffset;float dy0 = -1.0 * yPixelOffset;float dx1 = 1.0 * xPixelOffset;float dy1 = 1.0 * yPixelOffset;mat3 shadowKernel;mat3 depthKernel;depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );vec3 shadowZ = vec3( shadowCoord.z );shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));shadowKernel[0] *= vec3(0.25);shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));shadowKernel[1] *= vec3(0.25);shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));shadowKernel[2] *= vec3(0.25);vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );vec4 shadowValues;shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );shadow = dot( shadowValues, vec4( 1.0 ) );shadowColor = shadowColor * vec3( ( 1.0 - darkness * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );float fDepth = unpackDepth( rgbaDepth );if ( fDepth < shadowCoord.z )shadowColor = shadowColor * vec3( 1.0 - darkness );\n#endif\n}//LOOP_END\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\n"+MMD_SA.MME_shader_branch("SERIOUS_SHADER",!0,!0)+"Y  =  0.298912 * gl_FragColor.r + 0.586611 * gl_FragColor.g + 0.114478 * gl_FragColor.b;\nCb = -0.168736 * gl_FragColor.r - 0.331264 * gl_FragColor.g + 0.5      * gl_FragColor.b;\nCr =  0.5      * gl_FragColor.r - 0.418688 * gl_FragColor.g - 0.081312 * gl_FragColor.b;\nshadowColor.x = mix(1.0-MMDShadow,1.0, shadowColor.x);\ngl_FragColor.rgb = mix(clamp(YCbCrtoRGB(Y*shadowColor.x, Cb, Cr), vec3(0.),vec3(1.)), gl_FragColor.xyz*shadowColor.x, 0.5);\n"+MMD_SA.MME_shader_branch("SERIOUS_SHADER",!1)+"#ifdef MMD\n}\n#endif\n#endif\n"+MMD_SA.MME_shader("serious_shader").fshader+MMD_SA.MME_shader_branch("SERIOUS_SHADER",!0,!0)+"#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif\n#ifdef MMD_TOONMAP\ngl_FragColor.xyz *= totalToon;\n#endif\n"+MMD_SA.MME_shader_branch("SERIOUS_SHADER",!1)+"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif\n#ifdef MMD\n}\n#endif\n#ifdef USE_XRAY_PASS\nfloat xray_distance = distance(vWorldPosition, xray_center);\nif (xray_distance < xray_radius) {\n  float xray_ratio = (1.0 - xray_distance/xray_radius) * 5.0;\n  gl_FragColor.a *= mix(1.0, xray_opacity, ((xray_ratio>1.0)?1.0:xray_ratio));\n}\n#endif\n"+MMD_SA.MME_shader("HDR").fshader+MMD_SA.MME_shader("self_overlay").fshader+THREE.ShaderChunk.uniTexture_fragment+"\n#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif\n}"},V=function(re){THREE.ShaderMaterial.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.specular=new THREE.Color(1118481),this.shininess=30,this.metal=!1,this.perPixel=!1,this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=0.98,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.castShadow=!0,this.shadowMapCullFace=THREE.CullFaceFront,this.mmdToonMap=null,this.mmdSphereMap=null,this.mmdSphereMode=0,this.mmdEdgeColor=new THREE.Vector4(0,0,0,1),this.mmdEdgeThick=0,this.mmdShadowDark=0,this.passes=1,this.preRenderPass=null,this.postRenderPass=null,this.uniforms=THREE.UniformsUtils.clone(F.uniforms),this.vertexShader=F.vertexShader,this.fragmentShader=F.fragmentShader,this.setValues(re)},V.prototype=Object.create(THREE.ShaderMaterial.prototype),V.prototype.constructor=V,self.MMD_SA&&(V.prototype._passes=1,Object.defineProperty(V.prototype,"passes",{get:function(){return MMD_SA._mirror_rendering_?1:this._passes},set:function(re){this._passes=re}})),V.prototype._castShadow=!0,Object.defineProperty(V.prototype,"castShadow",{get:function(){return!!this.opacity&&this._castShadow},set:function(re){this._castShadow=re}}),V.prototype.setup=function(){0>=this.opacity?(this.passes=-1,this.preRenderPass=this.postRenderPass=null):0<this.mmdEdgeThick?(this.passes=2,this.preRenderPass=function(re,ne){var se,de,_e;return se=re.context,0===ne?(this.side===THREE.DoubleSide?se.disable(se.CULL_FACE):(se.enable(se.CULL_FACE),se.cullFace(se.BACK)),de=0,_e=!1):(se.enable(se.CULL_FACE),se.cullFace(se.FRONT),de=2*this.mmdEdgeThick/re.getViewportHeight(),_e=0>=de),se.uniform1f(this.program.uniforms.mmdEdgeThick,de),_e},this.postRenderPass=function(re){var se;se=re.context,se.enable(se.CULL_FACE),se.cullFace(se.BACK)}):(this.passes=1,this.preRenderPass=function(re){var se;se=re.context,this.side===THREE.DoubleSide?se.disable(se.CULL_FACE):(se.enable(se.CULL_FACE),se.cullFace(se.BACK))},this.postRenderPass=function(re){var se;se=re.context,se.enable(se.CULL_FACE),se.cullFace(se.BACK)}),this.mmdToonMap?this.defines.MMD_TOONMAP="":delete this.defines.MMD_TOONMAP,this.mmdSphereMap?this.defines.MMD_SPHEREMAP=this.mmdSphereMode.toString():delete this.defines.MMD_SPHEREMAP,this._xray_pass&&(this.defines.USE_XRAY_PASS=""),this.needsUpdate=!0},V.prototype.refreshUniforms=function(re){var ne=this,se=this.mesh,de=this._original_value,_e=this.opacity,ue=se._material_morph[this.name],le,me,pe,fe,ce;if(ue){de||(de=this._original_value={},de.opacity=this.opacity,de.mmdEdgeColor=this.mmdEdgeColor.clone(),de.diffuse=[this.color.r,this.color.g,this.color.b],de.specular=[this.specular.r,this.specular.g,this.specular.b],de.ambient=[this.ambient.r,this.ambient.g,this.ambient.b]),le=de.opacity,me=de.mmdEdgeColor.w,pe=de.diffuse.slice(0),fe=de.specular.slice(0),ce=de.ambient.slice(0);var he=Object.keys(ue).sort(function(Ee,Pe){return Ee-Pe});he.forEach(function(Ee){var Pe=ue[Ee],Te=Pe.weight;if(Te){0>Te&&(Te=0),MMD_SA._mirror_rendering_||(Pe.weight?(Pe.weight=-1,ne._render_once=!0):Pe.weight=0);var Ce=Pe.morph_obj,Ie;if(0==Ce.operator)Ie=Te*Ce.alpha+(1-Te),le*=Ie,me*=Ie;else{if(Ie=Te*Ce.alpha,le+=Ie,me+=Ie,Ce.diffuse.find(function(ze){return!!ze}))for(var Ue=0;3>Ue;Ue++)pe[Ue]+=Ce.diffuse[Ue]*Te;if(Ce.specular.find(function(ze){return!!ze}))for(var Ue=0;3>Ue;Ue++)fe[Ue]+=Ce.specular[Ue]*Te;if(Ce.ambient.find(function(ze){return!!ze}))for(var Ue=0;3>Ue;Ue++)ce[Ue]+=Ce.ambient[Ue]*Te}1<le?le=1:0>le&&(le=0),1<me?me=1:0>me&&(me=0)}}),this.opacity=le,this.mmdEdgeColor.w=me,this.color.setRGB(pe[0],pe[1],pe[2]),this.specular.setRGB(fe[0],fe[1],fe[2]),this.ambient.setRGB(ce[0],ce[1],ce[2])}else de?(le=this.opacity=de.opacity,this.mmdEdgeColor.w=de.mmdEdgeColor.w,this.color.setRGB(de.diffuse[0],de.diffuse[1],de.diffuse[2]),this.specular.setRGB(de.specular[0],de.specular[1],de.specular[2]),this.ambient.setRGB(de.ambient[0],de.ambient[1],de.ambient[2])):le=_e;0==_e?0<le&&this.setup():0==le&&this.setup();var Me=this.uniforms;Me.opacity.value=this.opacity,re.gammaInput?Me.diffuse.value.copyGammaToLinear(this.color):Me.diffuse.value=this.color,Me.map.value=this.map,Me.lightMap.value=this.lightMap,Me.specularMap.value=this.specularMap,this.bumpMap&&(Me.bumpMap.value=this.bumpMap,Me.bumpScale.value=this.bumpScale),this.normalMap&&(Me.normalMap.value=this.normalMap,Me.normalScale.value.copy(this.normalScale));var ge;if(this.map?ge=this.map:this.specularMap?ge=this.specularMap:this.normalMap?ge=this.normalMap:this.bumpMap&&(ge=this.bumpMap),void 0!=ge){var xe=ge.offset,ye=ge.repeat;Me.offsetRepeat.value.set(xe.x,xe.y,ye.x,ye.y)}if(Me.envMap.value=this.envMap,Me.flipEnvMap.value=this.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,Me.reflectivity.value=re.gammaInput?this.reflectivity:this.reflectivity,Me.refractionRatio.value=this.refractionRatio,Me.combine.value=this.combine,Me.useRefract.value=this.envMap&&this.envMap.mapping instanceof THREE.CubeRefractionMapping,Me.shininess.value=this.shininess,re.gammaInput?(Me.ambient.value.copyGammaToLinear(this.ambient),Me.emissive.value.copyGammaToLinear(this.emissive),Me.specular.value.copyGammaToLinear(this.specular)):(Me.ambient.value=this.ambient,Me.emissive.value=this.emissive,Me.specular.value=this.specular),this.wrapAround&&Me.wrapRGB.value.copy(this.wrapRGB),this.mmdToonMap&&(Me.mmdToonMap.value=this.mmdToonMap),this.mmdSphereMap&&(Me.mmdSphereMap.value=this.mmdSphereMap),self.MMD_SA){var Ae=se._model_index,be=THREE.MMD.getModels()[Ae];if(!this._MME_uniforms_updated_||0==Ae&&MMD_SA._MME_uniforms_updated_&&MMD_SA._MME_uniforms_updated_>this._MME_uniforms_updated_){var ve=0==Ae?MMD_SA_options.MME:MMD_SA_options.model_para_obj_all[Ae].MME,Se;Se=ve.self_overlay,Me.self_overlay_opacity.value=Se.opacity||0.5,Me.self_overlay_brightness.value=null==Se.brightness?0.5:Se.brightness;var De=Se.color_adjust||[1.5,1,1];Me.self_overlay_color_adjust.value.set(De[0],De[1],De[2]),Se=ve.HDR,Me.HDR_opacity.value=Se.opacity||0.5,Se=ve.serious_shader,Me.serious_shader_shadow_opacity.value=(Se.shadow_opacity||0.5)*Math.min(1,(Se.material&&Se.material[this.name]&&Se.material[this.name].shadow_opacity_scale||1)*(MMD_SA_options.use_shadowMap?1+MMD_SA_options.shadow_darkness:1)),Me.OverBright.value=(Se.OverBright||("AdultShaderS2"==Se.type?1.15:1.2))+MMD_SA_options.SeriousShader_OverBright_adjust,Me.ShadowDarkness.value=Se.ShadowDarkness||("SeriousShader"==Se.type?0.6:1),Me.ToonPower.value=Se.ToonPower||("SeriousShader"==Se.type?1.5:"AdultShaderS2"==Se.type?1.1:1),Me.EyeLightPower.value=Se.EyeLightPower||("AdultShaderS2"==Se.type?0.7:2),Me.serious_shader_mode.value="AdultShaderS"==Se.type?2:"AdultShaderS2"==Se.type?1:0,MMD_SA.MME_shader_inline_switch_mode&&["self_overlay","HDR","serious_shader"].forEach(function(Ee){Se=ve[Ee],Me[Ee.toUpperCase()].value=null==Se.enabled||Se.enabled?1:0}),this._MME_uniforms_updated_=Date.now()}else 0==Ae&&MMD_SA._MME_uniforms_updated_&&(DEBUG_show("(MMD shader updated)",2),MMD_SA._MME_uniforms_updated_=0);if(this._xray_pass){var ke=MMD_SA_options.mesh_obj_by_id.XrayMESH;if(ke&&ke.visible){Me.xray_center.value.copy(ke._obj.position);var we=(Date.now()-ke._start_time)/1e3;Me.xray_opacity.value=MMD_SA_options._xray_opacity+(1-MMD_SA_options._xray_opacity)*(1-(1<we?1:we))}else Me.xray_center.value.set(999,999,999)}}Me.MMDShadow.value=MMD_SA_options.shadow_darkness,Me.mmdEdgeColor.value=this.mmdEdgeColor,Me.mmdShadowDark.value=this.mmdShadowDark},function(){var re,ne,se,de,_e,le,me,pe,fe;re=new THREE.Vector3,ne=new THREE.Vector3,se=new THREE.Vector3,de=new THREE.Vector3,_e=new THREE.Quaternion,le=new THREE.Matrix4,me=function(ce){var ue=ce.matrix;return ce.visible&&(ce.visible=!1,ue.makeRotationFromQuaternion(ce.quaternion),ue.setPosition(ce.position)),ue},pe=function(ce,ue,he){for(he.copy(ue.position);ue.parent!==ce;)ue=ue.parent,he.applyMatrix4(me(ue))},fe=function(ce,ue,he){for(he.copy(me(ue));ue.parent!==ce;)ue=ue.parent,he.multiplyMatrices(me(ue),he);he.getInverse(he)},O=function(ce){this.mesh=ce},O.prototype.update=function(ce){var ue,he,Me,ge,xe,ye,Ae,be,ve,Se,De,ke,we,Ee,Pe,Te;ue=this.mesh,Me=ue.bones,he=ue.geometry.MMDIKs;var Ce,Ie,Ue,ze,Re=[],Le=0,Fe=he.length,Ve=1;for(self.MMD_SA&&(Ce=THREE.MMD.getModels()[ue._model_index],Ie=MMD_SA_options.model_para_obj_all[ue._model_index],Ue=Ce.skin&&MMD_SA.motion[Ce.skin._motion_index],Ve=Ie.ik_iteration_factor||(MMD_SA_options.Dungeon&&ue._model_index?MMD_SA_options.Dungeon_options.ik_iteration_factor||0.5:1),ze=Ue&&Ue.para_SA,ce&&(Le=ce.ini,Fe=ce.end||Le)),ge=Le,xe=Fe;ge<=xe;ge++){if(ye=ue._IK_and_AddTrans[ge].pmxBone.IK,ke=Me[ye.target],Ue){if(ze.IK_disabled&&ze.IK_disabled.test(ke.name))continue;if(System._browser.camera.poseNet.IK_disabled_check(ke.name))continue;if(/\u8155\uFF29\uFF2B/.test(ke.name)){let Be=MMD_SA.vmd_by_filename[Ue.filename];if(!System._browser.camera.use_armIK&&Be&&!Be.use_armIK&&!ze.use_armIK)continue}}for(we=Me[ye.effector],pe(ue,ke,re),Se=ye.iteration,Se=Math.max(Math.floor(Se*Ve),1),De=ye.links.length,ve=0;ve<De;ve++)Ae=ye.links[ve],Ee=Me[Ae.bone],-1!=Ee.name.indexOf("\u8DB3\u9996")&&Ee.quaternion.slerp(MMD_SA.TEMP_q.set(0,0,0,1),0.5),Re[ve]=Ae.limits&&Ie&&Ie.IK_link_inverted&&Ie.IK_link_inverted.test(Ee.name)?-1:1;loop:for(be=0;be<Se;be++){var Oe=!1;for(ve=0;ve<De;ve++){if(Ae=ye.links[ve],Ee=Me[Ae.bone],Ee.omitIK)break loop;(fe(ue,Ee,le),pe(ue,we,se),se.applyProjection(le).normalize(),ne.copy(re),ne.applyProjection(le).normalize(),Pe=ne.dot(se),1<Pe&&(Pe=1),Pe=Math.acos(Pe),!(1e-5>Pe))&&(Pe>ye.control&&(Pe=ye.control),_e.setFromAxisAngle(de.crossVectors(se,ne).normalize(),Pe),Ee.quaternion.multiplyQuaternions(Ee.quaternion,_e),Ae.limits&&(Te=Ee.quaternion.w,Ee.quaternion.set(Re[ve]*Math.sqrt(1-Te*Te),0,0,Te)),Ee.visible=!0,Oe=!0)}if(!Oe)break}}Me.forEach(function(Be){Be.visible=!0})}}(),function(){var re=self.MMD_SA&&MMD_SA.ammo_proxy,ne,se,de,_e,le,me,pe,fe,ce,ue,he,Me,ge,xe,ye,Ae;window.Ammo&&(jThree._ammo_async_init_=[],jThree._ammo_async_init_.push(function(){ne=new Ammo.btDefaultCollisionConfiguration,se=new Ammo.btCollisionDispatcher(ne),de=new Ammo.btSequentialImpulseConstraintSolver,_e=new Ammo.btDbvtBroadphase,Q=new Ammo.btDiscreteDynamicsWorld(se,_e,de,ne),le=new Ammo.btTransform,me=new Ammo.btVector3,pe=new Ammo.btQuaternion,Y=function(be,ve,Se){return me.setValue(be,ve,Se),me},J=function(be,ve,Se,De){return pe.setValue(be,ve,Se,De),pe},self.MMD_SA&&re&&re.update_worker("TEST")})),fe=new THREE.Vector3,ce=new THREE.Vector3,ue=new THREE.Vector3,he=new THREE.Quaternion,Me=new THREE.Quaternion,ge=new THREE.Quaternion,xe=new THREE.Matrix4,ye=new THREE.Matrix4,Ae=function(be,ve){return he.copy(ve.q),xe.makeRotationFromQuaternion(he),xe.getInverse(xe),fe.set(be.pos[0]-ve.pos[0],be.pos[1]-ve.pos[1],be.pos[2]-ve.pos[2]),fe.applyProjection(xe)},B=function(be){this.create(be)},B.prototype.create=function(be){function ve(Ee,Pe,Te){return"OR"===Te?self.MMD_SA&&re?(Ee=Ee._v_index&&(Ammo_local?"L.":"")+Ee._v_index||Ee,Pe=Pe._v_index&&(Ammo_local?"L.":"")+Pe._v_index||Pe,re.use_text_command?("string"==typeof Ee?"v['"+Ee+"']":Ee)+"|"+("string"==typeof Pe?"v['"+Pe+"']":Pe):{L:Ee,R:Pe,op:"OR"}):Ee|Pe:void 0}var Se=be.MMDrigids,De=be.geometry.MMDjoints;this.mesh=be;var ke=MMD_SA_options.model_para_obj_all[be._model_index],we={};De.forEach(function(Ee){var Pe=Se[Ee.rigidA],Te=Se[Ee.rigidB];0==Pe.type&&0<Te.type&&(we[Ee.rigidA]=!0)}),Se.forEach(function(Ee,Pe){var Te,Ce,Ie,Ue,ze,Re,Le;Ee.q=new THREE.Quaternion,Ee.q.setFromEuler(new THREE.Vector3(Ee.rot[0],Ee.rot[1],Ee.rot[2]),"YXZ");var Fe=ke.rigid_default&&(ke.rigid_default[Ee.name]||ke.rigid_default._all_)||{};null!=Fe.type&&(-1==Fe.type?(Ee.type=0,Ee.size=[0,0,0]):Ee.type=Fe.type);var Ve=self.MMD_SA&&ke.rigid_filter;switch(Ve&&!Ve.test(Ee.name)&&(Ee.type=0),0<=Ee.bone?(Te=be.bones[Ee.bone],0<Ee.type&&(Te.omitIK=!0)):2===Ee.type&&(Ee.type=1),Ee.shape){case 0:Ce=new Ammo.btSphereShape(Ee.size[0]);break;case 1:Ce=new Ammo.btBoxShape(Y(Ee.size[0],Ee.size[1],Ee.size[2]));break;case 2:Ce=new Ammo.btCapsuleShape(Ee.size[0],Ee.size[1]);break;default:return;}Ie=0===Ee.type?0:Ee.mass,Ue=new Ammo.btVector3(0,0,0),Ce.calculateLocalInertia(Ie,Ue),le.setIdentity(),le.setOrigin(Y(Ee.pos[0]+be.position.x,Ee.pos[1]+be.position.y,Ee.pos[2]+be.position.z)),le.setRotation(J(Ee.q.x,Ee.q.y,Ee.q.z,Ee.q.w)),ze=new Ammo.btDefaultMotionState(le),Re=new Ammo.btRigidBodyConstructionInfo(Ie,ze,Ce,Ue),Re.set_m_friction(Ee.friction),Re.set_m_restitution(Ee.restitution),Le=new Ammo.btRigidBody(Re),0===Ee.type&&(Le.setCollisionFlags(ve(Le.getCollisionFlags(),2,"OR")),!we[Pe]&&Le.setActivationState(4)),Le.setDamping(Ee.posDamping*(Fe.posDamping_scale||1),Ee.rotDamping*(Fe.rotDamping_scale||1)),Le.setSleepingThresholds(0,0),Q.addRigidBody(Le,1<<Ee.group,Ee.mask),Ammo.destroy(Re),Ammo.destroy(Ue),Ee.body=Le}),De.forEach(function(Ee){var Re=Se[Ee.rigidA],Le=Se[Ee.rigidB],Fe=new Ammo.btTransform,Ve=new Ammo.btTransform,Pe,Te,Ce,Ie,Ue,ze;0!==Re.type&&2===Le.type&&(0<Re.bone&&(Ue=be.bones[Re.bone]),0<Le.bone&&(ze=be.bones[Le.bone]),Ue&&ze&&ze.parent===Ue&&(Le.type=1)),Fe.setIdentity(),Pe=Ae(Ee,Re),Fe.setOrigin(Y(Pe.x,Pe.y,Pe.z)),Te=J(-Re.q.x,-Re.q.y,-Re.q.z,Re.q.w),Fe.setRotation(Te),Ve.setIdentity(),Pe=Ae(Ee,Le),Ve.setOrigin(Y(Pe.x,Pe.y,Pe.z)),Te=J(-Le.q.x,-Le.q.y,-Le.q.z,Le.q.w),Ve.setRotation(Te);var Oe=ke.joint_default&&ke.joint_default[Ee.name]||{};for(Ce=new Ammo.btGeneric6DofSpringConstraint(Re.body,Le.body,Fe,Ve,!0),Ce.setLinearLowerLimit(Y(Ee.posLower[0],Ee.posLower[1],Ee.posLower[2])),Ce.setLinearUpperLimit(Y(Ee.posUpper[0],Ee.posUpper[1],Ee.posUpper[2])),Ce.setAngularLowerLimit(Y(Ee.rotLower[0]*(Oe.rotLower_scale&&Oe.rotLower_scale[0]||1),Ee.rotLower[1]*(Oe.rotLower_scale&&Oe.rotLower_scale[1]||1),Ee.rotLower[2]*(Oe.rotLower_scale&&Oe.rotLower_scale[2]||1))),Ce.setAngularUpperLimit(Y(Ee.rotUpper[0]*(Oe.rotUpper_scale&&Oe.rotUpper_scale[0]||1),Ee.rotUpper[1]*(Oe.rotUpper_scale&&Oe.rotUpper_scale[1]||1),Ee.rotUpper[2]*(Oe.rotUpper_scale&&Oe.rotUpper_scale[2]||1))),Ie=0;3>Ie;Ie++)0<Ee.posSpring[Ie]&&(Ce.enableSpring(Ie,!0),Ce.setStiffness(Ie,Ee.posSpring[Ie]*(Oe.posSpring_scale&&Oe.posSpring_scale[Ie]||1))),0<Ee.rotSpring[Ie]&&(Ce.enableSpring(Ie+3,!0),Ce.setStiffness(Ie+3,Ee.rotSpring[Ie]));for(Ie=0;6>Ie;Ie++)(!self.MMD_SA||Ce.setParam)&&Ce.setParam(2,ee.STOP_ERP,Ie);Q.addConstraint(Ce,!0),Ammo.destroy(Fe),Ammo.destroy(Ve),Ee.constraint=Ce}),self.MMD_SA&&re&&re.update_worker()},B.prototype.dispose=function(){this.mesh.geometry.MMDjoints.forEach(function(be){Q.removeConstraint(be.constraint),Ammo.destroy(be.constraint),delete be.constraint}),this.mesh.MMDrigids.forEach(function(be){Q.removeRigidBody(be.body),Ammo.destroy(be.body),delete be.body}),self.MMD_SA&&re&&re.update_worker()},B.prototype.preSimulate=function(){var be;be=this.mesh,be.matrixWorld_physics&&be.matrixWorld_physics.update();var ve=be.matrixWorld_physics&&be.matrixWorld_physics.m4||be.matrixWorld;Me.setFromRotationMatrix(ve);var Se=!1;re&&(re.cache_by_model.set_enabled(be._model_index,!be._reset_rigid_body_physics_),Se=re.use_optimized_command&&!re.use_text_command,Se&&re.add_optimized_command({o:2,_btransform_v_index:le._v_index,_bv_v_index:me._v_index,_bq_v_index:pe._v_index})),be.MMDrigids.forEach(function(De){var ke,we;(0<be._reset_rigid_body_physics_||De._reset_physics_&&(!re||!re.data_id_locked.stepSimulation)||0===De.type)&&0<=De.bone&&(De._reset_physics_=null,ke=be.bones[De.bone].skinMatrix,fe.set(De.ofs[0],De.ofs[1],De.ofs[2]),fe.applyMatrix4(ke),fe.applyMatrix4(ve),he.setFromRotationMatrix(ke),he.multiplyQuaternions(he,De.q),he.multiplyQuaternions(Me,he),we=De.body,Se?re.add_optimized_command({o:3,body_v_index:we._v_index,_v:fe,_q:he}):(le.setOrigin(Y(fe.x,fe.y,fe.z)),le.setRotation(J(he.x,he.y,he.z,he.w)),we.setCenterOfMassTransform(le),we.getMotionState().setWorldTransform(le)))})},B.prototype.postSimulate=function(){function be(Xe){for(var qe=0,Qe=Xe.children.length,Ye;qe<Qe;qe++)Ye=Xe.children[qe],Ye instanceof THREE.Bone&&(Ye.pmxBone.afterPhysics?Ye.update(Xe.skinMatrix,!1):be(Ye))}var ve,Se,De;ve=this.mesh;var ke=ve._model_index,we=self.MMD_SA&&re&&!Ammo_local,Ee=ve.matrixWorld_physics&&ve.matrixWorld_physics.m4||ve.matrixWorld,Ie=!1,Pe,Te,Ce;we&&(Ie=re.use_optimized_command&&!re.use_text_command,Pe=we&&re.cache_by_model.list[ke],Te=we&&re.cache_by_model_temp.list[ke],Ce=we&&re.cache_by_model.get_enabled(ke),re.cache_by_model_temp.set_matrixWorld(ke,Ee),re.cache_by_model_temp.set_skin(ke,ve.bones,Ce)),ye.getInverse(Ee),ge.setFromRotationMatrix(ye);var Re={},Ue,ze,Le,Fe,Ve,Oe,Be,He;if(self.MMD_SA){if(Le=THREE.MMD.getModels()[ke],Fe=MMD_SA_options.model_para_obj_all[ke],Ve=Le.skin&&MMD_SA.motion[Le.skin._motion_index].filename||"",Oe=MMD_SA_options.motion_para[Ve]||{},Be=Oe.adjustment_per_model&&(Oe.adjustment_per_model[Fe._filename]||Oe.adjustment_per_model[Fe._filename_cleaned]||Oe.adjustment_per_model._default_)||Oe,He=Fe.skin_filter_by_motion&&(Fe.skin_filter_by_motion.find(function(Xe){return Xe.motion.test(Ve)})||{}).skin||Be.skin_filter||Oe.skin_filter,Ue=Fe.bone_constraint,Ue&&Ue.motion_filter&&!Ue.motion_filter.test(Ve)&&(Ue=null),Ue&&Ue.group_skip)for(var je in Ue.group_skip)Ue.group_skip[je].motion_match.test(Ve)&&(Re[je]=!0);0<ve._reset_rigid_body_physics_&&(ze=!0,ve._reset_rigid_body_physics_=Math.max(ve._reset_rigid_body_physics_-Math.min(30*(RAF_timestamp_delta/1e3),1),0))}if(ve.MMDrigids.forEach(function(Xe){var qe,Qe,Ye,Je,Ze;if(0!==Xe.type&&0<=Xe.bone&&(qe=ve.bones[Xe.bone].skinMatrix,Xe._skin_parent&&ve.bones[Xe.bone].update(Xe._skin_parent.skinMatrix,!1)),-1!=Xe.bone){var $e=ve.bones[Xe.bone].name,et=!ze&&He&&!He.test($e)&&(!Fe.skin_weight||!Fe.skin_weight[$e]);if(we&&ze&&2>=ve._reset_rigid_body_physics_&&(et=!0),ze||et)we&&et&&0!==Xe.type&&0<=Xe.bone&&(Ie&&!re.locked&&(re._locked=!0),Qe=Xe.body.getCenterOfMassTransform(),Je=Qe.getRotation(),Je.x(),Je.y(),Je.z(),Je.w(),Ie&&!re.locked&&(re._locked=!1,re.add_optimized_command({o:5,body_v_index:Xe.body._v_index})),1===Xe.type?(Ie&&!re.locked&&(re._locked=!0),Ye=Qe.getOrigin(),Ye.x(),Ye.y(),Ye.z(),Ie&&!re.locked&&(re._locked=!1,re.add_optimized_command({o:6,body_v_index:Xe.body._v_index}))):(fe.set(Xe.ofs[0],Xe.ofs[1],Xe.ofs[2]),fe.applyMatrix4(qe),fe.applyMatrix4(Ee),Ie?re.add_optimized_command({o:4,body_v_index:Xe.body._v_index,_v:fe}):(Ze=Xe.body,Ze.getMotionState().getWorldTransform(le),le.setOrigin(Y(fe.x,fe.y,fe.z)),Ze.setCenterOfMassTransform(le),Ze.getMotionState().setWorldTransform(le))));else if(0!==Xe.type&&0<=Xe.bone){2===Xe.type&&ue.getPositionFromMatrix(qe),Ie&&!re.locked&&(re._locked=!0),Qe=Xe.body.getCenterOfMassTransform(),Je=Qe.getRotation(),he.set(Je.x(),Je.y(),Je.z(),Je.w()),Ie&&!re.locked&&(re._locked=!1,re.add_optimized_command({o:5,body_v_index:Xe.body._v_index})),Me.copy(Xe.q).conjugate();let At;we&&(Ce?(he.multiplyQuaternions(Pe.q_matrixWorld_inv,he),At=!0):he.multiplyQuaternions(MMD_SA.TEMP_q.setFromRotationMatrix(ve.matrixWorld),he.multiplyQuaternions(MMD_SA._q1.setFromRotationMatrix(qe),Xe.q))),At||he.multiplyQuaternions(ge,he),he.multiplyQuaternions(he,Me);var tt=Ue&&Ue[$e];if(tt){var ot=tt.rotation,it=ot._q;it||(it=ot._q=new THREE.Quaternion),Me.setFromRotationMatrix(xe.extractRotation(qe)),it.copy(he).multiply(Me.conjugate()),fe.setEulerFromQuaternion(it.normalize());var rt,nt;Re[tt.group||"ALL"]&&(nt=!0);var st=ot.x,lt=ot.y,pt=ot.z,ft=45;if(!nt&&st){var ct=st[0][0]- -fe.x,ut=-fe.x-st[1][0];0<ct?(rt=!0,ct>ft||!0==st[0][1]?nt=!0:fe.x=1==st[0].length?st[0][0]:st[0][1]):0<ut&&(rt=!0,ut>ft||!0==st[1][1]?nt=!0:fe.x=1==st[1].length?st[1][0]:st[1][1]),fe.x=-fe.x}if(!nt&&lt){var ht=lt[0][0]-fe.y,Mt=fe.y-lt[1][0];0<ht?(rt=!0,ht>ft||!0==lt[0][1]?nt=!0:fe.y=1==lt[0].length?lt[0][0]:lt[0][1]):0<Mt&&(rt=!0,Mt>ft||!0==lt[1][1]?nt=!0:fe.y=1==lt[1].length?lt[1][0]:lt[1][1])}if(!nt&&pt){var gt=pt[0][0]- -fe.z,xt=-fe.z-pt[1][0];0<gt?(rt=!0,gt>ft||!0==pt[0][1]?nt=!0:fe.z=1==pt[0].length?pt[0][0]:pt[0][1]):0<xt&&(rt=!0,xt>ft||!0==pt[1][1]?nt=!0:fe.z=1==pt[1].length?pt[1][0]:pt[1][1]),fe.z=-fe.z}if(nt)return void(Xe._reset_physics_=!0);rt&&(Me.conjugate(),Me.multiply(it.setFromEuler(fe)),he.copy(Me),it.copy(Me),Me.setFromRotationMatrix(Ee),fe.set(Xe.ofs[0],Xe.ofs[1],Xe.ofs[2]),fe.applyMatrix4(qe),fe.applyMatrix4(Ee),he.setFromRotationMatrix(qe),he.multiplyQuaternions(he,Xe.q),he.multiplyQuaternions(Me,he),Ze=Xe.body,Ie?re.add_optimized_command({o:3,body_v_index:Ze._v_index,_v:fe,_q:he}):(le.setOrigin(Y(fe.x,fe.y,fe.z)),le.setRotation(J(he.x,he.y,he.z,he.w)),Ze.setCenterOfMassTransform(le),Ze.getMotionState().setWorldTransform(le)),he.copy(it))}var yt=MMD_SA.TEMP_v3.getPositionFromMatrix(qe);if(qe.makeRotationFromQuaternion(he),1===Xe.type){Ie&&!re.locked&&(re._locked=!0),Ye=Qe.getOrigin(),fe.set(Ye.x(),Ye.y(),Ye.z()),Ie&&!re.locked&&(re._locked=!1,re.add_optimized_command({o:6,body_v_index:Xe.body._v_index}));let bt;we&&(Ce?(fe.applyProjection(Pe.matrixWorld_inv),bt=!0):fe.copy(MMD_SA._v3a.set(Xe.ofs[0],Xe.ofs[1],Xe.ofs[2]).applyMatrix4(qe)).add(yt).applyMatrix4(Ee)),bt||fe.applyProjection(ye),ce.set(Xe.ofs[0],Xe.ofs[1],Xe.ofs[2]).negate(),ce.applyMatrix4(qe),fe.add(ce),qe.setPosition(fe),Ce&&qe.setPosition(fe.sub(MMD_SA._v3a_.getPositionFromMatrix(Pe.skin[Xe.bone])).add(MMD_SA._v3b_.getPositionFromMatrix(Te._skin[Xe.bone])))}else qe.setPosition(ue),fe.set(Xe.ofs[0],Xe.ofs[1],Xe.ofs[2]),fe.applyMatrix4(qe),fe.applyMatrix4(Ee),Ze=Xe.body,Ie?re.add_optimized_command({o:4,body_v_index:Ze._v_index,_v:fe}):(Ze.getMotionState().getWorldTransform(le),le.setOrigin(Y(fe.x,fe.y,fe.z)),Ze.setCenterOfMassTransform(le),Ze.getMotionState().setWorldTransform(le))}we&&re.register([Je,Ye])}}),self.MMD_SA&&MMD_SA.use_afterPhysics){for(var Ne in ve._bone_update_afterPhysics){var Ke=ve.bones[Ne];Ke.parent instanceof THREE.Bone?xe.multiplyMatrices(MMD_SA.TEMP_m4.getInverse(Ke.parent.skinMatrix),Ke.skinMatrix):xe.copy(Ke.skinMatrix),Ke.position.getPositionFromMatrix(xe),Ke.quaternion.setFromRotationMatrix(xe)}Le._update_IK_and_AddTrans(!0);for(var Ge=0,We=ve.children.length;Ge<We;Ge++)child=ve.children[Ge],child instanceof THREE.Bone&&(child.pmxBone.afterPhysics?child.update(ve.identityMatrix,!1):be(child))}for(Se=0,De=ve.bones.length;Se<De;Se++)xe.multiplyMatrices(ve.bones[Se].skinMatrix,ve.boneInverses[Se]),xe.flattenToArrayOffset(ve.boneMatrices,16*Se);ve.useVertexTexture&&(ve.boneTexture.needsUpdate=!0)},B.prototype.reset=function(){var be;be=this.mesh,be.updateMatrixWorld(!0),be.matrixWorld_physics&&be.matrixWorld_physics.update();var ve=be.matrixWorld_physics&&be.matrixWorld_physics.m4||be.matrixWorld;Me.setFromRotationMatrix(ve),be.MMDrigids.forEach(function(Se){var De;fe.set(Se.pos[0],Se.pos[1],Se.pos[2]).applyMatrix4(ve),he.multiplyQuaternions(Me,Se.q),De=Se.body,De.getMotionState().getWorldTransform(le),le.setOrigin(Y(fe.x,fe.y,fe.z)),le.setRotation(J(he.x,he.y,he.z,he.w)),De.setWorldTransform(le)}),self.MMD_SA&&re&&re.update_worker()}}(),C=function(){var pe=function(Me){return((re*Me+ne)*Me+se)*Me},fe=function(Me){return((de*Me+_e)*Me+le)*Me},ce=function(Me){return(3*re*Me+2*ne)*Me+se},ue=function(Me){var ge,xe,ye,Ae,be,ve;for(ye=Me,ve=0;8>ve;ve++){if(Ae=pe(ye)-Me,Math.abs(Ae)<me)return ye;if(be=ce(ye),1e-6>Math.abs(be))break;ye-=Ae/be}if(ge=0,xe=1,ye=Me,ye<ge)return ge;if(ye>xe)return xe;for(;ge<xe;){if(Ae=pe(ye),Math.abs(Ae-Me)<me)return ye;Me>Ae?ge=ye:xe=ye,ye=0.5*(xe-ge)+ge}return ye},re,ne,se,de,_e,le,me;return function(Me,ge,xe,ye,Ae,be){return me=be,se=3*ge,ne=3*(ye-ge)-se,re=1-se-ne,le=3*xe,_e=3*(Ae-xe)-le,de=1-le-_e,fe(ue(Me))}}(),I=function(re,ne){re instanceof Array||(re=[re]),this.targets=re,this.duration=ne,this.duration_default=ne,this.loop=!1,this.playing=!1,this.minKeyDelta=0,this.reset()},I.prototype.reset=function(){this.time=0,this.targets.forEach(function(re){re.k=0})},I.prototype.seek=function(re,ne){var se;se=re-this.time,0<=se?this.update(se,ne):(this.reset(),this.update(re,ne))},I.prototype.play=function(re){re!==void 0&&(this.loop=re),this.playing=!0},I.prototype.pause=function(){this.playing=!1},I.prototype.update=function(re){var se,de,_e;if(this.playing&&(se=this,de=this.time+re,this.time=de%this.duration,_e=!1,!(0>this.time))){var me={},pe=THREE.MMD.getModels()[this._model_index].pmx.morphs,fe=null==this._motion_index_MMD_SA_extra?this._motion_index-MMD_SA.custom_action_index:this._motion_index_MMD_SA_extra,le;this.targets.forEach(function(ce,ue){var he,Me,ge;if(2>ce.keys.length)return void(1==ce.keys.length&&se._is_MMD_SA_animation&&(he=ce.keys[0],ge=0,se.onupdate(he,he,ge,ue)));if(he=ce.keys[ce.k],Me=ce.keys[ce.k+1],!me[Me.name]){if(0==Me.morph_type&&pe[Me.morph_index].items.forEach(function(xe){me[pe[xe.target].name]=!0}),Me.time<=de)if(!(se.time<de))do ce.k++,he=ce.keys[ce.k],Me=ce.keys[ce.k+1];while(Me.time<se.time);else if(_e=!0,se.freeze_onended){if(_e=!1,se._is_MMD_SA_custom_animation&&se._is_skin&&!le&&(le=!0,MMD_SA_options.custom_action[fe].onFinish(se._model_index)),se.time=se.duration-1/59/1e3,ge=1,!se._MMD_SA_animation_check||se._MMD_SA_animation_check(ue))return void se.onupdate(he,Me,ge,ue);}else if(se.loop)for(jThree.MMD._onLoop=!0,ce.k=0,he=ce.keys[ce.k],Me=ce.keys[ce.k+1];Me.time<se.time;)ce.k++,he=ce.keys[ce.k],Me=ce.keys[ce.k+1];else se.time=Me.time;ge=Me.time-he.time<=se.minKeyDelta?0:se.time<he.time?0:(se.time-he.time)/(Me.time-he.time),(!se._MMD_SA_animation_check||se._MMD_SA_animation_check(ue))&&se.onupdate(he,Me,ge,ue)}}),se.freeze_onended&&se._is_MMD_SA_custom_animation&&se._is_skin&&!le&&de>se.duration&&MMD_SA_options.custom_action[fe].onFinish(se._model_index),_e&&(!this.loop&&this.pause(),this.onended&&this.onended(this))}},I.prototype.adjustDuration=function(re){return this.duration_default>re?void(re=this.duration_default):void(this.duration=re,this.targets.forEach(function(ne){var se,de;se=ne.keys;2>se.length||(de=se[se.length-1],de.time<re&&(de=U(de),de.time=re,se.push(de)))}))},H=function(re,ne){var se,de;this.mesh=re,I.call(this,ne.targets,ne.duration),de=ne.targets,se=re.geometry;var _e=this,le=[],me=0,pe=[],fe=[],ce=0,ue=se.morphTargets?se.morphTargets.length:0;if(se._morphTargets_index||(se._morphTargets_index={}),se.MMDmorphs.forEach(function(he){if(1==he.type){var Me,ge,xe;if(xe=ce,xe<de.length&&he.name===de[xe].keys[0].name){if(ce++,null!=se._morphTargets_index[he.name])return me++,void(pe[se._morphTargets_index[he.name]]=de[xe]);se._morphTargets_index[he.name]=ue++,fe.push(de[xe])}else return;ge=[],se.vertices.forEach(function(ye){ge.push(ye.clone())}),he.items.forEach(function(ye){var Ae=ge[ye.target];Ae.x+=ye.offset[0],Ae.y+=ye.offset[1],Ae.z+=ye.offset[2]}),Me={},Me.name=he.name,Me.vertices=ge,le.push(Me)}}),me){for(;ce<de.length;)1!=de[ce].keys[0].morph_type&&fe.push(de[ce]),ce++;se.morphTargets.forEach(function(he,Me){pe[Me]||(pe[Me]={keys:[{name:he.name,weight:0,morph_type:1}]})}),this.targets=pe.concat(fe)}le.length&&(se.morphTargets=se.morphTargets?se.morphTargets.concat(le):le),0<se.morphTargets.length&&(se.morphTargetsNeedUpdate=!0,re.updateMorphTargets(),re.material.materials.forEach(function(he){he.morphTargets=!0,he.needsUpdate=!0}))},H.prototype=Object.create(I.prototype),H.prototype.constructor=H,H.prototype.onupdate=function(re,ne,se,de){var _e=this,le=re.weight+(ne.weight-re.weight)*se,me=this.mesh,pe=me.geometry,fe=pe.morphs_weight_by_name[re.name];if(pe.morphs_weight_by_name[re.name]=le,0==re.morph_type){var ce=re.morph_index,ue=pe.MMDmorphs[ce];ue.items.forEach(function(he){var Me=pe.MMDmorphs[he.target],ge={name:Me.name,weight:le*he.weight,morph_type:Me.type,morph_index:he.target};_e.onupdate(ge,ge,0,pe._morphTargets_index[Me.name]||0)})}else if(2==re.morph_type){var ce=re.morph_index,ue=pe.MMDmorphs[ce];ue.items.forEach(function(he){var Me=me.bones[he.target].name,ge=me._bone_morph;ge=ge[Me]=ge[Me]||{},ge=ge[ce]=ge[ce]||{weight:0,pos_v3:new THREE.Vector3,rot_q:new THREE.Quaternion},ge.weight>=Math.abs(le)||(ge.weight=Math.abs(le),he.pos_v3?ge.pos_v3.copy(he.pos_v3).multiplyScalar(le):ge.pos_v3.set(0,0,0),he.rot_q?ge.rot_q.set(0,0,0,1).slerp(he.rot_q,le):ge.rot_q.set(0,0,0,1))})}else if(8==re.morph_type){var ce=re.morph_index,ue=pe.MMDmorphs[ce];ue.items.forEach(function(he){if(-1!=he.target){var Me=me.material.materials[he.target];Me._render_once=!0;var ge=Me.name,xe=me._material_morph[ge];xe||(xe=me._material_morph[ge]={}),xe[ce]={weight:le,morph_obj:he}}})}else if(3<=re.morph_type&&7>=re.morph_type){if(fe==le)return;var ce=re.morph_index,ue=pe.MMDmorphs[ce];pe._faceVertexUvs||(pe._faceVertexUvs=[[]]),ue.items.forEach(function(he){var ge=he.target,xe=pe._face_index_by_vertex[ge];xe&&xe.forEach(function(ye){var Ae=ye[0],be=pe.faceVertexUvs[0][Ae],ve=pe._faceVertexUvs[0][Ae];ve||(ve=pe._faceVertexUvs[0][Ae]=[be[0].clone(),be[1].clone(),be[2].clone()]);var Se=ye[1];be[Se].x=ve[Se].x+he.uv[0]*le,be[Se].y=ve[Se].y+he.uv[1]*le})}),pe.uvsNeedUpdate=!0}else(le>me.morphTargetInfluences[de]||re.override_weight)&&(this.mesh.morphTargetInfluences[de]=le)},function(){var re,ne,se;re=function(de,_e,le,me){var pe,fe,ce,ue,he;return(pe=de[0]*_e[0]+de[1]*_e[1]+de[2]*_e[2]+de[3]*_e[3],0>pe?(le[0]=-_e[0],le[1]=-_e[1],le[2]=-_e[2],le[3]=-_e[3],pe=-pe):(le[0]=_e[0],le[1]=_e[1],le[2]=_e[2],le[3]=_e[3]),1<=Math.abs(pe))?(le[0]=de[0],le[1]=de[1],le[2]=de[2],void(le[3]=de[3])):(fe=Math.acos(pe),ce=Math.sqrt(1-pe*pe),1e-3>Math.abs(ce)?(le[0]=0.5*(de[0]+le[0]),le[1]=0.5*(de[1]+le[1]),le[2]=0.5*(de[2]+le[2]),void(le[3]=0.5*(de[3]+le[3]))):void(ue=Math.sin((1-me)*fe)/ce,he=Math.sin(me*fe)/ce,le[0]=de[0]*ue+le[0]*he,le[1]=de[1]*ue+le[1]*he,le[2]=de[2]*ue+le[2]*he,le[3]=de[3]*ue+le[3]*he))},ne=function(de,_e,le){return C(de,_e[le]/127,_e[le+4]/127,_e[le+8]/127,_e[le+12]/127,1/128)},se=[0,0,0,1],N=function(de,_e){this.mesh=de,I.call(this,_e.targets,_e.duration),this._timeMax=_e._timeMax},N.prototype=Object.create(I.prototype),N.prototype.constructor=N,N.prototype.onupdate=function(){var de=new THREE.Vector3,_e=new THREE.Quaternion,le={x:1,y:1,z:1};return function(me,pe,fe,ce){var ue=this.mesh.bones[ce],he=this.mesh.geometry.bones[ce],Me;let ge;if(self.MMD_SA){let xe=MMD_SA_options.model_para_obj_all[this.mesh._model_index],ye;if(null!=this._motion_index)ye=MMD_SA.motion[this._motion_index].filename;else{let ve=THREE.MMD.getModels()[this.mesh._model_index].skin;ve&&(ye=MMD_SA.motion[ve._motion_index].filename)}ge=MMD_SA_options.motion_para[ye];let Ae=ge&&ge.adjustment_per_model&&(ge.adjustment_per_model[xe._filename]||ge.adjustment_per_model[xe._filename_cleaned]||ge.adjustment_per_model._default_);Ae=Ae&&Ae.skin_default||{};let be=Ae[he.name]||xe.skin_default[he.name];if(be&&be.gpos_add){let ve=[];he.pos.forEach(function(Se,De){ve[De]=Se+be.gpos_add[De]}),he={name:he.name,pos:ve}}}if(Me=pe.interp,de.x=he.pos[0]+me.pos[0]+(pe.pos[0]-me.pos[0])*ne(fe,Me,0),de.y=he.pos[1]+me.pos[1]+(pe.pos[1]-me.pos[1])*ne(fe,Me,1),de.z=he.pos[2]+me.pos[2]+(pe.pos[2]-me.pos[2])*ne(fe,Me,2),re(me.rot,pe.rot,se,ne(fe,Me,3)),_e.x=se[0],_e.y=se[1],_e.z=se[2],_e.w=se[3],null==this._blending_ratio_)ue.position.copy(de),ue.quaternion.copy(_e);else{let xe=this._blending_ratio_,ye=!1;if(ge&&ge.bone_to_position){let Ae=-1==he.name.indexOf("\u8DB3\uFF29\uFF2B")?he.name:"\u30BB\u30F3\u30BF\u30FC",be=ge.bone_to_position.find(ve=>ve.name==Ae);if(be){let ve=be.scale||le;ue.position.x+=(de.x-ue.position.x)*xe*(1-ve.x),ue.position.y+=(de.y-ue.position.y)*xe*(1-ve.y),ue.position.z+=(de.z-ue.position.z)*xe*(1-ve.z),ye=!0}}ye||ue.position.lerp(de,xe),ue.quaternion.slerp(_e,this._blending_ratio_)}}}(),MMD_SA._skin_onupdate=N.prototype.onupdate}(),function(){var re,ne,se,de,_e,le;re=new THREE.Vector3,ne=new THREE.Quaternion,se=new THREE.Vector3,de=new THREE.Vector3,_e=new THREE.Quaternion,le=new THREE.Quaternion,K=function(me,pe){var fe;this.mesh=pe,fe=[],pe.bones.forEach(function(ce){var he,Me;he=ce.pmxBone.additionalTransform,he&&0<=he[0]&&0!==he[1]&&(Me=pe.bones[he[0]],Me.basePosition=Me.position.clone(),Me.baseQuaternion=Me.quaternion.clone(),Me.baseSkinMatrix=Me.skinMatrix.clone(),fe.push(ce))}),fe.sort(function(ce,ue){return ce.pmxBone.deformHierachy-ue.pmxBone.deformHierachy}),this.hasGlobal=fe.some(function(ce){return 0!=(128&ce.pmxBone.flags)}),this.hasGlobal=!1,this.bones=fe},K.prototype.update=function(me){var pe;pe=this.mesh,this.hasGlobal&&pe.updateMatrixWorld();var fe=0,ce=this.bones.length-1;me&&(fe=me.ini,ce=me.end||fe);for(var ue=fe,he=ce;ue<=he;ue++){var Me=pe._IK_and_AddTrans[ue],ge,xe,ye;ge=Me.pmxBone.additionalTransform,xe=pe.bones[ge[0]],(re.subVectors(xe.position,xe.basePosition),ne.copy(xe.quaternion)),ye=ge[1],0!=(256&Me.pmxBone.flags)&&(_e.set(0,0,0,1),0<=ye?_e.slerp(ne,ye):_e.slerp(ne.conjugate(),-ye),Me.quaternion.multiplyQuaternions(Me.quaternion,_e)),0!=(512&Me.pmxBone.flags)&&Me.position.addVectors(Me.position,re.multiplyScalar(ye))}}}(),function(){var re,ne;re=function(se,de,_e){return _e*=4,C(se,de[_e]/127,de[_e+2]/127,de[_e+1]/127,de[_e+3]/127,1/128)},ne=new THREE.Vector3,G=function(se,de){return se instanceof THREE.PerspectiveCamera?void(this.persepectiveCamera=se,I.call(this,de,de.duration),this.minKeyDelta=ee.minKeyDelta,this.offset=new THREE.Vector3,this.target=new THREE.Vector3):void console.error("not PerspectiveCamera")},G.prototype=Object.create(I.prototype),G.prototype.constructor=G,G.prototype.play=function(se){I.prototype.play.call(this,se),this.persepectiveCamera.rotationAutoUpdate=!1,this.persepectiveCamera.matrixAutoUpdate=!1},G.prototype.pause=function(){I.prototype.pause.call(this),this.persepectiveCamera.rotationAutoUpdate=!0,this.persepectiveCamera.matrixAutoUpdate=!0},G.prototype.onupdate=function(se,de,_e){var le=this.persepectiveCamera,me=de.interp,pe,fe,ce,ue,he,Me;fe=le.position,fe.x=se.target[0]+(de.target[0]-se.target[0])*re(_e,me,0),fe.y=se.target[1]+(de.target[1]-se.target[1])*re(_e,me,1),fe.z=se.target[2]+(de.target[2]-se.target[2])*re(_e,me,2),fe.addVectors(fe,this.offset),this.target.copy(fe),pe=re(_e,me,3),ce=le.rotation,ce.x=se.rot[0]+(de.rot[0]-se.rot[0])*pe,ce.y=se.rot[1]+(de.rot[1]-se.rot[1])*pe,ce.z=se.rot[2]+(de.rot[2]-se.rot[2])*pe,ue=se.distance+(de.distance-se.distance)*re(_e,me,4),he=le.fov,le.fov=se.fov+(de.fov-se.fov)*re(_e,me,5),le.fov!==he&&le.updateProjectionMatrix(),Me=le.matrix,Me.makeRotationFromEuler(ce),fe.add(ne.getColumnFromMatrix(2,Me).multiplyScalar(ue)),Me.setPosition(fe),le.up.copy(ne.getColumnFromMatrix(1,Me)),le.matrixWorldNeedsUpdate=!0}}(),W=function(re,ne){return re instanceof THREE.DirectionalLight?void(this.directionalLight=re,I.call(this,ne,ne.duration),this.minKeyDelta=ee.minKeyDelta):void console.error("not DirectionalLight")},W.prototype=Object.create(I.prototype),W.prototype.constructor=W,W.prototype.onupdate=function(re,ne,se){var de=this.directionalLight,_e=de.color,le=de.position,me=de.target.position;_e.r=re.color[0]+(ne.color[0]-re.color[0])*se,_e.g=re.color[1]+(ne.color[1]-re.color[1])*se,_e.b=re.color[2]+(ne.color[2]-re.color[2])*se,le.x=0,le.y=0,le.z=0,me.x=re.dir[0]+(ne.dir[0]-re.dir[0])*se,me.y=re.dir[1]+(ne.dir[1]-re.dir[1])*se,me.z=re.dir[2]+(ne.dir[2]-re.dir[2])*se};var te=function(re){var ne,se,de;if(this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||re)&&(this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,re=!0),this._mesh_parent&&this._mesh_parent._RAF_timestamp_){if(this._mesh_parent._RAF_timestamp_==RAF_timestamp)return;this._mesh_parent._RAF_timestamp_=RAF_timestamp}for(ne=0,se=this.children.length;ne<se;ne++)de=this.children[ne],de instanceof THREE.Bone?(!de.pmxBone||!de.pmxBone.afterPhysics)&&de.update(this.identityMatrix,!1):de.updateMatrixWorld(!0)};(function(){function re(ne){return ne.bones.some(function(se){return!!se.additionalTransform})}X=function(ne,se){this.init(ne,se)},X.prototype.init=function(ne,se){this.pmx=ne,this.vmd=se,this.ik=null,this.physi=null,this.skin=null,this.morph=null,this.addTrans=null,this.mesh=null,this.simulateCallback=null,this.boundingCenterOffset=null,this._onmotionended=null,this._MMD_SA_cache=[]},X.prototype.load=function(ne,se,de){function _e(me,pe){X.call(le,me,pe),de(le)}var le;le=this,new P().load(ne,function(me){se?new T().load(se,function(pe){_e(me,pe)}):_e(me)})},X.prototype._update_IK_and_AddTrans=function(ne){var se=this,de=this.mesh._IK_and_AddTrans,_e,le,me,pe;ne?(le=this.mesh._IK_and_AddTrans_afterPhysics_index,pe=de.length-1):(le=0,pe=(this.mesh._IK_and_AddTrans_afterPhysics_index||de.length)-1);for(var me=-1,fe=le,ce;fe<=pe;fe++)ce=de[fe],_e?ce.pmxBone.IK&&!ce._additionalTransform_only?me=fe:(se.ik.update({ini:le,end:me}),_e=!1,le=me=fe):ce.pmxBone.additionalTransform&&(!ce.pmxBone.IK||ce._additionalTransform_only)?me=fe:(-1!=me&&se.addTrans.update({ini:le,end:me}),_e=!0,le=me=fe),fe==pe&&(_e?se.ik.update({ini:le,end:me}):se.addTrans.update({ini:le,end:me}))},X.prototype.create=function(ne,se){var de=this;var _e,le,me,pe;self.MMD_SA&&(_e=document.createElement("canvas"),le=_e.getContext("2d"),me=document.createElement("canvas"),pe=me.getContext("2d")),this.pmx&&this.pmx.createMesh(ne,function(fe){function ce(be){for(var ve=be,Se=-1,De;ve!==fe;){if(De=de.pmx.rigid_index_by_bone[ve._index],null!=De&&0<fe.MMDrigids[De].type){Se=ve._index;break}ve=ve.parent}return Se}fe._bone_morph={},fe.MMDrigids=de.pmx.rigids;var ue;if(self.MMD_SA){fe._model_index=fe._model_index_default=de.pmx._model_index,fe._material_morph={},ue=self.MMD_SA&&MMD_SA_options.model_para_obj_all[fe._model_index],fe.bones_by_name={},fe._IK_and_AddTrans=[];var he={},Me={};fe.geometry.bones.forEach(function(be,ve){var Se=fe.bones[ve];fe.bones_by_name[be.name]=Se,Se._index=ve;var De=Se.pmxBone=de.pmx.bones[ve];if(De.IK){fe._IK_and_AddTrans.push(Se);var ke=De.IK;he[ke.effector]=!0,ke.links.forEach(function(we){he[we.bone]=!0})}}),fe.geometry.bones.forEach(function(be,ve){var Se=fe.bones[ve],De=Se.pmxBone,ke=De.additionalTransform;if(ke&&0<=ke[0]&&0!==ke[1]){if(De.IK){let we=Object.assign({},Se);we._additionalTransform_only=!0,fe._IK_and_AddTrans.push(we)}else fe._IK_and_AddTrans.push(Se);ke&&he[ke[0]]&&(he[Se._index]=Me[Se._index]=!0)}}),fe._bone_update_afterPhysics={},fe._IK_and_AddTrans.forEach(function(be){if(be.pmxBone.afterPhysics){var ve;be.pmxBone.IK?(ve=ce(be),-1!=ve&&(fe._bone_update_afterPhysics[ve]=!0)):(ve=ce(be),-1!=ve&&(fe._bone_update_afterPhysics[ve]=!0),ve=ce(fe.bones[be.pmxBone.additionalTransform[0]]),-1!=ve&&(fe._bone_update_afterPhysics[ve]=!0))}}),fe._IK_and_AddTrans.sort(function(be,ve){var Se=be.pmxBone,De=ve.pmxBone;return(Se.afterPhysics&&8192||0)+(Se.additionalTransform&&(!Se.IK||be._additionalTransform_only)&&4096||0)+1024*Se.deformHierachy+be._index-((De.afterPhysics&&8192||0)+(De.additionalTransform&&(!De.IK||ve._additionalTransform_only)&&4096||0)+1024*De.deformHierachy+ve._index)}),MMD_SA.use_afterPhysics&&fe._IK_and_AddTrans.some(function(be,ve){if(be.pmxBone.afterPhysics)return fe._IK_and_AddTrans_afterPhysics_index=ve,console.log(fe._model_index,"._IK_and_AddTrans_afterPhysics_index",ve),!0})}var ge,xe,ye=0;self.MMD_SA&&(ge=self.MMD_SA&&-1==de.pmx._clone_index,xe=ue.material_para=ue.material_para||{}),fe.material.materials.forEach(function(be){function Se(Pe){return 0<=Pe?Pe%1:Pe%1+1}if(be.mesh=fe,self.MMD_SA){let Ie=xe[be.name]||{},Pe,Te,Ce;null!=Ie.depthWrite&&(be.depthWrite=Ie.depthWrite);let Ue=ge&&null==Ie.transparent;if(Ue){if(1>be.opacity)Ie.transparent=!0;else if(!be.map)Ie.transparent=!1;else if(be.map instanceof THREE.CompressedTexture)Ie.transparent=!0;else if(be.map.image.src&&/\.jpg$/i.test(be.map.image.src)&&!/\.jpga\.jpg$/i.test(be.map.image.src))Ie.transparent=!1;else{Pe=be.map.image,Te=_e.width=me.width=Math.ceil(0.5*Pe.width),Ce=_e.height=me.height=Math.ceil(0.5*Pe.height),le.drawImage(Pe,0,0,Te,Ce);let ze=fe.geometry.faceVertexUvs[0];pe=me.getContext("2d"),pe.fillStyle="white";for(var De=be._uv_bbox.face_ini,ke=be._uv_bbox.face_end;De<ke;De++){let Ve=ze[De];pe.beginPath(),pe.moveTo(Se(Ve[0].x)*Te,Se(Ve[0].y)*Ce),pe.lineTo(Se(Ve[1].x)*Te,Se(Ve[1].y)*Ce),pe.lineTo(Se(Ve[2].x)*Te,Se(Ve[2].y)*Ce),pe.closePath(),pe.fill()}let Re=le.getImageData(0,0,Te,Ce).data,Le=pe.getImageData(0,0,Te,Ce).data,Fe=!1;for(var we=0,Ee=Re.length;we<Ee;we+=4)if(192>Re[we+3]){Fe=!0;break}Ie.transparent=Fe,Re=Le=void 0}null!=Ie.transparent&&(be.transparent=Ie.transparent)}be._material_para=xe[be.name]||xe._default_||null,be.transparent||ye++}}),console.log("model-"+fe._model_index+":auto_detect_material_para-"+!!ge+",opaque/total material count-"+ye+"/"+fe.material.materials.length),self.MMD_SA&&(_e.width=_e.height=me.width=me.height=0,_e=le=me=pe=void 0);var Ae;de.mesh=fe,fe.identityMatrix=null,fe.useQuaternion=!0,ne.position&&fe.position.copy(ne.position),ne.rotation&&(fe.rotation.copy(ne.rotation),fe.useQuaternion=!1),ne.quaternion&&(fe.quaternion.copy(ne.quaternion),fe.useQuaternion=!0),de.boundingCenterOffset=fe.geometry.boundingSphere.center.clone().sub(fe.bones[0].position),de.ik=fe.geometry.MMDIKs.length?new O(fe):null,de.physi=window.Ammo?new B(fe):null,de.vmd?(Ae=de.vmd.generateSkinAnimation(de.pmx),Ae?(de.skin=new N(fe,Ae),de.skin.onended=function(be){be.loop&&de.physi&&de.physi.reset(),de._onmotionended=de.onmotionended},de.physi&&(fe.updateMatrixWorld=te)):de.skin=null,Ae=de.vmd.generateMorphAnimation(de.pmx),de.morph=Ae?new H(fe,Ae):null,self.MMD_SA&&(de._MMD_SA_cache[toLocalPath(de.vmd.url)]={skin:de.skin,morph:de.morph})):self.MMD_SA&&(fe.updateMatrixWorld=te),de.addTrans=re(de.pmx)?new K(de.pmx,fe):null,se(de),self.MMD_SA&&(ue.hidden_before_start||ue.hidden_on_start||MMD_SA_options.hidden_before_start||MMD_SA_options.hidden_on_start)&&fe.scale.set(0,0,0)})},X.prototype.resetBones=function(){var ne,se;ne=this.mesh,ne&&(se=ne.bones,ne.geometry.bones.forEach(function(de,_e){var le;le=se[_e],le.position.set(de.pos[0],de.pos[1],de.pos[2]),le.quaternion.set(de.rotq[0],de.rotq[1],de.rotq[2],de.rotq[3])}))},X.prototype.setupMotion_MMD_SA=function(ne,se,de){se||(se={skin_jThree:!0,morph_jThree:!0});var _e=se.skin_jThree?ne.generateSkinAnimation(this.pmx,!0===se.skin_jThree?null:se.skin_jThree):null,le=se.morph_jThree?(ne._morph_component||ne).generateMorphAnimation(this.pmx,!0===se.morph_jThree?null:se.morph_jThree):null,me=_e?new N(this.mesh,_e):de?MMD_SA.Animation_dummy:null,pe=le?new H(this.mesh,le):de?MMD_SA.Animation_dummy:null;me&&(me._model_index=this._model_index,me._motion_index=ne._index),pe&&(pe._model_index=this._model_index,pe._motion_index=ne._index);var fe={skin:me,morph:pe};return pe&&!de&&(pe.target_index_by_name={},pe.targets.forEach(function(ce,ue){pe.target_index_by_name[ce.keys[0].name]=ue}),"\u307E\u3070\u305F\u304D"in pe.target_index_by_name&&(fe._blink_target_index=pe.target_index_by_name.)),fe},X.prototype._VMD=function(ne,se){new T().load(ne,se)},X.prototype.resetMotion=function(ne){if(this.resetBones(),this.morph&&(this.morph.reset(),this.morph_MMD_SA_extra&&this.morph_MMD_SA_extra.forEach(function(se){(!se.time||se._MMD_SA_disabled)&&se.reset()})),this.skin&&(this.skin.reset(),this.skin_MMD_SA_extra&&this.skin_MMD_SA_extra.forEach(function(se){(!se.time||se._MMD_SA_disabled)&&se.reset()})),this.physi){if(ne)return;if(self.MMD_SA){let se=(0<this._model_index?MMD_SA.motion[this.skin._motion_index]:MMD_SA.MMD.motionManager).para_SA;if(this.resetPhysics(),0==this._model_index){let de=se.gravity||[0,-1,0];(de[0]!=MMD_SA.gravity[0]||de[1]!=MMD_SA.gravity[1]||de[2]!=MMD_SA.gravity[2])&&(THREE.MMD.setGravity(10*(9.8*de[0]),10*(9.8*de[1]),10*(9.8*de[2])),MMD_SA.gravity=de)}}this.physi.reset()}},X.prototype.resetPhysics=function(ne){if(self.MMD_SA){if(0===ne)return void(this.mesh._reset_rigid_body_physics_=0);if(null==ne){let se=(0<this._model_index?MMD_SA.motion[this.skin._motion_index]:MMD_SA.MMD.motionManager).para_SA;ne=se.reset_rigid_body_physics_step||MMD_SA_options.reset_rigid_body_physics_step}this.mesh._reset_rigid_body_physics_=Math.max(this.mesh._reset_rigid_body_physics_||0,ne)}},self.MMD_SA?Object.defineProperty(X.prototype,"visible",{get:function(){if(this._visible_RAF_timestamp==RAF_timestamp)return this._visible;var ne;return ne=!!this.mesh.visible||!!this._clone_cache&&this._clone_cache.list.some(function(se){return se.visible}),this._visible_RAF_timestamp=RAF_timestamp,this._visible=ne,ne}}):X.prototype.visible=!0,X.prototype.updateMotion=function(ne,se){if(this.visible){this.resetBones();var de=this.mesh,_e=this,le,me,pe,fe,ce;if(self.MMD_SA){le=self.MMD_SA&&MMD_SA.meter_motion_disabled,me=MMD_SA_options.model_para_obj_all[this._model_index],pe=MMD_SA.motion[(this.skin||this.morph||{})._motion_index],pe=pe&&pe.para_SA||{},de._bone_morph={};let yt=(pe.playbackRate_by_model_index&&pe.playbackRate_by_model_index[this._model_index]||1)*(me._playbackRate||1);0==this._model_index?me._playbackRate_OPC_=MMD_SA._playbackRate*yt:me._playbackRate_OPC_&&(yt=me._playbackRate_OPC_/MMD_SA._playbackRate),ne*=yt}if(this.morph){var ue=!1;if(self.MMD_SA){let yt=de.morphTargetInfluences;if(yt)if(this.morph.playing)for(var he=0,Me=yt.length;he<Me;he++)yt[he]=0;else pe.auto_blink&&(yt[this.morph.target_index_by_name.]=0,null!=this.morph.target_index_by_name.&&(yt[this.morph.target_index_by_name.]=0))}if(this.morph_MMD_SA_extra&&this.morph_MMD_SA_extra.forEach(function(yt){if(!yt._is_dummy&&yt.targets.length){var bt=null==yt._motion_index_MMD_SA_extra?yt._motion_index-MMD_SA.custom_action_index:yt._motion_index_MMD_SA_extra;if(bt<MMD_SA_options.custom_action.length){var vt=MMD_SA_options.custom_action[bt],St=vt.frame=vt.para_by_model_index[_e._model_index].frame=yt._MMD_SA_disabled?0:~~(30*(yt.time<yt.duration?yt.time:yt.duration));vt.condition(!1,yt)?(ue=!0,yt._MMD_SA_disabled&&(yt._MMD_SA_disabled=!1,yt.reset(),yt.play())):!yt._MMD_SA_disabled&&(yt.pause(),yt._MMD_SA_disabled=!0)}yt._MMD_SA_disabled||yt.update(ne)}}),ue?this.morph.time+=ne:this.morph.update(ne,se),!self.MMD_SA||pe.process_morphs&&pe.process_morphs(this,this.morph)||(me.process_morphs&&me.process_morphs(this,this.morph),window.dispatchEvent(new CustomEvent("SA_MMD_model"+this._model_index+"_process_morphs",{detail:{model:this,morph:this.morph}}))),self.MMD_SA){pe.morph_noise&&pe.morph_noise.forEach(function(yt){yt._count||(yt._count=~~(yt.time_range[0]+Math.random()*(yt.time_range[1]-yt.time_range[0]+1)),yt.morph_list.forEach(function(bt){bt._weight=bt.weight_range[0]+Math.random()*(bt.weight_range[1]-bt.weight_range[0])})),yt._count--;var At=_e.morph.targets;yt.morph_list.forEach(function(bt){var vt=bt.name,St=_e.morph.target_index_by_name[vt],Dt=At[St],kt=Dt.keys[0],wt={name:vt,weight:_e.pmx.morphs_weight_by_name[vt]+bt._weight,morph_type:kt.morph_type,morph_index:kt.morph_index};_e.morph.onupdate(wt,wt,0,St)})});var ge=me._custom_morph||MMD_SA._custom_morph;ge.forEach(function(yt){(!yt.condition||yt.condition(_e))&&_e.morph.onupdate(yt.key,yt.key,0,yt.idx)}),me._custom_morph=null,MMD_SA._custom_morph=[]}if(self.MMD_SA&&MMD_SA_options.auto_blink&&!ue&&null!=this.pmx.morphs_index_by_name.){let yt=this.morph.targets,At=this._MMD_SA_cache_current,bt=yt[At._blink_target_index];if(null==this._blink_countdown&&(this._blink_countdown=-9999),pe.auto_blink||null==pe.auto_blink&&2>=bt.keys.length&&!bt.keys[0].weight&&!bt.keys[bt.keys.length-1].weight){let St="\u307E\u3070\u305F\u304D",Dt=At._blink_target_index,vt;if(pe.auto_blink&&this.morph.playing){vt=this.pmx.morphs_weight_by_name.;let kt=this.pmx.morphs_weight_by_name.;vt&&kt?vt=null:kt&&(vt=kt,St="\u7B11\u3044",Dt=this.morph.target_index_by_name[St])}else vt=0;if(null==vt)this._blink_countdown=null;else{let kt=this._blink_countdown,wt=-1,Et=2;if(kt<=-1-3*Et?(this._blink_countdown=~~(20*(4*Math.random()+4)),wt=vt||0):kt<=-1-2*Et?wt=vt+(1-vt)*(Math.abs(3*Et+kt)+1)/(Et+1):kt<=-1-1*Et?wt=1:-1>=kt&&(wt=vt+(1-vt)*(Math.abs(1+kt)+1)/(Et+1)),0<=wt){let Pt=bt.keys[0],Tt={name:St,weight:wt,morph_type:Pt.morph_type,morph_index:Pt.morph_index};this.morph.onupdate(Tt,Tt,0,Dt)}this._blink_countdown--}}}}if(this.skin&&(self.MMD_SA&&MMD_SA_options.Dungeon&&MMD_SA_options.Dungeon.SFX_check(this,pe,this.skin,ne),this.skin.update(ne,se)),self.MMD_SA&&(pe.process_bones&&pe.process_bones(this,this.skin)||(me.process_bones&&me.process_bones(this,this.skin),window.dispatchEvent(new CustomEvent("SA_MMD_model"+this._model_index+"_process_bones",{detail:{model:this,skin:this.skin}}))),0<this._model_index)){let yt=MMD_SA.bone_to_position.call(this,pe);yt&&de.position.add(de._bone_to_position_last.pos_delta_rotated)}if(this.skin){if(this.skin_MMD_SA_extra&&this.skin_MMD_SA_extra.forEach(function(yt){if(!yt._is_dummy){var bt=null==yt._motion_index_MMD_SA_extra?yt._motion_index-MMD_SA.custom_action_index:yt._motion_index_MMD_SA_extra;if(bt<MMD_SA_options.custom_action.length){var vt=MMD_SA_options.custom_action[bt],St=vt.frame=vt.para_by_model_index[_e._model_index].frame=yt._MMD_SA_disabled?0:~~(30*(yt.time<yt.duration?yt.time:yt.duration));if(vt.condition(!0,yt)){!1!=vt.meter_motion_disabled&&(le=!0);var Dt=vt.look_at_screen_ratio;null!=Dt&&(fe=Dt),ce=ce||vt.look_at_mouse_disabled,yt._MMD_SA_disabled&&(yt._MMD_SA_disabled=!1,yt.reset(),yt.play())}else yt._MMD_SA_disabled||(yt.pause(),yt._MMD_SA_disabled=!0)}yt._MMD_SA_disabled||(null==yt._seek_time_?yt.update(ne):(yt.seek(yt._seek_time_),yt._seek_time_=null),yt._blending_ratio_=null)}}),self.MMD_SA)for(var xe in de._bone_morph){var ye=de._bone_morph[xe],Ae=de.bones_by_name[xe];for(var be in ye)Ae.position.add(ye[be].pos_v3),Ae.quaternion.multiply(ye[be].rot_q)}var ve="\u982D",Se=null;if(self.MMD_SA&&(me.is_object||(Se=MMD_SA.get_bone_position(de,ve)),0==this._model_index&&(MMD_SA._head_pos=Se,MMD_SA.SpeechBubble.update_placement(),MMD_SA_options.Dungeon))){var De=MMD_SA_options.Dungeon.character.bb_translate;De&&De.update&&De.update()}var ke;if(self.MMD_SA&&Se&&de.bones_by_name[ve]&&0!=fe&&MMD_SA_options.look_at_screen_by_model(this)&&!1!=me.look_at_screen){var we=MMD_SA.camera_position;if(pe&&pe.center_view_lookAt||MMD_SA_options.center_view_lookAt||MMD_SA_options.use_JSARToolKit&&MMD_SA.AR_obj._m4)ke=!0;else{for(var Ee=MMD_SA_options.camera_position.slice(0),Pe=MMD_SA.center_view,Te=de.position.toArray(),he=0;3>he;he++)Te[he]+=Ee[he]+Pe[he];for(var Ce=[we.x,we.y,we.z],he=0;3>he;he++)if(0.01<Math.abs(Te[he]-Ce[he])){ke=!0;break}}var Ie=!ce&&MMD_SA_options.look_at_mouse||null!=me.look_at_character||me.look_at_target;if(ke||Ie){var Ue=(MMD_SA_options.look_at_screen_parent_rotation||System._browser.camera.facemesh.enabled&&de.bones_by_name..quaternion||MMD_SA.get_bone_rotation_parent(de,ve)).inverse(),ze=MMD_SA.face_camera(Se,Ue),Re=pe.look_at_screen_angle_x_limit||[0.5*Math.PI,0.5*-Math.PI],Le=pe.look_at_screen_angle_y_limit||[0.5*Math.PI,0.5*-Math.PI],Fe=null==fe?MMD_SA_options.look_at_screen_ratio:fe;ze.x=Math.min(Math.max(MMD_SA.normalize_angle(ze.x*Fe),Re[1]),Re[0]),ze.y=Math.min(Math.max(MMD_SA.normalize_angle(ze.y*Fe),Le[1]),Le[0]);var Ve=MMD_SA.TEMP_v3.copy(we).sub(Se);if(0==this._model_index&&(MMD_SA._rx=Math.atan2(-Ve.y,Math.sqrt(Math.pow(Ve.x,2)+Math.pow(Ve.z,2))),MMD_SA._ry=ze.y,MMD_SA._rx_last=ze.x,MMD_SA._ry_last=ze.y),Ie){var Oe;if(null!=me.look_at_character)Oe=THREE.MMD.getModels()[me.look_at_character].mesh.position.clone(),Oe.y+=15;else if(me.look_at_target)Oe=me.look_at_target();else{var Be=webkit_electron_mode?System._browser._electron_cursor_pos:{x:System._browser._WE_mouse_x,y:System._browser._WE_mouse_y},He=webkit_electron_mode?System._browser._electron_window_pos.slice(0):[Lbody_host.style.posLeft,Lbody_host.style.posTop];if(is_SA_child_animation){var je=parent.SA_child_animation[SA_child_animation_id];He[0]+=je.x,He[1]+=je.y}Oe=new THREE.Vector3(640*((Be.x-He[0])/B_content_width-0.5),480*-((Be.y-He[1])/B_content_height-0.5),pe.look_at_mouse_z||0).unproject(MMD_SA._trackball_camera.object);var Ne=MMD_SA._trackball_camera.position0,Pe=MMD_SA.center_view_lookAt;Oe.x+=Ne.x-de.position.x+Pe[0],Oe.z-=Pe[2]}MMD_SA._mouse_pos_3D[this._model_index]?["x","y","z"].forEach(function(yt){var At=Oe[yt]-MMD_SA._mouse_pos_3D[_e._model_index][yt];5<Math.abs(At)&&(At=5*(0<At?1:-1)),MMD_SA._mouse_pos_3D[_e._model_index][yt]+=At}):MMD_SA._mouse_pos_3D[this._model_index]=Oe,MMD_SA._camera_position_=MMD_SA._mouse_pos_3D[this._model_index],ze=MMD_SA.face_camera(Se,Ue),MMD_SA._camera_position_=null,ze.x=Math.min(Math.max(MMD_SA.normalize_angle(ze.x*Fe),Re[1]),Re[0]),ze.y=Math.min(Math.max(MMD_SA.normalize_angle(ze.y*Fe),Le[1]),Le[0])}var Ke,Ge,We,Xe;We=Re[0>ze.x?1:0],Xe=Le[0>ze.y?1:0],Ke=Math.abs(ze.x/We),Ge=Math.abs(ze.y/Xe);for(var qe=MMD_SA_options.look_at_screen_bone_list,he=0,Qe=qe.length;he<Qe;he++){let yt=qe[he],At=de.bones_by_name[yt.name];if(At){let Tt=yt.weight_screen,Ct=MMD_SA_options.model_para_obj.skin_default[yt.name]&&MMD_SA_options.model_para_obj.skin_default[yt.name].pos_scale;Ct&&(Tt*=Math.min(Ct.x,Ct.y,Ct.z));let It,Ut;null==yt.weight_screen_pow?(It=ze.x,Ut=ze.y):(It=We*Math.pow(Ke,yt.weight_screen_pow),Ut=Xe*Math.pow(Ge,yt.weight_screen_pow));let zt=yt.weight_motion,Rt=zt+(1-Fe)*(1-zt),Lt=null==yt.weight_screen_x?1:yt.weight_screen_x,Ft=null==yt.weight_screen_y?1:yt.weight_screen_y;MMD_SA.process_bone(At,MMD_SA.TEMP_v3.set(It*Tt*Lt,Ut*Tt*Ft,0),[Rt+(1-Rt)*(1-Lt),Rt+(1-Rt)*(1-Ft),1])}}if(MMD_SA._update_with_look_at_screen_){for(var Ye=MMD_SA._update_with_look_at_screen_.bone_list,Je=MMD_SA._update_with_look_at_screen_.parent_list,Ze=MMD_SA.TEMP_q.set(0,0,0,1),$e=0,et=Je.length,tt;$e<et;$e++)tt=de.bones_by_name[Je[$e]],tt&&Ze.multiply(tt.quaternion,Ze);Ze.inverse();for(var $e=0,et=Ye.length;$e<et;$e++){let yt=Ye[$e],At;for(var ot=0,it=yt.name.length;ot<it;ot++){let bt=de.bones_by_name[yt.name[ot]];if(bt){if(!At){At=MMD_SA._q1.copy(Ze);let vt=yt.ratio;1>vt&&(At.inverse(),vt=-vt),At.slerp(MMD_SA._q2.set(0,0,0,1),1-vt/3)}bt.quaternion.multiply(At)}}}MMD_SA._update_with_look_at_screen_=null}}}if(ke||0!=this._model_index||(MMD_SA._rx=MMD_SA._rx_last=0,MMD_SA._ry=MMD_SA._ry_last=0),self.MMD_SA&&0==this._model_index){var rt=this,nt=MMD_SA_options.custom_action.length;if(!le&&9<self.EV_usage){var st=[];60>EV_usage?st.push(~~(EV_usage/10)-1):st.push(4,~~(EV_usage/10-1));for(var he=0,lt=rt.skin_MMD_SA_extra.length-nt;he<lt;he++){for(var pt=rt.skin_MMD_SA_extra[he+nt],ft=!1,ot=0,ct=st.length;ot<ct;ot++)if(he==st[ot]){ft=!0;break}ft?pt._MMD_SA_disabled&&(pt._MMD_SA_disabled=!1,pt.reset(),pt.play()):!pt._MMD_SA_disabled&&(pt.pause(),pt._MMD_SA_disabled=!0)}}else for(var he=0,lt=rt.skin_MMD_SA_extra.length-nt,pt;he<lt;he++)pt=rt.skin_MMD_SA_extra[he+nt],pt._MMD_SA_disabled||(pt.pause(),pt._MMD_SA_disabled=!0)}}if(self.MMD_SA){var ut=me._custom_skin||MMD_SA._custom_skin;ut.forEach(function(yt){(!yt.condition||yt.condition(_e))&&MMD_SA._skin_onupdate.call({mesh:de},yt.key,yt.key,0,yt.idx)}),me._custom_skin=null,MMD_SA._custom_skin=[];var ht=pe.adjustment_per_model&&(pe.adjustment_per_model[me._filename]||pe.adjustment_per_model[me._filename_cleaned]||pe.adjustment_per_model._default_);if(ht&&ht.skin_default)for(var xe in ht.skin_default){var Ae=ht.skin_default[xe];if(Ae.pos_scale&&Ae.pos_scale.auto_adjust&&-1!=xe.indexOf("\u8DB3\uFF29\uFF2B")&&me._ref_length&&me._ref_length[xe]){var Mt=MMD_SA.get_bone_position(de,xe),gt=MMD_SA.get_bone_position(de,xe.substring(0,2)),xt=gt.sub(Mt).setY(0).multiplyScalar(1-((me._ref_length[xe]/Ae.pos_scale.auto_adjust.ref_length-1)*(Ae.pos_scale.auto_adjust.scale||1)+1));de.bones_by_name[xe].position.sub(xt)}}}this._update_IK_and_AddTrans(),!self.MMD_SA||pe.process_bones_after_IK&&pe.process_bones_after_IK(this,this.skin)||(me.process_bones_after_IK&&me.process_bones_after_IK(this,this.skin),window.dispatchEvent(new CustomEvent("SA_MMD_model"+this._model_index+"_process_bones_after_IK",{detail:{model:this,skin:this.skin}}))),self.MMD_SA&&MMD_SA_options.model_para_obj_all.forEach(function(yt,At){if(At!=_e._model_index){var bt=yt.bone_connection;if(bt&&bt.target_model_index==_e._model_index){var vt=MMD_SA.get_bone_position(de,bt.target_bone_name),St=MMD_SA.get_bone_rotation(de,bt.target_bone_name);bt.position&&vt.add(MMD_SA.TEMP_v3.set(-bt.position.x,bt.position.y,-bt.position.z).applyQuaternion(St)),bt.rotation&&(!bt.rotation._quaternion&&(bt.rotation._quaternion=new THREE.Quaternion().setFromEuler(MMD_SA.TEMP_v3.set(bt.rotation.x*Math.PI/180,-bt.rotation.y*Math.PI/180,bt.rotation.z*Math.PI/180))),St.multiply(bt.rotation._quaternion)),yt._custom_skin=[{key:{name:bt.self_bone_name,pos:vt.toArray(),rot:St.toArray(),interp:MMD_SA._skin_interp_default},idx:THREE.MMD.getModels()[At].mesh.bones_by_name[bt.self_bone_name]._index}]}}}),this.checkCallback()}},X.prototype.seekMotion=function(ne,se){this.resetBones(),this.morph&&this.morph.seek(ne,se),this.skin&&this.skin.seek(ne,se),this._update_IK_and_AddTrans(),this.checkCallback()},X.prototype.playMotion=function(ne){this.morph&&(this.morph.play(ne),this.morph_MMD_SA_extra&&this.morph_MMD_SA_extra.forEach(function(se){se._MMD_SA_disabled||se.play(ne)})),this.skin&&(this.skin.play(ne),this.skin_MMD_SA_extra&&this.skin_MMD_SA_extra.forEach(function(se){se._MMD_SA_disabled||se.play(ne)}))},X.prototype.pauseMotion=function(){this.morph&&(this.morph.pause(),this.morph_MMD_SA_extra&&this.morph_MMD_SA_extra.forEach(function(ne){ne._MMD_SA_disabled||ne.pause()})),this.skin&&(this.skin.pause(),this.skin_MMD_SA_extra&&this.skin_MMD_SA_extra.forEach(function(ne){ne._MMD_SA_disabled||ne.pause()}))},X.prototype.preSimulate=function(){this.physi&&this.physi.preSimulate()},X.prototype.postSimulate=function(){this.physi&&this.physi.postSimulate()},X.prototype.dispose=function(){this.physi&&this.physi.dispose(),this.mesh&&this.mesh.dispose(),this.init()},X.prototype.checkCallback=function(){this._onmotionended&&(this._onmotionended(this),this._onmotionended=null)}})();var ae=[],oe,ie;(function(){var re,ne,se,de,_e,le,me,pe,fe,ce;oe=[],re=!1,ne=!1,se=0,de=0,_e=!1,le=!0,pe={render:function(ue){var he;ee.targetScene&&ee.targetScene!==ue||(ee.motionPlaying||_e||le?(_e=!1,he=se):he=0,ee.simulate(he))}},ce=function(){fe&&(fe(),fe=void 0)},ee={addModel:function(ue){ue._model_index=ue.pmx._model_index,oe.push(ue)},removeModel:function(ue){var he;he=oe.indexOf(ue),0<=he&&oe.splice(he,1)},getModels:function(){return oe},swapModels:function(ue,he,Me){[ue,he].forEach(function(ve){var Se=oe[ve],De=ve==ue?he:ue;for(var ke in Se._model_index=Se.mesh._model_index=Se.pmx._model_index=De,Se.morph_MMD_SA_extra&&Se.morph_MMD_SA_extra.forEach(function(Ee){Ee._model_index=De}),Se.skin_MMD_SA_extra&&Se.skin_MMD_SA_extra.forEach(function(Ee){Ee._model_index=De}),Se._MMD_SA_cache){var we=Se._MMD_SA_cache[ke];we.morph&&(we.morph._model_index=De),we.skin&&(we.skin._model_index=De)}});var ge,xe;ge=oe[ue],xe=oe[he],oe[ue]=xe,oe[he]=ge,ge=MMD_SA_options.model_para_obj_all[ue],xe=MMD_SA_options.model_para_obj_all[he],MMD_SA_options.model_para_obj_all[ue]=xe,MMD_SA_options.model_para_obj_all[he]=ge,MMD_SA_options.model_para_obj_all[ue]._model_index=ue,MMD_SA_options.model_para_obj_all[he]._model_index=he,ge=MMD_SA_options.mesh_obj_by_id["mikuPmx"+ue],xe=MMD_SA_options.mesh_obj_by_id["mikuPmx"+he],MMD_SA_options.mesh_obj_by_id["mikuPmx"+ue]=xe,MMD_SA_options.mesh_obj_by_id["mikuPmx"+he]=ge,MMD_SA.ammo_proxy&&["cache_by_model","cache_by_model_next","cache_by_model_temp"].forEach(function(ve){ge=MMD_SA.ammo_proxy[ve].list[ue],xe=MMD_SA.ammo_proxy[ve].list[he],MMD_SA.ammo_proxy[ve].list[ue]=xe,MMD_SA.ammo_proxy[ve].list[he]=ge});var ye={},Ae={},be=["position","rotation","quaternion"];be.forEach(function(ve){ye[ve]=oe[ue].mesh[ve].clone(),Ae[ve]=oe[he].mesh[ve].clone()}),Me&&Me(ue,he),be.forEach(function(ve){oe[ue].mesh[ve].copy(Ae[ve]),oe[he].mesh[ve].copy(ye[ve])}),0==ue&&(MMD_SA_options.model_para_obj=MMD_SA_options.model_para_obj_all[0],oe[0].mesh.visible=!0,oe[0].mesh.children.forEach(function(ve){ve.visible=!0}))},setupCameraMotion:function(ue,he){var Me=ue.generateCameraAnimation(),ge,xe;ae.forEach(function(ye,Ae){ye.persepectiveCamera===he&&(xe=Ae)}),isFinite(xe)&&ae.splice(xe,1),Me&&(ge=new G(he,Me),ae.push(ge),ge.vmd=ue)},getCameraMotion:function(){return ae},setupLightMotion:function(ue,he){var Me;Me=ue.generateLightAnimation(),Me?(ie=new W(he,Me),ie.vmd=ue):ie=void 0},getLightMotion:function(){return ie},adjustMotionDuration:function(){var ue=jThree.MMD._duration;ae.forEach(function(he){ue=Math.max(ue,he.duration)}),ie&&(ue=Math.max(ue,ie.duration)),oe.forEach(function(he){0<he._model_index||(he.skin&&(ue=Math.max(ue,he.skin.duration_default)),he.morph&&(ue=Math.max(ue,he.morph.duration_default)))}),ae.forEach(function(he){he.adjustDuration(ue)}),ie&&ie.adjustDuration(ue),oe.forEach(function(he){0<he._model_index||(he.skin&&he.skin.adjustDuration(ue),he.morph&&he.morph.adjustDuration(ue))})},resetMotion:function(){ae.forEach(function(ue){ue.reset()}),ie&&ie.reset(),oe.forEach(function(ue){ue.resetMotion()}),de=0},updateMotion:function(ue,he){se=ue;(he||re)&&(ae.forEach(function(Me){Me.update(ue,he)}),ie&&ie.update(ue,he),oe.forEach(function(Me){Me.updateMotion(ue,he)}),window.dispatchEvent(new CustomEvent("SA_MMD_model_all_process_bones")),ce(),de+=ue)},seekMotion:function(ue,he){(he||re)&&(ae.forEach(function(Me){Me.seek(ue,he)}),ie&&ie.seek(ue,he),oe.forEach(function(Me){Me.seekMotion(ue,he)}),ce(),_e=!0,de=ue)},playMotion:function(ue){var he;he=this,ue!==void 0&&(ne=ue),ae.forEach(function(Me){Me.play(ne)}),ie&&ie.play(ne),oe.forEach(function(Me){Me.playMotion(ne)}),0<oe.length&&(oe[0].onmotionended=function(){ne?de=0:he.pauseMotion(),fe=ee.onmotionended}),re=!0},pauseMotion:function(ue){le=ue,ae.forEach(function(he){he.pause()}),ie&&ie.pause(),oe.forEach(function(he){he.pauseMotion()}),re=!1},adjustCameraOffset:function(ue){var he,Me,ge;ue?(he=ue.model,Me=ue.offset):0<oe.length&&(he=oe[0]),he&&(ge=he.mesh.geometry.boundingBox.size()),ae.offset.set(0,0,0),ge&&(ae.offset.y=ge.y-20),Me&&ae.offset.addVectors(ae.offset,Me)},getWorld:function(){return Q},setGravity:function(ue,he,Me){Q.setGravity(Y(ue,he,Me))},simulate:function(ue,he){var Me=ue;self.MMD_SA&&MMD_SA.ammo_proxy&&MMD_SA.ammo_proxy.lock("stepSimulation");performance.now();if(0!==oe.length){if(0>=ue);else{if(self.MMD_SA){if(MMD_SA._motionTime_last==THREE.MMD.motionTime)return;MMD_SA._motionTime_last=THREE.MMD.motionTime,ue+=MMD_SA.ammo_proxy&&MMD_SA.ammo_proxy._timeStep||0}ue<Z&&(ue=Z),he=he||Math.ceil(ue/Z),self.MMD_SA&&(he=Math.min(Math.ceil(ue/Z),MMD_SA_options.model_para_obj.physics_maxSubSteps||MMD_SA_options.physics_maxSubSteps||9)),oe.forEach(function(xe){xe.visible&&xe.preSimulate()}),Q&&Q.stepSimulation(ue,he,Z),oe.forEach(function(xe){xe.visible&&xe.postSimulate()}),self.MMD_SA&&(MMD_SA.ammo_proxy&&(MMD_SA.ammo_proxy.update_worker("stepSimulation")?(MMD_SA.ammo_proxy.cache_by_model_temp.transfer_to("cache_by_model_next"),MMD_SA.ammo_proxy._timeStep=0):(MMD_SA.ammo_proxy._timeStep+=Me,MMD_SA.ammo_proxy.reset())),MMD_SA.physicsHelper&&MMD_SA.physicsHelper.update())}oe.forEach(function(xe){xe.simulateCallback&&xe.simulateCallback()})}},init:function(ue,he){ee.targetScene=he,ee.targetRenderer=ue},targetScene:null,get targetRenderer(){return me},set targetRenderer(ue){me!==ue&&(me=ue,-1===ue.renderPluginsPre.indexOf(pe)&&ue.renderPluginsPre.unshift(pe))},get motionPlaying(){return re},get motionLoop(){return ne},get motionDelta(){return se},get motionTime(){return de},onmotionended:null,minKeyDelta:1/30+1/60,STOP_ERP:0.475,PMX:P,VMD:T,Model:X}})(),THREE.MMD=ee,THREE.Mesh.prototype.dispose=function(){function re(ne){var se,de;for(de in ne)se=ne[de],se instanceof THREE.Texture&&se.dispose()}this.material.materials?this.material.materials.forEach(function(ne){re(ne),ne.dispose()}):(re(this.material),this.material.dispose()),this.geometry.dispose()},jThree._ammo_async_init_.push(function(){if(window.Ammo&&ee.setGravity(0,-98,0),window.Ammo){var re=new Ammo.btVector3,ne=new Ammo.btTransform,se,de,_e,le;re.setValue(0,1,0),se=new Ammo.btStaticPlaneShape(re,0),de=new Ammo.btVector3(0,0,0),se.calculateLocalInertia(0,de),ne.setIdentity(),_e=new Ammo.btRigidBodyConstructionInfo(0,new Ammo.btDefaultMotionState(ne),se,de),self.MMD_SA&&!MMD_SA_options.ground_physics_disabled&&(le=new Ammo.btRigidBody(_e),Q.addRigidBody(le),jThree.MMD._ground=le.getWorldTransform().getOrigin(),MMD_SA_options.ground_y&&jThree.MMD._ground.setY(MMD_SA_options.ground_y)),Ammo.destroy(_e),Ammo.destroy(de),Ammo.destroy(ne),Ammo.destroy(re)}self.MMD_SA&&MMD_SA.ammo_proxy&&MMD_SA.ammo_proxy.update_worker()}),self.MMD_SA&&MMD_SA_options.ammo_version&&!MMD_SA._ammo_async_loaded_||(jThree._ammo_async_init_.forEach(function(re){re()}),jThree._ammo_async_init_=[]),jThree.modelHooks.pmx=function(re,ne){new P().load(re,function(se){ne(se),ne=null})},jThree.motionHooks.vmd=function(re,ne){new T().load(re,function(se){ne(se),ne=null})},jThree.mmdHook=function(re,ne,se){var de=jThree.three(this),_e;if(/(\d+)$/.test(this.getAttribute("model"))&&(_e=parseInt(RegExp.$1)),!ne)(function(){var me=_e;MMD_SA.fn._model_creation_timerID[me]=setInterval(function(){MMD_SA.fn._ready_for_model_creation[me]&&(new THREE.MMD.Model(re).create(jThree.MMD,function(pe){var fe=pe.mesh;de.__mmd=pe,fe.material.materials.forEach(function(Me){Me.fog=!0,Me.lights=!0}),de.addEventListener("removed",d),THREE.MMD.addModel(pe),se(fe),de=se=null;var ce=MMD_SA_options.model_para_obj_all[re._model_index],ue=ce.position_loading;if(!ue){var he=ce.skin_default.;ue=he&&(he.pos||he.pos_add||he.pos_add_absolute),ue&&(ue==he.pos||ue==he.pos_add)&&he.pos_add_absolute&&(ue={x:ue.x+he.pos_add_absolute.x,y:ue.y+he.pos_add_absolute.y,z:ue.z+he.pos_add_absolute.z})}ue&&fe.position.set(ue.x,ue.y,ue.z)}),clearInterval(MMD_SA.fn._model_creation_timerID[me]),MMD_SA.fn._model_creation_timerID[me]=null,setTimeout("MMD_SA.fn.setupUI()",0))},500)})();else{function me(fe){var ce=jThree.three(this)._srcObj||(self.MMD_SA&&this._id?MMD_SA._j3_obj_by_id[this._id]:null);(function(){var ue=_e;MMD_SA.fn._model_creation_timerID[ue]=setInterval(function(){MMD_SA.fn._ready_for_model_creation[ue]&&(new THREE.MMD.Model(re,ce).create(jThree.MMD,function(he){var Me=he.mesh;de.__mmd=he,Me.material.materials.forEach(function(Ae){Ae.fog=!0,Ae.lights=!0}),de.addEventListener("removed",d),THREE.MMD.addModel(he),THREE.MMD.adjustMotionDuration(),se(Me),de=se=null;var ge=MMD_SA_options.model_para_obj_all[re._model_index],xe=ge.skin_default.,ye=ge.position_loading||xe&&(xe.pos||xe.pos_add);ye&&Me.position.set(ye.x,ye.y,ye.z)}),clearInterval(MMD_SA.fn._model_creation_timerID[ue]),MMD_SA.fn._model_creation_timerID[ue]=null,setTimeout("MMD_SA.fn.setupUI()",0))},500)})(),fe&&($.event.remove(this,"load",me),$.event.remove(this,"error",pe)),le=null}function pe(){$.event.remove(this,"load",me),$.event.remove(this,"error",pe),$.event.trigger("error",void 0,le),le=de=se=null}var le=this;switch(ne.attr("loadStates")){case"loading":ne.load(me),ne.error(pe);break;case"success":me.call(ne);break;default:$.event.trigger("error",void 0,this);}}},jThree.otherMmdHook=function(re){function ne(le){var me=THREE.MMD["setup"+("CAMERA"===de.tagName?"Camera":"Light")+"Motion"],pe=jThree.three(de),fe=jThree.three(this)._srcObj;me(fe,pe),THREE.MMD.adjustMotionDuration(),$.event.trigger("load",void 0,de),le&&($.event.remove(this,"load",ne),$.event.remove(this,"error",se)),de=null}function se(){$.event.remove(this,"load",ne),$.event.remove(this,"error",se),$.event.trigger("error",void 0,de),de=null}var de=this;switch(re.attr("loadStates")){case"loading":re.load(ne),re.error(se);break;case"success":ne.call(re[0]);break;default:if("CAMERA"===this.tagName){var _e=jThree.three(this);ae.forEach(function(le,me){le.persepectiveCamera===_e&&ae.splice(me,1)}),_e=null}else ie=null;$.event.trigger("load",void 0,this);}},jThree.MMD._simulate={render:function(){motionSeek=!1,self.MMD_SA?ee.simulate(ee.motionPlaying||motionSeek?ee.motionDelta/(MMD_SA._playbackRate*MMD_SA.playbackRate):0):ee.simulate(ee.motionPlaying||motionSeek?ee.motionDelta:0)}},jThree.MMD.seek=THREE.MMD.seekMotion}(),THREE.MMDPhysicsHelper=function(d){THREE.Object3D.call(this),this.root=d,this.matrix=d.matrixWorld.clone(),this.matrixAutoUpdate=!1,this.materials=[],this.materials.push(new THREE.MeshBasicMaterial({color:new THREE.Color(16746632),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:0.25,transparent:!0})),this.materials.push(new THREE.MeshBasicMaterial({color:new THREE.Color(8978312),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:0.25,transparent:!0})),this.materials.push(new THREE.MeshBasicMaterial({color:new THREE.Color(8947967),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:0.25,transparent:!0})),this._init(),this.update()},THREE.MMDPhysicsHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.MMDPhysicsHelper.prototype.constructor=THREE.MMDPhysicsHelper,THREE.MMDPhysicsHelper.prototype._init=function(){function d(D){switch(D.shape){case 0:return new THREE.SphereGeometry(D.size[0],16,8);case 1:return new THREE.CubeGeometry(2*D.size[0],2*D.size[1],2*D.size[2],8,8,8);case 2:return _(D.size[0],D.size[1],16,8);default:return null;}}function _(D,E,P,T){var C=new THREE.CylinderGeometry(D,D,E,P,T,!0);return C}for(var u=this.root,M=u.MMDrigids,g=0,A=M.length,S;g<A;g++){S=M[g];let D=new THREE.Mesh(d(S),this.materials[S.type]);D.useQuaternion=!0,this.add(D)}},THREE.MMDPhysicsHelper.prototype.update=function(){function d(T){return A.set(T.x(),T.y(),T.z()),A}function _(T){return S.set(T.x(),T.y(),T.z(),T.w()),D.setFromRotationMatrix(g),D.multiply(S),D}for(var u=this.root,M=u.MMDrigids,g=new THREE.Matrix4().getInverse(u.matrixWorld),A=new THREE.Vector3,S=new THREE.Quaternion,D=new THREE.Quaternion,E=0,P=M.length;E<P;E++){let T=M[E].body,C=this.children[E],I=T.getCenterOfMassTransform();C.position.copy(d(I.getOrigin())),C.quaternion.copy(_(I.getRotation()))}this.matrix.copy(this.root.matrix),this.updateMatrix()},function(){"use strict";var d="?".charCodeAt(0),_={SJISToUTF8:function(M){for(var g=[],A=M.length,S=0,D,E,P,T,C,I;S<A;S++)161<=M[S]&&223>=M[S]?(E=M[S]-64,P=188|3&E>>6,T=128|63&E,g[g.length]=239,g[g.length]=P,g[g.length]=T):128<=M[S]?(D=M[S]<<1,E=M[++S],159>E?(D-=319>D?225:97,E-=126<E?32:31):(D-=319>D?224:96,E-=126),D&=255,C=(D<<8)+E,void 0===u[C]?g[g.length]=d:(I=u[C],65535>I?(g[g.length]=255&I>>8,g[g.length]=255&I):(g[g.length]=255&I>>16,g[g.length]=255&I>>8,g[g.length]=255&I))):g[g.length]=M[S];return g},UTF8ToUNICODE:function(M){for(var g=[],A=0,S=M.length,D,E,P,T,C;A<S;)E=M[A++],D=E>>4,0<=D&&7>=D?g[g.length]=E:12<=D&&13>=D?(P=M[A++],g[g.length]=(31&E)<<6|63&P):14===D?(P=M[A++],T=M[A++],g[g.length]=(15&E)<<12|(63&P)<<6|(63&T)<<0):A+2<S&&(P=M[A++],T=M[A++],C=M[A++],g[g.length]=(7&E)<<18|(63&P)<<12|(63&T)<<6|(63&C)<<0);return g},SJISToUNICODE:function(M){return _.UTF8ToUNICODE(_.SJISToUTF8(M))}},u={8481:14909568,8482:14909569,8483:14909570,8484:15711372,8485:15711374,8486:14910395,8487:15711386,8488:15711387,8489:15711391,8490:15711361,8491:14910107,8492:14910108,8493:49844,8494:15711616,8495:49832,8496:15711422,8497:15712163,8498:15711423,8499:14910397,8500:14910398,8501:14910109,8502:14910110,8503:14909571,8504:14990237,8505:14909573,8506:14909574,8507:14909575,8508:14910396,8509:14844053,8510:14844048,8511:15711375,8512:15711420,8513:15711646,8514:14844054,8515:15711644,8516:14844070,8517:14844069,8518:14844056,8519:14844057,8520:14844060,8521:14844061,8522:15711368,8523:15711369,8524:14909588,8525:14909589,8526:15711419,8527:15711421,8528:15711643,8529:15711645,8530:14909576,8531:14909577,8532:14909578,8533:14909579,8534:14909580,8535:14909581,8536:14909582,8537:14909583,8538:14909584,8539:14909585,8540:15711371,8541:15711373,8542:49841,8543:50071,8544:50103,8545:15711389,8546:14846368,8547:15711388,8548:15711390,8549:14846374,8550:14846375,8551:14846110,8552:14846132,8553:14850434,8554:14850432,8555:49840,8556:14844082,8557:14844083,8558:14845059,8559:15712165,8560:15711364,8561:15712160,8562:15712161,8563:15711365,8564:15711363,8565:15711366,8566:15711370,8567:15711392,8568:49831,8569:14850182,8570:14850181,8571:14849931,8572:14849935,8573:14849934,8574:14849927,8737:14849926,8738:14849697,8739:14849696,8740:14849715,8741:14849714,8742:14849725,8743:14849724,8744:14844091,8745:14909586,8746:14845586,8747:14845584,8748:14845585,8749:14845587,8750:14909587,8762:14846088,8763:14846091,8764:14846598,8765:14846599,8766:14846594,8767:14846595,8768:14846122,8769:14846121,8778:14846119,8779:14846120,8780:49836,8781:14845842,8782:14845844,8783:14846080,8784:14846083,8796:14846112,8797:14846629,8798:14847122,8799:14846082,8800:14846087,8801:14846369,8802:14846354,8803:14846378,8804:14846379,8805:14846106,8806:14846141,8807:14846109,8808:14846133,8809:14846123,8810:14846124,8818:14845099,8819:14844080,8820:14850479,8821:14850477,8822:14850474,8823:14844064,8824:14844065,8825:49846,8830:14849967,9008:15711376,9009:15711377,9010:15711378,9011:15711379,9012:15711380,9013:15711381,9014:15711382,9015:15711383,9016:15711384,9017:15711385,9025:15711393,9026:15711394,9027:15711395,9028:15711396,9029:15711397,9030:15711398,9031:15711399,9032:15711400,9033:15711401,9034:15711402,9035:15711403,9036:15711404,9037:15711405,9038:15711406,9039:15711407,9040:15711408,9041:15711409,9042:15711410,9043:15711411,9044:15711412,9045:15711413,9046:15711414,9047:15711415,9048:15711416,9049:15711417,9050:15711418,9057:15711617,9058:15711618,9059:15711619,9060:15711620,9061:15711621,9062:15711622,9063:15711623,9064:15711624,9065:15711625,9066:15711626,9067:15711627,9068:15711628,9069:15711629,9070:15711630,9071:15711631,9072:15711632,9073:15711633,9074:15711634,9075:15711635,9076:15711636,9077:15711637,9078:15711638,9079:15711639,9080:15711640,9081:15711641,9082:15711642,9249:14909825,9250:14909826,9251:14909827,9252:14909828,9253:14909829,9254:14909830,9255:14909831,9256:14909832,9257:14909833,9258:14909834,9259:14909835,9260:14909836,9261:14909837,9262:14909838,9263:14909839,9264:14909840,9265:14909841,9266:14909842,9267:14909843,9268:14909844,9269:14909845,9270:14909846,9271:14909847,9272:14909848,9273:14909849,9274:14909850,9275:14909851,9276:14909852,9277:14909853,9278:14909854,9279:14909855,9280:14909856,9281:14909857,9282:14909858,9283:14909859,9284:14909860,9285:14909861,9286:14909862,9287:14909863,9288:14909864,9289:14909865,9290:14909866,9291:14909867,9292:14909868,9293:14909869,9294:14909870,9295:14909871,9296:14909872,9297:14909873,9298:14909874,9299:14909875,9300:14909876,9301:14909877,9302:14909878,9303:14909879,9304:14909880,9305:14909881,9306:14909882,9307:14909883,9308:14909884,9309:14909885,9310:14909886,9311:14909887,9312:14910080,9313:14910081,9314:14910082,9315:14910083,9316:14910084,9317:14910085,9318:14910086,9319:14910087,9320:14910088,9321:14910089,9322:14910090,9323:14910091,9324:14910092,9325:14910093,9326:14910094,9327:14910095,9328:14910096,9329:14910097,9330:14910098,9331:14910099,9505:14910113,9506:14910114,9507:14910115,9508:14910116,9509:14910117,9510:14910118,9511:14910119,9512:14910120,9513:14910121,9514:14910122,9515:14910123,9516:14910124,9517:14910125,9518:14910126,9519:14910127,9520:14910128,9521:14910129,9522:14910130,9523:14910131,9524:14910132,9525:14910133,9526:14910134,9527:14910135,9528:14910136,9529:14910137,9530:14910138,9531:14910139,9532:14910140,9533:14910141,9534:14910142,9535:14910143,9536:14910336,9537:14910337,9538:14910338,9539:14910339,9540:14910340,9541:14910341,9542:14910342,9543:14910343,9544:14910344,9545:14910345,9546:14910346,9547:14910347,9548:14910348,9549:14910349,9550:14910350,9551:14910351,9552:14910352,9553:14910353,9554:14910354,9555:14910355,9556:14910356,9557:14910357,9558:14910358,9559:14910359,9560:14910360,9561:14910361,9562:14910362,9563:14910363,9564:14910364,9565:14910365,9566:14910366,9567:14910367,9568:14910368,9569:14910369,9570:14910370,9571:14910371,9572:14910372,9573:14910373,9574:14910374,9575:14910375,9576:14910376,9577:14910377,9578:14910378,9579:14910379,9580:14910380,9581:14910381,9582:14910382,9583:14910383,9584:14910384,9585:14910385,9586:14910386,9587:14910387,9588:14910388,9589:14910389,9590:14910390,9761:52881,9762:52882,9763:52883,9764:52884,9765:52885,9766:52886,9767:52887,9768:52888,9769:52889,9770:52890,9771:52891,9772:52892,9773:52893,9774:52894,9775:52895,9776:52896,9777:52897,9778:52899,9779:52900,9780:52901,9781:52902,9782:52903,9783:52904,9784:52905,9793:52913,9794:52914,9795:52915,9796:52916,9797:52917,9798:52918,9799:52919,9800:52920,9801:52921,9802:52922,9803:52923,9804:52924,9805:52925,9806:52926,9807:52927,9808:53120,9809:53121,9810:53123,9811:53124,9812:53125,9813:53126,9814:53127,9815:53128,9816:53129,10017:53392,10018:53393,10019:53394,10020:53395,10021:53396,10022:53397,10023:53377,10024:53398,10025:53399,10026:53400,10027:53401,10028:53402,10029:53403,10030:53404,10031:53405,10032:53406,10033:53407,10034:53408,10035:53409,10036:53410,10037:53411,10038:53412,10039:53413,10040:53414,10041:53415,10042:53416,10043:53417,10044:53418,10045:53419,10046:53420,10047:53421,10048:53422,10049:53423,10065:53424,10066:53425,10067:53426,10068:53427,10069:53428,10070:53429,10071:53649,10072:53430,10073:53431,10074:53432,10075:53433,10076:53434,10077:53435,10078:53436,10079:53437,10080:53438,10081:53439,10082:53632,10083:53633,10084:53634,10085:53635,10086:53636,10087:53637,10088:53638,10089:53639,10090:53640,10091:53641,10092:53642,10093:53643,10094:53644,10095:53645,10096:53646,10097:53647,10273:14849152,10274:14849154,10275:14849164,10276:14849168,10277:14849176,10278:14849172,10279:14849180,10280:14849196,10281:14849188,10282:14849204,10283:14849212,10284:14849153,10285:14849155,10286:14849167,10287:14849171,10288:14849179,10289:14849175,10290:14849187,10291:14849203,10292:14849195,10293:14849211,10294:14849419,10295:14849184,10296:14849199,10297:14849192,10298:14849207,10299:14849215,10300:14849181,10301:14849200,10302:14849189,10303:14849208,10304:14849410,11553:14848416,11554:14848417,11555:14848418,11556:14848419,11557:14848420,11558:14848421,11559:14848422,11560:14848423,11561:14848424,11562:14848425,11563:14848426,11564:14848427,11565:14848428,11566:14848429,11567:14848430,11568:14848431,11569:14848432,11570:14848433,11571:14848434,11572:14848435,11573:14845344,11574:14845345,11575:14845346,11576:14845347,11577:14845348,11578:14845349,11579:14845350,11580:14845351,11581:14845352,11582:14845353,11584:14912905,11585:14912660,11586:14912674,11587:14912909,11588:14912664,11589:14912679,11590:14912643,11591:14912694,11592:14912913,11593:14912919,11594:14912653,11595:14912678,11596:14912675,11597:14912683,11598:14912906,11599:14912699,11600:14913180,11601:14913181,11602:14913182,11603:14913166,11604:14913167,11605:14913412,11606:14913185,11615:14912955,11616:14909597,11617:14909599,11618:14845078,11619:14913421,11620:14845089,11621:14912164,11622:14912165,11623:14912166,11624:14912167,11625:14912168,11626:14911665,11627:14911666,11628:14911673,11629:14912958,11630:14912957,11631:14912956,11635:14846126,11636:14846097,11640:14846111,11641:14846655,12321:14989980,12322:15045782,12323:15050883,12324:15308991,12325:15045504,12326:15107227,12327:15109288,12328:15050678,12329:15302818,12330:15241653,12331:15240348,12332:15182224,12333:15106730,12334:15110049,12335:15120549,12336:15112109,12337:15241638,12338:15239846,12339:15314869,12340:15114899,12341:15047847,12342:15111841,12343:15108529,12344:15052443,12345:15050640,12346:15243707,12347:15311796,12348:15185314,12349:15185598,12350:15314574,12351:15108246,12352:15184543,12353:15246007,12354:15052425,12355:15055541,12356:15109257,12357:15112855,12358:15114632,12359:15308679,12360:15310477,12361:15113615,12362:14990245,12363:14990474,12364:14990733,12365:14991005,12366:15040905,12367:15047602,12368:15049911,12369:15050644,12370:15050881,12371:15052937,12372:15106975,12373:15107215,12374:15107504,12375:15112339,12376:15115397,12377:15172282,12378:15177103,12379:15177136,12380:15181755,12381:15185581,12382:15185839,12383:15238019,12384:15241358,12385:15245731,12386:15248514,12387:15303061,12388:15303098,12389:15043771,12390:14989973,12391:14989989,12392:15048607,12393:15237810,12394:15303553,12395:15180719,12396:14989440,12397:15049649,12398:15121058,12399:15302840,12400:15182002,12401:15240360,12402:15239819,12403:15315119,12404:15041921,12405:15044016,12406:15045309,12407:15045537,12408:15047584,12409:15050683,12410:15056021,12411:15311794,12412:15120299,12413:15238052,12414:15242413,12577:15309218,12578:15309232,12579:15309472,12580:15310779,12581:15044747,12582:15044531,12583:15052423,12584:15172495,12585:15187645,12586:15253378,12587:15309736,12588:15044015,12589:15316380,12590:15182522,12591:14989457,12592:15180435,12593:15239100,12594:15120550,12595:15046808,12596:15045764,12597:15117469,12598:15242394,12599:15315131,12600:15050661,12601:15044265,12602:15119782,12603:15176604,12604:15308431,12605:15047042,12606:14989969,12607:15303051,12608:15309746,12609:15240591,12610:15312012,12611:15044513,12612:15046326,12613:15051952,12614:15056305,12615:15112352,12616:15113139,12617:15114372,12618:15118520,12619:15119283,12620:15119529,12621:15176091,12622:15178632,12623:15182222,12624:15311028,12625:15240113,12626:15245723,12627:15247776,12628:15305645,12629:15120050,12630:15177387,12631:15178634,12632:15312773,12633:15106726,12634:15248513,12635:15251082,12636:15308466,12637:15115918,12638:15044269,12639:15042182,12640:15047826,12641:15048880,12642:15050116,12643:15052468,12644:15055798,12645:15106216,12646:15109801,12647:15110068,12648:15119039,12649:15121556,12650:15172238,12651:15172756,12652:15173017,12653:15173525,12654:15174847,12655:15186049,12656:15239606,12657:15240081,12658:15242903,12659:15303072,12660:15305115,12661:15316123,12662:15049129,12663:15111868,12664:15118746,12665:15176869,12666:15042489,12667:15049902,12668:15050149,12669:15056512,12670:15056796,12833:15108796,12834:15112122,12835:15116458,12836:15117479,12837:15118004,12838:15175307,12839:15187841,12840:15246742,12841:15316140,12842:15316110,12843:15317892,12844:15053473,12845:15118998,12846:15240635,12847:15041668,12848:15053195,12849:15107766,12850:15239046,12851:15114678,12852:15174049,12853:14989721,12854:14991290,12855:15044024,12856:15106473,12857:15120553,12858:15182223,12859:15310771,12860:14989451,12861:15043734,12862:14990254,12863:14990741,12864:14990525,12865:14991009,12866:14990771,12867:15043232,12868:15044527,12869:15046793,12870:15049871,12871:15051649,12872:15052470,12873:15052705,12874:15181713,12875:15112839,12876:15113884,12877:15113910,12878:15117708,12879:15119027,12880:15172011,12881:15175554,12882:15181453,12883:15181502,12884:15182012,12885:15183495,12886:15239857,12887:15240091,12888:15240324,12889:15240631,12890:15241135,12891:15241107,12892:15244710,12893:15248050,12894:15046825,12895:15250088,12896:15253414,12897:15303054,12898:15309982,12899:15243914,12900:14991236,12901:15053736,12902:15108241,12903:15174041,12904:15176891,12905:15239077,12906:15239869,12907:15244222,12908:15250304,12909:15309701,12910:15312019,12911:15312789,12912:14990219,12913:14990490,12914:15247267,12915:15047582,12916:15049098,12917:15049610,12918:15055803,12919:15056811,12920:15106218,12921:15106708,12922:15106466,12923:15107984,12924:15108242,12925:15109008,12926:15111353,13089:15314305,13090:15112614,13091:15114928,13092:15119799,13093:15172016,13094:15177100,13095:15178374,13096:15185333,13097:15239845,13098:15245241,13099:15308427,13100:15309454,13101:15250077,13102:15042481,13103:15043262,13104:15049878,13105:15045299,13106:15052467,13107:15053974,13108:15107496,13109:15115906,13110:15120047,13111:15180429,13112:15242123,13113:15245719,13114:15247794,13115:15306407,13116:15313592,13117:15119788,13118:15312552,13119:15244185,13120:15048355,13121:15114175,13122:15244174,13123:15304846,13124:15043203,13125:15047303,13126:15044740,13127:15055763,13128:15109025,13129:15110841,13130:15114428,13131:15114424,13132:15118011,13133:15175090,13134:15180474,13135:15182251,13136:15247002,13137:15247250,13138:15250859,13139:15252611,13140:15303597,13141:15308451,13142:15309460,13143:15310249,13144:15052198,13145:15053491,13146:15115709,13147:15311245,13148:15311246,13149:15109787,13150:15183008,13151:15116459,13152:15116735,13153:15114934,13154:15315085,13155:15121823,13156:15042994,13157:15046301,13158:15106480,13159:15109036,13160:15119547,13161:15120519,13162:15121297,13163:15241627,13164:15246480,13165:15252868,13166:14989460,13167:15315129,13168:15044534,13169:15115419,13170:15116474,13171:15310468,13172:15114410,13173:15041948,13174:15182723,13175:15241906,13176:15304604,13177:15306380,13178:15047067,13179:15316136,13180:15114402,13181:15240325,13182:15241393,13345:15184549,13346:15042696,13347:15240069,13348:15176614,13349:14989758,13350:14990979,13351:15042208,13352:15052690,13353:15042698,13354:15043480,13355:15043495,13356:15054779,13357:15046298,13358:15048874,13359:15050662,13360:15052428,13361:15052440,13362:15052699,13363:15055282,13364:15055289,13365:15106723,13366:15107231,13367:15107491,13368:15107774,13369:15110043,13370:15111586,13371:15114129,13372:15114643,13373:15115194,13374:15117502,13375:15117715,13376:15118743,13377:15121570,13378:15122071,13379:15121797,13380:15176368,13381:15176856,13382:15178659,13383:15178891,13384:15182783,13385:15183521,13386:15184033,13387:15185833,13388:15187126,13389:15187888,13390:15237789,13391:15239590,13392:15240862,13393:15247027,13394:15248268,13395:15250091,13396:15303300,13397:15307153,13398:15308435,13399:15308433,13400:15308450,13401:15309221,13402:15310739,13403:15312040,13404:15239320,13405:14989496,13406:15044779,13407:15053496,13408:15054732,13409:15175337,13410:15178124,13411:15178940,13412:15053481,13413:15187883,13414:15250571,13415:15309697,13416:15310993,13417:15311252,13418:15311256,13419:14990465,13420:14990478,13421:15044017,13422:15046300,13423:15047080,13424:15048634,13425:15050119,13426:15051913,13427:15052676,13428:15053456,13429:15054988,13430:15055294,13431:15056780,13432:15110062,13433:15113402,13434:15112087,13435:15112098,13436:15113375,13437:15115147,13438:15115140,13601:15116703,13602:15055024,13603:15118213,13604:15118487,13605:15118781,13606:15177151,13607:15181192,13608:15052195,13609:15181952,13610:15185024,13611:15056573,13612:15246991,13613:15247512,13614:15250100,13615:15250871,13616:15252364,13617:15252637,13618:15311778,13619:15313038,13620:15314108,13621:14989952,13622:15040957,13623:15041664,13624:15050387,13625:15052444,13626:15108271,13627:15108736,13628:15111084,13629:15117498,13630:15174304,13631:15177361,13632:15181191,13633:15187625,13634:15245243,13635:15248060,13636:15248816,13637:15109804,13638:15241098,13639:15310496,13640:15044745,13641:15044739,13642:15046315,13643:15114644,13644:15116696,13645:15247792,13646:15179943,13647:15113653,13648:15317901,13649:15044020,13650:15052450,13651:15238298,13652:15243664,13653:15302790,13654:14989464,13655:14989701,13656:14990215,13657:14990481,13658:15044490,13659:15044792,13660:15052462,13661:15056019,13662:15106213,13663:15111569,13664:15113405,13665:15118722,13666:15118770,13667:15119267,13668:15172024,13669:15175811,13670:15182262,13671:15182510,13672:15182984,13673:15185050,13674:15184830,13675:15185318,13676:15112103,13677:15174043,13678:15044283,13679:15053189,13680:15054760,13681:15109010,13682:15109024,13683:15109273,13684:15120544,13685:15243674,13686:15247537,13687:15251357,13688:15305656,13689:15121537,13690:15181478,13691:15314330,13692:14989992,13693:14989995,13694:14989996,13857:14991003,13858:14991008,13859:15041425,13860:15041927,13861:15182774,13862:15041969,13863:15042486,13864:15043988,13865:15043745,13866:15044031,13867:15044523,13868:15046316,13869:15049347,13870:15053729,13871:15056055,13872:15056266,13873:15106223,13874:15106448,13875:15106477,13876:15109279,13877:15111577,13878:15116683,13879:15119233,13880:15174530,13881:15174573,13882:15179695,13883:15238072,13884:15238277,13885:15239304,13886:15242638,13887:15303607,13888:15306657,13889:15310783,13890:15312279,13891:15313306,13892:14990256,13893:15042461,13894:15052973,13895:15112833,13896:15115693,13897:15053184,13898:15113138,13899:15115701,13900:15175305,13901:15114640,13902:15184513,13903:15041413,13904:15043492,13905:15048071,13906:15054782,13907:15305894,13908:15111844,13909:15117475,13910:15117501,13911:15175860,13912:15181441,13913:15181501,13914:15183243,13915:15185802,13916:15239865,13917:15241100,13918:15245759,13919:15246751,13920:15248569,13921:15253393,13922:15304593,13923:15044767,13924:15305344,13925:14989725,13926:15040694,13927:15044517,13928:15043770,13929:15174551,13930:15175318,13931:15179689,13932:15240102,13933:15252143,13934:15312774,13935:15312776,13936:15312786,13937:15041975,13938:15107226,13939:15243678,13940:15046320,13941:15182266,13942:15040950,13943:15052691,13944:15303047,13945:15309445,13946:14989490,13947:15117211,13948:15304615,13949:15053201,13950:15053192,14113:15109784,14114:15182495,14115:15118995,14116:15310260,14117:15252897,14118:15182506,14119:15173258,14120:15309448,14121:15184514,14122:15114391,14123:15186352,14124:15114641,14125:15306156,14126:15043506,14127:15044763,14128:15242923,14129:15247507,14130:15187620,14131:15252365,14132:15303585,14133:15044006,14134:15245960,14135:15181185,14136:14991234,14137:15041214,14138:15042705,14139:15041924,14140:15046035,14141:15047853,14142:15175594,14143:15048331,14144:15050129,14145:15056290,14146:15056516,14147:15106485,14148:15107510,14149:15107495,14150:15107753,14151:15109810,14152:15110330,14153:15111596,14154:15112623,14155:15114626,14156:15120531,14157:15177126,14158:15182013,14159:15184827,14160:15185292,14161:15185561,14162:15186315,14163:15187371,14164:15240334,14165:15240586,14166:15244173,14167:15247496,14168:15247779,14169:15248806,14170:15252413,14171:15311002,14172:15316623,14173:15239864,14174:15253390,14175:15314856,14176:15043207,14177:15108255,14178:15110787,14179:15122304,14180:15309465,14181:15114625,14182:15041169,14183:15117472,14184:15118778,14185:15121812,14186:15182260,14187:15185296,14188:15245696,14189:15247523,14190:15113352,14191:14990262,14192:15040697,14193:15040678,14194:15040933,14195:15041980,14196:15042744,14197:15042979,14198:15046311,14199:15047823,14200:15048837,14201:15051660,14202:15055802,14203:15107762,14204:15108024,14205:15109043,14206:15109554,14369:15115420,14370:15116457,14371:15174077,14372:15174316,14373:15174830,14374:15179924,14375:15180207,14376:15185337,14377:15178892,14378:15237801,14379:15246987,14380:15248537,14381:15250338,14382:15252370,14383:15303075,14384:15306165,14385:15309242,14386:15311253,14387:15313043,14388:15317432,14389:15041923,14390:15044255,14391:15044275,14392:15055291,14393:15056038,14394:15120539,14395:15121040,14396:15175300,14397:15175614,14398:15185283,14399:15239351,14400:15247488,14401:15248314,14402:15309200,14403:14989710,14404:15040651,14405:15044516,14406:15045052,14407:15047610,14408:15050641,14409:15052196,14410:15054769,14411:15055531,14412:15056039,14413:15108280,14414:15111557,14415:15113903,14416:15120790,14417:15174544,14418:15184778,14419:15246004,14420:15237793,14421:15238049,14422:15241136,14423:15243662,14424:15248007,14425:15251368,14426:15304887,14427:15309703,14428:15311271,14429:15318163,14430:14989972,14431:14989970,14432:14990477,14433:15043976,14434:15045001,14435:15044798,14436:15050927,14437:15056524,14438:15056545,14439:15106719,14440:15114919,14441:15116942,14442:15176090,14443:15180417,14444:15248030,14445:15248036,14446:15248823,14447:15304336,14448:14989726,14449:15314825,14450:14989988,14451:14990780,14452:14991023,14453:15040665,14454:15040662,14455:15041929,14456:15041964,14457:15043231,14458:15043257,14459:15043518,14460:15044250,14461:15044515,14462:15044753,14625:15044750,14626:15046281,14627:15048081,14628:15048354,14629:15050173,14630:15052180,14631:15052189,14632:15052431,14633:15054757,14634:15054759,14635:15054775,14636:15055288,14637:15055491,14638:15055514,14639:15055543,14640:15056024,14641:15106450,14642:15107468,14643:15108759,14644:15109016,14645:15109799,14646:15111355,14647:15112322,14648:15112579,14649:15113140,14650:15113645,14651:15114401,14652:15114903,14653:15116171,14654:15118751,14655:15119530,14656:15119785,14657:15120559,14658:15121053,14659:15176882,14660:15178375,14661:15180204,14662:15182015,14663:15184800,14664:15185029,14665:15185048,14666:15185310,14667:15185585,14668:15237269,14669:15237251,14670:15237807,14671:15237809,14672:15238548,14673:15238799,14674:15239338,14675:15240594,14676:15245708,14677:15245729,14678:15248539,14679:15250082,14680:15250364,14681:15303562,14682:15304117,14683:15305137,14684:15179967,14685:15305660,14686:15308452,14687:15309197,14688:15310981,14689:15312537,14690:15313816,14691:15316155,14692:15042971,14693:15043243,14694:15044535,14695:15044744,14696:15049621,14697:15109047,14698:15122336,14699:15249834,14700:15252895,14701:15317689,14702:15041931,14703:15042747,14704:15045002,14705:15047613,14706:15182208,14707:15304119,14708:15316384,14709:15317906,14710:15175044,14711:15121545,14712:15238576,14713:15176849,14714:15056829,14715:15106970,14716:15313576,14717:15174555,14718:15253180,14881:15117732,14882:15310979,14883:14990218,14884:15047600,14885:15048100,14886:15049406,14887:15051162,14888:15106472,14889:15107975,14890:15112335,14891:15112326,14892:15114425,14893:15114929,14894:15120311,14895:15177621,14896:15185082,14897:15239598,14898:15314306,14899:14989979,14900:14990736,14901:15044489,14902:15045766,14903:15054255,14904:15054758,14905:15054766,14906:15114171,14907:15119001,14908:15176115,14909:15179906,14910:15247760,14911:15306390,14912:15246239,14913:15048080,14914:15055527,14915:15109291,14916:15041205,14917:15041196,14918:15042189,14919:15113344,14920:15045513,14921:15049118,14922:15050427,14923:15052464,14924:15056297,14925:15108493,14926:15109793,14927:15114429,14928:15117747,14929:15120520,14930:15172029,14931:15304583,14932:15174272,14933:15179925,14934:15179942,14935:15181229,14936:15111822,14937:15185072,14938:15241116,14939:15246209,14940:15252617,14941:15309467,14942:15042980,14943:15047848,14944:15113616,14945:15187370,14946:15250081,14947:15042228,14948:15048066,14949:15308970,14950:15048890,14951:15115914,14952:15237812,14953:15045298,14954:15053966,14955:15048636,14956:15180437,14957:15316922,14958:14990748,14959:15042954,14960:15045259,14961:15110334,14962:15112360,14963:15113364,14964:15114165,14965:15182468,14966:15183254,14967:15185058,14968:15305903,14969:15114652,14970:15314605,14971:15183033,14972:15043737,14973:15042186,14974:15042743,15137:15052703,15138:15109046,15139:15110830,15140:15111078,15141:15113389,15142:15118010,15143:15242921,15144:15309713,15145:15178384,15146:15314838,15147:15109516,15148:15305862,15149:15314603,15150:15178431,15151:15112594,15152:14989449,15153:15041176,15154:15044482,15155:15053233,15156:15106984,15157:15110802,15158:15111587,15159:15114655,15160:15173542,15161:15175562,15162:15176867,15163:15183511,15164:15186562,15165:15243925,15166:15249027,15167:15250331,15168:15304120,15169:15312016,15170:15111852,15171:15112875,15172:15117963,15173:14990229,15174:14990228,15175:14990522,15176:14990783,15177:15042746,15178:15044536,15179:15044530,15180:15046563,15181:15047579,15182:15049643,15183:15050635,15184:15050633,15185:15050687,15186:15052176,15187:15053197,15188:15054978,15189:15055019,15190:15056791,15191:15106205,15192:15109255,15193:15111343,15194:15052188,15195:15111855,15196:15111869,15197:15112104,15198:15113885,15199:15117730,15200:15117755,15201:15118479,15202:15175045,15203:15181193,15204:15181697,15205:15184824,15206:15185049,15207:15185067,15208:15237794,15209:15238274,15210:15239091,15211:15246998,15212:15247774,15213:15247785,15214:15247782,15215:15248012,15216:15248302,15217:15250311,15218:15250332,15219:15309708,15220:15311804,15221:15117743,15222:14989963,15223:14990524,15224:14990989,15225:15041936,15226:15052183,15227:15052730,15228:15107464,15229:15109249,15230:15112578,15393:15117473,15394:15121291,15395:15119035,15396:15173822,15397:15176381,15398:15177620,15399:15180673,15400:15180986,15401:15237260,15402:15237299,15403:15239082,15404:15241876,15405:15253150,15406:15118736,15407:15317439,15408:15056015,15409:15248792,15410:15316139,15411:15182778,15412:15252408,15413:15052429,15414:15309739,15415:14989443,15416:15044529,15417:15048631,15418:15049905,15419:15051657,15420:15052452,15421:15106697,15422:15120831,15423:15121542,15424:15177406,15425:15250346,15426:15052447,15427:15242368,15428:15183776,15429:15040946,15430:15114164,15431:15239837,15432:15053217,15433:15242634,15434:15186078,15435:15239310,15436:15042201,15437:15052932,15438:15109544,15439:15250854,15440:15111836,15441:15173038,15442:15180990,15443:15185047,15444:15237253,15445:15248541,15446:15252362,15447:15303086,15448:15244167,15449:15303338,15450:15040671,15451:15043514,15452:15052986,15453:15113619,15454:15172028,15455:15173813,15456:15304076,15457:15304584,15458:15305899,15459:15240101,15460:15052674,15461:15056049,15462:15107001,15463:14989499,15464:15044502,15465:15052424,15466:15108491,15467:15113393,15468:15117962,15469:15174569,15470:15175584,15471:15181998,15472:15238571,15473:15251107,15474:15304082,15475:15312534,15476:15041682,15477:15044503,15478:15045034,15479:15052735,15480:15109768,15481:15116473,15482:15185580,15483:15309952,15484:15047578,15485:15044494,15486:15045032,15649:15052439,15650:15052977,15651:15054750,15652:14991278,15653:15107201,15654:15109054,15655:15119538,15656:15181696,15657:15181707,15658:15185282,15659:15186317,15660:15187858,15661:15239085,15662:15239327,15663:15241872,15664:15245702,15665:15246770,15666:15249040,15667:15251892,15668:15252655,15669:15302833,15670:15304075,15671:15304108,15672:15309702,15673:15304348,15674:14990208,15675:14990735,15676:15041925,15677:15043969,15678:15056531,15679:15108238,15680:15114132,15681:15118721,15682:15120523,15683:15175075,15684:15186086,15685:15304589,15686:15305347,15687:15044500,15688:15049881,15689:15052479,15690:15120273,15691:15181213,15692:15186094,15693:15184539,15694:15049150,15695:15173279,15696:15042490,15697:15245715,15698:15253424,15699:14991242,15700:15053755,15701:15112357,15702:15179436,15703:15182755,15704:15239324,15705:15312831,15706:15042438,15707:15056554,15708:15112108,15709:15115695,15710:15117961,15711:15120307,15712:15121046,15713:15121828,15714:15178686,15715:15185044,15716:15054753,15717:15303093,15718:15304327,15719:15310982,15720:15042470,15721:15042717,15722:15108480,15723:15112849,15724:15113113,15725:15120538,15726:15055542,15727:15185810,15728:15187378,15729:15113144,15730:15242927,15731:15243191,15732:15248312,15733:15043241,15734:15044505,15735:15050163,15736:15055503,15737:15056528,15738:15106453,15739:15305636,15740:15309220,15741:15041207,15742:15041695,15905:15043485,15906:15043744,15907:15043975,15908:15044524,15909:15045544,15910:15046022,15911:15045809,15912:15046807,15913:15050152,15914:15050430,15915:15050940,15916:15052469,15917:15052934,15918:15052943,15919:15052945,15920:15052954,15921:15055492,15922:15055498,15923:15055776,15924:15056304,15925:15108543,15926:15108740,15927:15109019,15928:15109772,15929:15109559,15930:15112327,15931:15112332,15932:15112365,15933:15112630,15934:15113662,15935:15114914,15936:15116447,15937:15116469,15938:15119036,15939:15120008,15940:15120521,15941:15120792,15942:15172796,15943:15172774,15944:15173031,15945:15177607,15946:15178881,15947:15180189,15948:15180929,15949:15181221,15950:15181744,15951:15182752,15952:15182993,15953:15184551,15954:15185081,15955:15237782,15956:15241110,15957:15241867,15958:15242633,15959:15245725,15960:15246259,15961:15247519,15962:15247548,15963:15247764,15964:15247795,15965:15249825,15966:15250334,15967:15304356,15968:15305126,15969:15306174,15970:15306904,15971:15309468,15972:15310488,15973:14989450,15974:14989448,15975:14989470,15976:14989719,15977:15042199,15978:15042992,15979:15048590,15980:15048884,15981:15049612,15982:15051938,15983:15055032,15984:15106949,15985:15111102,15986:15113633,15987:15113622,15988:15119748,15989:15174326,15990:15177139,15991:15182243,15992:15241912,15993:15248818,15994:15304376,15995:15305888,15996:15046833,15997:15048628,15998:15311806,16161:15109037,16162:15115405,16163:15117974,16164:15173549,16165:15186324,16166:15237559,16167:15239602,16168:15247270,16169:15311775,16170:15244693,16171:15253169,16172:15052987,16173:14990520,16174:14991265,16175:14991029,16176:15045767,16177:15050912,16178:15052701,16179:15052713,16180:15056771,16181:15107470,16182:15109295,16183:15111856,16184:15112587,16185:15115182,16186:15115931,16187:15119800,16188:15120305,16189:15176883,16190:15177401,16191:15178911,16192:15181214,16193:15181734,16194:15185075,16195:15239075,16196:15239855,16197:15242922,16198:15247018,16199:15247546,16200:15252139,16201:15253147,16202:15302834,16203:15304605,16204:15309959,16205:14990010,16206:14990209,16207:15042691,16208:15049141,16209:15049644,16210:15052939,16211:15176858,16212:15052989,16213:15238542,16214:15247498,16215:15253381,16216:15309219,16217:15310253,16218:15183013,16219:15248271,16220:15310984,16221:15304098,16222:15047603,16223:15044264,16224:15302807,16225:15044793,16226:15048322,16227:15055013,16228:15109800,16229:15118516,16230:15172234,16231:15179169,16232:15184523,16233:15187872,16234:15245744,16235:15303042,16236:15304084,16237:15305872,16238:15305880,16239:15309455,16240:15176094,16241:15313796,16242:15053959,16243:15054249,16244:15111600,16245:15113890,16246:15251112,16247:15309723,16248:15109550,16249:15113609,16250:15115417,16251:15241093,16252:15310999,16253:15309696,16254:15246270,16417:15122052,16418:15110586,16419:15052728,16420:14989462,16421:15171756,16422:15177117,16423:15112367,16424:15042436,16425:15042742,16426:15043490,16427:15050643,16428:15056513,16429:15106215,16430:15108240,16431:15111359,16432:15111604,16433:15112351,16434:15112628,16435:15115186,16436:15114390,16437:15117731,16438:15120517,16439:15174066,16440:15176863,16441:15178651,16442:15184574,16443:15237526,16444:15049648,16445:15246269,16446:15246783,16447:15248032,16448:15248019,16449:15248267,16450:15302813,16451:15304338,16452:15310226,16453:15310233,16454:15111817,16455:15181966,16456:15238278,16457:15309499,16458:15055021,16459:15106972,16460:15108250,16461:15111845,16462:15112340,16463:15113872,16464:15179699,16465:15182221,16466:15184269,16467:15186110,16468:15238282,16469:15250092,16470:15250852,16471:15251361,16472:15251871,16473:15180457,16474:15042695,16475:15109017,16476:15109797,16477:15110530,16478:15108760,16479:15247533,16480:15182467,16481:15183744,16482:15248044,16483:15309738,16484:15185334,16485:15239308,16486:15244681,16487:14990233,16488:15041928,16489:15043971,16490:15044000,16491:15052451,16492:15052930,16493:15052950,16494:15054749,16495:15108262,16496:15108487,16497:15110832,16498:15114387,16499:15114420,16500:15119241,16501:15119749,16502:15119511,16503:15114131,16504:15121820,16505:15173006,16506:15173053,16507:15112075,16508:15182271,16509:15183533,16510:15185818,16673:15186314,16674:15187624,16675:15238586,16676:15239323,16677:15239353,16678:15242918,16679:15247790,16680:15250318,16681:15251381,16682:15303096,16683:15303095,16684:15305389,16685:15305361,16686:15308419,16687:15314606,16688:15042957,16689:15046276,16690:15121592,16691:15172790,16692:15041960,16693:15181445,16694:15186325,16695:15238835,16696:15184782,16697:15047052,16698:15049105,16699:15053480,16700:15109802,16701:15113150,16702:15113149,16703:15115674,16704:15174553,16705:15177359,16706:15177358,16707:15180942,16708:15181206,16709:15181727,16710:15184535,16711:15185056,16712:15185284,16713:15243399,16714:15247540,16715:15308987,16716:15303073,16717:15318176,16718:15041447,16719:15042997,16720:15044492,16721:15044514,16722:15040649,16723:15046314,16724:15049646,16725:15050127,16726:15173821,16727:15052427,16728:15053220,16729:15043741,16730:15106979,16731:15106995,16732:15109532,16733:15109763,16734:15109311,16735:15109819,16736:15111053,16737:15112105,16738:15113145,16739:15054755,16740:15116173,16741:15116221,16742:15121557,16743:15173541,16744:14989961,16745:15177641,16746:15178680,16747:15182483,16748:15184799,16749:15185807,16750:15185564,16751:15237537,16752:15240585,16753:15240600,16754:15241644,16755:15241916,16756:15243195,16757:15246213,16758:15250864,16759:15302785,16760:15303085,16761:15306391,16762:15309980,16763:15313042,16764:15041423,16765:15049367,16766:15107726,16929:15239059,16930:15242421,16931:15250568,16932:15302816,16933:14991235,16934:15040948,16935:15042951,16936:15044019,16937:15106479,16938:15109513,16939:15113631,16940:15120556,16941:15251123,16942:15302815,16943:14991255,16944:15053214,16945:15250314,16946:15112079,16947:15185562,16948:15043986,16949:15245974,16950:15041974,16951:15110019,16952:15052184,16953:15052203,16954:15052938,16955:15110285,16956:15113617,16957:15303068,16958:14990230,16959:15049882,16960:15049898,16961:15118768,16962:15247761,16963:15045822,16964:15048853,16965:15050405,16966:15106992,16967:15108499,16968:15114113,16969:15239349,16970:15115669,16971:15309184,16972:15312772,16973:15313064,16974:14990739,16975:15048838,16976:15052734,16977:15237264,16978:15053489,16979:15055023,16980:15056517,16981:15106208,16982:15107467,16983:15108276,16984:15113151,16985:15119280,16986:15121310,16987:15238030,16988:15238591,16989:15240084,16990:15245963,16991:15250104,16992:15302784,16993:15302830,16994:15309450,16995:15317915,16996:15314843,16997:14990243,16998:15044528,16999:15049895,17000:15183020,17001:15304333,17002:15311244,17003:15316921,17004:15121309,17005:15171751,17006:15043987,17007:15046020,17008:15052421,17009:15108504,17010:15108766,17011:15109011,17012:15119010,17013:15122351,17014:15175842,17015:15247511,17016:15306936,17017:15122305,17018:15248318,17019:15240376,17020:15042471,17021:15244216,17022:15044522,17185:15044521,17186:14990726,17187:15303060,17188:15253168,17189:15050154,17190:15238321,17191:15054781,17192:15182762,17193:15253183,17194:15115162,17195:15249591,17196:15174584,17197:15315336,17198:15116477,17199:15248048,17200:14989497,17201:15043992,17202:15046790,17203:15048102,17204:15108997,17205:15109794,17206:15112102,17207:15117710,17208:15120289,17209:15120795,17210:15172269,17211:15179693,17212:15182767,17213:15183530,17214:15185595,17215:15237309,17216:15238022,17217:15244171,17218:15248021,17219:15306139,17220:15047587,17221:15049607,17222:15056062,17223:15111853,17224:15112854,17225:15116928,17226:15118005,17227:15176887,17228:15248263,17229:15040676,17230:15179685,17231:15047856,17232:15056027,17233:15106469,17234:15112634,17235:15118752,17236:15177652,17237:15181978,17238:15187374,17239:15239092,17240:15244440,17241:15303045,17242:15312563,17243:15183753,17244:15177116,17245:15182777,17246:15183249,17247:15242116,17248:15302800,17249:15181737,17250:15182482,17251:15240374,17252:15051681,17253:15179136,17254:14989485,17255:14990258,17256:15052441,17257:15056800,17258:15108797,17259:15112380,17260:15114161,17261:15119272,17262:15243691,17263:15245751,17264:15247547,17265:15304078,17266:15305651,17267:15312784,17268:15116439,17269:15171750,17270:15174826,17271:15240103,17272:15241623,17273:15250095,17274:14989441,17275:15041926,17276:15042443,17277:15046283,17278:15052725,17441:15054998,17442:15055027,17443:15055489,17444:15056020,17445:15056053,17446:15056299,17447:15056564,17448:15108018,17449:15109265,17450:15112866,17451:15113373,17452:15121838,17453:15174034,17454:15176890,17455:15178938,17456:15237556,17457:15238329,17458:15238584,17459:15244726,17460:15248063,17461:15248284,17462:15251077,17463:15251379,17464:15305370,17465:15308215,17466:15310978,17467:15315877,17468:15043461,17469:15109527,17470:15178676,17471:15113365,17472:15118984,17473:15175565,17474:15250307,17475:15306414,17476:15309235,17477:15119525,17478:15049372,17479:15115406,17480:15116172,17481:15253437,17482:15306394,17483:15177627,17484:15302810,17485:15049114,17486:15114370,17487:15109812,17488:15116219,17489:14990723,17490:15121580,17491:15114136,17492:15253179,17493:15242406,17494:15185588,17495:15306132,17496:15115455,17497:15121840,17498:15048106,17499:15049655,17500:15051948,17501:15185068,17502:15173802,17503:15044746,17504:15304611,17505:15316660,17506:14989997,17507:14990734,17508:15040924,17509:15040949,17510:15042947,17511:15250078,17512:15045000,17513:15048868,17514:15052442,17515:15055005,17516:15055509,17517:15055533,17518:15055799,17519:15056031,17520:15106700,17521:15108789,17522:15109306,17523:15110032,17524:15114927,17525:15118720,17526:15180423,17527:15181454,17528:15181963,17529:15185824,17530:15239559,17531:15247490,17532:15248294,17533:15251844,17534:15302803,17697:15303352,17698:15303853,17699:15304600,17700:15318158,17701:15119269,17702:15110552,17703:15111074,17704:15111605,17705:15121332,17706:15178372,17707:15183003,17708:15303081,17709:15306641,17710:15121082,17711:15045554,17712:15056569,17713:15110820,17714:15252877,17715:15253421,17716:15305092,17717:15041976,17718:15049131,17719:15049897,17720:15053205,17721:15055511,17722:15120315,17723:15186575,17724:15176860,17725:15250108,17726:15252386,17727:15311259,17728:15172281,17729:14990493,17730:15118015,17731:15122097,17732:15176880,17733:15309755,17734:15041934,17735:15044752,17736:15048885,17737:15049111,17738:15050412,17739:15053216,17740:15056530,17741:15111831,17742:15113628,17743:15120545,17744:15178171,17745:15241119,17746:15250349,17747:15302804,17748:15303613,17749:15306125,17750:15179941,17751:15179962,17752:15043242,17753:15055526,17754:15047839,17755:15050164,17756:15106194,17757:15040658,17758:15041946,17759:15042220,17760:15042445,17761:15042688,17762:15045776,17763:15049108,17764:15049112,17765:15050135,17766:15052437,17767:15053750,17768:15054475,17769:15106748,17770:15108757,17771:15110317,17772:15113649,17773:15114627,17774:15114940,17775:15115167,17776:15178647,17777:15120280,17778:15120815,17779:15120027,17780:15172015,17781:15173512,17782:15056275,17783:15177624,17784:15181239,17785:15183241,17786:15183252,17787:15183250,17788:15184790,17789:15185329,17790:15042736,17953:15241635,17954:15242665,17955:15243172,17956:15247502,17957:15248516,17958:15249798,17959:15251599,17960:15302787,17961:15302799,17962:15306905,17963:15309238,17964:15311021,17965:15313072,17966:15308696,17967:15041421,17968:15043477,17969:15044748,17970:15048834,17971:15052942,17972:15107751,17973:15110814,17974:15119518,17975:15179443,17976:15182757,17977:15238068,17978:15241348,17979:15303059,17980:15305349,17981:15053728,17982:15316103,17983:15043775,17984:15056535,17985:15056563,17986:15120028,17987:15174073,17988:15179171,17989:15181503,17990:15183780,17991:15118226,17992:15174572,17993:15248045,17994:15114371,17995:15116705,17996:15042488,17997:15182465,17998:15115444,17999:15053194,18000:15315894,18001:15240107,18002:15052677,18003:15304073,18004:15171742,18005:15047096,18006:15053231,18007:15106951,18008:15111590,18009:15118988,18010:15249818,18011:15303041,18012:15310995,18013:15045009,18014:15113095,18015:15304845,18016:15050120,18017:15303331,18018:15042181,18019:14989709,18020:15042474,18021:15242905,18022:15248526,18023:15171992,18024:15109562,18025:15306123,18026:15115682,18027:15312564,18028:15186052,18029:15177143,18030:15043991,18031:15115680,18032:15252383,18033:15309731,18034:15118749,18035:14989964,18036:15052988,18037:15056016,18038:15253417,18039:15043714,18040:15250321,18041:15237769,18042:15243705,18043:15055807,18044:15112101,18045:14989747,18046:15041957,18209:15050370,18210:15052991,18211:15310766,18212:14990267,18213:15050378,18214:15056781,18215:15248013,18216:15122337,18217:15181488,18218:15181218,18219:15052711,18220:15241649,18221:15174827,18222:15173297,18223:15055284,18224:15056821,18225:15109563,18226:15110810,18227:15173507,18228:15184536,18229:14989699,18230:15055804,18231:14989707,18232:15048604,18233:15047330,18234:15106729,18235:15122307,18236:15185037,18237:15238077,18238:15238323,18239:15238847,18240:15253170,18241:15246999,18242:15243940,18243:15054772,18244:15108746,18245:15110829,18246:15246983,18247:15113655,18248:15119266,18249:15119550,18250:15175862,18251:15179956,18252:15051142,18253:15187381,18254:15239853,18255:15312556,18256:14991283,18257:15055747,18258:15109021,18259:15109778,18260:15111575,18261:15113647,18262:15178627,18263:15174028,18264:15238028,18265:15237818,18266:15252649,18267:15304077,18268:15040653,18269:15048633,18270:15051410,18271:15114885,18272:15115699,18273:15173028,18274:15174589,18275:15250103,18276:15049650,18277:15250336,18278:15309226,18279:15302809,18280:15244735,18281:15181732,18282:15179687,18283:15241385,18284:14990511,18285:15042981,18286:15043994,18287:15109005,18288:15114127,18289:15119242,18290:15178173,18291:15183508,18292:15184533,18293:15239350,18294:15242884,18295:15253419,18296:15113117,18297:15121568,18298:15173766,18299:15186075,18300:15240875,18301:15312769,18302:15317670,18465:15042493,18466:15183537,18467:15180210,18468:15183544,18469:15237767,18470:15183240,18471:15117224,18472:15055265,18473:15237772,18474:15177105,18475:15177120,18476:15041963,18477:15305122,18478:15121036,18479:15178170,18480:15304343,18481:15313834,18482:14990480,18483:15187376,18484:15108764,18485:15183247,18486:15308453,18487:15315881,18488:15047098,18489:15049113,18490:15244196,18491:15309500,18492:14990516,18493:15042724,18494:15043978,18495:15044493,18496:15044507,18497:15054982,18498:15110316,18499:15111825,18500:15113663,18501:15118526,18502:15118734,18503:15174024,18504:15174319,18505:15175597,18506:15177108,18507:15186305,18508:15239340,18509:15243177,18510:15250089,18511:15183748,18512:15304582,18513:15173033,18514:15310994,18515:15311791,18516:15109309,18517:15112617,18518:15177130,18519:15178660,18520:15180688,18521:15242627,18522:15244206,18523:15043754,18524:15043985,18525:15044774,18526:15050371,18527:15055495,18528:15056316,18529:15106738,18530:15108489,18531:15108537,18532:15108779,18533:15111824,18534:15118228,18535:15119244,18536:15177394,18537:15178414,18538:15180433,18539:15181720,18540:15185803,18541:15187383,18542:15237797,18543:15245995,18544:15248057,18545:15250107,18546:15303103,18547:15310238,18548:15311771,18549:15116427,18550:15184056,18551:15041177,18552:15052990,18553:15056558,18554:15113863,18555:15118232,18556:15175861,18557:15178889,18558:15187598,18721:15318203,18722:15114122,18723:15181975,18724:15043769,18725:15177355,18726:15313837,18727:15056294,18728:15238813,18729:15241137,18730:15237784,18731:15056060,18732:15056773,18733:15177122,18734:15183238,18735:15302844,18736:15114663,18737:15050667,18738:15051419,18739:15185040,18740:15178174,18741:15248556,18742:14991285,18743:15056298,18744:15116441,18745:15118519,18746:15121538,18747:15176610,18748:15181224,18749:15245736,18750:15247765,18751:15249849,18752:15055775,18753:15110031,18754:15177605,18755:15181714,18756:15240087,18757:15305896,18758:15305650,18759:15241884,18760:15244205,18761:15315117,18762:15045505,18763:15056300,18764:15111820,18765:15119772,18766:15171733,18767:15250087,18768:15250323,18769:15311035,18770:15111567,18771:15176630,18772:14989453,18773:14990232,18774:15048608,18775:15049899,18776:15051174,18777:15052684,18778:15042216,18779:15054979,18780:15055516,18781:15106198,18782:15108534,18783:15111607,18784:15111847,18785:15112622,18786:15119790,18787:15173814,18788:15183014,18789:15238544,18790:15238810,18791:15239833,18792:15248796,18793:15250080,18794:15250342,18795:15250868,18796:15308956,18797:15309188,18798:14991022,18799:15110827,18800:15117734,18801:15239326,18802:15241633,18803:15242666,18804:15303592,18805:15052929,18806:15115667,18807:15311528,18808:15241658,18809:15242647,18810:14990479,18811:15042991,18812:15056553,18813:15055237,18814:15113357,18977:15181455,18978:15238585,18979:15246471,18980:15246982,18981:15120309,18982:15056023,18983:15108501,18984:15119032,18985:14990223,18986:15174057,18987:15314578,18988:15042694,18989:15044795,18990:15047092,18991:15049395,18992:15107748,18993:15108526,18994:15172762,18995:15050158,18996:15184521,18997:15184798,18998:15185051,18999:15309744,19000:15111815,19001:15237534,19002:14989465,19003:14990773,19004:15041973,19005:15049088,19006:15055267,19007:15055283,19008:15056010,19009:15114116,19010:14989478,19011:15242429,19012:15308425,19013:15309211,19014:15184307,19015:15310977,19016:15041467,19017:15049601,19018:15178134,19019:15180455,19020:15042725,19021:15179429,19022:15242385,19023:15183494,19024:15040911,19025:15049865,19026:15174023,19027:15183751,19028:15185832,19029:15253178,19030:15253396,19031:15303053,19032:14991039,19033:15043465,19034:15050921,19035:15056001,19036:15310509,19037:14991261,19038:15239319,19039:15305642,19040:15047811,19041:15109525,19042:15117737,19043:15176875,19044:15246236,19045:15252628,19046:15182210,19047:15043487,19048:15049363,19049:15107477,19050:15108234,19051:15112878,19052:15118221,19053:15184063,19054:15241129,19055:15040675,19056:14991288,19057:15043717,19058:15044998,19059:15048881,19060:15050121,19061:15052445,19062:15053744,19063:15053743,19064:15053993,19065:15055510,19066:15108785,19067:15109543,19068:15111358,19069:15111865,19070:15113355,19233:15119253,19234:15119265,19235:15172537,19236:15179954,19237:15186091,19238:15238046,19239:15239859,19240:15241356,19241:15242156,19242:15244418,19243:15246482,19244:15247530,19245:15249802,19246:15303334,19247:15305618,19248:15311805,19249:15315891,19250:15316396,19251:14989711,19252:14989985,19253:15041165,19254:15042966,19255:15048074,19256:15050408,19257:15055037,19258:15056792,19259:15056793,19260:15108287,19261:15112884,19262:15113371,19263:15114128,19264:15115154,19265:15042194,19266:15185057,19267:15237802,19268:15238824,19269:15248512,19270:15250060,19271:15250111,19272:15305150,19273:15308978,19274:15044768,19275:15311020,19276:15043735,19277:15041429,19278:15043996,19279:15049384,19280:15110834,19281:15113396,19282:15174055,19283:15179174,19284:15182214,19285:15304614,19286:15043459,19287:15119009,19288:15117958,19289:15048832,19290:15055244,19291:15050132,19292:15113388,19293:15187899,19294:15042465,19295:15178630,19296:15110569,19297:15180712,19298:15314324,19299:15317691,19300:15048587,19301:15050425,19302:15112359,19303:15113882,19304:15118222,19305:15045545,19306:15116185,19307:15055253,19308:15238812,19309:15113877,19310:15314602,19311:15114174,19312:15315346,19313:15114653,19314:14989990,19315:14991267,19316:15044488,19317:15108793,19318:15113387,19319:15119019,19320:15253380,19321:14991021,19322:15186349,19323:15317695,19324:14989447,19325:15107490,19326:15121024,19489:15121579,19490:15242387,19491:15045043,19492:15113386,19493:15314309,19494:15054771,19495:15183509,19496:15053484,19497:15052678,19498:15244444,19499:15120778,19500:15242129,19501:15181972,19502:15238280,19503:15050393,19504:15184525,19505:15118481,19506:15178912,19507:15043481,19508:15049890,19509:15172769,19510:15174047,19511:15179675,19512:15309991,19513:15316385,19514:15115403,19515:15051199,19516:15050904,19517:15042213,19518:15044749,19519:15045053,19520:15112334,19521:15178655,19522:15253431,19523:15305368,19524:15315892,19525:15050666,19526:15174045,19527:15121285,19528:15041933,19529:15115145,19530:15185599,19531:15185836,19532:15310242,19533:15317690,19534:15110584,19535:15116449,19536:15240322,19537:15050372,19538:15052191,19539:15118235,19540:15174811,19541:15178674,19542:15185586,19543:15237271,19544:15241881,19545:15041714,19546:15113384,19547:15317913,19548:15178670,19549:15113634,19550:15043519,19551:15312005,19552:15052964,19553:15108283,19554:15184318,19555:15250096,19556:15046031,19557:15106742,19558:15185035,19559:15308416,19560:15043713,19561:14989727,19562:15042230,19563:15049884,19564:15173818,19565:15237302,19566:15304590,19567:15056037,19568:15179682,19569:15044228,19570:15056313,19571:15185028,19572:15242924,19573:15247539,19574:15252109,19575:15310230,19576:15114163,19577:15242926,19578:15307155,19579:15107209,19580:15107208,19581:15119033,19582:15178130,19745:15248301,19746:15252664,19747:15045807,19748:14990737,19749:15041706,19750:15043463,19751:15044491,19752:15052453,19753:15055293,19754:15106720,19755:15107714,19756:15110038,19757:15113353,19758:15114138,19759:15120807,19760:15120012,19761:15174838,19762:15174839,19763:15176881,19764:15181200,19765:15246229,19766:15248024,19767:15303050,19768:15303313,19769:15303605,19770:15309700,19771:15244941,19772:15049877,19773:14989960,19774:14990745,19775:14989454,19776:15248009,19777:15252671,19778:15310992,19779:15041197,19780:15055292,19781:15050390,19782:15052473,19783:15055544,19784:15110042,19785:15110074,19786:15111041,19787:15113116,19788:15115658,19789:15116184,19790:15119499,19791:15121078,19792:15173268,19793:15176872,19794:15182511,19795:15187594,19796:15237248,19797:15241609,19798:15242121,19799:15246977,19800:15248545,19801:15251594,19802:15303077,19803:15309245,19804:15312010,19805:15107518,19806:15108753,19807:15117490,19808:15118979,19809:15119796,19810:15187852,19811:15187900,19812:15120256,19813:15187589,19814:15244986,19815:15246264,19816:15113637,19817:15240881,19818:15311036,19819:15309751,19820:15119515,19821:15185313,19822:15241405,19823:15304106,19824:14989745,19825:15044021,19826:15054224,19827:15117444,19828:15122347,19829:15243149,19830:15243437,19831:15247015,19832:15042729,19833:15044751,19834:15053221,19835:15113614,19836:15114920,19837:15175814,19838:15176323,20001:15177634,20002:15246223,20003:15246241,20004:15304588,20005:15309730,20006:15309240,20007:15056523,20008:15175303,20009:15182731,20010:15241614,20011:15109792,20012:15177125,20013:15043209,20014:15119745,20015:15121052,20016:15175817,20017:15177113,20018:15180203,20019:15184530,20020:15309446,20021:15182748,20022:15318669,20023:14991030,20024:15107502,20025:15112069,20026:15243676,20027:14989958,20028:14989998,20029:15041434,20030:14989473,20031:15042444,20032:15052718,20033:15111833,20034:15114881,20035:15120060,20036:15174815,20037:15178114,20038:15179437,20039:15181980,20040:15184807,20041:15239599,20042:15248274,20043:15303100,20044:15304591,20045:15309237,20046:15311000,20047:15043227,20048:15185809,20049:15040683,20050:15044248,20051:15113879,20052:15120267,20053:15173520,20054:15175859,20055:15239080,20056:15252650,20057:15309475,20058:15315351,20059:15317663,20060:15176096,20061:15049089,20062:15120025,20063:15185071,20064:15311262,20065:14990244,20066:14990518,20067:14990987,20068:15042231,20069:15043249,20070:15054522,20071:15106204,20072:15175346,20073:15180988,20074:15240083,20075:15304884,20076:15309495,20077:15309750,20078:15309962,20079:15317655,20080:15318434,20081:15112870,20082:15117748,20083:15042711,20084:15043235,20085:15172488,20086:15246210,20087:15055753,20088:15106443,20089:15107728,20090:15121571,20091:15173001,20092:15184062,20093:15185844,20094:15237551,20257:15242158,20258:15302819,20259:15305900,20260:15044994,20261:15314351,20262:15117203,20263:15172233,20264:15250306,20265:15251375,20266:15310002,20267:15043252,20268:15051137,20269:15055754,20270:15056004,20271:15113367,20272:15115708,20273:15115924,20274:15119786,20275:15121551,20276:15174050,20277:15174588,20278:15183789,20279:15237249,20280:15237566,20281:15244683,20282:15303566,20283:15041965,20284:15317651,20285:15181444,20286:15237771,20287:15305906,20288:15248278,20289:15040685,20290:15045260,20291:15247793,20292:15117738,20293:15250308,20294:15238279,20295:15106961,20296:15113888,20297:15316914,20298:14989977,20299:14989976,20300:15315088,20301:15247787,20302:15243137,20303:15242664,20304:15115392,20305:15120830,20306:15180439,20307:15238549,20513:15056012,20514:14989456,20515:14989461,20516:14989482,20517:14989489,20518:14989494,20519:14989500,20520:14989503,20521:14989698,20522:14989718,20523:14989720,20524:14989954,20525:14989957,20526:15249835,20527:14989962,20528:15239314,20529:15056013,20530:14989966,20531:14989982,20532:14989983,20533:14989984,20534:14989986,20535:14990000,20536:14990003,20537:14990006,20538:14990222,20539:14990221,20540:14990212,20541:14990214,20542:14990210,20543:14990231,20544:14990238,20545:14990253,20546:14990239,20547:14990263,20548:14990473,20549:14990746,20550:14990512,20551:14990747,20552:14990749,20553:14990743,20554:14990727,20555:14990774,20556:14990984,20557:14990991,20558:14991000,20559:14990779,20560:14990761,20561:14990768,20562:14990993,20563:14990767,20564:14990982,20565:14990998,20566:15041688,20567:14991252,20568:14991263,20569:14991246,20570:14991256,20571:14991259,20572:14991249,20573:14991258,20574:14991248,20575:14991268,20576:14991269,20577:15040666,20578:15040680,20579:15040660,20580:15040682,20581:15040677,20582:15040645,20583:14990492,20584:14991286,20585:15040673,20586:15040681,20587:15040684,20588:14991294,20589:14991279,20590:15040657,20591:15040646,20592:15040899,20593:15040903,20594:15113347,20595:15040917,20596:15040912,20597:15040904,20598:15040922,20599:15040918,20600:15040940,20601:15040952,20602:15041152,20603:15041178,20604:15041157,20605:15041204,20606:15041202,20769:15041417,20770:15041418,20771:15041203,20772:15041410,20773:15041430,20774:15041438,20775:15041445,20776:15041453,20777:15041443,20778:15041454,20779:15041465,20780:15041461,20781:15041673,20782:15041665,20783:15041666,20784:15041686,20785:15041685,20786:15041684,20787:15041690,20788:15041697,20789:15041722,20790:15041719,20791:15041724,20792:15041723,20793:15041727,20794:15041920,20795:15041938,20796:15041932,20797:15041940,20798:15041954,20799:15182776,20800:15041961,20801:15041962,20802:15041966,20803:15042176,20804:15042178,20805:15047576,20806:15042188,20807:15042185,20808:15042191,20809:15042193,20810:15042195,20811:15042197,20812:15042198,20813:15042212,20814:15042214,20815:15042210,20816:15042217,20817:15042218,20818:15042219,20819:15042227,20820:15042225,20821:15042226,20822:15042224,20823:15042229,20824:15042237,20825:15042437,20826:15042441,20827:15042459,20828:15042464,20829:15243669,20830:15042473,20831:15042477,20832:15042480,20833:15042485,20834:15042494,20835:15042692,20836:15042699,20837:15042708,20838:15042702,20839:15042727,20840:15042730,20841:15042734,20842:15042739,20843:15042745,20844:15042959,20845:15042948,20846:15042955,20847:15042956,20848:15042974,20849:15042964,20850:15042986,20851:15042996,20852:15042985,20853:15042995,20854:15043007,20855:15043005,20856:15043213,20857:15043220,20858:15043218,20859:15042993,20860:15043208,20861:15043217,20862:15253160,21025:15253159,21026:15043244,21027:15043245,21028:15043260,21029:15043253,21030:15043457,21031:15043469,21032:15043479,21033:15043486,21034:15043491,21035:15043494,21036:15311789,21037:15043488,21038:15043507,21039:15043509,21040:15043512,21041:15043513,21042:15043718,21043:15043720,21044:15176888,21045:15043725,21046:15043728,21047:15043727,21048:15043733,21049:15043738,21050:15043747,21051:15043759,21052:15043761,21053:15043763,21054:15043768,21055:15043968,21056:15043974,21057:15043973,21058:14989463,21059:15043977,21060:15043981,21061:15042454,21062:15043998,21063:15044009,21064:15044014,21065:15049880,21066:15044027,21067:15044023,21068:15044226,21069:15044246,21070:15044256,21071:15044262,21072:15044261,21073:15044270,21074:15044272,21075:15044278,21076:15044483,21077:15184018,21078:15309721,21079:15044511,21080:15113148,21081:15173550,21082:15044526,21083:15044520,21084:15044525,21085:15044538,21086:15044737,21087:15044797,21088:15044992,21089:15044780,21090:15044781,21091:15044796,21092:15044782,21093:15044790,21094:15044777,21095:15044765,21096:15045006,21097:15045263,21098:15045045,21099:15045262,21100:15045023,21101:15045041,21102:15045047,21103:15045040,21104:15045266,21105:15045051,21106:15045248,21107:15045046,21108:15045252,21109:15045264,21110:15045254,21111:15045511,21112:15045282,21113:15045304,21114:15045285,21115:15045292,21116:15045508,21117:15045512,21118:15045288,21281:15045291,21282:15045506,21283:15045284,21284:15045310,21285:15045308,21286:15045528,21287:15045541,21288:15045542,21289:15045775,21290:15045780,21291:15045565,21292:15045550,21293:15045549,21294:15045562,21295:15045538,21296:15045817,21297:15046016,21298:15046051,21299:15046028,21300:15045806,21301:15046044,21302:15046021,21303:15046038,21304:15046039,21305:15045816,21306:15045811,21307:15046045,21308:15046297,21309:15046272,21310:15045295,21311:15046282,21312:15046303,21313:15046075,21314:15046078,21315:15046296,21316:15046302,21317:15046318,21318:15046076,21319:15046275,21320:15046313,21321:15046279,21322:15046312,21323:15046554,21324:15046533,21325:15046559,21326:15046532,21327:15046556,21328:15046564,21329:15046548,21330:15046804,21331:15046583,21332:15046806,21333:15046590,21334:15046589,21335:15046811,21336:15046585,21337:15047054,21338:15047056,21339:15173535,21340:15046836,21341:15046838,21342:15046834,21343:15046840,21344:15047083,21345:15047076,21346:15046831,21347:15047084,21348:15047082,21349:15047302,21350:15047296,21351:15047306,21352:15047328,21353:15047316,21354:15047311,21355:15047333,21356:15047342,21357:15047350,21358:15047348,21359:15047554,21360:15047356,21361:15047553,21362:15047555,21363:15047552,21364:15047560,21365:15047566,21366:15047569,21367:15047571,21368:15047575,21369:15047598,21370:15047609,21371:15047808,21372:15047615,21373:15047812,21374:15047817,21537:15047816,21538:15047819,21539:15047821,21540:15047827,21541:15047832,21542:15047830,21543:15046535,21544:15047836,21545:15047846,21546:15047863,21547:15047864,21548:15048078,21549:15047867,21550:15048064,21551:15048079,21552:15048105,21553:15048576,21554:15048328,21555:15048097,21556:15048127,21557:15048329,21558:15048339,21559:15048352,21560:15048371,21561:15048356,21562:15048362,21563:15048368,21564:15048579,21565:15048582,21566:15048596,21567:15048594,21568:15048595,21569:15048842,21570:15048598,21571:15048611,21572:15048843,21573:15048857,21574:15048861,21575:15049138,21576:15048865,21577:15049122,21578:15049099,21579:15049136,21580:15118208,21581:15049106,21582:15048893,21583:15049145,21584:15049349,21585:15049401,21586:15049375,21587:15049387,21588:15049402,21589:15049630,21590:15049403,21591:15049400,21592:15049390,21593:15049605,21594:15049619,21595:15049617,21596:15049623,21597:15049625,21598:15049624,21599:15049637,21600:15049628,21601:15049636,21602:15049631,21603:15049647,21604:15049658,21605:15049657,21606:15049659,21607:15049660,21608:15049661,21609:15049858,21610:15049866,21611:15049872,21612:15049883,21613:15114918,21614:15049893,21615:15049900,21616:15049901,21617:15049906,21618:15049912,21619:15049918,21620:15182738,21621:15050133,21622:15050128,21623:15050126,21624:15050138,21625:15050136,21626:15050146,21627:15050144,21628:15050151,21629:15050156,21630:15050153,21793:15050168,21794:15050369,21795:15050397,21796:14990750,21797:14991019,21798:15050403,21799:15050418,21800:15050630,21801:15050664,21802:15050652,21803:15050381,21804:15050649,21805:15050650,21806:15050917,21807:15050911,21808:15050897,21809:15050908,21810:15050889,21811:15050906,21812:15051136,21813:15051180,21814:15051145,21815:15050933,21816:15050934,21817:15051170,21818:15051178,21819:15051418,21820:15051452,21821:15051454,21822:15051659,21823:15051650,21824:15051453,21825:15051683,21826:15051671,21827:15051686,21828:15051689,21829:15051670,21830:15051706,21831:15051707,21832:15051916,21833:15051915,21834:15051926,21835:15051954,21836:15051664,21837:15051946,21838:15051958,21839:15051966,21840:15052163,21841:15052165,21842:15052160,21843:15052177,21844:15052181,21845:15052186,21846:15052187,21847:15052197,21848:15052201,21849:15052208,21850:15052211,21851:15052213,21852:15052216,21853:15111816,21854:15052218,21855:15052416,21856:15052419,21857:15052454,21858:15052472,21859:15052675,21860:15052679,21861:15052681,21862:15052692,21863:15052688,21864:15052708,21865:15052710,21866:15052706,21867:15052702,21868:15052709,21869:15052715,21870:15052720,21871:15052726,21872:15052723,21873:15052933,21874:15052935,21875:15052936,21876:15052941,21877:15052947,21878:15052960,21879:15052962,21880:15052968,21881:15052984,21882:15052985,21883:15053185,21884:15053190,21885:15053198,21886:15053203,22049:15053200,22050:15053199,22051:15052209,22052:15053228,22053:15053230,22054:14989730,22055:15053238,22056:15053241,22057:15053452,22058:15053457,22059:15053460,22060:15050395,22061:15053483,22062:15053499,22063:15053494,22064:15053500,22065:15053495,22066:15053701,22067:15053502,22068:15053703,22069:15053721,22070:15053737,22071:15053757,22072:15053754,22073:15053741,22074:15054476,22075:15053738,22076:15053963,22077:15053973,22078:15053975,22079:15054236,22080:15053983,22081:15053979,22082:15053969,22083:15053972,22084:15053986,22085:15053978,22086:15053977,22087:15053976,22088:15054220,22089:15054226,22090:15054222,22091:15054219,22092:15054252,22093:15054259,22094:15054262,22095:15054471,22096:15054468,22097:15054466,22098:15054498,22099:15054493,22100:15054508,22101:15054510,22102:15054525,22103:15054480,22104:15054519,22105:15054524,22106:15054729,22107:15054733,22108:15054739,22109:15054738,22110:15054742,22111:15054747,22112:15054763,22113:15054770,22114:15054773,22115:15054987,22116:15055002,22117:15055001,22118:15054993,22119:15055003,22120:15055030,22121:15055031,22122:15055236,22123:15055235,22124:15055232,22125:15055246,22126:15055255,22127:15055252,22128:15055263,22129:15055266,22130:15055268,22131:15055239,22132:15055285,22133:15055286,22134:15055290,22135:15317692,22136:15055295,22137:15055520,22138:15055745,22139:15055746,22140:15055752,22141:15055760,22142:15055759,22305:15055766,22306:15055779,22307:15055773,22308:15055770,22309:15055771,22310:15055778,22311:15055777,22312:15055784,22313:15055785,22314:15055788,22315:15055793,22316:15055795,22317:15055792,22318:15055796,22319:15055800,22320:15055806,22321:15056003,22322:15056009,22323:15056285,22324:15056284,22325:15056011,22326:15056017,22327:15056022,22328:15056041,22329:15056045,22330:15056056,22331:15056257,22332:15056264,22333:15056268,22334:15056270,22335:15056047,22336:15056273,22337:15056278,22338:15056279,22339:15056281,22340:15056289,22341:15056301,22342:15056307,22343:15056311,22344:15056515,22345:15056514,22346:15056319,22347:15056522,22348:15056520,22349:15056529,22350:15056519,22351:15056542,22352:15056537,22353:15056536,22354:15056544,22355:15056552,22356:15056557,22357:15056572,22358:15056790,22359:15056827,22360:15056804,22361:15056824,22362:15056817,22363:15056797,22364:15106739,22365:15056831,22366:15106209,22367:15106464,22368:15106201,22369:15106192,22370:15106217,22371:15106190,22372:15106225,22373:15106203,22374:15106197,22375:15106219,22376:15106214,22377:15106191,22378:15106234,22379:15106458,22380:15106433,22381:15106474,22382:15106487,22383:15106463,22384:15106442,22385:15106438,22386:15106445,22387:15106467,22388:15106435,22389:15106468,22390:15106434,22391:15106476,22392:15106475,22393:15106457,22394:15106689,22395:15106701,22396:15106983,22397:15106691,22398:15106714,22561:15106692,22562:15106715,22563:15106710,22564:15106711,22565:15106706,22566:15106727,22567:15106699,22568:15106977,22569:15106744,22570:15106976,22571:15106963,22572:15106740,22573:15056816,22574:15106749,22575:15106950,22576:15106741,22577:15106968,22578:15107469,22579:15107221,22580:15107206,22581:15106998,22582:15106999,22583:15107200,22584:15106996,22585:15107002,22586:15107203,22587:15107233,22588:15107003,22589:15106993,22590:15107213,22591:15107214,22592:15107463,22593:15107262,22594:15107240,22595:15107239,22596:15107466,22597:15107263,22598:15107260,22599:15107244,22600:15107252,22601:15107261,22602:15107458,22603:15107460,22604:15107507,22605:15107511,22606:15107480,22607:15107481,22608:15107482,22609:15107499,22610:15107508,22611:15107503,22612:15107493,22613:15107505,22614:15107487,22615:15107485,22616:15107475,22617:15107509,22618:15107737,22619:15107734,22620:15107719,22621:15107756,22622:15107732,22623:15107738,22624:15107722,22625:15107729,22626:15107755,22627:15107758,22628:15107980,22629:15107978,22630:15107977,22631:15108023,22632:15107976,22633:15107971,22634:15107974,22635:15107770,22636:15107979,22637:15187385,22638:15107981,22639:15108006,22640:15108003,22641:15108022,22642:15108026,22643:15108020,22644:15108031,22645:15108029,22646:15108028,22647:15108030,22648:15108224,22649:15108232,22650:15108233,22651:15108237,22652:15108236,22653:15108244,22654:15108251,22817:15108254,22818:15108257,22819:15108266,22820:15108270,22821:15108272,22822:15108274,22823:15108275,22824:15108481,22825:15108494,22826:15108510,22827:15108515,22828:15108507,22829:15108512,22830:15108520,22831:15108540,22832:15108738,22833:15108745,22834:15108542,22835:15108754,22836:15108755,22837:15108758,22838:15109012,22839:15108739,22840:15108756,22841:15109015,22842:15109009,22843:15108795,22844:15109007,22845:15109055,22846:15108998,22847:15111060,22848:15109000,22849:15109020,22850:15109004,22851:15109002,22852:15108994,22853:15108999,22854:15108763,22855:15109001,22856:15109260,22857:15109038,22858:15109041,22859:15109287,22860:15109250,22861:15109256,22862:15109039,22863:15109045,22864:15109520,22865:15109310,22866:15109517,22867:15110300,22868:15109519,22869:15109782,22870:15109774,22871:15109760,22872:15109803,22873:15109558,22874:15109795,22875:15109775,22876:15109769,22877:15109791,22878:15109813,22879:15109547,22880:15109545,22881:15109822,22882:15110057,22883:15110016,22884:15110022,22885:15110051,22886:15110025,22887:15110034,22888:15110070,22889:15110020,22890:15110294,22891:15110324,22892:15110278,22893:15110291,22894:15110310,22895:15110326,22896:15111325,22897:15110295,22898:15110312,22899:15110287,22900:15110567,22901:15110575,22902:15110582,22903:15110542,22904:15111338,22905:15110805,22906:15110803,22907:15110821,22908:15110825,22909:15110792,22910:15110844,23073:15111066,23074:15111058,23075:15111045,23076:15111047,23077:15110843,23078:15111064,23079:15111042,23080:15111089,23081:15111079,23082:15239305,23083:15111072,23084:15111073,23085:15108780,23086:15111075,23087:15111087,23088:15111340,23089:15111094,23090:15111092,23091:15111090,23092:15111098,23093:15111296,23094:15111101,23095:15111320,23096:15111324,23097:15111301,23098:15111332,23099:15111331,23100:15111339,23101:15111348,23102:15111349,23103:15111351,23104:15111350,23105:15111352,23106:15177099,23107:15111560,23108:15111574,23109:15111573,23110:15111565,23111:15111576,23112:15111582,23113:15111581,23114:15111602,23115:15111608,23116:15111810,23117:15111811,23118:15249034,23119:15111835,23120:15111839,23121:15111851,23122:15111863,23123:15112067,23124:15112070,23125:15112065,23126:15112068,23127:15112076,23128:15112082,23129:15112091,23130:15112089,23131:15112096,23132:15112097,23133:15112113,23134:15113650,23135:15112330,23136:15112323,23137:15112123,23138:15113651,23139:15112373,23140:15112374,23141:15112372,23142:15112348,23143:15112591,23144:15112580,23145:15112585,23146:15112577,23147:15112606,23148:15112605,23149:15112612,23150:15112615,23151:15112616,23152:15112607,23153:15112610,23154:15112624,23155:15112835,23156:15112840,23157:15112846,23158:15112841,23159:15112836,23160:15112856,23161:15112861,23162:15113089,23163:15112889,23164:15113097,23165:15112894,23166:15112892,23329:15113092,23330:15112888,23331:15113110,23332:15113114,23333:15113120,23334:15112383,23335:15113126,23336:15113129,23337:15113136,23338:15113141,23339:15113143,23340:15113359,23341:15113366,23342:15113374,23343:15113382,23344:15113383,23345:15310008,23346:15113390,23347:15113407,23348:15113398,23349:15113601,23350:15113400,23351:15113399,23352:15113606,23353:15113630,23354:15113632,23355:15113625,23356:15113635,23357:15113636,23358:15113865,23359:15113648,23360:15113897,23361:15113660,23362:15113642,23363:15113868,23364:15113867,23365:15113894,23366:15113889,23367:15113861,23368:15113911,23369:15114159,23370:15113908,23371:15114156,23372:15113907,23373:15114153,23374:15113912,23375:15114148,23376:15114142,23377:15114141,23378:15114146,23379:15114158,23380:15113913,23381:15114126,23382:15114118,23383:15114151,23384:15116956,23385:15114398,23386:15114630,23387:15114409,23388:15114624,23389:15114637,23390:15114418,23391:15114638,23392:15114931,23393:15114411,23394:15114649,23395:15114659,23396:15114679,23397:15114687,23398:15114911,23399:15114895,23400:15114925,23401:15114900,23402:15114909,23403:15114907,23404:15114883,23405:15116974,23406:15114937,23407:15114676,23408:15114933,23409:15114912,23410:15114938,23411:15115407,23412:15114893,23413:15114686,23414:15115393,23415:15115146,23416:15115400,23417:15115160,23418:15115426,23419:15115430,23420:15115169,23421:15115404,23422:15115149,23585:15115156,23586:15115175,23587:15115157,23588:15115446,23589:15115410,23590:15115396,23591:15115159,23592:15115171,23593:15115429,23594:15115193,23595:15115168,23596:15115183,23597:15115432,23598:15115434,23599:15115418,23600:15115427,23601:15115425,23602:15115142,23603:15115705,23604:15115703,23605:15115676,23606:15115704,23607:15115691,23608:15115668,23609:15115710,23610:15115694,23611:15115449,23612:15115700,23613:15115453,23614:15115673,23615:15115440,23616:15115681,23617:15115678,23618:15115677,23619:15115905,23620:15115690,23621:15115954,23622:15115950,23623:15116176,23624:15115967,23625:15116161,23626:15116179,23627:15115966,23628:15116174,23629:15052712,23630:15116170,23631:15116189,23632:15115963,23633:15116163,23634:15115943,23635:15116462,23636:15115921,23637:15115936,23638:15115932,23639:15115925,23640:15115956,23641:15116190,23642:15116200,23643:15116418,23644:15116443,23645:15116223,23646:15117450,23647:15116217,23648:15116210,23649:15116199,23650:15116421,23651:15115953,23652:15116446,23653:15116205,23654:15116436,23655:15116203,23656:15116426,23657:15116434,23658:15117185,23659:15116451,23660:15116435,23661:15116676,23662:15116428,23663:15116722,23664:15116470,23665:15116728,23666:15116679,23667:15116706,23668:15116697,23669:15116710,23670:15116680,23671:15116472,23672:15116450,23673:15116944,23674:15116941,23675:15116960,23676:15116932,23677:15116962,23678:15116963,23841:15116951,23842:15243415,23843:15116987,23844:15117187,23845:15117186,23846:15116984,23847:15116979,23848:15116972,23849:15117214,23850:15117201,23851:15117215,23852:15116970,23853:15117210,23854:15117226,23855:15117243,23856:15117445,23857:15243414,23858:15117242,23859:15117458,23860:15117462,23861:15314097,23862:15117471,23863:15117496,23864:15117495,23865:15178652,23866:15117497,23867:15311790,23868:15117703,23869:15117699,23870:15117705,23871:15117712,23872:15117721,23873:15117716,23874:15117723,23875:15117727,23876:15117729,23877:15117752,23878:15117753,23879:15117759,23880:15117952,23881:15117956,23882:15117955,23883:15117965,23884:15117976,23885:15117973,23886:15117982,23887:15117988,23888:15117994,23889:15117995,23890:15117999,23891:15118002,23892:15118001,23893:15118003,23894:15118007,23895:15118012,23896:15118214,23897:15118219,23898:15118227,23899:15118239,23900:15118252,23901:15118251,23902:15118259,23903:15118255,23904:15317694,23905:15118472,23906:15118483,23907:15118484,23908:15118491,23909:15118500,23910:15118499,23911:15118750,23912:15118741,23913:15118754,23914:15118762,23915:15118978,23916:15118989,23917:15119002,23918:15118977,23919:15119003,23920:15118782,23921:15118760,23922:15118771,23923:15118994,23924:15118992,23925:15119236,23926:15119281,23927:15119251,23928:15119037,23929:15119255,23930:15119237,23931:15119261,23932:15119022,23933:15119025,23934:15119038,24097:15119034,24098:15119259,24099:15119279,24100:15119257,24101:15119274,24102:15119519,24103:15245709,24104:15119542,24105:15119531,24106:15119549,24107:15119544,24108:15119513,24109:15119541,24110:15119539,24111:15119506,24112:15119500,24113:15119779,24114:15120019,24115:15119780,24116:15119770,24117:15119801,24118:15119769,24119:15120014,24120:15120021,24121:15122340,24122:15120005,24123:15120313,24124:15120533,24125:15120522,24126:15120053,24127:15120263,24128:15120294,24129:15120056,24130:15120262,24131:15120300,24132:15120286,24133:15120268,24134:15120296,24135:15120274,24136:15120261,24137:15120314,24138:15120281,24139:15120292,24140:15120277,24141:15120298,24142:15120302,24143:15120557,24144:15120814,24145:15120558,24146:15120537,24147:15120818,24148:15120799,24149:15120574,24150:15120547,24151:15120811,24152:15120555,24153:15120822,24154:15120781,24155:15120543,24156:15120771,24157:15120570,24158:15120782,24159:15120548,24160:15121343,24161:15120541,24162:15120568,24163:15121026,24164:15121066,24165:15121048,24166:15121289,24167:15121079,24168:15121299,24169:15121085,24170:15121071,24171:15121284,24172:15121074,24173:15121300,24174:15121301,24175:15121039,24176:15121061,24177:15121282,24178:15121055,24179:15121793,24180:15121553,24181:15171980,24182:15121324,24183:15121336,24184:15121342,24185:15121599,24186:15121330,24187:15121585,24188:15121327,24189:15121586,24190:15121292,24353:15121598,24354:15121555,24355:15121335,24356:15122054,24357:15121850,24358:15121848,24359:15122049,24360:15122048,24361:15121839,24362:15121819,24363:15122355,24364:15121837,24365:15122050,24366:15121852,24367:15121816,24368:15122062,24369:15122065,24370:15122306,24371:15121830,24372:15122099,24373:15122083,24374:15122081,24375:15122084,24376:15122105,24377:15122310,24378:15122090,24379:15122335,24380:15122325,24381:15122348,24382:15122324,24383:15122328,24384:15122353,24385:15122350,24386:15122331,24387:15171721,24388:15171723,24389:15122362,24390:15171729,24391:15171713,24392:15171727,24393:15122366,24394:15171739,24395:15171738,24396:15121844,24397:15171741,24398:15171736,24399:15171743,24400:15171760,24401:15171774,24402:15171762,24403:15171985,24404:15172003,24405:15172249,24406:15172242,24407:15172271,24408:15172529,24409:15172268,24410:15172280,24411:15172275,24412:15172270,24413:15172511,24414:15172491,24415:15172509,24416:15172505,24417:15172745,24418:15172541,24419:15172764,24420:15172761,24421:15173029,24422:15173013,24423:15173256,24424:15173030,24425:15173026,24426:15173004,24427:15173014,24428:15173036,24429:15173263,24430:15173563,24431:15173252,24432:15173269,24433:15173288,24434:15173292,24435:15173527,24436:15173305,24437:15173310,24438:15173522,24439:15173513,24440:15173524,24441:15173518,24442:15173536,24443:15173548,24444:15173543,24445:15173557,24446:15173564,24609:15173561,24610:15173567,24611:15173773,24612:15173776,24613:15173787,24614:15173800,24615:15173805,24616:15173804,24617:15173808,24618:15173810,24619:15173819,24620:15173820,24621:15173823,24622:15174016,24623:15174022,24624:15174027,24625:15174040,24626:15174068,24627:15174078,24628:15174274,24629:15174273,24630:15174279,24631:15174290,24632:15174294,24633:15174306,24634:15174311,24635:15174329,24636:15174322,24637:15174531,24638:15174534,24639:15174532,24640:15174542,24641:15174546,24642:15174562,24643:15174560,24644:15174561,24645:15174585,24646:15174583,24647:15040655,24648:15174807,24649:15174794,24650:15174812,24651:15174806,24652:15174813,24653:15174836,24654:15174831,24655:15174825,24656:15174821,24657:15174846,24658:15175054,24659:15175055,24660:15317912,24661:15175063,24662:15175082,24663:15175080,24664:15175088,24665:15175096,24666:15175093,24667:15175099,24668:15175098,24669:15175560,24670:15175347,24671:15175566,24672:15175355,24673:15175552,24674:15175589,24675:15175598,24676:15175582,24677:15176354,24678:15175813,24679:15176111,24680:15175845,24681:15175608,24682:15175858,24683:15175866,24684:15176085,24685:15175871,24686:15176095,24687:15176089,24688:15176065,24689:15176092,24690:15176105,24691:15176112,24692:15176099,24693:15176106,24694:15176118,24695:15176126,24696:15176331,24697:15176350,24698:15176359,24699:15176586,24700:15176591,24701:15176596,24702:15175601,24865:15176608,24866:15176611,24867:15176615,24868:15176617,24869:15176622,24870:15176626,24871:15176624,24872:15176625,24873:15176632,24874:15176631,24875:15176836,24876:15176835,24877:15176837,24878:15176844,24879:15176846,24880:15176845,24881:15176853,24882:15176851,24883:15176862,24884:15176870,24885:15176876,24886:15176892,24887:15177092,24888:15177101,24889:15177098,24890:15177097,24891:15177115,24892:15177094,24893:15177114,24894:15177129,24895:15177124,24896:15177127,24897:15177131,24898:15177133,24899:15177144,24900:15177142,24901:15177350,24902:15177351,24903:15177140,24904:15177354,24905:15177353,24906:15177346,24907:15177364,24908:15177370,24909:15177373,24910:15177381,24911:15177379,24912:15177602,24913:15177395,24914:15177603,24915:15177397,24916:15177405,24917:15177400,24918:15177404,24919:15177393,24920:15177613,24921:15177610,24922:15177618,24923:15177625,24924:15177635,24925:15177630,24926:15177662,24927:15177663,24928:15177660,24929:15177857,24930:15177648,24931:15177658,24932:15177650,24933:15177651,24934:15177867,24935:15177869,24936:15177865,24937:15177887,24938:15177895,24939:15177888,24940:15177889,24941:15177890,24942:15177892,24943:15177908,24944:15177904,24945:15177915,24946:15178119,24947:15178120,24948:15178118,24949:15178140,24950:15178136,24951:15178145,24952:15178146,24953:15178152,24954:15178153,24955:15178154,24956:15178151,24957:15178156,24958:15178160,25121:15178162,25122:15178166,25123:15178168,25124:15178172,25125:15178368,25126:15178371,25127:15178376,25128:15178379,25129:15178382,25130:15178390,25131:15178387,25132:15178393,25133:15178394,25134:15178416,25135:15178420,25136:15178424,25137:15178425,25138:15178426,25139:15178626,25140:15178637,25141:15178646,25142:15178642,25143:15178654,25144:15178657,25145:15178661,25146:15178663,25147:15178666,25148:15243439,25149:15178683,25150:15178888,25151:15178887,25152:15178884,25153:15178921,25154:15178916,25155:15178910,25156:15178917,25157:15178918,25158:15178907,25159:15178935,25160:15178936,25161:15179143,25162:15179162,25163:15179176,25164:15179179,25165:15179163,25166:15179173,25167:15179199,25168:15179198,25169:15179193,25170:15179406,25171:15179403,25172:15179409,25173:15179424,25174:15179422,25175:15179440,25176:15179446,25177:15179449,25178:15179455,25179:15179452,25180:15179453,25181:15179451,25182:15179655,25183:15179661,25184:15179671,25185:15179674,25186:15179676,25187:15179683,25188:15179694,25189:15179708,25190:15179916,25191:15179922,25192:15180966,25193:15179936,25194:15180970,25195:15180165,25196:15180430,25197:15180212,25198:15180422,25199:15180220,25200:15180442,25201:15180428,25202:15180451,25203:15180469,25204:15180458,25205:15180463,25206:15180689,25207:15180678,25208:15180683,25209:15180692,25210:15180478,25211:15180476,25212:15180677,25213:15180682,25214:15180716,25377:15180711,25378:15180698,25379:15180733,25380:15180724,25381:15180935,25382:15180946,25383:15180945,25384:15180953,25385:15180972,25386:15180971,25387:15181184,25388:15181216,25389:15181207,25390:15181215,25391:15181210,25392:15181205,25393:15181203,25394:15181242,25395:15181247,25396:15181450,25397:15181469,25398:15181479,25399:15318411,25400:15181482,25401:15181486,25402:15181491,25403:15181497,25404:15181498,25405:15181705,25406:15181717,25407:15181735,25408:15181740,25409:15181729,25410:15181731,25411:15181960,25412:15181965,25413:15181976,25414:15181977,25415:15181984,25416:15181983,25417:15181440,25418:15182001,25419:15182011,25420:15182014,25421:15182007,25422:15182211,25423:15182231,25424:15182217,25425:15182241,25426:15182242,25427:15182249,25428:15318685,25429:15182256,25430:15182265,25431:15182269,25432:15182472,25433:15182487,25434:15182485,25435:15182488,25436:15182486,25437:15182505,25438:15182728,25439:15182512,25440:15182518,25441:15182725,25442:15182724,25443:15182527,25444:15303299,25445:15182727,25446:15182730,25447:15182733,25448:15182735,25449:15182741,25450:15182739,25451:15182745,25452:15182746,25453:15182749,25454:15182753,25455:15182754,25456:15182758,25457:15182765,25458:15182768,25459:15182978,25460:15182991,25461:15182986,25462:15182982,25463:15183027,25464:15183000,25465:15183001,25466:15183006,25467:15183029,25468:15183016,25469:15183030,25470:15183248,25633:15183290,25634:15182980,25635:15183245,25636:15182987,25637:15183244,25638:15183237,25639:15183285,25640:15183269,25641:15183284,25642:15183271,25643:15183280,25644:15183281,25645:15183276,25646:15183278,25647:15183517,25648:15183512,25649:15183519,25650:15183501,25651:15183516,25652:15183514,25653:15183499,25654:15183506,25655:15183503,25656:15183261,25657:15183513,25658:15183755,25659:15183745,25660:15183756,25661:15183759,25662:15183540,25663:15183750,25664:15183773,25665:15183785,25666:15184017,25667:15184020,25668:15183782,25669:15183781,25670:15184288,25671:15184000,25672:15184007,25673:15184019,25674:15183795,25675:15183799,25676:15184023,25677:15184013,25678:15183798,25679:15184035,25680:15184039,25681:15184042,25682:15184031,25683:15184055,25684:15184043,25685:15184061,25686:15184268,25687:15184259,25688:15184276,25689:15184271,25690:15184256,25691:15184272,25692:15184280,25693:15184287,25694:15184292,25695:15184278,25696:15184293,25697:15184300,25698:15184309,25699:15184515,25700:15184528,25701:15184548,25702:15184557,25703:15184546,25704:15184555,25705:15184545,25706:15184552,25707:15184563,25708:15184562,25709:15184561,25710:15184558,25711:15184569,25712:15184573,25713:15184768,25714:15184773,25715:15184770,25716:15184792,25717:15184786,25718:15184796,25719:15184802,25720:15314107,25721:15184815,25722:15184818,25723:15184820,25724:15184822,25725:15184826,25726:15185030,25889:15185026,25890:15185052,25891:15185045,25892:15185034,25893:15185285,25894:15185291,25895:15185070,25896:15185074,25897:15185087,25898:15185077,25899:15185286,25900:15185331,25901:15185302,25902:15185294,25903:15185330,25904:15185320,25905:15185326,25906:15185295,25907:15185315,25908:15185555,25909:15185545,25910:15185307,25911:15185551,25912:15185341,25913:15185563,25914:15185594,25915:15185582,25916:15185571,25917:15185589,25918:15185799,25919:15185597,25920:15185579,25921:15186109,25922:15185570,25923:15185583,25924:15185820,25925:15185592,25926:15185567,25927:15185584,25928:15185816,25929:15185821,25930:15185828,25931:15185822,25932:15185851,25933:15185842,25934:15185825,25935:15186053,25936:15186058,25937:15186083,25938:15186081,25939:15186066,25940:15186097,25941:15186079,25942:15186057,25943:15186059,25944:15186082,25945:15186310,25946:15186342,25947:15186107,25948:15186101,25949:15186105,25950:15186307,25951:15186103,25952:15186098,25953:15186106,25954:15186343,25955:15186333,25956:15186326,25957:15186334,25958:15186329,25959:15186330,25960:15186361,25961:15186346,25962:15186345,25963:15186364,25964:15186363,25965:15186563,25966:15185813,25967:15186365,25968:15253166,25969:15186367,25970:15186568,25971:15186569,25972:15186572,25973:15186578,25974:15186576,25975:15186579,25976:15186580,25977:15186582,25978:15186574,25979:15186587,25980:15186588,25981:15187128,25982:15187130,26145:15187333,26146:15187340,26147:15187341,26148:15187342,26149:15187344,26150:15187345,26151:15187349,26152:15187348,26153:15187352,26154:15187359,26155:15187360,26156:15187368,26157:15187369,26158:15187367,26159:15187384,26160:15187586,26161:15187590,26162:15187587,26163:15187592,26164:15187591,26165:15187596,26166:15187604,26167:15187614,26168:15187613,26169:15187610,26170:15187619,26171:15187631,26172:15187634,26173:15187641,26174:15187630,26175:15187638,26176:15187640,26177:15248817,26178:15187845,26179:15187846,26180:15187850,26181:15187861,26182:15187860,26183:15187873,26184:15187878,26185:15187881,26186:15187891,26187:15187897,26188:15311772,26189:15237254,26190:15237252,26191:15237259,26192:15237266,26193:15237272,26194:15237273,26195:15237276,26196:15237281,26197:15237288,26198:15237311,26199:15237307,26200:15237514,26201:15237510,26202:15237522,26203:15237528,26204:15237530,26205:15237535,26206:15237538,26207:15237544,26208:15237555,26209:15237554,26210:15237552,26211:15237558,26212:15237561,26213:15237565,26214:15237567,26215:15237764,26216:15237766,26217:15237765,26218:15237787,26219:15237779,26220:15237786,26221:15237805,26222:15042192,26223:15237804,26224:15238043,26225:15238053,26226:15238041,26227:15238045,26228:15238020,26229:15238042,26230:15238038,26231:15238281,26232:15238063,26233:15238065,26234:15238299,26235:15238313,26236:15238307,26237:15238319,26238:15238539,26401:15309451,26402:15238534,26403:15238334,26404:15238547,26405:15238545,26406:15238076,26407:15238577,26408:15238574,26409:15238565,26410:15238566,26411:15238580,26412:15238787,26413:15238792,26414:15238794,26415:15238784,26416:15238786,26417:15238816,26418:15238805,26419:15238820,26420:15238819,26421:15238559,26422:15238803,26423:15238825,26424:15238832,26425:15238837,26426:15238846,26427:15238840,26428:15238845,26429:15239040,26430:15239042,26431:15238842,26432:15239049,26433:15239053,26434:15239057,26435:15239065,26436:15239064,26437:15239048,26438:15239066,26439:15239071,26440:15239072,26441:15239079,26442:15239098,26443:15239099,26444:15239102,26445:15239297,26446:15239298,26447:15239301,26448:15239303,26449:15239306,26450:15239309,26451:15239312,26452:15239318,26453:15239337,26454:15239339,26455:15239352,26456:15239347,26457:15239552,26458:15239577,26459:15239576,26460:15239581,26461:15239578,26462:15239583,26463:15239588,26464:15239586,26465:15239592,26466:15239594,26467:15239595,26468:15239342,26469:15239601,26470:15239607,26471:15239608,26472:15239614,26473:15239821,26474:15239826,26475:15239851,26476:15239839,26477:15239867,26478:15239852,26479:15240097,26480:15240099,26481:15240095,26482:15240082,26483:15240116,26484:15240115,26485:15240122,26486:15240851,26487:15240323,26488:15240123,26489:15240121,26490:15240094,26491:15240326,26492:15240092,26493:15240329,26494:15240089,26657:15240373,26658:15240372,26659:15240342,26660:15240370,26661:15240369,26662:15240576,26663:15240377,26664:15240592,26665:15240581,26666:15240367,26667:15240363,26668:15240343,26669:15240344,26670:15240837,26671:15240858,26672:15240874,26673:15240863,26674:15240866,26675:15240854,26676:15240355,26677:15240846,26678:15240839,26679:15240842,26680:15240636,26681:15240885,26682:15240627,26683:15240629,26684:15240864,26685:15240841,26686:15240872,26687:15241140,26688:15241363,26689:15241131,26690:15241102,26691:15241149,26692:15241347,26693:15241112,26694:15241355,26695:15241089,26696:15241143,26697:15241351,26698:15241120,26699:15241138,26700:15241357,26701:15241378,26702:15241376,26703:15240893,26704:15241400,26705:15242374,26706:15241147,26707:15241645,26708:15241386,26709:15241404,26710:15242650,26711:15241860,26712:15241655,26713:15241643,26714:15241901,26715:15241646,26716:15241858,26717:15241641,26718:15241606,26719:15241388,26720:15241647,26721:15241657,26722:15241397,26723:15242122,26724:15241634,26725:15241913,26726:15241919,26727:15241887,26728:15242137,26729:15242125,26730:15241915,26731:15242138,26732:15242128,26733:15242113,26734:15242118,26735:15242134,26736:15241889,26737:15242401,26738:15242175,26739:15242164,26740:15242391,26741:15242392,26742:15242412,26743:15242399,26744:15242389,26745:15242388,26746:15242172,26747:15242624,26748:15242659,26749:15242648,26750:15242632,26913:15242625,26914:15243394,26915:15242635,26916:15242645,26917:15242880,26918:15242916,26919:15242888,26920:15242897,26921:15242890,26922:15242920,26923:15242669,26924:15242900,26925:15242907,26926:15243178,26927:15242887,26928:15242908,26929:15242679,26930:15242686,26931:15242896,26932:15243145,26933:15242938,26934:15243151,26935:15242937,26936:15243152,26937:15243157,26938:15243165,26939:15243173,26940:15243164,26941:15243193,26942:15243402,26943:15243411,26944:15243403,26945:15243198,26946:15243194,26947:15243398,26948:15243426,26949:15243418,26950:15243440,26951:15243455,26952:15243661,26953:14989717,26954:15243668,26955:15243679,26956:15243687,26957:15243697,26958:15243923,26959:15243939,26960:15243945,26961:15243946,26962:15243915,26963:15243916,26964:15243958,26965:15243951,26966:15244164,26967:15244166,26968:15243952,26969:15244169,26970:15245475,26971:15243947,26972:15244180,26973:15244190,26974:15244201,26975:15244204,26976:15244191,26977:15244187,26978:15244207,26979:15244434,26980:15244422,26981:15244424,26982:15244416,26983:15244419,26984:15244219,26985:15244433,26986:15244425,26987:15244429,26988:15244217,26989:15244426,26990:15244468,26991:15244479,26992:15244471,26993:15244475,26994:15244453,26995:15244457,26996:15244442,26997:15244704,26998:15244703,26999:15244728,27000:15244684,27001:15244686,27002:15244724,27003:15244695,27004:15244712,27005:15244718,27006:15244697,27169:15244691,27170:15244707,27171:15244714,27172:15245445,27173:15244962,27174:15244959,27175:15244930,27176:15244975,27177:15245195,27178:15244989,27179:15245184,27180:15245200,27181:15309718,27182:15244971,27183:15245188,27184:15244979,27185:15245191,27186:15245190,27187:15244987,27188:15245231,27189:15245234,27190:15245216,27191:15245455,27192:15245453,27193:15245246,27194:15245238,27195:15245239,27196:15245454,27197:15245202,27198:15245457,27199:15245462,27200:15245461,27201:15245474,27202:15245473,27203:15245489,27204:15245494,27205:15245497,27206:15245479,27207:15245499,27208:15245700,27209:15245698,27210:15245714,27211:15245721,27212:15245726,27213:15245730,27214:15245739,27215:15245953,27216:15245758,27217:15245982,27218:15245749,27219:15245757,27220:15246005,27221:15245746,27222:15245954,27223:15245975,27224:15245970,27225:15245998,27226:15245977,27227:15245986,27228:15245965,27229:15245988,27230:15246000,27231:15246015,27232:15246001,27233:15246211,27234:15246212,27235:15246228,27236:15246232,27237:15246233,27238:15246237,27239:15246265,27240:15246466,27241:15246268,27242:15246260,27243:15246248,27244:15246258,27245:15246468,27246:15246476,27247:15246474,27248:15246483,27249:15246723,27250:15246494,27251:15246501,27252:15246506,27253:15246507,27254:15246721,27255:15246724,27256:15246523,27257:15246518,27258:15246520,27259:15246732,27260:15246493,27261:15246752,27262:15246750,27425:15246758,27426:15246756,27427:15246765,27428:15246762,27429:15246767,27430:15246772,27431:15246775,27432:15246782,27433:15246979,27434:15246984,27435:15246986,27436:15246995,27437:15247000,27438:15247009,27439:15247017,27440:15247014,27441:15247020,27442:15247023,27443:15247026,27444:15247034,27445:15247037,27446:15247039,27447:15247232,27448:15247258,27449:15247260,27450:15247261,27451:15247271,27452:15247284,27453:15247288,27454:15247491,27455:15247510,27456:15247504,27457:15247500,27458:15247515,27459:15247517,27460:15247525,27461:15247542,27462:15247745,27463:15247771,27464:15247762,27465:15247750,27466:15247752,27467:15247804,27468:15247789,27469:15247788,27470:15247778,27471:15248005,27472:15248002,27473:15248004,27474:15248040,27475:15248033,27476:15248017,27477:15248037,27478:15248038,27479:15248026,27480:15248035,27481:15248260,27482:15248269,27483:15248258,27484:15248282,27485:15248299,27486:15248307,27487:15248295,27488:15248292,27489:15248305,27490:15248532,27491:15248288,27492:15248290,27493:15248311,27494:15248286,27495:15248283,27496:15248524,27497:15248519,27498:15248538,27499:15248289,27500:15248534,27501:15248528,27502:15248535,27503:15248544,27504:15248563,27505:15310507,27506:15248550,27507:15248555,27508:15248574,27509:15248552,27510:15248769,27511:15248780,27512:15248783,27513:15248782,27514:15248777,27515:15248790,27516:15248795,27517:15248794,27518:15248811,27681:15248799,27682:15248812,27683:15248815,27684:15248820,27685:15248829,27686:15249024,27687:15249036,27688:15249038,27689:15249042,27690:15249043,27691:15249046,27692:15249049,27693:15249050,27694:15249594,27695:15249793,27696:15249599,27697:15249800,27698:15249804,27699:15249806,27700:15249808,27701:15249813,27702:15249826,27703:15249836,27704:15249848,27705:15249850,27706:15250050,27707:15250057,27708:15250053,27709:15250058,27710:15250061,27711:15250062,27712:15250068,27713:15249852,27714:15250072,27715:15108253,27716:15250093,27717:15250090,27718:15250109,27719:15250098,27720:15250099,27721:15250094,27722:15250102,27723:15250312,27724:15250305,27725:15250340,27726:15250339,27727:15250330,27728:15250365,27729:15250362,27730:15250363,27731:15250564,27732:15250565,27733:15250570,27734:15250567,27735:15250575,27736:15250573,27737:15250576,27738:15318414,27739:15250579,27740:15250317,27741:15250580,27742:15250582,27743:15250855,27744:15250861,27745:15250865,27746:15250867,27747:15251073,27748:15251097,27749:15251330,27750:15251134,27751:15251130,27752:15251343,27753:15251354,27754:15251350,27755:15251340,27756:15251355,27757:15251339,27758:15251370,27759:15251371,27760:15251359,27761:15251363,27762:15251388,27763:15251592,27764:15251593,27765:15251391,27766:15251613,27767:15251614,27768:15251600,27769:15251615,27770:15251842,27771:15251637,27772:15251632,27773:15251636,27774:15251850,27937:15251847,27938:15251849,27939:15251852,27940:15251856,27941:15251848,27942:15251865,27943:15251876,27944:15251872,27945:15251626,27946:15251875,27947:15251861,27948:15251894,27949:15251890,27950:15251900,27951:15252097,27952:15252103,27953:15252101,27954:15252100,27955:15252107,27956:15252106,27957:15252115,27958:15252113,27959:15252116,27960:15252121,27961:15252138,27962:15252129,27963:15252140,27964:15252144,27965:15252358,27966:15252145,27967:15252158,27968:15252357,27969:15252360,27970:15252363,27971:15252379,27972:15252387,27973:15252412,27974:15252411,27975:15252395,27976:15252414,27977:15252618,27978:15252613,27979:15252629,27980:15252626,27981:15252633,27982:15252627,27983:15252636,27984:15252639,27985:15252635,27986:15252620,27987:15252646,27988:15252659,27989:15252667,27990:15252665,27991:15252869,27992:15252866,27993:15252670,27994:15252876,27995:15252873,27996:15252870,27997:15252878,27998:15252887,27999:15252892,28000:15252898,28001:15252899,28002:15252900,28003:15253148,28004:15253151,28005:15253155,28006:15253165,28007:15253167,28008:15253175,28009:15253402,28010:15253413,28011:15253410,28012:15253418,28013:15253423,28014:15303303,28015:15253428,28016:15302789,28017:15253433,28018:15253434,28019:15302801,28020:15302805,28021:15302817,28022:15302797,28023:15302814,28024:15302806,28025:15302795,28026:15302823,28027:15302838,28028:15302837,28029:15302841,28030:15253432,28193:15303055,28194:15303056,28195:15303057,28196:15303058,28197:15302798,28198:15303049,28199:15302846,28200:15303062,28201:15303064,28202:15303070,28203:15303080,28204:15303087,28205:15303094,28206:15309480,28207:15303090,28208:15303298,28209:15303101,28210:15303297,28211:15303296,28212:15303306,28213:15303305,28214:15303311,28215:15303336,28216:15303343,28217:15303345,28218:15303349,28219:15303586,28220:15303588,28221:15108488,28222:15303579,28223:15303810,28224:15303826,28225:15303833,28226:15303858,28227:15303856,28228:15304074,28229:15304086,28230:15304088,28231:15304099,28232:15304101,28233:15304105,28234:15304115,28235:15304114,28236:15304331,28237:15304329,28238:15304322,28239:15304354,28240:15304363,28241:15304367,28242:15304362,28243:15304373,28244:15304372,28245:15304378,28246:15304576,28247:15304577,28248:15304585,28249:15304587,28250:15304592,28251:15304598,28252:15304607,28253:15304609,28254:15304603,28255:15304636,28256:15304629,28257:15304630,28258:15304862,28259:15304639,28260:15304852,28261:15304876,28262:15304853,28263:15304849,28264:15305118,28265:15305111,28266:15305093,28267:15305097,28268:15305124,28269:15305096,28270:15305365,28271:15304895,28272:15305099,28273:15305104,28274:15305372,28275:15305366,28276:15305363,28277:15305371,28278:15305114,28279:15305615,28280:15305401,28281:15305399,28282:15305641,28283:15305871,28284:15305658,28285:15306116,28286:15305902,28449:15305881,28450:15305890,28451:15305882,28452:15305891,28453:15305914,28454:15305909,28455:15305915,28456:15306140,28457:15306144,28458:15306172,28459:15306158,28460:15306134,28461:15306416,28462:15306412,28463:15306413,28464:15306388,28465:15306425,28466:15306646,28467:15306647,28468:15306664,28469:15306661,28470:15306648,28471:15306627,28472:15306653,28473:15306640,28474:15306632,28475:15306660,28476:15306906,28477:15306900,28478:15306899,28479:15306883,28480:15306887,28481:15306896,28482:15306934,28483:15306923,28484:15306933,28485:15306913,28486:15306938,28487:15307137,28488:15307154,28489:15307140,28490:15307163,28491:15307168,28492:15307170,28493:15307166,28494:15307178,28495:15304873,28496:15307184,28497:15307189,28498:15307191,28499:15307197,28500:15307162,28501:15307196,28502:15307198,28503:15307393,28504:15307199,28505:15308418,28506:15308423,28507:15308426,28508:15308436,28509:15308438,28510:15308440,28511:15308441,28512:15308448,28513:15308456,28514:15308455,28515:15308461,28516:15308476,28517:15308475,28518:15308473,28519:15308478,28520:15308682,28521:15122358,28522:15308675,28523:15308685,28524:15308684,28525:15308693,28526:15308692,28527:15308694,28528:15308700,28529:15308705,28530:15308709,28531:15308706,28532:15308961,28533:15308968,28534:15308974,28535:15308975,28536:15309186,28537:15309196,28538:15309199,28539:15309195,28540:15309239,28541:15309212,28542:15309214,28705:15309213,28706:15309215,28707:15309222,28708:15309234,28709:15309228,28710:15309453,28711:15309464,28712:15309461,28713:15309463,28714:15309482,28715:15309479,28716:15309489,28717:15309490,28718:15309488,28719:15309492,28720:15309494,28721:15309496,28722:15309497,28723:15309710,28724:15309707,28725:15309705,28726:15309709,28727:15246733,28728:15309724,28729:15309965,28730:15309717,28731:15309753,28732:15309956,28733:15309958,28734:15309960,28735:15309971,28736:15309966,28737:15309969,28738:15309967,28739:15309974,28740:15309977,28741:15309988,28742:15309994,28743:15310000,28744:15310009,28745:15310013,28746:15310014,28747:15310212,28748:15310214,28749:15310216,28750:15310210,28751:15310217,28752:15310236,28753:15310240,28754:15310244,28755:15310246,28756:15310248,28757:15043474,28758:15310251,28759:15310257,28760:15310265,28761:15310469,28762:15310268,28763:15310465,28764:15310266,28765:15310470,28766:15310475,28767:15310479,28768:15310480,28769:15310492,28770:15310504,28771:15310502,28772:15310499,28773:15310515,28774:15310516,28775:15310723,28776:15310726,28777:15310728,28778:15310731,28779:15310748,28780:15310765,28781:15318415,28782:15310770,28783:15182751,28784:15310774,28785:15310773,28786:15310991,28787:15310988,28788:15311032,28789:15311012,28790:15311009,28791:15311031,28792:15311037,28793:15311238,28794:15311247,28795:15311243,28796:15311275,28797:15311279,28798:15311280,28961:15311281,28962:15311284,28963:15311283,28964:15311530,28965:15311535,28966:15311537,28967:15311542,28968:15311748,28969:15311747,28970:15311750,28971:15311785,28972:15311787,28973:15312003,28974:15312009,28975:15312018,28976:15312020,28977:15312024,28978:15312033,28979:15312029,28980:15312030,28981:15312036,28982:15312032,28983:15312044,28984:15312046,28985:15312061,28986:15312062,28987:15312258,28988:15312265,28989:15312261,28990:15312272,28991:15312267,28992:15312273,28993:15312274,28994:15312268,28995:15312277,28996:15312535,28997:15312536,28998:15312549,28999:15312557,29000:15312558,29001:15312572,29002:15312799,29003:15312795,29004:15312797,29005:15312792,29006:15312785,29007:15312813,29008:15312814,29009:15312817,29010:15312818,29011:15312827,29012:15312824,29013:15313025,29014:15313039,29015:15313029,29016:15312802,29017:15313049,29018:15313067,29019:15313079,29020:15313285,29021:15313282,29022:15313280,29023:15313283,29024:15313086,29025:15313301,29026:15313293,29027:15313307,29028:15313303,29029:15313311,29030:15313314,29031:15313317,29032:15313316,29033:15313321,29034:15313323,29035:15313322,29036:15313581,29037:15313584,29038:15313596,29039:15313792,29040:15313807,29041:15313809,29042:15313811,29043:15313812,29044:15313822,29045:15313823,29046:15313826,29047:15313827,29048:15313830,29049:15313839,29050:15313835,29051:15313838,29052:15313844,29053:15313841,29054:15313847,29217:15313851,29218:15314054,29219:15314072,29220:15314074,29221:15314079,29222:15314082,29223:15314083,29224:15314085,29225:15314087,29226:15314088,29227:15314089,29228:15314090,29229:15314094,29230:15314095,29231:15314098,29232:15314308,29233:15314307,29234:15314319,29235:15314317,29236:15314318,29237:15314321,29238:15314328,29239:15314356,29240:15314579,29241:15314563,29242:15314577,29243:15314582,29244:15314583,29245:15314591,29246:15314592,29247:15314600,29248:15314612,29249:15314816,29250:15314826,29251:15314617,29252:15314822,29253:15314831,29254:15314833,29255:15314834,29256:15314851,29257:15314850,29258:15314852,29259:15314836,29260:15314849,29261:15315130,29262:15314866,29263:15314865,29264:15314864,29265:15315093,29266:15315092,29267:15315081,29268:15315091,29269:15315084,29270:15315078,29271:15315080,29272:15315090,29273:15315082,29274:15315076,29275:15315118,29276:15315099,29277:15315109,29278:15315108,29279:15315105,29280:15315120,29281:15315335,29282:15315122,29283:15315334,29284:15315134,29285:15315354,29286:15315360,29287:15315367,29288:15315382,29289:15315384,29290:15315879,29291:15315884,29292:15315888,29293:15316105,29294:15316104,29295:15315883,29296:15316099,29297:15316102,29298:15316138,29299:15316134,29300:15316655,29301:15316131,29302:15316127,29303:15316356,29304:15316117,29305:15316114,29306:15316353,29307:15316159,29308:15316158,29309:15316358,29310:15316360,29473:15316381,29474:15316382,29475:15316388,29476:15316369,29477:15316368,29478:15316377,29479:15316402,29480:15316617,29481:15316615,29482:15316651,29483:15316399,29484:15316410,29485:15316634,29486:15316644,29487:15316649,29488:15316658,29489:15316868,29490:15316865,29491:15316667,29492:15316664,29493:15316666,29494:15316870,29495:15316879,29496:15316866,29497:15316889,29498:15316883,29499:15316920,29500:15316902,29501:15316909,29502:15316911,29503:15316925,29504:15317146,29505:15317147,29506:15317150,29507:15317429,29508:15317433,29509:15317437,29510:15317633,29511:15317640,29512:15317643,29513:15317644,29514:15317650,29515:15317653,29516:15317649,29517:15317661,29518:15317669,29519:15317673,29520:15317688,29521:15317674,29522:15317677,29523:15310241,29524:15317900,29525:15317902,29526:15317903,29527:15317904,29528:15317908,29529:15317916,29530:15317918,29531:15317917,29532:15317920,29533:15317925,29534:15317928,29535:15317935,29536:15317940,29537:15317942,29538:15317943,29539:15317945,29540:15317947,29541:15317948,29542:15317949,29543:15318151,29544:15318152,29545:15178423,29546:15318165,29547:15318177,29548:15318188,29549:15318206,29550:15318410,29551:15318418,29552:15318420,29553:15318435,29554:15318431,29555:15318432,29556:15318433,29557:15318438,29558:15318439,29559:15318444,29560:15318442,29561:15318455,29562:15318450,29563:15318454,29564:15318677,29565:15318684,29566:15318688,29729:15048879,29730:15116167,29731:15303065,29732:15176100,29733:15042460,29734:15173273};THREE.MMD.Encoding=_}();

THREE.LineSegments=function(c,d){THREE.Line.call(this,c,d),this.type="LineSegments"},THREE.LineSegments.prototype=Object.assign(Object.create(THREE.Line.prototype),{constructor:THREE.LineSegments}),THREE.CameraHelper=function(c){function d(p,q,r){e(p,r),e(q,r)}function e(p,q){f.vertices.push(new THREE.Vector3),f.colors.push(new THREE.Color(q)),j[p]===void 0&&(j[p]=[]),j[p].push(f.vertices.length-1)}var f=new THREE.Geometry,g=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),j={},k=16755200,l=16711680,m=43775,o=3355443;d("n1","n2",k),d("n2","n4",k),d("n4","n3",k),d("n3","n1",k),d("f1","f2",k),d("f2","f4",k),d("f4","f3",k),d("f3","f1",k),d("n1","f1",k),d("n2","f2",k),d("n3","f3",k),d("n4","f4",k),d("p","n1",l),d("p","n2",l),d("p","n3",l),d("p","n4",l),d("u1","u2",m),d("u2","u3",m),d("u3","u1",m),d("c","t",16777215),d("p","c",o),d("cn1","cn2",o),d("cn3","cn4",o),d("cf1","cf2",o),d("cf3","cf4",o),THREE.LineSegments.call(this,f,g),this.camera=c,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=c.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=j,this.update()},THREE.CameraHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.CameraHelper.prototype.constructor=THREE.CameraHelper,THREE.CameraHelper.prototype.update=function(){function c(j,k,l,m){f.set(k,l,m).unproject(g);var n=e[j];if(n!==void 0)for(var o=0,p=n.length;o<p;o++)d.vertices[n[o]].copy(f)}var d,e,f=new THREE.Vector3,g=new THREE.Camera;return function(){d=this.geometry,e=this.pointMap;var k=1,l=1;g.projectionMatrix.copy(this.camera.projectionMatrix),c("c",0,0,-1),c("t",0,0,1),c("n1",-k,-l,-1),c("n2",k,-l,-1),c("n3",-k,l,-1),c("n4",k,l,-1),c("f1",-k,-l,1),c("f2",k,-l,1),c("f3",-k,l,1),c("f4",k,l,1),c("u1",0.7*k,1.1*l,-1),c("u2",0.7*-k,1.1*l,-1),c("u3",0,2*l,-1),c("cf1",-k,0,1),c("cf2",k,0,1),c("cf3",0,-l,1),c("cf4",0,l,1),c("cn1",-k,0,-1),c("cn2",k,0,-1),c("cn3",0,-l,-1),c("cn4",0,l,-1),d.verticesNeedUpdate=!0}}();
THREE.XLoader=function(a,d,e){this.txrPath=/\//.test(a)?a.slice(0,a.lastIndexOf("/")+1):"",this.url=a,this.onload=d,this.onerror=e,this.mode=null,this.modeArr=[],this.uvIdx=[],this.txrs={},this.nArr=[],this.uvArr=[],this.vColors=[],this.vId={},this.txrLength=0,this.meshNormalsVector=[],this.gmt=new THREE.Geometry,this.mtrs=new THREE.MeshFaceMaterial;var f=new XMLHttpRequestZIP,j=this;f.onload=function(){"arraybuffer"==f.responseType?j.parse(j.shift_jis_decoder.decode(new Uint8Array(f.response))):j.parse(f.response),j=f=null},f.onerror=function(){j.onerror&&j.onerror(a,f.statusText)},f.open("GET",a,!0),f.responseType=/\.zip/i.test(a)?"text":"arraybuffer",f.send()},THREE.XLoader.prototype={constructor:THREE.XLoader,parse:function(a){var d=this;a.replace(/^xof[\s.]+?\r\n/,"").split("\r\n").forEach(function(e){d.decision(e)}),this.uvArr.length&&this.uvIdx.forEach(function(e){d.gmt.faceVertexUvs[0].push([d.uvArr[e[0]],d.uvArr[e[1]],d.uvArr[e[2]],d.uvArr[e[3]]])}),this.vColors.length&&this.gmt.faces.forEach(function(e){e.vertexColors=[d.vColors[e.a],d.vColors[e.b],d.vColors[e.c]],isFinite(e.d)&&(e.vertexColors[3]=d.vColors[e.d])}),this.gmt.computeCentroids(),this.gmt.computeFaceNormals(),this.gmt.computeVertexNormals(),self.MMD_SA&&(this.gmt.computeBoundingBox(),this.gmt.boundingSphere=this.gmt.boundingBox.getBoundingSphere(),console.log(toLocalPath(this.txrPath)+"\n"+JSON.stringify(this.gmt.boundingBox))),this.txrLength||this.onload(new THREE.Mesh(this.gmt,this.mtrs)),this.mode=this.modeArr=this.uvIdx=this.txrs=this.nArr=this.uvArr=this.vColors=this.meshNormalsVector=this.vId=null},decision:function(a){return!a||/^\s+$/.test(a)?void 0:/{.+?}/.test(a)?void(/^\s*TextureFilename/.test(a)&&this.TextureFilename(a.match(/{\s*(.+)?\s*}/)[1])):/{/.test(a)?(this.modeArr.push(this.mode),this.mode=a.match(/^\s*([a-zA-Z]+)/)[1],this.nArr.push(this.n),void(this.n=0)):/}/.test(a)?(this.mode=this.modeArr.pop(),void(this.n=this.nArr.pop())):void(this.mode&&!/^(Header|template)$/.test(this.mode)&&(this.n++,this[this.mode]&&this[this.mode](a)))},toRgb:function(a,d,e){return"rgb("+Math.floor(100*a)+"%,"+Math.floor(100*d)+"%,"+Math.floor(100*e)+"%)"},Mesh:function(a){if(a=a.split(";"),2!==a.length||""!==a[1])if(3===a.length||""===a[2]||2===a.length&&/,/.test(a[1])){var d=a[1].split(",");/3/.test(a[0])?(this.gmt.faces.push(new THREE.Face3(+d[2],+d[1],+d[0])),this.uvIdx.push([+d[2],+d[1],+d[0]])):(this.gmt.faces.push(new THREE.Face4(+d[3],+d[2],+d[1],+d[0])),this.uvIdx.push([+d[3],+d[2],+d[1],+d[0]]))}else{var e=a.join(";"),f=this.vId[e]=this.vId[e]||new THREE.Vector3(+a[0],+a[1],-a[2]);this.gmt.vertices.push(f)}},MeshNormals:function(a){if(a=a.split(";"),2!==a.length)if(3===a.length||""===a[2]){this.faceN||(this.faceN=this.n);var d=a[1].split(",");this.gmt.faces[this.n-this.faceN].normal=/3/.test(a[0])?this.meshNormalsVector[+d[0]]:this.meshNormalsVector[+d[0]]}else this.meshNormalsVector.push(new THREE.Vector3(+a[0],+a[1],-a[2]))},MeshMaterialList:function(a){3>this.n||(this.gmt.faces[this.n-3].materialIndex=+a.match(/[0-9]+/)[0])},Material:function(a){if(a=a.split(";"),1===this.n){this.mtr=new THREE.MeshPhongMaterial({ambient:"#444",color:this.toRgb(a[0],a[1],a[2]),opacity:+a[3]});var d=this.material_para[this.mtrs.materials.length]||this.material_para._default_||{};2==d.side&&(this.mtr.side=THREE.DoubleSide),!1===d.transparent&&(this.mtr.transparent=!1),null!=d.opacity&&(this.mtr.opacity=d.opacity),null!=d.alphaTest&&(this.mtr.alphaTest=d.alphaTest),this.transparency_check(d),this.mtr.base_color=[a[0],a[1],a[2]].join(","),this.mtr.color.setStyle("#FFF"),this.mtr.ambient.setStyle(d.ambient||"#FFF"),this.mtrs.materials.push(this.mtr)}else 2===this.n?this.mtr.shininess=+a[0]||5:3===this.n?this.mtr.specular.setStyle(this.toRgb(a[0],a[1],a[2])):4===this.n&&this.mtr.emissive.setStyle(this.toRgb(a[0],a[1],a[2]))},transparency_check:function(){var a=0,d=0;return window.addEventListener("MMDStarted",function(){a&&console.log("X object opaque/total material count:"+d+"/"+a)}),function(e,f){return f?void(!1===e.transparent||1==this.mtr.opacity&&/\.jpg$/i.test(f)&&!/\.jpga\.jpg$/i.test(f)?this.mtr.transparent=!1:(this.mtr.transparent=!0,d--)):(a++,1==this.mtr.opacity&&(this.mtr.transparent=!1),void(this.mtr.transparent||d++))}}(),shift_jis_decoder:new TextDecoder("shift-jis"),TextureFilename:function(a){a=a.split("\"")[1].split(/\\+/).join("/").split("*")[0];var d=this.material_para[this.mtrs.materials.length-1]||this.material_para._default_||{},e=toFileProtocol(d.txrPath||this.txrPath);if(a=d.row||a,this.mtr.base_color&&(this.mtr.color.setArray(this.mtr.base_color.split(",").map(function(p){return 255*parseFloat(p)})),this.mtr.base_color=null,this.mtr.ambient.setStyle(d.ambient||"#444")),this.txrs[a])return this.mtr.map=this.txrs[a],void this.transparency_check(d,a);if(self.MMD_SA&&!FSO_OBJ.FileExists(toLocalPath(e+a)))return void console.error("Texture file not found ("+toLocalPath(e+a)+")");var f=this;if(this.txrLength++,self.MMD_SA&&MMD_SA_options.child_animation_as_texture&&MMD_SA_options.child_animation_as_texture_swap_list){var j=0;if(MMD_SA_options.child_animation_as_texture_swap_list.forEach(function(p,q){-1==a.indexOf(p)||(f.mtr.map=f.txrs[a]=jThree("#ChildAnimation"+q+"TXR").three(0),j++)}),j)return void(0==--f.txrLength&&f.onload(new THREE.Mesh(f.gmt,f.mtrs)))}if(self.MMD_SA){var k=/\.zip\#/i.test(toLocalPath(e)),l=a.replace(/\.(png|jpg|bmp|jpeg|tga)$/i,"_normal."+(d.use_normal_jpg?"jpg":"png"));if(d.use_normal||(browser_native_mode||k?d.use_normal:FSO_OBJ.FileExists(toLocalPath(e+l)))){if(this.txrs[l])return void(this.mtr.normalMap=this.txrs[l]);this.txrLength++,this.mtr.normalMap=this.txrs[l]=THREE.ImageUtils.loadTexture(e+l,void 0,function(){--f.txrLength||(f.onload(new THREE.Mesh(f.gmt,f.mtrs)),f=null)},function(){--f.txrLength||(f.onerror(new THREE.Mesh(f.gmt,f.mtrs)),f=null)}),this.mtr.normalMap.wrapS=this.mtr.normalMap.wrapT=THREE.RepeatWrapping,console.log("Normal map",l)}var n=a.replace(/\.(png|jpg|bmp|jpeg|tga)$/i,"_specular."+(d.use_specular_jpg?"jpg":"png"));if(d.use_specular||(browser_native_mode||k?d.use_specular:FSO_OBJ.FileExists(toLocalPath(e+n)))){if(this.txrs[n])return void(this.mtr.specularMap=this.txrs[n]);this.txrLength++,this.mtr.specularMap=this.txrs[n]=THREE.ImageUtils.loadTexture(e+n,void 0,function(p){var q=a.replace(/\.(png|jpg|bmp|jpeg|tga)$/i,"_metalness."+(d.use_metalness_jpg?"jpg":"png"));if(d.use_metalness||(browser_native_mode||k?d.use_metalness:FSO_OBJ.FileExists(toLocalPath(e+q))))return void THREE.ImageUtils.loadTexture(e+q,void 0,function(x){let y=document.createElement("canvas"),z=y.width=p.image.width,A=y.height=p.image.height,B=y.getContext("2d");B.drawImage(p.image,0,0);let C=B.getImageData(0,0,z,A),D=C.data;B.drawImage(x.image,0,0,x.image.width,x.image.height,0,0,z,A);let E=B.getImageData(0,0,z,A).data;for(var F=0,G=D.length;F<G;F+=4)D[F+1]=E[F+1];B.putImageData(C,0,0),x.image=y,C=D=E=void 0,console.log("Metal map merged with specular map",q),--f.txrLength||(f.onload(new THREE.Mesh(f.gmt,f.mtrs)),f=null)});if(!d.use_specular_as_metalness){let x=document.createElement("canvas"),y=x.width=p.image.width,z=x.height=p.image.height,A=x.getContext("2d");A.drawImage(p.image,0,0);let B=A.getImageData(0,0,y,z),C=B.data;for(var t=0,u=C.length;t<u;t+=4)C[t+1]=C[t+2]=0;A.putImageData(B,0,0),p.image=x,B=C=void 0}--f.txrLength||(f.onload(new THREE.Mesh(f.gmt,f.mtrs)),f=null)},function(){--f.txrLength||(f.onerror(new THREE.Mesh(f.gmt,f.mtrs)),f=null)}),this.mtr.specular.setStyle("rgb(100%,100%,100%)"),this.mtr.specularMap.wrapS=this.mtr.specularMap.wrapT=THREE.RepeatWrapping,console.log("Specular map",n)}}this.mtr.map=this.txrs[a]=THREE.ImageUtils.loadTexture(e+a,void 0,function(){--f.txrLength||(f.onload(new THREE.Mesh(f.gmt,f.mtrs)),f=null)},function(){--f.txrLength||(f.onerror(new THREE.Mesh(f.gmt,f.mtrs)),f=null)}),this.mtr.map.wrapS=this.mtr.map.wrapT=THREE.RepeatWrapping,this.transparency_check(d,a)},MeshTextureCoords:function(a){if(1!==this.n){a=a.split(";");var d;a[1]=1-a[1],d=+a[0],a[0]=d,d=a[1],a[1]=d,this.uvArr.push(new THREE.Vector2(a[0],a[1]))}},MeshVertexColors:function(a){},_material_para:null,get material_para(){if(this._material_para)return this._material_para;if(this._material_para={},self.MMD_SA){var a=toLocalPath(this.url).replace(/^.+[\/\\]/,""),d=a.replace(/[\-\_]copy\d+\.x$/,".x").replace(/[\-\_]v\d+\.x$/,".x"),e=MMD_SA_options.model_para[a]||MMD_SA_options.model_para[d];this._material_para=e&&e.material_para||this._material_para}return this._material_para}},jThree.modelHooks.x=function(a,d,e){new THREE.XLoader(a,function(f){if(d){var j=toLocalPath(a).replace(/^.+[\/\\]/,""),k=j.replace(/[\-\_]copy\d+\.x$/,".x").replace(/[\-\_]v\d+\.x$/,".x"),l=MMD_SA_options.model_para[j]||MMD_SA_options.model_para[k];l&&l.instanced_drawing&&(f.instanced_drawing=l.instanced_drawing),d(f),d=e=null}},function(){e(),d=e=null})};
THREE.ShadowMapPlugin=function(){function a(x){t!==x&&(x===THREE.CullFaceNone?f.disable(f.CULL_FACE):(f.enable(f.CULL_FACE),x===THREE.CullFaceBack?f.cullFace(f.BACK):x===THREE.CullFaceFront?f.cullFace(f.FRONT):x===THREE.CullFaceFrontBack?f.cullFace(f.FRONT_AND_BACK):void 0),t=x)}function b(x,y){var z=new THREE.DirectionalLight;z.isVirtual=!0,z.onlyShadow=!0,z.castShadow=!0,z.shadowCameraNear=x.shadowCameraNear,z.shadowCameraFar=x.shadowCameraFar,z.shadowCameraLeft=x.shadowCameraLeft,z.shadowCameraRight=x.shadowCameraRight,z.shadowCameraBottom=x.shadowCameraBottom,z.shadowCameraTop=x.shadowCameraTop,z.shadowCameraVisible=x.shadowCameraVisible,z.shadowDarkness=x.shadowDarkness,z.shadowBias=x.shadowCascadeBias[y],z.shadowMapWidth=x.shadowCascadeWidth[y],z.shadowMapHeight=x.shadowCascadeHeight[y],z.shadowBias_range=x.shadowBias_range,z.pointsWorld=[],z.pointsFrustum=[];for(var A=z.pointsWorld,B=z.pointsFrustum,C=0;8>C;C++)A[C]=new THREE.Vector3,B[C]=new THREE.Vector3;var D=x.shadowCascadeNearZ[y],E=x.shadowCascadeFarZ[y];return B[0].set(-1,-1,D),B[1].set(1,-1,D),B[2].set(-1,1,D),B[3].set(1,1,D),B[4].set(-1,-1,E),B[5].set(1,-1,E),B[6].set(-1,1,E),B[7].set(1,1,E),z}function c(x,y){var z=x.shadowCascadeArray[y];z.position.copy(x.position),z.target.position.copy(x.target.position),z.lookAt(z.target.position),z.shadowCameraVisible=x.shadowCameraVisible,z.shadowDarkness=x.shadowDarkness,z.shadowBias=x.shadowCascadeBias[y];var A=x.shadowCascadeNearZ[y],B=x.shadowCascadeFarZ[y],C=z.pointsFrustum;C[0].z=A,C[1].z=A,C[2].z=A,C[3].z=A,C[4].z=B,C[5].z=B,C[6].z=B,C[7].z=B}function d(x,y){var z=y.shadowCamera,A=y.pointsFrustum,B=y.pointsWorld;u.set(Infinity,Infinity,Infinity),v.set(-Infinity,-Infinity,-Infinity);for(var D,C=0;8>C;C++)D=B[C],D.copy(A[C]),D.unproject(x),D.applyMatrix4(z.matrixWorldInverse),D.x<u.x&&(u.x=D.x),D.x>v.x&&(v.x=D.x),D.y<u.y&&(u.y=D.y),D.y>v.y&&(v.y=D.y),D.z<u.z&&(u.z=D.z),D.z>v.z&&(v.z=D.z);z.left=u.x,z.right=v.x,z.top=v.y,z.bottom=u.y,z.updateProjectionMatrix()}function e(x){var y;return y=x.object.material,y instanceof THREE.MeshFaceMaterial&&(y=y.materials[x.buffer.materialIndex]),y}var f,g,h,l,o,q,t,r=new THREE.Frustum,s=new THREE.Matrix4,u=new THREE.Vector3,v=new THREE.Vector3,w=new THREE.Vector3;this.init=function(x){f=x.context,g=x;var y=THREE.ShaderLib.depthRGBA,z=THREE.UniformsUtils.clone(y.uniforms);h=new THREE.ShaderMaterial({fragmentShader:y.fragmentShader,vertexShader:y.vertexShader,uniforms:z}),l=new THREE.ShaderMaterial({fragmentShader:y.fragmentShader,vertexShader:y.vertexShader,uniforms:z,morphTargets:!0}),o=new THREE.ShaderMaterial({fragmentShader:y.fragmentShader,vertexShader:y.vertexShader,uniforms:z,skinning:!0}),q=new THREE.ShaderMaterial({fragmentShader:y.fragmentShader,vertexShader:y.vertexShader,uniforms:z,morphTargets:!0,skinning:!0}),this._switch_material=function(){var A={},B;return function(C,D){B=null==C._model_index_default?-1:C._model_index_default;var E=A[B];return E||(E=A[B]={_depthMaterialMorphSkin:q.clone(),_depthMaterialSkin:o.clone()}),D?E._depthMaterialMorphSkin:E._depthMaterialSkin}}(),h._shadowPass=!0,l._shadowPass=!0,o._shadowPass=!0,q._shadowPass=!0},this.render=function(x,y){g.shadowMapEnabled&&g.shadowMapAutoUpdate&&this.update(x,y)},this.update=function(x,y){var z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=[],O=0,P=null;f.clearColor(1,1,1,1),f.disable(f.BLEND),f.frontFace(f.CCW),a(g.shadowMapCullFace),g.setDepthTest(!0);var Q=-1;for(z=0,A=x.__lights.length;z<A;z++)if(L=x.__lights[z],L.isVirtual||(L instanceof THREE.DirectionalLight?(Q++,!L._shadowPara&&(L._shadowPara=new THREE.Vector3(0,Q,0))):!L._shadowPara&&(L._shadowPara=new THREE.Vector3(1,0,0))),!!L.castShadow)if(L instanceof THREE.DirectionalLight&&L.shadowCascade)for(D=0;D<L.shadowCascadeCount;D++){var R;L.shadowCascadeArray[D]?R=L.shadowCascadeArray[D]:(R=b(L,D),R.originalCamera=y,R._shadowPara=L._shadowPara.clone(),x.add(R),L.shadowCascadeArray[D]=R,console.log("Created virtualLight",R)),c(L,D),N[O]=R,O++}else{if(L.isVirtual)continue;N[O]=L,O++}var S={},T=[],U=[];for(let aa=0,ba=N.length;aa<ba;aa++)T[aa]=0,U[aa]=0;for(z=0,A=N.length;z<A;z++){if(L=N[z],!L.shadowMap){var V=THREE.LinearFilter;g.shadowMapType===THREE.PCFSoftShadowMap&&(V=THREE.NearestFilter);var W={minFilter:V,magFilter:V,format:THREE.RGBAFormat};L.shadowMap=new THREE.WebGLRenderTarget(L.shadowMapWidth,L.shadowMapHeight,W),L.shadowMapSize=new THREE.Vector2(L.shadowMapWidth,L.shadowMapHeight),L.shadowMatrix=new THREE.Matrix4}if(!L.shadowCamera){if(L instanceof THREE.SpotLight)L.shadowCamera=new THREE.PerspectiveCamera(L.shadowCameraFov,L.shadowMapWidth/L.shadowMapHeight,L.shadowCameraNear,L.shadowCameraFar);else if(L instanceof THREE.DirectionalLight)L.shadowCamera=new THREE.OrthographicCamera(L.shadowCameraLeft,L.shadowCameraRight,L.shadowCameraTop,L.shadowCameraBottom,L.shadowCameraNear,L.shadowCameraFar);else{console.error("Unsupported light type for shadow");continue}x.add(L.shadowCamera),!0===x.autoUpdate&&x.updateMatrixWorld()}for(L.shadowCameraVisible&&!L.cameraHelper&&(L.cameraHelper=new THREE.CameraHelper(L.shadowCamera),L.shadowCamera.add(L.cameraHelper)),L.isVirtual&&R.originalCamera==y&&d(y,L),E=L.shadowMap,F=L.shadowMatrix,G=L.shadowCamera,G.position.copy(L.position),G.lookAt(L.target.position),G.updateMatrixWorld(),G.matrixWorldInverse.getInverse(G.matrixWorld),L._shadowBias_range||(!L.shadowBias_range&&(L.shadowBias_range=[0.1,100]),L._shadowBias_range=new THREE.Vector3(0,L.shadowBias_range[0],L.shadowBias_range[1])),L._shadowBias_range.x=L.shadowBias,L.cameraHelper&&(L.cameraHelper.visible=L.shadowCameraVisible),L.shadowCameraVisible&&L.cameraHelper.update(),F.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1),F.multiply(G.projectionMatrix),F.multiply(G.matrixWorldInverse),s.multiplyMatrices(G.projectionMatrix,G.matrixWorldInverse),r.setFromMatrix(s),g.setRenderTarget(E),g.clear(),M=x.__webglObjects,(B=0,C=M.length);B<C;B++)if(J=M[B],X=e(J),K=J.object,J.render=!1,K.visible&&K.castShadow&&(void 0===X.castShadow||X.castShadow)&&(!(K instanceof THREE.Mesh||K instanceof THREE.ParticleSystem)||!K.frustumCulled||r.intersectsOrContainsObject(K))){if(T[z]++,S[B]){U[z]++;continue}r._containing&&(S[B]=!0),K._modelViewMatrix.multiplyMatrices(G.matrixWorldInverse,K.matrixWorld),J.render=!0}var X,Y,Z;for(B=0,C=M.length;B<C;B++)J=M[B],J.render&&(K=J.object,H=J.buffer,X=e(J),void 0===X.shadowMapCullFace?a(g.shadowMapCullFace):a(X.shadowMapCullFace),Y=0<K.geometry.morphTargets.length&&X.morphTargets,Z=K instanceof THREE.SkinnedMesh&&X.skinning,I=K.customDepthMaterial?K.customDepthMaterial:Z?this._switch_material(K,Y):Y?l:h,H instanceof THREE.BufferGeometry?g.renderBufferDirect(G,x.__lights,P,I,H,K):g.renderBuffer(G,x.__lights,P,I,H,K));for(a(g.shadowMapCullFace),M=x.__webglObjectsImmediate,(B=0,C=M.length);B<C;B++)J=M[B],K=J.object,K.visible&&K.castShadow&&(K._modelViewMatrix.multiplyMatrices(G.matrixWorldInverse,K.matrixWorld),g.renderImmediateObject(G,x.__lights,P,h,K))}var $=g.getClearColor(),_=g.getClearAlpha();f.clearColor($.r,$.g,$.b,_),f.enable(f.BLEND),a(THREE.CullFaceBack)}};
THREE.ShaderLib.mirror={uniforms:{mirrorSampler:{type:"t",value:null},mirrorPosition:{type:"v3",value:new THREE.Vector3(0,0,0)},reflection_state:{type:"i",value:0},reflection_alpha:{type:"f",value:1},fade_radius:{type:"f",value:15},fade_min:{type:"f",value:1},fade_max:{type:"f",value:1},depth_render_mode:{type:"i",value:0},baseTexture:{type:"t",value:null},baseSpeed:{type:"f",value:0},noiseTexture:{type:"t",value:null},noiseScale:{type:"f",value:0},bumpScale:{type:"f",value:5},vUv_scale:{type:"v2",value:new THREE.Vector2(1,1)},time:{type:"f",value:0},nIntensity:{type:"f",value:0},sIntensity:{type:"f",value:0.5},sCount:{type:"f",value:512},textureMatrix:{type:"m4",value:new THREE.Matrix4}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 mirrorCoord;","varying vec3 vWorldPosition;","varying vec2 vUv;","uniform sampler2D noiseTexture;","uniform float time;","uniform float baseSpeed;","uniform float bumpScale;","void main() {","vUv = uv;","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","mirrorCoord = textureMatrix * worldPosition;","vec3 bumpedPosition = position;","vec4 mvPosition;","if (baseSpeed > 0.0) {","  vec2 uvTimeShift = vUv + vec2( 1.1, 1.9 ) * time * 0.15;","  vec4 bumpData = texture2D( noiseTexture, uvTimeShift );","  float displacement = (bumpData.g - 0.25) * bumpScale;","  bumpedPosition = bumpedPosition + normal * displacement;","}","mvPosition = modelViewMatrix * vec4( bumpedPosition, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D mirrorSampler;","varying vec4 mirrorCoord;","varying vec3 vWorldPosition;","uniform vec3 mirrorPosition;","uniform int reflection_state;","uniform float reflection_alpha;","uniform float fade_radius;","uniform float fade_min;","uniform float fade_max;","uniform vec2 vUv_scale;","varying vec2 vUv;","uniform sampler2D baseTexture;","uniform float baseSpeed;","uniform sampler2D noiseTexture;","uniform float noiseScale;","uniform float time;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","vec4 FilmShader(vec4 cTextureScreen, vec2 vUv) {","float x = vUv.x * vUv.y * time *  1000.0;","x = mod( x, 13.0 ) * mod( x, 123.0 );","float dx = mod( x, 0.01 );","vec3 cResult = cTextureScreen.rgb * clamp( 0.1 + dx * 100.0, 0.0, 1.0 );","vec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","cResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","cResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","return vec4( cResult, cTextureScreen.a );","}",THREE.ShaderChunk.AT_depth_render_mode_pars_fragment,"void main() {",THREE.ShaderChunk.AT_depth_render_mode_fragment,"vec4 color;","if (reflection_state == 0) {","  color = texture2DProj(mirrorSampler, mirrorCoord);","} else if (reflection_state == 1) {","  color = texture2D( mirrorSampler, vUv * vUv_scale + (1.0-vUv_scale)/2.0);","} else {","  color = vec4(0,0,0,0);","}","vec4 baseColor;","if (baseSpeed > 0.0) {","  vec2 uvTimeShift = vUv + vec2( -0.7, 1.5 ) * time * baseSpeed;","  vec4 noiseGeneratorTimeShift = texture2D( noiseTexture, uvTimeShift );","  vec2 uvNoiseTimeShift = vUv + noiseScale * vec2( noiseGeneratorTimeShift.r, noiseGeneratorTimeShift.b );","  baseColor = texture2D( baseTexture, uvNoiseTimeShift );","}","else {","  baseColor = texture2D( baseTexture, vUv );","}","color = vec4(mix(color.rgb, baseColor.rgb, baseColor.a * (1.0 - color.a*reflection_alpha)), baseColor.a + ((1.0-baseColor.a) * color.a*reflection_alpha));","if (nIntensity > 0.0) {","  color = FilmShader(color, vUv);","}","if ((fade_max < 1.0) || (fade_min < 1.0)) {","  if (fade_max != fade_min) {","    float fade_distance = distance(vWorldPosition, mirrorPosition);","    float fade_ratio = pow(fade_distance/fade_radius, 2.0);","    color.a *= mix(fade_max, fade_min, fade_ratio);","  } else {","    color.a *= fade_max;","  }","}","gl_FragColor = color;","}"].join("\n")},THREE.FlatMirror=function(a,b,d){function f(){self.MMD_SA&&MMD_SA.use_webgl2&&!is_mobile&&(this.texture._use_multisample=4),[this.texture,this.tempTexture].forEach(function(y){y.generateMipmaps=!1,y.minFilter=y.magFilter}),this.updateTextureMatrix(),this.render()}THREE.Object3D.call(this),this.name="flatMirror_"+this.id,d=d||{},this.matrixNeedsUpdate=!0;var g=void 0===d.textureWidth?512:d.textureWidth,h=void 0===d.textureHeight?512:d.textureHeight;this.clipBias=void 0===d.clipBias?0:d.clipBias,this.renderer=a,this.mirrorPlane=new THREE.Plane,this.normal=new THREE.Vector3(0,0,1),this.mirrorWorldPosition=new THREE.Vector3,this.cameraWorldPosition=new THREE.Vector3,this.rotationMatrix=new THREE.Matrix4,this.lookAtPosition=new THREE.Vector3(0,0,-1),this.clipPlane=new THREE.Vector4;var i=void 0!==d.debugMode&&d.debugMode;if(i){var j=new THREE.ArrowHelper(new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,0),10,16777088),k=new THREE.Geometry;k.vertices.push(new THREE.Vector3(-10,-10,0)),k.vertices.push(new THREE.Vector3(10,-10,0)),k.vertices.push(new THREE.Vector3(10,10,0)),k.vertices.push(new THREE.Vector3(-10,10,0)),k.vertices.push(k.vertices[0]);var l=new THREE.Line(k,new THREE.LineBasicMaterial({color:16777088}));this.add(j),this.add(l)}b instanceof THREE.PerspectiveCamera?this.camera=b:(this.camera=new THREE.PerspectiveCamera,console.log(this.name+": camera is not a Perspective Camera!")),this.textureMatrix=new THREE.Matrix4,this.mirrorCamera=this.camera.clone();var m={stencilBuffer:!1};this.texture=new THREE.WebGLRenderTarget(g,h,m),this.tempTexture=new THREE.WebGLRenderTarget(g,h,m);var n=THREE.ShaderLib.mirror,o=THREE.UniformsUtils.clone(n.uniforms);if(this.material=new THREE.ShaderMaterial({fragmentShader:n.fragmentShader,vertexShader:n.vertexShader,uniforms:o}),this.material.uniforms.mirrorSampler.value=this.texture,this.material.uniforms.textureMatrix.value=this.textureMatrix,self.MMD_SA){this.mirrorCamera.matrixAutoUpdate=!0,this.mirror_index=d.mirror_index,this.clip_y=d.clip_y;var p=MMD_SA.mirror_obj[this.mirror_index],r=this.material.uniforms;if(p.reflection_state||(this.mirrorCamera.fov*=1.75),r.baseTexture.value=/^\#/.test(p.baseTexture)?jThree(p.baseTexture).three(0):THREE.ImageUtils.loadTexture(toFileProtocol(p.baseTexture)),r.reflection_state.value=p.reflection_state||0,null!=p.reflection_alpha&&(r.reflection_alpha.value=p.reflection_alpha),null!=p.fade_radius&&(r.fade_radius.value=p.fade_radius),null!=p.fade_min&&(r.fade_min.value=p.fade_min),null!=p.fade_max&&(r.fade_max.value=p.fade_max),this.time_ref=performance.now(),r.time.value=p.time||0,null!=p.baseSpeed){r.baseSpeed.value=p.baseSpeed||0.5;var s=new THREE.ImageUtils.loadTexture(toFileProtocol(p.noiseTexture));s.wrapS=s.wrapT=THREE.RepeatWrapping,r.noiseTexture.value=s,r.noiseScale.value=p.noiseScale||0.5337,p.bumpScale||(p.bumpScale=5),r.bumpScale.value=p.bumpScale}null!=p.nIntensity&&(r.nIntensity.value=p.nIntensity,null!=p.sIntensity&&(r.sIntensity.value=p.sIntensity),null!=p.sCount&&(r.sCount.value=p.sCount))}var t=this;self.MMD_SA&&!MMD_SA.WebGL_initialized?window.addEventListener("WebGL_initialized",()=>{f.call(t,g,h)}):f.call(t,g,h)},THREE.FlatMirror.prototype=Object.create(THREE.Object3D.prototype),THREE.FlatMirror.prototype.renderWithMirror=function(a){this.updateTextureMatrix(),this.matrixNeedsUpdate=!1;var b=a.camera;a.camera=this.mirrorCamera,a.renderTemp(),a.material.uniforms.mirrorSampler.value=a.tempTexture,this.render(),this.matrixNeedsUpdate=!0,a.material.uniforms.mirrorSampler.value=a.texture,a.camera=b,a.updateTextureMatrix()},THREE.FlatMirror.prototype.updateTextureMatrix=function(){var a=new THREE.Vector4,b,d=new THREE.Vector3;return function(){function e(s){return s?0>s?-1:1:0}this.updateMatrixWorld(),this.camera.updateMatrixWorld(),this.mirrorWorldPosition.getPositionFromMatrix(this.matrixWorld),this.cameraWorldPosition.getPositionFromMatrix(this.camera.matrixWorld),this.rotationMatrix.extractRotation(this.matrixWorld),this.normal.set(0,0,1),this.normal.applyMatrix4(this.rotationMatrix);var f=self.MMD_SA&&jThree(this._mesh_id).three(0);if(!f||1!=f.material.uniforms.reflection_state.value){var g=this.mirrorWorldPosition.clone().sub(this.cameraWorldPosition),h=g.reflect(this.normal);h.add(this.mirrorWorldPosition),this.rotationMatrix.extractRotation(this.camera.matrixWorld),this.lookAtPosition.set(0,0,-1),this.lookAtPosition.applyMatrix4(this.rotationMatrix),this.lookAtPosition.add(this.cameraWorldPosition);var i=this.mirrorWorldPosition.clone().sub(this.lookAtPosition),j=i.reflect(this.normal);j.add(this.mirrorWorldPosition),this.up.set(0,-1,0),this.up.applyMatrix4(this.rotationMatrix);var k=this.up.reflect(this.normal);this.mirrorCamera.position.copy(h),this.mirrorCamera.up=k,this.mirrorCamera.lookAt(j)}if(this.mirrorCamera.updateProjectionMatrix(),this.mirrorCamera.updateMatrixWorld(),this.mirrorCamera.matrixWorldInverse.getInverse(this.mirrorCamera.matrixWorld),this.textureMatrix.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1),this.textureMatrix.multiply(this.mirrorCamera.projectionMatrix),this.textureMatrix.multiply(this.mirrorCamera.matrixWorldInverse),f){var l=MMD_SA.mirror_obj[this.mirror_index];null!=l.renderDepth&&(f.renderDepth=l.renderDepth,l.renderDepth=null);var m=f.material.uniforms;if(m.textureMatrix.value=this.textureMatrix,m.mirrorPosition.value=this.mirrorWorldPosition,!this._baseTexture_loaded){var n=m.baseTexture.value;n&&n.image&&(n.image.complete&&n.image.src||n.image._canvas_ready)&&(n.image._canvas_ready?n.needsUpdate=jThree(l.baseTexture).three(0).needsUpdate:(this._baseTexture_loaded=!0,n.needsUpdate=!0))}if(!this._noiseTexture_loaded){var n=m.noiseTexture.value;n&&n.image&&n.image.complete&&n.image.src&&(this._noiseTexture_loaded=!0,n.needsUpdate=!0)}if(!l.vUv_scale)if(l.plane){var o=Math.max(l.plane[0],l.plane[1]);l.vUv_scale=new THREE.Vector2(l.plane[0]/o,l.plane[1]/o)}else l.vUv_scale=new THREE.Vector2(1,1);m.vUv_scale.value=l.vUv_scale;var p=performance.now();m.time.value+=(p-this.time_ref)/1e3,this.time_ref=p}if(f&&1!=f.material.uniforms.reflection_state.value){d.copy(this.mirrorWorldPosition),null!=this.clip_y&&(d.y=this.clip_y),this.mirrorPlane.setFromNormalAndCoplanarPoint(this.normal,d),this.mirrorPlane.applyMatrix4(this.mirrorCamera.matrixWorldInverse),this.clipPlane.set(this.mirrorPlane.normal.x,this.mirrorPlane.normal.y,this.mirrorPlane.normal.z,this.mirrorPlane.constant);var r=this.mirrorCamera.projectionMatrix;a.x=(e(this.clipPlane.x)+r.elements[8])/r.elements[0],a.y=(e(this.clipPlane.y)+r.elements[9])/r.elements[5],a.z=-1,a.w=(1+r.elements[10])/r.elements[14],b=this.clipPlane.multiplyScalar(2/this.clipPlane.dot(a)),r.elements[2]=b.x,r.elements[6]=b.y,r.elements[10]=b.z+1-this.clipBias,r.elements[14]=b.w}}}(),THREE.FlatMirror.prototype.render=function(a){var b=self.MMD_SA&&jThree(this._mesh_id).three(0);if(!b||b.visible){this.matrixNeedsUpdate&&this.updateTextureMatrix(),this.matrixNeedsUpdate=!0;for(var d=this;void 0!==d.parent;)d=d.parent;if(b&&b.visible){var e,f,g,h,i={};if(e=b.material.uniforms.reflection_state,f=e.value,e.value=-1,self.MMD_SA&&(g=MMD_SA.mirror_obj[this.mirror_index],h=g.skip_reflection_list,!h&&(h=[this._mesh_id]),h.forEach(function(l){var m=/^\#(.+)$/.test(l)?MMD_SA_options.mesh_obj_by_id[RegExp.$1]:MMD_SA_options.x_object_by_name[l];m&&m.visible&&(i[l]=!0,m.hide())})),void 0!==d&&d instanceof THREE.Scene&&this.renderer.render(d,this.mirrorCamera,a||this.texture,!0),e.value=f,self.MMD_SA)for(var j in i){var k=/^\#(.+)$/.test(j)?MMD_SA_options.mesh_obj_by_id[RegExp.$1]:MMD_SA_options.x_object_by_name[j];k&&k.show()}}}},THREE.FlatMirror.prototype.renderTemp=function(){this.render(this.tempTexture)},THREE.MirrorMaterial=function(a){var b=jThree(a.camera).three(0),d=new THREE.FlatMirror(null,b,a);return MMD_SA._THREE_mirror.push(d),d.material._mirror=d,d._mesh_id=a.mesh,d._renderer_id=a.renderer,d.material},THREE.Math.isPowerOfTwo=function(a){return 0==(a&a-1)},THREE.Vector3.prototype.setFromMatrixPosition=THREE.Vector3.prototype.getPositionFromMatrix,THREE.PerspectiveCamera.prototype.clone=function(){var a=new THREE.PerspectiveCamera;return THREE.Camera.prototype.clone.call(this,a),a.zoom=this.zoom,a.fov=this.fov,a.aspect=this.aspect,a.near=this.near,a.far=this.far,a.projectionMatrix.copy(this.projectionMatrix),a};
THREE.TrackballControls=function(a,b){function c(F){m.enabled&&(F.preventDefault(),F.stopPropagation(),o===n.NONE&&(o=F.button),o!==n.ROTATE||m.noRotate?o!==n.ZOOM||m.noZoom?o===n.PAN&&!m.noPan&&(x=m.getMouseOnScreen(F.pageX,F.pageY,x),y.copy(x)):(t=m.getMouseOnScreen(F.pageX,F.pageY,t),u.copy(t)):(q=m.getMouseProjectionOnBall(F.pageX,F.pageY,q),r.copy(q),m.rotate_with_up_fixed&&A.copy(m.getMouseOnScreen_fixed_up(F.pageX,F.pageY,z))),document.addEventListener("mousemove",f,!1),document.addEventListener("mouseup",g,!1))}function f(F){m.enabled&&(F.preventDefault(),F.stopPropagation(),o!==n.ROTATE||m.noRotate?o!==n.ZOOM||m.noZoom?o===n.PAN&&!m.noPan&&(y=m.getMouseOnScreen(F.pageX,F.pageY,y)):u=m.getMouseOnScreen(F.pageX,F.pageY,u):(r=m.getMouseProjectionOnBall(F.pageX,F.pageY,r),m.rotate_with_up_fixed&&m.getMouseOnScreen_fixed_up(F.pageX,F.pageY,A)))}function g(F){m.enabled&&(F.preventDefault(),F.stopPropagation(),o=n.NONE,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g))}function h(F){if(m.enabled){F.preventDefault(),F.stopPropagation();var G=0;F.deltaY?G=F.deltaY/(0==F.deltaMode?40:1):F.wheelDelta?G=F.wheelDelta/40:F.detail&&(G=-F.detail/3),t.y+=0.01*G}}function j(F){if(!1!==m.enabled){for(var G=[],H=0;H<F.touches.length;H++)"Ljoystick"!=F.touches[H].target.id&&G.push(F.touches[H]);switch(G.length!=F.touches.length&&(F={touches:G}),F.touches.length){case 1:o=n.TOUCH_ROTATE,r.copy(m.getMouseProjectionOnBall(F.touches[0].pageX,F.touches[0].pageY,q)),m.rotate_with_up_fixed&&A.copy(m.getMouseOnScreen_fixed_up(F.touches[0].pageX,F.touches[0].pageY,z));break;case 2:o=n.TOUCH_ZOOM;var I=F.touches[0].pageX-F.touches[1].pageX,J=F.touches[0].pageY-F.touches[1].pageY;w=v=Math.sqrt(I*I+J*J);break;case 3:o=n.TOUCH_PAN,y.copy(m.getMouseOnScreen(F.touches[0].pageX,F.touches[0].pageY,x));break;default:o=n.NONE;}}}function k(F){if(!1!==m.enabled){F.preventDefault(),F.stopPropagation();for(var G=[],H=0;H<F.touches.length;H++)"Ljoystick"!=F.touches[H].target.id&&G.push(F.touches[H]);switch(G.length!=F.touches.length&&(F={touches:G}),F.touches.length){case 1:r=m.getMouseProjectionOnBall(F.touches[0].pageX,F.touches[0].pageY,r),m.rotate_with_up_fixed&&m.getMouseOnScreen_fixed_up(F.touches[0].pageX,F.touches[0].pageY,A);break;case 2:var I=F.touches[0].pageX-F.touches[1].pageX,J=F.touches[0].pageY-F.touches[1].pageY;w=Math.sqrt(I*I+J*J);break;case 3:y=m.getMouseOnScreen(F.touches[0].pageX,F.touches[0].pageY,y);break;default:o=n.NONE;}}}function l(F){if(!1!==m.enabled){for(var G=[],H=0;H<F.touches.length;H++)"Ljoystick"!=F.touches[H].target.id&&G.push(F.touches[H]);switch(G.length!=F.touches.length&&(F={touches:G}),F.touches.length){case 1:q.copy(m.getMouseProjectionOnBall(F.touches[0].pageX,F.touches[0].pageY,r)),m.rotate_with_up_fixed&&z.copy(m.getMouseOnScreen_fixed_up(F.touches[0].pageX,F.touches[0].pageY,z));break;case 2:v=w=0;break;case 3:x.copy(m.getMouseOnScreen(F.touches[0].pageX,F.touches[0].pageY,y));}o=n.NONE}}var m=this,n={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM:4,TOUCH_PAN:5};this.object=a,this.domElement=b===void 0?document:b,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=0.3,this.noRotate=this.noZoom=this.noPan=this.noRoll=!1,this.damping=0.2,this.minDistance=0,this.maxDistance=Infinity,this.target=a._lookAt,this.lastPosition=new THREE.Vector3,this._eye=new THREE.Vector3;var o=n.NONE,p=n.NONE,q=new THREE.Vector3,r=new THREE.Vector3,t=new THREE.Vector2,u=new THREE.Vector2,v=0,w=0,x=new THREE.Vector2,y=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this._fixed=!1,this.objectUp=new THREE.Vector3;var z=new THREE.Vector2,A=new THREE.Vector2,B=new THREE.Vector2;this.rotate_with_up_fixed=!1,this.getMouseOnScreen_fixed_up=function(F,G,H){return this.getMouseOnScreen(F,G,H||new THREE.Vector2)},this.rotateCamera=function(){function F(){if(O=P=null,!self.MMD_SA||!MMD_SA_options.trackball_camera_limit)return!1;var Q=MMD_SA_options.trackball_camera_limit;O=Q.max,P=Q.min,J.copy(this._eye).applyQuaternion(I);var R=Q.adjust&&Q.adjust(J);return R?R:O&&(J.x>O.x||J.y>O.y||J.z>O.z)||P&&(J.x<P.x||J.z<P.z)}function G(){if(!P||!(this._eye.y<P.y))return!1;let Q=this._eye.lengthSq(),R=this._eye.x*this._eye.x,S=this._eye.z*this._eye.z,T=(Q-P.y*P.y)/(R+S);return K.x=(0>this._eye.x?-1:1)*Math.sqrt(R*T),K.z=(0>this._eye.z?-1:1)*Math.sqrt(S*T),K.y=P.y,!0}var H=new THREE.Vector3,I=new THREE.Quaternion,J=new THREE.Vector3,K=new THREE.Vector3,L=new THREE.Vector3,M=new THREE.Vector3,N=new THREE.Quaternion,O,P;return function(){if(this.rotate_with_up_fixed){if(z.distanceToSquared(A)>this.EPS){J.subVectors(this.position0,this.target),L.set(0,J.y,-Math.sqrt(J.x*J.x+J.z*J.z));let R=Math.atan2(L.y,-L.z),S=1.9-R/(Math.PI/4),T=-1.9-R/(Math.PI/4);M.copy(B).add(A).sub(z),M.y=THREE.Math.clamp(M.y,T,S),I.setFromEuler(MMD_SA.TEMP_v3.set(45*M.y/180*Math.PI,180*-M.x/180*Math.PI,0),"YXZ"),K.copy(this._eye);let U=L.angleTo(J);N.setFromAxisAngle(H.set(0,1,0),U),I.multiplyQuaternions(N,I),this._eye.copy(L);let V=F.call(this);if(V)return this._eye.copy(K),void z.copy(A);this._eye.applyQuaternion(I),G.call(this)&&(this._eye.copy(K),z.y=A.y),B.add(A).sub(z),B.y=THREE.Math.clamp(B.y,T,S),z.add(M.copy(A).sub(z).multiplyScalar(this.damping))}return}var Q=q.angleTo(r);if(Q){if(H.crossVectors(q,r).normalize(),Q*=m.rotateSpeed,I.setFromAxisAngle(H,-Q),F.call(this))return void q.copy(r);if(this._eye.applyQuaternion(I),m._fixed||m.object.up.applyQuaternion(I),r.applyQuaternion(I),I.setFromAxisAngle(H,Q*(m.damping-1)),q.applyQuaternion(I),G.call(this)){let R=M.crossVectors(J,K).normalize(),S=J.angleTo(K);N.setFromAxisAngle(R,S),this._eye.applyQuaternion(N),m._fixed||m.object.up.applyQuaternion(N),r.applyQuaternion(N),q.applyQuaternion(N)}}}}();var C=function(){var F=new THREE.Vector3;return function(G,H){if(!self.MMD_SA||!MMD_SA_options.trackball_camera_limit)return void G.multiplyScalar(H);var I=MMD_SA_options.trackball_camera_limit,J=I.max,K=I.min,L=F.copy(G).multiplyScalar(H).length();J&&L>J.length||K&&L<K.length||I.adjust&&I.adjust(G)||(G.multiplyScalar(H),J&&(G.x>J.x&&(G.x=J.x),G.y>J.y&&(G.y=J.y),G.z>J.z&&(G.z=J.z)),K&&(G.x<K.x&&(G.x=K.x),G.y<K.y&&(G.y=K.y),G.z<K.z&&(G.z=K.z)))}}();this.zoomCamera=function(){if(o===n.TOUCH_ZOOM){var F=v/w;v=w,C(this._eye,F)}else{var F=1+(u.y-t.y)*this.zoomSpeed;1!=F&&0<F&&(C(this._eye,F),t.y+=(u.y-t.y)*this.damping)}},this.panCamera=function(){var F=new THREE.Vector2,G=new THREE.Vector3,H=new THREE.Vector3;return function(){F.copy(y).sub(x),F.lengthSq()&&(F.multiplyScalar(this._eye.length()*m.panSpeed),H.copy(this._eye).cross(m.object.up).setLength(F.x),H.add(G.copy(m.object.up).setLength(F.y)),m.object.position.add(H),m.target.add(H),x.add(F.subVectors(y,x).multiplyScalar(m.damping)))}}();var D=new THREE.Vector3,E=1;this.reset=function(){return self.MMD_SA&&(System._browser._wallpaper_mousedown=!1),D.set(0,0,0),E=1,z=new THREE.Vector2,A=new THREE.Vector2,B=new THREE.Vector2,q=new THREE.Vector3,r=new THREE.Vector3,o=p=n.NONE,this.object.position.copy(this.position0),this.object.up.copy(this.up0),this.object.lookAt(this.target0),this._eye.subVectors(this.object.position,this.target),this.lastPosition.copy(this.object.position),this},self.MMD_SA&&(this.SA_adjust=function(){var F=new THREE.Vector3,G=new THREE.Vector3,H=new THREE.Vector3,I=new THREE.Quaternion,J={filter:function(K){return K.no_camera_collision}};return function(K,L){F.copy(this.object.position);var M,N;K&&(K instanceof Array?(M=K[0],N=K[1]):M=N=K,this.object.position.sub(this.target).multiplyScalar(1/E).add(this.target).add(M),this.target.add(N),E=1),L&&D.add(L);var O=10,P=2,Q=1,R=2,S=0,T;(D.x||D.y||D.z)&&(T=I.setFromEuler(D));for(var U=10;U>=P;U--){H.copy(G.copy(this.object.position).sub(this.target).multiplyScalar(1/E*(S+U/O))),T&&G.applyQuaternion(T);var V={return_value:null};if(window.dispatchEvent(new CustomEvent("SA_camera_adjust",{detail:{rot_delta:D,pos_v3:G,result:V}})),!V.return_value){if(Q<R&&10>U&&(1<Q||U>P)){Q++,S+=U/O,O=Math.pow(10,Q),U=10,P=0;continue}(Q==R||1==Q&&(10==U||U==P))&&D.set(0,0,0),this.object.position.copy(G).add(this.target),E=S+U/O;break}1==Q&&U==P&&(this.object.position.copy(H).add(this.target),E=S+U/O)}var W=MMD_SA_options.Dungeon;if(W&&E>2/10){var X=!W.no_camera_collision&&W.check_ray_intersection(this.target,G.copy(this.object.position).sub(this.target),J);if(X){var Y=G.length()/E,Z=Math.max(X.nearest.distance/Y,2/10);this.object.position.sub(this.target).multiplyScalar(1/E*Z).add(this.target),E=Z}}N&&N.lengthSq()>0.01*0.01&&(MMD_SA._mouse_pos_3D=[]),this.object.updateMatrixWorld(),this.position0.add(this.object.position).sub(F)}}()),self.Animate_RAF?(Lbody_host.addEventListener("mousedown",function(F){0!==F.button||c(F)},!1),Lbody_host.addEventListener("wheel",h,!1),Lbody_host.addEventListener("touchstart",j,!1),Lbody_host.addEventListener("touchend",l,!1),Lbody_host.addEventListener("touchmove",k,!1),window.addEventListener("resize",function(){m.resize()})):(this.domElement.addEventListener("contextmenu",function(F){F.preventDefault()},!1),this.domElement.addEventListener("mousedown",c,!1),this.domElement.addEventListener("mousewheel",h,!1),this.domElement.addEventListener("DOMMouseScroll",h,!1),this.domElement.addEventListener("touchstart",j,!1),this.domElement.addEventListener("touchend",l,!1),this.domElement.addEventListener("touchmove",k,!1)),this.resize()},THREE.TrackballControls.prototype={constructor:THREE.TrackballControls,stop:function(){return this.enabled=!1,this},start:function(){return this.enabled=!0,this},setup:function(a){return jThree.extend(this,a),this},fixUp:function(a){this._fixed=a===void 0?!this._fixed:a},resize:function(){if(this.domElement===document)this.screen.left=this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{jThree.extend(this.screen,this.domElement.getBoundingClientRect());var a=this.domElement.ownerDocument.documentElement;this.screen.left+=window.pageXOffset-a.clientLeft,this.screen.top+=window.pageYOffset-a.clientTop}},getMouseOnScreen:function(a,b,c){return(c||new THREE.Vector2).set((a-this.screen.left)/this.screen.width,(b-this.screen.top)/this.screen.height)},getMouseProjectionOnBall:function(a,b,c){var f=new THREE.Vector3((a-0.5*this.screen.width-this.screen.left)/(.5*this.screen.width),(0.5*this.screen.height+this.screen.top-b)/(.5*this.screen.height),0),g=f.length();return this.noRoll?g<Math.SQRT1_2?f.z=Math.sqrt(1-g*g):f.z=.5/g:1<g?f.normalize():f.z=Math.sqrt(1-g*g),this._eye.copy(this.object.position).sub(this.target),c.copy(this.object.up).setLength(f.y),c.add(this.objectUp.copy(this.object.up).cross(this._eye).setLength(f.x)),c.add(this._eye.setLength(f.z)),c},checkDistances:function(){this.noZoom&&this.noPan||(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._eye.lengthSq()<this.minDistance*this.minDistance&&this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)))},EPS:1e-6,update:function(){this.enabled&&(this._eye.subVectors(this.object.position,this.target),!this.noRotate&&this.rotateCamera(),!this.noZoom&&this.zoomCamera(),!this.noPan&&this.panCamera(),this.object.position.addVectors(this.target,this._eye),this.checkDistances(),this.object.lookAt(this.target),this.lastPosition.distanceToSquared(this.object.position)>this.EPS&&this.lastPosition.copy(this.object.position))}},jThree.Trackball=function(a){var b=[];return jThree(isFinite(a)?"rdr:eq("+a+")":a||"rdr").each(function(){var c=new THREE.TrackballControls(jThree.three(jThree.getCamera(this)),jThree.getCanvas(this));jThree.update(this,function(){c.callback&&c.callback(),c.update()}),jThree(this).resize(function(){c.resize()}).on("attrChange",function(f){"camera"!==f.attrName||(c.object=jThree.three(jThree.getCamera(this)),c.target=c.object._lookAt)}),b.push(c)}),self.MMD_SA&&(MMD_SA._trackball_camera=b[0]),1<b.length?b:b[0]};
(function(){function a(){d.call(this),this.type='AudioListener',this.context=j.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function b(k){d.call(this),this.type='Audio',this.listener=k,this.context=k.context,this.gain=this.context.createGain(),this.gain.connect(k.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType='empty',this.filters=[]}function c(k){b.call(this,k),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}var d=THREE.Object3D,e=THREE.Vector3,f=THREE.Quaternion,g=THREE.Clock,h,j={getContext:function(){return void 0===h&&(h=new(window.AudioContext||window.webkitAudioContext)),h},setContext:function(k){h=k}};a.prototype=Object.assign(Object.create(d.prototype),{constructor:a,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(k){return null===this.filter?this.gain.disconnect(this.context.destination):(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)),this.filter=k,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(k){return this.gain.gain.setTargetAtTime(k,this.context.currentTime,0.01),this},updateMatrixWorld:function(){var k=new e,m=new f,n=new e,o=new e,p=new g;return function(r){d.prototype.updateMatrixWorld.call(this,r);var s=this.context.listener,t=this.up;if(this.timeDelta=p.getDelta(),this.matrixWorld.decompose(k,m,n),o.set(0,0,-1).applyQuaternion(m),s.positionX){var u=this.context.currentTime+this.timeDelta;s.positionX.linearRampToValueAtTime(k.x,u),s.positionY.linearRampToValueAtTime(k.y,u),s.positionZ.linearRampToValueAtTime(k.z,u),s.forwardX.linearRampToValueAtTime(o.x,u),s.forwardY.linearRampToValueAtTime(o.y,u),s.forwardZ.linearRampToValueAtTime(o.z,u),s.upX.linearRampToValueAtTime(t.x,u),s.upY.linearRampToValueAtTime(t.y,u),s.upZ.linearRampToValueAtTime(t.z,u)}else s.setPosition(k.x,k.y,k.z),s.setOrientation(o.x,o.y,o.z,t.x,t.y,t.z)}}()}),b.prototype=Object.assign(Object.create(d.prototype),{constructor:b,getOutput:function(){return this.gain},setNodeSource:function(k){return this.hasPlaybackControl=!1,this.sourceType='audioNode',this.source=k,this.connect(),this},setMediaElementSource:function(k){return this.hasPlaybackControl=!1,this.sourceType='mediaNode',this.source=this.context.createMediaElementSource(k),this.connect(),this},setBuffer:function(k){return this.buffer=k,this.sourceType='buffer',this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)return void console.warn('THREE.Audio: Audio is already playing.');if(!1===this.hasPlaybackControl)return void console.warn('THREE.Audio: this Audio has no playback control.');this._player&&this._player._dispatchEvent('playing');var k=this.context.createBufferSource();return k.buffer=this.buffer,k.detune.value=this.detune,k.loop=this.loop,k.onended=this.onEnded.bind(this),k.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,k.start(this.startTime,this.offset),this.isPlaying=!0,this.source=k,this.connect()},pause:function(){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this)},stop:function(){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this)},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var k=1,m=this.filters.length;k<m;k++)this.filters[k-1].connect(this.filters[k]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var k=1,m=this.filters.length;k<m;k++)this.filters[k-1].disconnect(this.filters[k]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(k){return k||(k=[]),!0===this.isPlaying?(this.disconnect(),this.filters=k,this.connect()):this.filters=k,this},setDetune:function(k){return this.detune=k,!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,0.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(k){return this.setFilters(k?[k]:[])},setPlaybackRate:function(k){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.playbackRate=k,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,0.01),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this._player&&this._player._dispatchEvent('ended'),this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn('THREE.Audio: this Audio has no playback control.'),!1):this.loop},setLoop:function(k){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.loop=k,!0===this.isPlaying&&(this.source.loop=this.loop),this)},getVolume:function(){return this.gain.gain.value},setVolume:function(k){return this.gain.gain.setTargetAtTime(k,this.context.currentTime,0.01),this}}),c.prototype=Object.assign(Object.create(b.prototype),{constructor:c,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(k){return this.panner.refDistance=k,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(k){return this.panner.rolloffFactor=k,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(k){return this.panner.distanceModel=k,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(k){return this.panner.maxDistance=k,this},setDirectionalCone:function(k,m,n){return this.panner.coneInnerAngle=k,this.panner.coneOuterAngle=m,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(){var k=new e,m=new f,n=new e,o=new e;return function(q){if(d.prototype.updateMatrixWorld.call(this,q),!1!==this.isPlaying){this.matrixWorld.decompose(k,m,n),o.set(0,0,1).applyQuaternion(m);var r=this.panner;if(r.positionX){var s=this.context.currentTime+this.listener.timeDelta;r.positionX.linearRampToValueAtTime(k.x,s),r.positionY.linearRampToValueAtTime(k.y,s),r.positionZ.linearRampToValueAtTime(k.z,s),r.orientationX.linearRampToValueAtTime(o.x,s),r.orientationY.linearRampToValueAtTime(o.y,s),r.orientationZ.linearRampToValueAtTime(o.z,s)}else r.setPosition(k.x,k.y,k.z),r.setOrientation(o.x,o.y,o.z)}}}()}),THREE.AudioContext=j,THREE.AudioListener=a,THREE.Audio=b,THREE.PositionalAudio=c})();

MMD_SA.fn={length:2,load_length_extra:MMD_SA_options.load_length_extra||0,_ready_for_model_creation:[],_model_creation_timerID:[],setupUI:function(){this.length++;var g=MMD_SA_options.motion.length+MMD_SA_options.x_object.length+1+this.load_length_extra;if(g+=MMD_SA_options.model_path_extra.length,this.length<g)DEBUG_show('('+parseInt(100*(this.length/g))+'% loaded)');else if(this.length==g)this._ready_for_model_creation[0]=!0,DEBUG_show('(100% loaded, processing model...)');else if(this.length==g+1);else if(this.length<g+2+2*MMD_SA_options.model_path_extra.length){var h=parseInt((this.length-(g+2))/2)+1;this._ready_for_model_creation[h]=!0,DEBUG_show('(100% loaded, processing extra model (#'+h+')...)')}else this.length==g+2+2*MMD_SA_options.model_path_extra.length?(setTimeout(function(){MMD_SA.fn.init()},200),DEBUG_show('(MMD starting...)',2)):this.length>g+2&&(DEBUG_show('loading error(?)',0,1),console.log('loading error(?)',this.length+'/'+g))},x_object_init:function(){MMD_SA_options.x_object.forEach(function(e,g){if(MMD_SA_options.x_object_by_name[e.path.replace(/^.+[\/\\]/,'').replace(/\.x$/i,'')]=e,e.id='#x_object'+g,e.show=MMD_SA._x_object_show,e.hide=MMD_SA._x_object_hide,e._obj=jThree(e.id).three(0),null!=e.boundingBox_list){var h=e._obj.children[0].geometry;h.boundingBox_list=[],e.boundingBox_list.forEach(function(j){if(null==j)h.boundingBox_list.push(h.boundingBox);else{var l=new THREE.Box3().set(j.min,j.max);l.oncollide=j.oncollide,l.onaway=j.onaway,h.boundingBox_list.push(l)}}),e.bb_adjust&&h.boundingBox_list.forEach(function(j){e.bb_adjust.min&&j.min.add(e.bb_adjust.min)})}null==e.scale&&(e.scale=0==e._obj.scale.x?0:1),e.visible=!e.hidden_on_start&&0<e._obj.scale.x}),MMD_SA_options.mesh_obj.forEach(function(e){if(MMD_SA_options.mesh_obj_by_id[e.id]=MMD_SA_options.mesh_obj_by_id['#'+e.id]=e,e.id='#'+e.id,e.show=MMD_SA._x_object_show,e.hide=MMD_SA._x_object_hide,/^\#mikuPmx(\d+)$/.test(e.id))e._obj=THREE.MMD.getModels()[parseInt(RegExp.$1)].mesh,Object.defineProperty(e,'visible',{get:function(){return this._obj.visible},set:function(j){this._obj.visible=j}}),null==e.scale&&(e.scale=1),e.visible=!0;else{e._obj||(e._obj=jThree(e.id).three(0));var h=e._obj.children.length?e._obj.children[0]:e._obj;e.castShadow&&(h.castShadow=!0),e.receiveShadow&&(h.receiveShadow=!0),null==e.scale&&(e.scale=0==e._obj.scale.x?0:1),e.visible=!e.hidden_on_start&&0<e._obj.scale.x}}),MMD_SA_options.mesh_obj_all=MMD_SA_options.x_object.concat(MMD_SA_options.mesh_obj)},init:function(){var e=jThree;this.x_object_init();var g=this,h=THREE.MMD.getModels()[0],j=[];h.pmx.materials.forEach(function(C){j.push(C.name)}),MMD_SA._material_list=j;var l=[{path:MMD_SA_options.model_path_default}];for(var n in MMD_SA_options.MME_saved){var o=MMD_SA_options.MME_saved[n];o.path_full&&l.push({path:toLocalPath(o.path_full)})}l.forEach(function(C){var D=C.path;/^(\w+\:|\/)/.test(D)||(D=System.Gadget.path+toLocalPath('\\'+D)),C.in_use=D==MMD_SA_options.model_path||-1!=MMD_SA_options.model_path_extra.indexOf(D)}),MMD_SA._model_list=l,THREE.MMD.getModels().forEach(function(C){C.skin_MMD_SA_extra=[MMD_SA.Animation_dummy],C.morph_MMD_SA_extra=[MMD_SA.Animation_dummy]}),MMD_SA.MMD={MotionManager:function(){this._model_index=0},setFrameNumber:function(){},play:function(){jThree.MMD.play()},pause:function(){jThree.MMD.pause()}},Object.defineProperty(MMD_SA.MMD.MotionManager.prototype,'lastFrame',{get:function(){var C=THREE.MMD.getModels()[this._model_index]._MMD_SA_cache[this.para_SA._path];return 30*C.skin.duration}}),Object.defineProperty(MMD_SA.MMD.MotionManager.prototype,'_timeMax',{get:function(){var C=THREE.MMD.getModels()[this._model_index]._MMD_SA_cache[this.para_SA._path];return C.skin._timeMax}}),Object.defineProperty(MMD_SA.MMD.MotionManager.prototype,'lastFrame_',{get:function(){if(null!=this._lastFrame_)return this._lastFrame_;var C=MMD_SA.MMD.motionManager;return C.para_SA.multi_model_motion_list&&-1!=C.para_SA.multi_model_motion_list.indexOf(this.filename)?C._lastFrame_:this.lastFrame},set:function(C){this._lastFrame_=C}}),Object.defineProperty(MMD_SA.MMD.MotionManager.prototype,'firstFrame_',{get:function(){if(null!=this._firstFrame_)return this._firstFrame_;var C=MMD_SA.MMD.motionManager;return C.para_SA.multi_model_motion_list&&-1!=C.para_SA.multi_model_motion_list.indexOf(this.filename)?C._firstFrame_:0},set:function(C){this._firstFrame_=C}}),MMD_SA.motion=[];for(var x,q=MMD_SA_options.motion_shuffle_list_default&&MMD_SA_options.motion_shuffle_list_default[0]||0,u=0,w=MMD_SA_options.motion.length;u<w;u++){if(x=MMD_SA_options.motion[u],!x.path){MMD_SA.motion.push(new MMD_SA.MMD.MotionManager);continue}var z=decodeURIComponent(x.path.replace(/^.+[\/\\]/,'').replace(/\.vmd$/i,'')),A=MMD_SA_options.motion_para[z]||{},B=jThree.getReferent?jThree.getReferent('#vmd'+u).three(0):MMD_SA.vmd_by_filename[z];if(B._index=u,x.is_vmd_component){MMD_SA.motion.push({});continue}x.morph_component_by_filename&&(B._morph_component=MMD_SA.vmd_by_filename[x.morph_component_by_filename],B._morph_component.url=B.url),THREE.MMD.getModels().forEach(function(C,D){var E,F,G,H,I;if(F=C._MMD_SA_cache[x.path],F)C._MMD_SA_cache_current=F,G=F.skin,H=F.morph,G&&(G._model_index=C._model_index,G._motion_index=u),H&&(H._model_index=C._model_index,H._motion_index=u);else{I=MMD_SA_options.model_para_obj_all[D],E=x.jThree_para;var J=!1;if(A.model_name_RegExp||A.model_index_list?(A.model_name_RegExp&&(J=!A.model_name_RegExp.test(I._filename)),A.model_index_list&&(!A.model_name_RegExp||J)&&(J=-1==A.model_index_list.indexOf(D),J&&-1!=A.model_index_list.indexOf(0)&&I.is_PC_candidate&&(J=!1))):0<D&&!I.is_PC_candidate&&(E||!I.mirror_motion_from_first_model)&&(J=!0),I.motion_name_default==z&&(J=!1),J)return void(D!=MMD_SA_options.model_para_obj_all.length-1||MMD_SA.motion.length&&MMD_SA.motion[MMD_SA.motion.length-1].filename==z||MMD_SA.motion.push({}));F=C.setupMotion_MMD_SA(B,x.match,E),G=F.skin,H=F.morph,E&&(G._is_MMD_SA_custom_animation=H._is_MMD_SA_custom_animation=MMD_SA.custom_action_index&&u>=MMD_SA.custom_action_index&&u<MMD_SA.motion_number_meter_index,G._is_MMD_SA_animation=!0,G._is_skin=!0,G._MMD_SA_disabled=!0,G.freeze_onended=!0,C.skin_MMD_SA_extra&&(G._motion_index_extra=C.skin_MMD_SA_extra.length,C.skin_MMD_SA_extra.push(G)),H._is_MMD_SA_animation=!0,H._is_morph=!0,H._MMD_SA_disabled=!0,H.freeze_onended=!0,C.morph_MMD_SA_extra&&(H._motion_index_extra=C.morph_MMD_SA_extra.length,C.morph_MMD_SA_extra.push(H)),G._MMD_SA_animation_check=H._MMD_SA_animation_check=E.animation_check)}if((!E||G._is_MMD_SA_custom_animation)&&(C._MMD_SA_cache[x.path]=F,!MMD_SA.motion.length||MMD_SA.motion[MMD_SA.motion.length-1].filename!=z)){var K=new MMD_SA.MMD.MotionManager;K.filename=z,K.para_SA=A,K.para_SA._path=x.path,K._index=K.para_SA._index=MMD_SA.motion.length,K._model_index=D,MMD_SA.motion.push(K)}C.skin&&u!=q&&I.motion_name_default!=z||(!I.motion_name_default&&(0==D?u==q&&(I.motion_name_default=z):0<D&&!I.mirror_motion_from_first_model&&(I.motion_name_default=z)),C._MMD_SA_cache_current=F,C.skin=G,C.morph=H,THREE.MMD.adjustMotionDuration())})}MMD_SA.MMD.motionManager=MMD_SA.motion[0],MMD_SA_options.use_speech_bubble&&MMD_SA.SpeechBubble.onload(),MMD_SA._tray_updatable=!0,System._browser.update_tray(),setTimeout(function(){MMD_SA.MMD_started=!0,resize(),e.MMD.cameraMotion=!0,MMD_SA._head_pos=new THREE.Vector3(0,15,0),MMD_SA_options.model_para_obj.onMotionChange&&MMD_SA_options.model_para_obj.onMotionChange();var C=function(){var F=this,G=this.mesh,H=MMD_SA_options.Dungeon&&MMD_SA_options.Dungeon.accessory_list||MMD_SA_options.mesh_obj_all;H.forEach(function(I){var J=I.parent_bone;if(J){var K=J.model_index||0;if(F._model_index==K){if(MMD_SA_options.Dungeon){if(!G.visible||I.parent_bone.disabled)return I._obj_proxy.hidden=!0,void(I._obj_proxy.visible=!1);I._obj_proxy.hidden=!1,I._obj_proxy.visible=!0}if(!J.condition||J.condition(I,K)){var M,L=MMD_SA.motion[F.skin._motion_index].para_SA;M=L.adjustment_per_model&&(L.adjustment_per_model[MMD_SA_options.model_para_obj._filename]||L.adjustment_per_model[MMD_SA_options.model_para_obj._filename_cleaned]),M=M&&M.accessory_default&&M.accessory_default[I.path.replace(/^.+[\/\\]/,'')],M&&(J=M.parent_bone);var N=G.bones_by_name[J.name];if(N){var O=N.skinMatrix.decompose(),P=O[0],Q=O[1],R=I._obj;R.position.copy(P),J.position&&R.position.add(MMD_SA.TEMP_v3.set(J.position.x,J.position.y,-J.position.z).applyQuaternion(Q)),R.useQuaternion=!0,R.quaternion.copy(Q),J.rotation&&(!J.rotation._quaternion&&(J.rotation._quaternion=new THREE.Quaternion().setFromEuler(MMD_SA.TEMP_v3.set(-J.rotation.x,-J.rotation.y,J.rotation.z).multiplyScalar(Math.PI/180),'YXZ')),R.quaternion.multiply(J.rotation._quaternion));var S=MMD_SA.TEMP_m4.makeFromPositionQuaternionScale(R.position,R.quaternion,R.scale).multiplyMatrices(G.matrixWorld,MMD_SA.TEMP_m4).decompose();R.position.copy(S[0]),R.quaternion.copy(S[1]),R.matrixAutoUpdate=!1,R.updateMatrix()}}}}})};THREE.MMD.getModels().forEach(function(F){F.simulateCallback=C});var D=MMD_SA_options.MME.PostProcessingEffects;MMD_SA_options._PPE_enabled=D.enabled,MMD_SA_options.PPE_disabled_on_idle&&MMD_SA_options._PPE_enabled&&(D.enabled=!1),MMD_SA.fadeout_opacity=0.95,MMD_SA.fadeout_canvas.width=SL.width,MMD_SA.fadeout_canvas.height=SL.height;var E=MMD_SA.fadeout_canvas.getContext('2d');E.globalCompositeOperation='copy',E.globalAlpha=0.01,E.fillRect(0,0,SL.width,SL.height),E.globalAlpha=1,MMD_SA_options.model_para_obj_all.forEach(function(F,G){var H=THREE.MMD.getModels()[G].mesh;(F.position_loading||F.bone_connection||H.bones_by_name.)&&H.position.set(0,0,0),F.scale&&H.scale.set(F.scale,F.scale,F.scale)}),THREE.MMD.getModels().forEach(function(){function F(I){this.mesh=I,this.m4=new THREE.Matrix4,this.pos=new THREE.Vector3,this.pos_world=new THREE.Vector3,this.reset()}F.prototype.reset=function(){this.pos.set(0,0,0),this.pos_world.set(0,0,0)},F.prototype.update=function(){this.m4.copy(this.mesh.matrixWorld),G.getPositionFromMatrix(this.m4),H.copy(G).sub(this.pos_world),H.multiplyScalar(MMD_SA_options.matrixWorld_physics_scale),this.pos.add(H),this.pos_world.copy(G),H.y+=25*this.mesh._model_index,this.m4.setPosition(H)};var G=new THREE.Vector3,H=new THREE.Vector3;return function(I){let J=I.mesh;J.matrixWorld_physics=new F(J)}}()),MMD_SA_options.onstart&&MMD_SA_options.onstart(),window.dispatchEvent(new CustomEvent('MMDStarted')),MMD_SA.toggle_shadowMap(),e.MMD.play(!0),DEBUG_show('(MMD started)',2),MMD_SA.use_webgl2&&DEBUG_show('Use WebGL2',2),MMD_SA.use_MSAA_FBO&&DEBUG_show('Use MSAA FBO',2)},0),jThree.Trackball&&(jThree.trackball=jThree.Trackball),e.trackball(),returnBoolean('MMDTrackballCamera')||MMD_SA._trackball_camera.stop(),MMD_SA_options.edgeScale=0<=MMD_SA_options.model_para_obj.edgeScale?MMD_SA_options.model_para_obj.edgeScale:0<=MMD_SA_options.edgeScale?MMD_SA_options.edgeScale:1,e.MMD.edgeScale=parseFloat(System.Gadget.Settings.readString('MMDEdgeScale')||Settings_default.MMDEdgeScale)*MMD_SA_options.edgeScale,jQuery('canvas').on('mousedown mousewheel DOMMouseScroll',function(){e.MMD.cameraMotion=!1}).dblclick(function(){e.MMD.cameraMotion=!0})}},function(){if(MMD_SA.TEMP_q=new THREE.Quaternion,MMD_SA._q1=new THREE.Quaternion,MMD_SA._q2=new THREE.Quaternion,MMD_SA.TEMP_v3=new THREE.Vector3,MMD_SA._v3a=new THREE.Vector3,MMD_SA._v3b=new THREE.Vector3,MMD_SA.TEMP_m4=new THREE.Matrix4,MMD_SA._m4a=new THREE.Matrix4,MMD_SA._m4b=new THREE.Matrix4,MMD_SA.TEMP_b3=new THREE.Box3,MMD_SA._v3a_=new THREE.Vector3,MMD_SA._v3b_=new THREE.Vector3,MMD_SA.process_bone=function(j,l,n){var o=MMD_SA._v3a_.setEulerFromQuaternion(j.quaternion);n&&(o.x*=n[0],o.y*=n[1],o.z*=n[2]),l instanceof THREE.Quaternion&&(l=MMD_SA._v3b_.setEulerFromQuaternion(l)),o.add(l),j.quaternion.setFromEuler(o)},MMD_SA.copy_first_bone_frame=function(j,l,n){n||(n=MMD_SA_options.motion[j].match);var o=n&&n.skin_jThree?n.skin_jThree:null;l._is_skin||(l=THREE.MMD.getModels()[0].skin_MMD_SA_extra[l._motion_index_extra]);var q=l.mesh;l.targets.forEach(function(u){var w=u.keys[0];if(w&&(!o||o.test(w.name))&&!w.time){var x=q.bones_by_name[w.name],z=q.geometry.bones[x._index];w.pos[0]=x.position.x-z.pos[0],w.pos[1]=x.position.y-z.pos[1],w.pos[2]=x.position.z-z.pos[2],w.rot=x.quaternion.toArray()}})},MMD_SA.reset_skin=function(j){THREE.MMD.getModels().forEach(function(l,n){if(null==j||n==j){var o=l.skin;if(o&&!o._is_dummy)for(var q=o.mesh,u=q.geometry,w=0,x=q.bones.length;w<x;w++){var z=q.bones[w],A=u.bones[w];z.position.set(A.pos[0],A.pos[1],A.pos[2]),z.quaternion.set(0,0,0,1)}}})},MMD_SA.reset_morph=function(j){THREE.MMD.getModels().forEach(function(l,n){if(null==j||n==j){var o=l.morph;if(!(o&&o._is_dummy)&&(o=l.mesh.morphTargetInfluences,o))for(var q=0,u=o.length;q<u;q++)o[q]=0}})},MMD_SA._camera_y_offset_=0,MMD_SA.reset_camera=function(j){j&&window.dispatchEvent(new CustomEvent('MMDCameraReset',{detail:{}})),this._camera_y_offset_=0;var l=this.center_view,n=this.center_view_lookAt,o=THREE.MMD.getModels()[0].mesh.position,q=MMD_SA_options.camera_position.slice();if(MMD_SA_options.use_random_camera&&returnBoolean('MMDRandomCamera')&&(MMD_SA.MMD.motionManager.para_SA.use_random_camera||Audio_BPM.vo.BPM_mode)){var u=MMD_SA_options.random_camera;q=MMD_SA.TEMP_v3.set(q[0]-o.x,q[1]-o.y,q[2]-o.z).multiplyScalar(u.distance[0]+Math.random()*(u.distance[1]-u.distance[0])).applyQuaternion(MMD_SA.TEMP_q.setFromEuler(MMD_SA._v3a.set((u.rotation.x[0]+Math.random()*(u.rotation.x[1]-u.rotation.x[0]))*Math.PI/180,(u.rotation.y[0]+Math.random()*(u.rotation.y[1]-u.rotation.y[0]))*Math.PI/180,(u.rotation.z[0]+Math.random()*(u.rotation.z[1]-u.rotation.z[0]))*Math.PI/180))).add(o).toArray()}var w=this._trackball_camera;w.position0.set(q[0]+l[0],q[1]+l[1],q[2]+l[2]),w.target0.set(o.x+n[0],o.y+10+n[1],o.z+n[2]),w.reset(),MMD_SA._mouse_pos_3D=[],MMD_SA._trackball_camera.SA_adjust(),MMD_SA._trackball_camera.rotate_with_up_fixed=MMD_SA_options.Dungeon&&MMD_SA_options.Dungeon.character.TPS_mode},MMD_SA.Animation_dummy={_is_dummy:!0,_MMD_SA_disabled:!0},MMD_SA.Animation_dummy.reset=MMD_SA.Animation_dummy.seek=MMD_SA.Animation_dummy.play=MMD_SA.Animation_dummy.pause=MMD_SA.Animation_dummy.update=MMD_SA.Animation_dummy.adjustDuration=MMD_SA.Animation_dummy.onupdate=function(){},THREE.Box3.prototype.intersectObject=function(){function j(ma,na){return ma.normal.y>na}function l(ma,na,oa,pa,qa,ra,sa,ta){var ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da;if(wa=oa-ma,xa=pa-na,ya=sa-qa,za=ta-ra,Ca=wa*za-ya*xa,0==Ca)return 0;var Ea=0<Ca;if(ua=ma-qa,va=na-ra,Aa=wa*va-xa*ua,0>Aa==Ea)return 0;if(Ba=ya*va-za*ua,0>Ba==Ea)return 0;if(Aa>Ca==Ea||Ba>Ca==Ea)return 0;Da=Ba/Ca;var Fa=ma+Da*wa,Ga=na+Da*xa;return[Fa,Ga]}var n={},o=new THREE.Vector3,q=new THREE.Vector3,u=new THREE.Vector3,w=new THREE.Vector3,x=new THREE.Vector3,z=new THREE.Vector3,A=new THREE.Vector3,B=new THREE.Vector3,C=new THREE.Vector3,D=new THREE.Vector3,E=new THREE.Vector3,F=new THREE.Vector3,G=new THREE.Vector3,H=new THREE.Vector3,I=new THREE.Vector3,J=new THREE.Vector3,K=new THREE.Vector3,L=new THREE.Plane;n.isIntersectionAABBPlane=function(ma,na){o.addVectors(ma.max,ma.min).multiplyScalar(0.5),q.subVectors(ma.max,o);var oa=q.x*Math.abs(na.normal.x)+q.y*Math.abs(na.normal.y)+q.z*Math.abs(na.normal.z),pa=na.normal.dot(o)-na.constant;return Math.abs(pa)<=oa},n.isIntersectionTriangleAABB=function(ma,na,oa,pa){var qa,ra,sa,ta;return(o.addVectors(pa.max,pa.min).multiplyScalar(0.5),q.subVectors(pa.max,o),u.subVectors(ma,o),w.subVectors(na,o),x.subVectors(oa,o),z.subVectors(w,u),A.subVectors(x,w),B.subVectors(u,x),C.set(0,-z.z,z.y),D.set(0,-A.z,A.y),E.set(0,-B.z,B.y),F.set(z.z,0,-z.x),G.set(A.z,0,-A.x),H.set(B.z,0,-B.x),I.set(-z.y,z.x,0),J.set(-A.y,A.x,0),K.set(-B.y,B.x,0),qa=u.dot(C),ra=w.dot(C),sa=x.dot(C),ta=q.y*Math.abs(z.z)+q.z*Math.abs(z.y),!(Math.max(-Math.max(qa,ra,sa),Math.min(qa,ra,sa))>ta))&&(qa=u.dot(D),ra=w.dot(D),sa=x.dot(D),ta=q.y*Math.abs(A.z)+q.z*Math.abs(A.y),!(Math.max(-Math.max(qa,ra,sa),Math.min(qa,ra,sa))>ta))&&(qa=u.dot(E),ra=w.dot(E),sa=x.dot(E),ta=q.y*Math.abs(B.z)+q.z*Math.abs(B.y),!(Math.max(-Math.max(qa,ra,sa),Math.min(qa,ra,sa))>ta))&&(qa=u.dot(F),ra=w.dot(F),sa=x.dot(F),ta=q.x*Math.abs(z.z)+q.z*Math.abs(z.x),!(Math.max(-Math.max(qa,ra,sa),Math.min(qa,ra,sa))>ta))&&(qa=u.dot(G),ra=w.dot(G),sa=x.dot(G),ta=q.x*Math.abs(A.z)+q.z*Math.abs(A.x),!(Math.max(-Math.max(qa,ra,sa),Math.min(qa,ra,sa))>ta))&&(qa=u.dot(H),ra=w.dot(H),sa=x.dot(H),ta=q.x*Math.abs(B.z)+q.z*Math.abs(B.x),!(Math.max(-Math.max(qa,ra,sa),Math.min(qa,ra,sa))>ta))&&(qa=u.dot(I),ra=w.dot(I),sa=x.dot(I),ta=q.x*Math.abs(z.y)+q.y*Math.abs(z.x),!(Math.max(-Math.max(qa,ra,sa),Math.min(qa,ra,sa))>ta))&&(qa=u.dot(J),ra=w.dot(J),sa=x.dot(J),ta=q.x*Math.abs(A.y)+q.y*Math.abs(A.x),!(Math.max(-Math.max(qa,ra,sa),Math.min(qa,ra,sa))>ta))&&(qa=u.dot(K),ra=w.dot(K),sa=x.dot(K),ta=q.x*Math.abs(B.y)+q.y*Math.abs(B.x),!(Math.max(-Math.max(qa,ra,sa),Math.min(qa,ra,sa))>ta))&&(Math.max(u.x,w.x,x.x)<-q.x||Math.min(u.x,w.x,x.x)>q.x?!1:Math.max(u.y,w.y,x.y)<-q.y||Math.min(u.y,w.y,x.y)>q.y?!1:Math.max(u.z,w.z,x.z)<-q.z||Math.min(u.z,w.z,x.z)>q.z?!1:(L.normal.copy(A).cross(z).normalize(),L.constant=L.normal.dot(ma),n.isIntersectionAABBPlane(pa,L)))};var la,M={_updated:!1,reset:function(ma){this.x_min={state:0,depth:[0,0],info:['','']},this.x_max={state:0,depth:[0,0],info:['','']},this.z_min={state:0,depth:[0,0],info:['','']},this.z_max={state:0,depth:[0,0],info:['','']},this.y_min={state:0,depth:[0,0],info:['','']},this.y_max={state:0,depth:[0,0],info:['','']},this.blocked={state:0,depth:[0,0],info:['','']},this.depth_min=0.1/ma._obj.scale.length(),this._updated=!1},set_state:function(ma,na,oa){na>M.depth_min&&this.depth[ma-1]<na&&(this.depth[ma-1]=na,this.state<ma&&(this.state=ma),this.info=oa,this!=M.y_min&&(M._updated=!0))}},N=new THREE.Matrix4,O=new THREE.Plane,P=new THREE.Ray,Q=new THREE.Box3,R=new THREE.Box3,S=new THREE.Box3,T=new THREE.Box3,U=new THREE.Box3,V=new THREE.Box3,W=new THREE.Box3,X=new THREE.Box3,Y=new THREE.Box3,Z=new THREE.Box3,_=new THREE.Vector3,aa=new THREE.Vector3,ba=new THREE.Vector3,ca=new THREE.Vector3,da={x_min:new THREE.Plane,x_max:new THREE.Plane,z_min:new THREE.Plane,z_max:new THREE.Plane,y_min:new THREE.Plane,y_max:new THREE.Plane},ea={x_min:new THREE.Plane,x_max:new THREE.Plane,z_min:new THREE.Plane,z_max:new THREE.Plane,y_min:new THREE.Plane,y_max:new THREE.Plane},fa={x_min:new THREE.Plane,x_max:new THREE.Plane,z_min:new THREE.Plane,z_max:new THREE.Plane,y_min:new THREE.Plane,y_max:new THREE.Plane},ga={x_min:new THREE.Plane,x_max:new THREE.Plane,z_min:new THREE.Plane,z_max:new THREE.Plane,y_min:new THREE.Plane,y_max:new THREE.Plane},ha=new THREE.Vector3,ia=new THREE.Vector3,ja=new THREE.Vector3,ka=new THREE.Plane;return function(ma,na){var wa,xa,ya,za,oa=ma.collision_by_mesh_face_grounded||j,pa=ma._obj,qa=pa.geometry?pa:pa.children[0],ra=qa.geometry,sa=ra.vertices,ta=qa.material instanceof THREE.MeshFaceMaterial,ua=!0===ta?qa.material.materials:null,va=qa.material.side;N.getInverse(pa.matrixWorld),Q.copy(na).applyMatrix4(N),R.copy(this).applyMatrix4(N);var Aa=this==na?[Q]:[R,Q],Ba=Q.min.y>R.min.y?Q:R,Ca=Ba.min.y+0.25*(Ba.max.y-Ba.min.y),Da=Ba.center(o).y,Ea=(Q.min.y>R.min.y?R.min.y:Q.min.y)-2*Math.max(Q.max.x-Q.min.x,Q.max.z-Q.min.z);R.union(Q),Q.center(_),R.center(aa),P.set(ha.copy(aa).setY(R.max.y),new THREE.Vector3(0,-1,0)),U.copy(Q),U.expandByVector(ha.copy(U.size(ba)).multiplyScalar(-0.25)),U.min.y=Ca,V.copy(R),V.expandByVector(ha.copy(V.size(ca)).multiplyScalar(-0.25)),V.min.y=Ca,W.copy(Q),W.expandByVector(ha.copy(W.size(ba)).multiplyScalar(-0.125)),W.min.y=Ca,X.copy(R),X.expandByVector(ha.copy(X.size(ca)).multiplyScalar(-0.125)),X.min.y=Ca;var Fa=!1,Ga=-999;S.copy(Q),T.copy(T),Q.min.y=Math.min(ra.boundingBox.min.y,Q.min.y),R.min.y=Math.min(ra.boundingBox.min.y,R.min.y);var Ha={},Ia={},Ja={},Ka={},La=[Q,R,S,T],Ma=[Ha,Ia,Ja,Ka];for(var Na in da)'x_min'===Na||'x_max'===Na?La.forEach(function(gb,hb){Ma[hb][Na]=[[[gb.min.z,gb.max.y],[gb.max.z,gb.max.y]],[[gb.max.z,gb.max.y],[gb.max.z,gb.min.y]],[[gb.min.z,gb.min.y],[gb.max.z,gb.min.y]],[[gb.min.z,gb.max.y],[gb.min.z,gb.min.y]]]}):'z_min'===Na||'z_max'===Na?La.forEach(function(gb,hb){Ma[hb][Na]=[[[gb.min.x,gb.max.y],[gb.max.x,gb.max.y]],[[gb.max.x,gb.max.y],[gb.max.x,gb.min.y]],[[gb.min.x,gb.min.y],[gb.max.x,gb.min.y]],[[gb.min.x,gb.max.y],[gb.min.x,gb.min.y]]]}):'y_min'===Na||'y_max'===Na?La.forEach(function(gb,hb){Ma[hb][Na]=[[[gb.min.x,gb.max.z],[gb.max.x,gb.max.z]],[[gb.max.x,gb.max.z],[gb.max.x,gb.min.z]],[[gb.min.x,gb.min.z],[gb.max.x,gb.min.z]],[[gb.min.x,gb.max.z],[gb.min.x,gb.min.z]]]}):void 0;var La=[Q,R,S,T];[da,ea,fa,ga].forEach(function(gb,hb){var ib=La[hb];gb.x_min.setFromNormalAndCoplanarPoint(ha.set(-1,0,0),ia.set(ib.min.x,0,0)),gb.x_max.setFromNormalAndCoplanarPoint(ha.set(1,0,0),ia.set(ib.max.x,0,0)),gb.z_min.setFromNormalAndCoplanarPoint(ha.set(0,0,-1),ia.set(0,0,ib.min.z)),gb.z_max.setFromNormalAndCoplanarPoint(ha.set(0,0,1),ia.set(0,0,ib.max.z)),gb.y_min.setFromNormalAndCoplanarPoint(ha.set(0,-1,0),ia.set(0,ib.min.y,0)),gb.y_max.setFromNormalAndCoplanarPoint(ha.set(0,1,0),ia.set(0,ib.max.y,0))}),M.reset(ma);var Pa,Qa,Ra,Oa=ma.collision_by_mesh_material_index_max||999;ma.collision_by_mesh_sort_range?(Pa=ma.collision_by_mesh_sort_range,Qa=ma.mesh_sorted.index_list,Ra=0):(Pa=0,Qa=ra.faces,Ra=0);for(var Sa={},Ta=[],Ua={},Va=-1,Wa=Ra,Xa=Qa.length;Wa<Xa;Wa++){var Ya=0===Pa?Wa:Qa[Wa];var Za=ra.faces[Ya];if(Za.materialIndex>=Oa)break;var $a=!0==ta?ua[Za.materialIndex]:qa.material;if(void 0!==$a){wa=sa[Za.a],xa=sa[Za.b],ya=sa[Za.c];var va=$a.side;if(va!==THREE.DoubleSide){var _a=ha.addVectors(wa,xa).add(ya).multiplyScalar(1/3).sub(aa).normalize().dot(Za.normal);if(va===THREE.FrontSide?!(0>_a):!(0<_a))continue}if(la=[],Za instanceof THREE.Face3)la.push([wa,xa,ya]);else if(Za instanceof THREE.Face4)za=sa[Za.d],la.push([wa,xa,za],[xa,ya,za]);else continue;la.forEach(function(fc){var gc=0;Aa.some(function(hc){if(!n.isIntersectionTriangleAABB(fc[0],fc[1],fc[2],hc))return!0;Sa[Ya]={};var ic,jc,kc,lc,mc,nc,oc,pc,qc,sc;hc==Q?(ic=S,jc=U,kc=W,lc=Ha,mc=Ja,nc=da,oc=fa,pc=_,qc=ba,sc=1,Fa=!0):(ic=T,jc=V,kc=X,lc=Ia,mc=Ka,nc=ea,oc=ga,pc=aa,qc=ca,sc=2);var uc,vc=0,wc=oa(Za,0.5);P.intersectTriangle(fc[2],fc[0],fc[1],!1,ha)&&(ha.y>Da?ha.y>jc.max.y?M.set_state.call(M.y_max,sc,hc.max.y-ha.y):uc=!0:vc>=gc&&(vc=gc=sc,Ga=Math.max(Ga,ha.y),Ga==ha.y&&(Va=Ya)));for(var xc=0;2>xc;xc++){var yc,zc,Ac,Bc;1==xc?(yc=hc,zc=nc,Ac=lc,Bc=Y):(yc=ic,zc=oc,Ac=mc,Bc=Z);var Cc=[],Dc=[];if(uc||fc.some(function(cd,dd){if(yc.containsPoint(cd)){if(jc.containsPoint(cd))return uc=!0,!0;Cc.push(cd.clone())}else Dc[dd]=!0}),uc)return void M.set_state.call(M.blocked,sc,1,Ya);var Ec=[];(Dc[0]||Dc[1])&&Ec.push(new THREE.Line3(fc[0],fc[1])),(Dc[1]||Dc[2])&&Ec.push(new THREE.Line3(fc[1],fc[2])),(Dc[2]||Dc[0])&&Ec.push(new THREE.Line3(fc[2],fc[0]));var Fc={x_min:[],x_max:[],z_min:[],z_max:[],y_min:[],y_max:[]};for(var Gc in Ec.forEach(function(cd){for(var dd in zc){var ed=zc[dd].intersectLine(cd);ed&&Fc[dd].push(ed)}}),Fc){var Hc=Fc[Gc];if(!(2>Hc.length)){var Ic=0,Jc=[];if(Hc.forEach(function(cd){var dd;'x_min'==Gc||'x_max'==Gc?dd=cd.y>=yc.min.y&&cd.y<=yc.max.y&&cd.z>=yc.min.z&&cd.z<=yc.max.z:'z_min'==Gc||'z_max'==Gc?dd=cd.y>=yc.min.y&&cd.y<=yc.max.y&&cd.x>=yc.min.x&&cd.x<=yc.max.x:'y_min'==Gc||'y_max'==Gc?dd=cd.z>=yc.min.z&&cd.z<=yc.max.z&&cd.x>=yc.min.x&&cd.x<=yc.max.x:void 0,dd&&(Ic++,Jc.push(cd))}),2>Ic){var Kc;'x_min'==Gc||'x_max'==Gc?Kc=[Hc[0].z,Hc[0].y,Hc[1].z,Hc[1].y]:'z_min'==Gc||'z_max'==Gc?Kc=[Hc[0].x,Hc[0].y,Hc[1].x,Hc[1].y]:'y_min'==Gc||'y_max'==Gc?Kc=[Hc[0].x,Hc[0].z,Hc[1].x,Hc[1].z]:void 0,Ac[Gc].some(function(cd){var dd=l(cd[0][0],cd[0][1],cd[1][0],cd[1][1],Kc[0],Kc[1],Kc[2],Kc[3]);if(dd){var ed;return'x_min'==Gc?ed=new THREE.Vector3(yc.min.x,dd[1],dd[0]):'x_max'==Gc?ed=new THREE.Vector3(yc.max.x,dd[1],dd[0]):'z_min'==Gc?ed=new THREE.Vector3(dd[0],dd[1],yc.min.z):'z_max'==Gc?ed=new THREE.Vector3(dd[0],dd[1],yc.max.z):'y_min'==Gc?ed=new THREE.Vector3(dd[0],yc.min.y,dd[1]):'y_max'==Gc?ed=new THREE.Vector3(dd[0],yc.max.y,dd[1]):void 0,Jc.push(ed),2==++Ic}})}2==Ic&&Cc.push(Jc[0],Jc[1])}}if(Cc.length){var Lc=ha.copy(Cc[0]),Mc=ia.copy(Cc[0]);Cc.forEach(function(cd){Lc.min(cd),Mc.max(cd)}),Bc.set(Lc,Mc),yc==hc&&(wc&&!vc&&sc>=gc&&(Bc.max.y<Ca?(vc=gc=sc,Ga=Math.max(Ga,Bc.max.y),Ga==Bc.max.y&&(Va=Ya)):Bc.min.y<Ca&&(vc=gc=sc,Ga=Math.max(Ga,Ca),Ga==Ca&&(Va=Ya))),1==sc&&Cc.forEach(function(cd){if(cd.y>Ea&&(wc||vc)){var dd=cd.clone();Ta.push(dd),Ua[Ya]||(Ua[Ya]=[]),Ua[Ya].push(dd)}}));var Nc=ja.copy(Za.normal).multiplyScalar(Math.max(qc.x,qc.z)).negate();Cc.forEach(function(cd){cd.add(Nc),Lc.min(cd),Mc.max(cd)}),Bc.set(Lc,Mc).intersect(yc);var Oc=Sa[Ya];if(Oc.abc=[Za.a,Za.b,Za.c],Oc.bb_priority={},Oc.bb_priority[sc]={_bb_contained:Bc.clone()},vc)return;if(Bc.max.y<Ga)return;for(var Pc,Rc,Sc,Tc,Uc,Vc,Wc,Xc,Yc,Zc,Qc='',$c=0;2>$c;$c++){if(1==$c){var _c=0;for(var ad in Sa){Oc=Sa[ad];var bd=Oc.abc;!bd||ad==Ya||!Oc.bb_priority[sc]||-1==bd.indexOf(Za.a)&&-1==bd.indexOf(Za.b)&&-1==bd.indexOf(Za.c)||(_c++,Bc.union(Oc.bb_priority[sc]._bb_contained))}if(!_c)break}else;Pc=Bc.center(ha),Rc=Pc.x>jc.min.x&&Pc.x<jc.max.x,Sc=Pc.y>jc.min.y&&Pc.y<jc.max.y,Tc=Pc.z>jc.min.z&&Pc.z<jc.max.z,Uc=Rc||Bc.min.x>kc.min.x&&Bc.min.x<kc.max.x||Bc.max.x>kc.min.x&&Bc.max.x<kc.max.x,Vc=Bc.max.y>Ca,Wc=Tc||Bc.min.z>kc.min.z&&Bc.min.z<kc.max.z||Bc.max.z>kc.min.z&&Bc.max.z<kc.max.z,Xc=!Rc,Yc=!Sc,Zc=!Tc,Xc&&Vc&&M.set_state.call(M['x_'+(Pc.x>pc.x?'max':'min')],sc,Bc.max.x-Bc.min.x,Qc),Uc&&Yc&&Wc&&M.set_state.call(M['y_'+(Pc.y>pc.y?'max':'min')],sc,Bc.max.y-Bc.min.y,Qc),Vc&&Zc&&M.set_state.call(M['z_'+(Pc.z>pc.z?'max':'min')],sc,Bc.max.z-Bc.min.z,Qc)}}}})})}}var ab=0;for(var cb in Sa)ab++;var db=[];if(-1!=Va&&Ua[Va]){var eb=ra.faces[Va];for(var cb in Ta=Ua[Va].slice(),Ua){fh=Sa[cb];var fb=fh.abc;!fb||cb==Va||-1==fb.indexOf(eb.a)&&-1==fb.indexOf(eb.b)&&-1==fb.indexOf(eb.c)||(db.push(cb),Ta=Ta.concat(Ua[cb]))}db.push(Va)}return{hit:[ab,Qa.length],updated:M._updated||-999<Ga||Fa,blocked_side:M,ground_y:Ga,ground_face_index:Va,ground_face_connected:db,bb_static_collided:Fa,plane_pts:Ta}}}(),THREE.Ray.prototype.intersectTriangle=function(){var j=new THREE.Vector3,l=new THREE.Vector3,n=new THREE.Vector3,o=new THREE.Vector3;return function(u,w,x,z,A){l.subVectors(w,u),n.subVectors(x,u),o.crossVectors(l,n);var C,B=this.direction.dot(o);if(0<B){if(z)return null;C=1}else if(0>B)C=-1,B=-B;else return null;j.subVectors(this.origin,u);var D=C*this.direction.dot(n.crossVectors(j,n));if(0>D)return null;var E=C*this.direction.dot(l.cross(j));if(0>E)return null;if(D+E>B)return null;var F=-C*j.dot(o);return 0>F?null:this.at(F/B,A)}}(),MMD_SA.bone_to_position=function(){function j(){this.by_bone_name=[],this.pos_delta=new THREE.Vector3,this.pos_delta_rotated=new THREE.Vector3,this.bone_pos_offset=new THREE.Vector3}var l=new THREE.Vector3,n=new THREE.Vector3,o=new THREE.Vector3,q=new THREE.Vector3;return j.prototype.init=function(u,w,x,z){var A=this.by_bone_name[w];A||(A=this.by_bone_name[w]={gbone:{position:new THREE.Vector3().fromArray(u.geometry.bones[u.bones_by_name[w]._index].pos)},position:new THREE.Vector3,quaternion:new THREE.Quaternion,path:'',motion_time:0}),(A.path!=x||A.motion_time>z)&&(A.position.set(0,0,0),A.quaternion.set(0,0,0,1),A.path=x),A.motion_time=z,this.gbone=A.gbone,this.position=A.position,this.quaternion=A.quaternion},function(u){var w=this;if(!w.skin)return null;var x=this.mesh;if(x._bone_to_position_last?(x._bone_to_position_last.pos_delta.set(0,0,0),x._bone_to_position_last.pos_delta_rotated.set(0,0,0),x._bone_to_position_last.bone_pos_offset.set(0,0,0)):x._bone_to_position_last=new j,!u.bone_to_position)return null;var z=u.adjustment_per_model&&(u.adjustment_per_model[MMD_SA_options.model_para_obj_all[this._model_index]._filename_cleaned]||u.adjustment_per_model._default_)||{};return u.bone_to_position.forEach(function(A){var B=A.name,C=A.scale||{x:1,y:1,z:1},D=x.bones_by_name[B],E=w.skin.time,F=30*E;x._bone_to_position_last.init(x,B,u._path,E),!A.frame_range||A.frame_range.some(function(I){return F>=I[0]&&F<=I[1]})?l.copy(D.position).sub(x._bone_to_position_last.gbone.position).multiply(C):l.set(0,0,0),o.copy(l);var G,H;if(z.skin_default){let I=z.skin_default[B]||{};G=I.rot_add||I.rot,G||u.bone_to_position.some(function(J){return'\u5168\u3066\u306E\u89AA'==J.name})||(I=z.skin_default.||{},G=I.rot_add||I.rot,H=!!G),G&&o.applyEuler(q.copy(G).multiplyScalar(Math.PI/180))}if(A.position_disabled?(n.set(0,0,0),o.set(0,0,0)):(n.copy(o).sub(x._bone_to_position_last.position),x._bone_to_position_last.position.copy(o)),'\u5168\u3066\u306E\u89AA'==B)D.position.sub(l),x._bone_to_position_last.bone_pos_offset.add(l);else{let I=H?l.applyEuler(q.copy(G).multiplyScalar(Math.PI/180)):l;x.bones_by_name..position.sub(I),x._bone_to_position_last.bone_pos_offset.add(I)}x._bone_to_position_last.pos_delta.add(n)}),x._bone_to_position_last.pos_delta_rotated.copy(x._bone_to_position_last.pos_delta).applyQuaternion(x.quaternion),x._bone_to_position_last.pos_delta}}(),MMD_SA_options.use_JSARToolKit){var e=MMD_SA.AR_obj={startup_countdown:1,TEMP_v3:new THREE.Vector3,_v3a:new THREE.Vector3,TEMP_q:new THREE.Quaternion,_q1:new THREE.Quaternion,_q2:new THREE.Quaternion,_q3:new THREE.Quaternion,TEMP_m4:new THREE.Matrix4,_m4a:new THREE.Matrix4,_m4b:new THREE.Matrix4};var g=MMD_SA_options.AR_para;THREE.Camera.prototype.setJsArMatrix=function(j){var l=new Float32Array(16);return j.copyCameraMatrix(l,10,1e4),this.projectionMatrix.set(l[0],l[4],l[8],l[12],l[1],l[5],l[9],l[13],l[2],l[6],l[10],l[14],l[3],l[7],l[11],l[15])},THREE.Matrix4.prototype.setJsArMatrix=function(j){return this.set(j.m00,j.m01,-j.m02,j.m03,-j.m10,-j.m11,j.m12,-j.m13,j.m20,j.m21,-j.m22,j.m23,0,0,0,1)},e.canvas=document.createElement('canvas'),e.canvas.width=g.video_width,e.canvas.height=g.video_height,e.raster=new NyARRgbRaster_Canvas2D(e.canvas),e.param=new FLARParam(e.canvas.width,e.canvas.height,49),e.detector=new FLARMultiIdMarkerDetector(e.param,g.marker_width),e.detector.setContinueMode(!0),e.markers={},e.compensationMatrix=new THREE.Matrix4().makeScale(1,1,-1),e.compensationMatrix.multiply(new THREE.Matrix4().makeRotationX(THREE.Math.degToRad(90)))}MMD_SA.use_jThree_v1&&jThree.goml('index.goml')}();
